(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};__webpack_require__.d(getter,'a',getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=7)})([(function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__GameScene__=__webpack_require__(12);const config={type:Phaser.AUTO,scale:{mode:Phaser.Scale.FIT,parent:'phaser-example',autoCenter:Phaser.Scale.CENTER_BOTH,width:1097,height:1920},dom:{createContainer:true},scene:__WEBPACK_IMPORTED_MODULE_0__GameScene__["a"],};__webpack_exports__["a"]=(config)}),(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",function(){return shadow});__webpack_require__.d(__webpack_exports__,"f",function(){return starterElements});__webpack_require__.d(__webpack_exports__,"g",function(){return winElements});__webpack_require__.d(__webpack_exports__,"c",function(){return restart});__webpack_require__.d(__webpack_exports__,"b",function(){return firstRun});var __WEBPACK_IMPORTED_MODULE_0__config__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_1__update_StarterListener__=__webpack_require__(5);let shadow,starterElements,winElements,winCoin,winNum,restart=true,firstRun=true;const setRestart=(value)=>{restart=value}__webpack_exports__["d"]=setRestart;const Starter=(game)=>{shadow=game.add.image(0,0,'shadow').setOrigin(0).setDepth(2);const playFrame=game.add.image(-10,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.height+130,'frame3').setOrigin(0,1).setDepth(2);const playBtn=game.add.image(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width/2,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.height+10,'button').setOrigin(0.5,1).setDepth(2).setInteractive({cursor:'pointer'});const question_ico=game.add.image(300,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.height-250,'question_icon').setOrigin(0,1).setDepth(2);const questionText=game.add.text(400,playFrame.y-460,'How To Play',{fontSize:'72px',color:'#ff8729',fontFamily:'DRAguSans',},).setDepth(2);const playText=game.add.text(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width/2-50,playBtn.y-90,'Play For 60',{fontSize:'72px',color:'#fff',fontFamily:'DRAguSans',},).setOrigin(0.5,1).setDepth(2);const coin=game.add.image(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width/2+185,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.height-80,'coin_icon_small',).setOrigin(0.5,1).setDepth(2);const winWindow=game.add.image(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width/2,230,'frame1',).setOrigin(0.5,0).setDepth(2);const winText=game.add.text(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width/2,winWindow.y+40,'You win',{fontSize:'116px',fontFamily:'DRAguSans',color:'#f45b4e',},).setDepth(2).setOrigin(0.5,0);winText.setText(winText.text.toUpperCase());const winNum=game.add.text(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width/2-50,winWindow.y+220,'0',{fontSize:'126px',fontFamily:'DRAguSans',color:'#000',},).setDepth(2).setOrigin(0.5);const winCoin=game.add.image(winNum.x+(winNum.width*2)+20,winNum.y,'coin_icon_big',).setOrigin(0.5).setDepth(2);playBtn.on('pointerup',function(event){restart=false;if(!firstRun){Object(__WEBPACK_IMPORTED_MODULE_1__update_StarterListener__["b"])(false)}firstRun=false});starterElements=[playFrame,playBtn,question_ico,questionText,playText,coin];winElements=[winWindow,winText,winNum,winCoin,]for(const element of starterElements){element.defaultY=element.y}for(const element of winElements){element.setAlpha(0)}}__webpack_exports__["a"]=Starter}),(function(module,exports){var g;g=(function(){return this})();try{g=g||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")g=window}module.exports=g}),(function(module,exports,__webpack_require__){(function webpackUniversalModuleDefinition(root,factory){if(true)module.exports=factory();else if(typeof define==='function'&&define.amd)define("Phaser",[],factory);else if(typeof exports==='object')exports["Phaser"]=factory();else root["Phaser"]=factory()})(window,function(){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{enumerable:true,get:getter})}};__webpack_require__.r=function(exports){if(typeof Symbol!=='undefined'&&Symbol.toStringTag){Object.defineProperty(exports,Symbol.toStringTag,{value:'Module'})}Object.defineProperty(exports,'__esModule',{value:true})};__webpack_require__.t=function(value,mode){if(mode&1)value=__webpack_require__(value);if(mode&8)return value;if((mode&4)&&typeof value==='object'&&value&&value.__esModule)return value;var ns=Object.create(null);__webpack_require__.r(ns);Object.defineProperty(ns,'default',{enumerable:true,value:value});if(mode&2&&typeof value!='string')for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module['default']}:function getModuleExports(){return module};__webpack_require__.d(getter,'a',getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=1393)})([(function(module,exports){function hasGetterOrSetter(def){return(!!def.get&&typeof def.get==='function')||(!!def.set&&typeof def.set==='function')}function getProperty(definition,k,isClassDescriptor){var def=(isClassDescriptor)?definition[k]:Object.getOwnPropertyDescriptor(definition,k);if(!isClassDescriptor&&def.value&&typeof def.value==='object'){def=def.value}if(def&&hasGetterOrSetter(def)){if(typeof def.enumerable==='undefined'){def.enumerable=true}if(typeof def.configurable==='undefined'){def.configurable=true}return def}else{return false}}function hasNonConfigurable(obj,k){var prop=Object.getOwnPropertyDescriptor(obj,k);if(!prop){return false}if(prop.value&&typeof prop.value==='object'){prop=prop.value}if(prop.configurable===false){return true}return false}function extend(ctor,definition,isClassDescriptor,extend){for(var k in definition){if(!definition.hasOwnProperty(k)){continue}var def=getProperty(definition,k,isClassDescriptor);if(def!==false){var parent=extend||ctor;if(hasNonConfigurable(parent.prototype,k)){if(Class.ignoreFinals){continue}throw new Error('cannot override final property \''+k+'\', set Class.ignoreFinals = true to skip')}Object.defineProperty(ctor.prototype,k,def)}else{ctor.prototype[k]=definition[k]}}}function mixin(myClass,mixins){if(!mixins){return}if(!Array.isArray(mixins)){mixins=[mixins]}for(var i=0;i<mixins.length;i++){extend(myClass,mixins[i].prototype||mixins[i])}}function Class(definition){if(!definition){definition={}}var initialize;var Extends;if(definition.initialize){if(typeof definition.initialize!=='function'){throw new Error('initialize must be a function')}initialize=definition.initialize;delete definition.initialize}else if(definition.Extends){var base=definition.Extends;initialize=function(){base.apply(this,arguments)}}else{initialize=function(){}}if(definition.Extends){initialize.prototype=Object.create(definition.Extends.prototype);initialize.prototype.constructor=initialize;Extends=definition.Extends;delete definition.Extends}else{initialize.prototype.constructor=initialize}var mixins=null;if(definition.Mixins){mixins=definition.Mixins;delete definition.Mixins}mixin(initialize,mixins);extend(initialize,definition,true,Extends);return initialize}Class.extend=extend;Class.mixin=mixin;Class.ignoreFinals=false;module.exports=Class}),(function(module,exports){var NOOP=function(){};module.exports=NOOP}),(function(module,exports){var GetFastValue=function(source,key,defaultValue){var t=typeof(source);if(!source||t==='number'||t==='string'){return defaultValue}else if(source.hasOwnProperty(key)&&source[key]!==undefined){return source[key]}else{return defaultValue}};module.exports=GetFastValue}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FuzzyEqual=__webpack_require__(106);var Vector2=new Class({initialize:function Vector2(x,y){this.x=0;this.y=0;if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0}else{if(y===undefined){y=x}this.x=x||0;this.y=y||0}},clone:function(){return new Vector2(this.x,this.y)},copy:function(src){this.x=src.x||0;this.y=src.y||0;return this},setFromObject:function(obj){this.x=obj.x||0;this.y=obj.y||0;return this},set:function(x,y){if(y===undefined){y=x}this.x=x;this.y=y;return this},setTo:function(x,y){return this.set(x,y)},setToPolar:function(azimuth,radius){if(radius==null){radius=1}this.x=Math.cos(azimuth)*radius;this.y=Math.sin(azimuth)*radius;return this},equals:function(v){return((this.x===v.x)&&(this.y===v.y))},fuzzyEquals:function(v,epsilon){return(FuzzyEqual(this.x,v.x,epsilon)&&FuzzyEqual(this.y,v.y,epsilon))},angle:function(){var angle=Math.atan2(this.y,this.x);if(angle<0){angle+=2*Math.PI}return angle},setAngle:function(angle){return this.setToPolar(angle,this.length())},add:function(src){this.x+=src.x;this.y+=src.y;return this},subtract:function(src){this.x-=src.x;this.y-=src.y;return this},multiply:function(src){this.x*=src.x;this.y*=src.y;return this},scale:function(value){if(isFinite(value)){this.x*=value;this.y*=value}else{this.x=0;this.y=0}return this},divide:function(src){this.x/=src.x;this.y/=src.y;return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},distance:function(src){var dx=src.x-this.x;var dy=src.y-this.y;return Math.sqrt(dx*dx+dy*dy)},distanceSq:function(src){var dx=src.x-this.x;var dy=src.y-this.y;return dx*dx+dy*dy},length:function(){var x=this.x;var y=this.y;return Math.sqrt(x*x+y*y)},setLength:function(length){return this.normalize().scale(length)},lengthSq:function(){var x=this.x;var y=this.y;return x*x+y*y},normalize:function(){var x=this.x;var y=this.y;var len=x*x+y*y;if(len>0){len=1/Math.sqrt(len);this.x=x*len;this.y=y*len}return this},normalizeRightHand:function(){var x=this.x;this.x=this.y*-1;this.y=x;return this},normalizeLeftHand:function(){var x=this.x;this.x=this.y;this.y=x*-1;return this},dot:function(src){return this.x*src.x+this.y*src.y},cross:function(src){return this.x*src.y-this.y*src.x},lerp:function(src,t){if(t===undefined){t=0}var ax=this.x;var ay=this.y;this.x=ax+t*(src.x-ax);this.y=ay+t*(src.y-ay);return this},transformMat3:function(mat){var x=this.x;var y=this.y;var m=mat.val;this.x=m[0]*x+m[3]*y+m[6];this.y=m[1]*x+m[4]*y+m[7];return this},transformMat4:function(mat){var x=this.x;var y=this.y;var m=mat.val;this.x=m[0]*x+m[4]*y+m[12];this.y=m[1]*x+m[5]*y+m[13];return this},reset:function(){this.x=0;this.y=0;return this},limit:function(max){var len=this.length();if(len&&len>max){this.scale(max/len)}return this},reflect:function(normal){normal=normal.clone().normalize();return this.subtract(normal.scale(2*this.dot(normal)))},mirror:function(axis){return this.reflect(axis).negate()},rotate:function(delta){var cos=Math.cos(delta);var sin=Math.sin(delta);return this.set(cos*this.x-sin*this.y,sin*this.x+cos*this.y)}});Vector2.ZERO=new Vector2();Vector2.RIGHT=new Vector2(1,0);Vector2.LEFT=new Vector2(-1,0);Vector2.UP=new Vector2(0,-1);Vector2.DOWN=new Vector2(0,1);Vector2.ONE=new Vector2(1,1);module.exports=Vector2}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GEOM_CONST=__webpack_require__(47);var Point=new Class({initialize:function Point(x,y){if(x===undefined){x=0}if(y===undefined){y=x}this.type=GEOM_CONST.POINT;this.x=x;this.y=y},setTo:function(x,y){if(x===undefined){x=0}if(y===undefined){y=x}this.x=x;this.y=y;return this}});module.exports=Point}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var GameObjectFactory=new Class({initialize:function GameObjectFactory(scene){this.scene=scene;this.systems=scene.sys;this.displayList;this.updateList;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList;this.updateList=this.systems.updateList;this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){this.systems.events.once(SceneEvents.SHUTDOWN,this.shutdown,this)},existing:function(child){if(child.renderCanvas||child.renderWebGL){this.displayList.add(child)}if(child.preUpdate){this.updateList.add(child)}return child},shutdown:function(){this.systems.events.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null;this.displayList=null;this.updateList=null}});GameObjectFactory.register=function(factoryType,factoryFunction){if(!GameObjectFactory.prototype.hasOwnProperty(factoryType)){GameObjectFactory.prototype[factoryType]=factoryFunction}};GameObjectFactory.remove=function(factoryType){if(GameObjectFactory.prototype.hasOwnProperty(factoryType)){delete GameObjectFactory.prototype[factoryType]}};PluginCache.register('GameObjectFactory',GameObjectFactory,'add');module.exports=GameObjectFactory}),(function(module,exports){var GetValue=function(source,key,defaultValue){if(!source||typeof source==='number'){return defaultValue}else if(source.hasOwnProperty(key)){return source[key]}else if(key.indexOf('.')!==-1){var keys=key.split('.');var parent=source;var value=defaultValue;for(var i=0;i<keys.length;i++){if(parent.hasOwnProperty(keys[i])){value=parent[keys[i]];parent=parent[keys[i]]}else{value=defaultValue;break}}return value}else{return defaultValue}};module.exports=GetValue}),(function(module,exports){var IsPlainObject=function(obj){if(typeof(obj)!=='object'||obj.nodeType||obj===obj.window){return false}try{if(obj.constructor&&!({}).hasOwnProperty.call(obj.constructor.prototype,'isPrototypeOf')){return false}}catch(e){return false}return true};module.exports=IsPlainObject}),(function(module,exports){var types={};var FileTypesManager={install:function(loader){for(var key in types){loader[key]=types[key]}},register:function(key,factoryFunction){types[key]=factoryFunction},destroy:function(){types={}}};module.exports=FileTypesManager}),(function(module,exports){module.exports={getTintFromFloats:function(r,g,b,a){var ur=((r*255.0)|0)&0xFF;var ug=((g*255.0)|0)&0xFF;var ub=((b*255.0)|0)&0xFF;var ua=((a*255.0)|0)&0xFF;return((ua<<24)|(ur<<16)|(ug<<8)|ub)>>>0},getTintAppendFloatAlpha:function(rgb,a){var ua=((a*255.0)|0)&0xFF;return((ua<<24)|rgb)>>>0},getTintAppendFloatAlphaAndSwap:function(rgb,a){var ur=((rgb>>16)|0)&0xff;var ug=((rgb>>8)|0)&0xff;var ub=(rgb|0)&0xff;var ua=((a*255.0)|0)&0xFF;return((ua<<24)|(ub<<16)|(ug<<8)|ur)>>>0},getFloatsFromUintRGB:function(rgb){var ur=((rgb>>16)|0)&0xff;var ug=((rgb>>8)|0)&0xff;var ub=(rgb|0)&0xff;return[ur/255.0,ug/ 255.0, ub /255.0]},getComponentCount:function(attributes,glContext){var count=0;for(var index=0;index<attributes.length;++index){var element=attributes[index];if(element.type===glContext.FLOAT){count+=element.size}else{count+=1}}return count}}}),(function(module,exports,__webpack_require__){"use strict";var has=Object.prototype.hasOwnProperty,prefix='~';function Events(){}if(Object.create){Events.prototype=Object.create(null);if(!new Events().__proto__)prefix=false}function EE(fn,context,once){this.fn=fn;this.context=context;this.once=once||false}function addListener(emitter,event,fn,context,once){if(typeof fn!=='function'){throw new TypeError('The listener must be a function')}var listener=new EE(fn,context||emitter,once),evt=prefix?prefix+event:event;if(!emitter._events[evt])emitter._events[evt]=listener,emitter._eventsCount++;else if(!emitter._events[evt].fn)emitter._events[evt].push(listener);else emitter._events[evt]=[emitter._events[evt],listener];return emitter}function clearEvent(emitter,evt){if(--emitter._eventsCount===0)emitter._events=new Events();else delete emitter._events[evt]}function EventEmitter(){this._events=new Events();this._eventsCount=0}EventEmitter.prototype.eventNames=function eventNames(){var names=[],events,name;if(this._eventsCount===0)return names;for(name in(events=this._events)){if(has.call(events,name))names.push(prefix?name.slice(1):name)}if(Object.getOwnPropertySymbols){return names.concat(Object.getOwnPropertySymbols(events))}return names};EventEmitter.prototype.listeners=function listeners(event){var evt=prefix?prefix+event:event,handlers=this._events[evt];if(!handlers)return[];if(handlers.fn)return[handlers.fn];for(var i=0,l=handlers.length,ee=new Array(l);i<l;i++){ee[i]=handlers[i].fn}return ee};EventEmitter.prototype.listenerCount=function listenerCount(event){var evt=prefix?prefix+event:event,listeners=this._events[evt];if(!listeners)return 0;if(listeners.fn)return 1;return listeners.length};EventEmitter.prototype.emit=function emit(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events[evt])return false;var listeners=this._events[evt],len=arguments.length,args,i;if(listeners.fn){if(listeners.once)this.removeListener(event,listeners.fn,undefined,true);switch(len){case 1:return listeners.fn.call(listeners.context),true;case 2:return listeners.fn.call(listeners.context,a1),true;case 3:return listeners.fn.call(listeners.context,a1,a2),true;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),true;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),true;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),true}for(i=1,args=new Array(len-1);i<len;i++){args[i-1]=arguments[i]}listeners.fn.apply(listeners.context,args)}else{var length=listeners.length,j;for(i=0;i<length;i++){if(listeners[i].once)this.removeListener(event,listeners[i].fn,undefined,true);switch(len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;case 4:listeners[i].fn.call(listeners[i].context,a1,a2,a3);break;default:if(!args)for(j=1,args=new Array(len-1);j<len;j++){args[j-1]=arguments[j]}listeners[i].fn.apply(listeners[i].context,args)}}}return true};EventEmitter.prototype.on=function on(event,fn,context){return addListener(this,event,fn,context,false)};EventEmitter.prototype.once=function once(event,fn,context){return addListener(this,event,fn,context,true)};EventEmitter.prototype.removeListener=function removeListener(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events[evt])return this;if(!fn){clearEvent(this,evt);return this}var listeners=this._events[evt];if(listeners.fn){if(listeners.fn===fn&&(!once||listeners.once)&&(!context||listeners.context===context)){clearEvent(this,evt)}}else{for(var i=0,events=[],length=listeners.length;i<length;i++){if(listeners[i].fn!==fn||(once&&!listeners[i].once)||(context&&listeners[i].context!==context)){events.push(listeners[i])}}if(events.length)this._events[evt]=events.length===1?events[0]:events;else clearEvent(this,evt)}return this};EventEmitter.prototype.removeAllListeners=function removeAllListeners(event){var evt;if(event){evt=prefix?prefix+event:event;if(this._events[evt])clearEvent(this,evt)}else{this._events=new Events();this._eventsCount=0}return this};EventEmitter.prototype.off=EventEmitter.prototype.removeListener;EventEmitter.prototype.addListener=EventEmitter.prototype.on;EventEmitter.prefixed=prefix;EventEmitter.EventEmitter=EventEmitter;if(true){module.exports=EventEmitter}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Contains=__webpack_require__(48);var GetPoint=__webpack_require__(152);var GetPoints=__webpack_require__(274);var GEOM_CONST=__webpack_require__(47);var Line=__webpack_require__(56);var Random=__webpack_require__(155);var Rectangle=new Class({initialize:function Rectangle(x,y,width,height){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=0}if(height===undefined){height=0}this.type=GEOM_CONST.RECTANGLE;this.x=x;this.y=y;this.width=width;this.height=height},contains:function(x,y){return Contains(this,x,y)},getPoint:function(position,output){return GetPoint(this,position,output)},getPoints:function(quantity,stepRate,output){return GetPoints(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random(this,point)},setTo:function(x,y,width,height){this.x=x;this.y=y;this.width=width;this.height=height;return this},setEmpty:function(){return this.setTo(0,0,0,0)},setPosition:function(x,y){if(y===undefined){y=x}this.x=x;this.y=y;return this},setSize:function(width,height){if(height===undefined){height=width}this.width=width;this.height=height;return this},isEmpty:function(){return(this.width<=0||this.height<=0)},getLineA:function(line){if(line===undefined){line=new Line()}line.setTo(this.x,this.y,this.right,this.y);return line},getLineB:function(line){if(line===undefined){line=new Line()}line.setTo(this.right,this.y,this.right,this.bottom);return line},getLineC:function(line){if(line===undefined){line=new Line()}line.setTo(this.right,this.bottom,this.x,this.bottom);return line},getLineD:function(line){if(line===undefined){line=new Line()}line.setTo(this.x,this.bottom,this.x,this.y);return line},left:{get:function(){return this.x},set:function(value){if(value>=this.right){this.width=0}else{this.width=this.right-value}this.x=value}},right:{get:function(){return this.x+this.width},set:function(value){if(value<=this.x){this.width=0}else{this.width=value-this.x}}},top:{get:function(){return this.y},set:function(value){if(value>=this.bottom){this.height=0}else{this.height=(this.bottom-value)}this.y=value}},bottom:{get:function(){return this.y+this.height},set:function(value){if(value<=this.y){this.height=0}else{this.height=value-this.y}}},centerX:{get:function(){return this.x+(this.width/2)},set:function(value){this.x=value-(this.width/2)}},centerY:{get:function(){return this.y+(this.height/2)},set:function(value){this.y=value-(this.height/2)}}});module.exports=Rectangle}),(function(module,exports,__webpack_require__){module.exports={Alpha:__webpack_require__(533),AlphaSingle:__webpack_require__(269),Animation:__webpack_require__(504),BlendMode:__webpack_require__(272),ComputedSize:__webpack_require__(552),Crop:__webpack_require__(553),Depth:__webpack_require__(273),Flip:__webpack_require__(554),GetBounds:__webpack_require__(555),Mask:__webpack_require__(277),Origin:__webpack_require__(572),PathFollower:__webpack_require__(573),Pipeline:__webpack_require__(156),ScrollFactor:__webpack_require__(280),Size:__webpack_require__(574),Texture:__webpack_require__(575),TextureCrop:__webpack_require__(576),Tint:__webpack_require__(577),ToJSON:__webpack_require__(281),Transform:__webpack_require__(282),TransformMatrix:__webpack_require__(29),Visible:__webpack_require__(283)}}),(function(module,exports){var MATH_CONST={PI2:Math.PI*2,TAU:Math.PI*0.5,EPSILON:1.0e-6,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,RND:null,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER||-9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};module.exports=MATH_CONST}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var ComponentsToJSON=__webpack_require__(281);var DataManager=__webpack_require__(113);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(90);var GameObject=new Class({Extends:EventEmitter,initialize:function GameObject(scene,type){EventEmitter.call(this);this.scene=scene;this.type=type;this.state=0;this.parentContainer=null;this.name='';this.active=true;this.tabIndex=-1;this.data=null;this.renderFlags=15;this.cameraFilter=0;this.input=null;this.body=null;this.ignoreDestroy=false;scene.sys.queueDepthSort()},setActive:function(value){this.active=value;return this},setName:function(value){this.name=value;return this},setState:function(value){this.state=value;return this},setDataEnabled:function(){if(!this.data){this.data=new DataManager(this)}return this},setData:function(key,value){if(!this.data){this.data=new DataManager(this)}this.data.set(key,value);return this},incData:function(key,value){if(!this.data){this.data=new DataManager(this)}this.data.inc(key,value);return this},toggleData:function(key){if(!this.data){this.data=new DataManager(this)}this.data.toggle(key);return this},getData:function(key){if(!this.data){this.data=new DataManager(this)}return this.data.get(key)},setInteractive:function(shape,callback,dropZone){this.scene.sys.input.enable(this,shape,callback,dropZone);return this},disableInteractive:function(){if(this.input){this.input.enabled=false}return this},removeInteractive:function(){this.scene.sys.input.clear(this);this.input=undefined;return this},update:function(){},toJSON:function(){return ComponentsToJSON(this)},willRender:function(camera){return!(GameObject.RENDER_MASK!==this.renderFlags||(this.cameraFilter!==0&&(this.cameraFilter&camera.id)))},getIndexList:function(){var child=this;var parent=this.parentContainer;var indexes=[];while(parent){indexes.unshift(parent.getIndex(child));child=parent;if(!parent.parentContainer){break}else{parent=parent.parentContainer}}indexes.unshift(this.scene.sys.displayList.getIndex(child));return indexes},destroy:function(fromScene){if(fromScene===undefined){fromScene=false}if(!this.scene||this.ignoreDestroy){return}if(this.preDestroy){this.preDestroy.call(this)}this.emit(Events.DESTROY,this);var sys=this.scene.sys;if(!fromScene){sys.displayList.remove(this);sys.updateList.remove(this)}if(this.input){sys.input.clear(this);this.input=undefined}if(this.data){this.data.destroy();this.data=undefined}if(this.body){this.body.destroy();this.body=undefined}if(!fromScene){sys.queueDepthSort()}this.active=false;this.visible=false;this.scene=undefined;this.parentContainer=undefined;this.removeAllListeners()}});GameObject.RENDER_MASK=15;module.exports=GameObject}),(function(module,exports,__webpack_require__){var MATH=__webpack_require__(170);var GetValue=__webpack_require__(6);var GetAdvancedValue=function(source,key,defaultValue){var value=GetValue(source,key,null);if(value===null){return defaultValue}else if(Array.isArray(value)){return MATH.RND.pick(value)}else if(typeof value==='object'){if(value.hasOwnProperty('randInt')){return MATH.RND.integerInRange(value.randInt[0],value.randInt[1])}else if(value.hasOwnProperty('randFloat')){return MATH.RND.realInRange(value.randFloat[0],value.randFloat[1])}}else if(typeof value==='function'){return value(key)}return value};module.exports=GetAdvancedValue}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var GameObjectCreator=new Class({initialize:function GameObjectCreator(scene){this.scene=scene;this.systems=scene.sys;this.displayList;this.updateList;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.displayList=this.systems.displayList;this.updateList=this.systems.updateList;this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){this.systems.events.once(SceneEvents.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null;this.displayList=null;this.updateList=null}});GameObjectCreator.register=function(factoryType,factoryFunction){if(!GameObjectCreator.prototype.hasOwnProperty(factoryType)){GameObjectCreator.prototype[factoryType]=factoryFunction}};GameObjectCreator.remove=function(factoryType){if(GameObjectCreator.prototype.hasOwnProperty(factoryType)){delete GameObjectCreator.prototype[factoryType]}};PluginCache.register('GameObjectCreator',GameObjectCreator,'make');module.exports=GameObjectCreator}),(function(module,exports){var FILE_CONST={LOADER_IDLE:0,LOADER_LOADING:1,LOADER_PROCESSING:2,LOADER_COMPLETE:3,LOADER_SHUTDOWN:4,LOADER_DESTROYED:5,FILE_PENDING:10,FILE_LOADING:11,FILE_LOADED:12,FILE_FAILED:13,FILE_PROCESSING:14,FILE_ERRORED:16,FILE_COMPLETE:17,FILE_DESTROYED:18,FILE_POPULATED:19};module.exports=FILE_CONST}),(function(module,exports,__webpack_require__){var IsPlainObject=__webpack_require__(7);var Extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==='boolean'){deep=target;target=arguments[1]||{};i=2}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(IsPlainObject(copy)||(copyIsArray=Array.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&Array.isArray(src)?src:[]}else{clone=src&&IsPlainObject(src)?src:{}}target[name]=Extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}return target};module.exports=Extend}),(function(module,exports){var Clamp=function(value,min,max){return Math.max(min,Math.min(max,value))};module.exports=Clamp}),(function(module,exports,__webpack_require__){module.exports={BLUR:__webpack_require__(556),BOOT:__webpack_require__(557),CONTEXT_LOST:__webpack_require__(558),CONTEXT_RESTORED:__webpack_require__(559),DESTROY:__webpack_require__(560),FOCUS:__webpack_require__(561),HIDDEN:__webpack_require__(562),PAUSE:__webpack_require__(563),POST_RENDER:__webpack_require__(564),POST_STEP:__webpack_require__(565),PRE_RENDER:__webpack_require__(566),PRE_STEP:__webpack_require__(567),READY:__webpack_require__(568),RESUME:__webpack_require__(569),STEP:__webpack_require__(570),VISIBLE:__webpack_require__(571)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var Events=__webpack_require__(82);var GetFastValue=__webpack_require__(2);var GetURL=__webpack_require__(138);var MergeXHRSettings=__webpack_require__(215);var XHRLoader=__webpack_require__(455);var XHRSettings=__webpack_require__(139);var File=new Class({initialize:function File(loader,fileConfig){this.loader=loader;this.cache=GetFastValue(fileConfig,'cache',false);this.type=GetFastValue(fileConfig,'type',false);this.key=GetFastValue(fileConfig,'key',false);var loadKey=this.key;if(loader.prefix&&loader.prefix!==''){this.key=loader.prefix+loadKey}if(!this.type||!this.key){throw new Error('Error calling \'Loader.'+this.type+'\' invalid key provided.')}this.url=GetFastValue(fileConfig,'url');if(this.url===undefined){this.url=loader.path+loadKey+'.'+GetFastValue(fileConfig,'extension','')}else if(typeof this.url==='string'&&this.url.indexOf('blob:')!==0&&this.url.indexOf('data:')!==0){this.url=loader.path+this.url}this.src='';this.xhrSettings=XHRSettings(GetFastValue(fileConfig,'responseType',undefined));if(GetFastValue(fileConfig,'xhrSettings',false)){this.xhrSettings=MergeXHRSettings(this.xhrSettings,GetFastValue(fileConfig,'xhrSettings',{}))}this.xhrLoader=null;this.state=(typeof(this.url)==='function')?CONST.FILE_POPULATED:CONST.FILE_PENDING;this.bytesTotal=0;this.bytesLoaded=-1;this.percentComplete=-1;this.crossOrigin=undefined;this.data=undefined;this.config=GetFastValue(fileConfig,'config',{});this.multiFile;this.linkFile},setLink:function(fileB){this.linkFile=fileB;fileB.linkFile=this},resetXHR:function(){if(this.xhrLoader){this.xhrLoader.onload=undefined;this.xhrLoader.onerror=undefined;this.xhrLoader.onprogress=undefined}},load:function(){if(this.state===CONST.FILE_POPULATED){this.loader.nextFile(this,true)}else{this.state=CONST.FILE_LOADING;this.src=GetURL(this,this.loader.baseURL);if(this.src.indexOf('data:')===0){console.warn('Local data URIs are not supported: '+this.key)}else{this.xhrLoader=XHRLoader(this,this.loader.xhr)}}},onLoad:function(xhr,event){var localFileOk=((xhr.responseURL&&xhr.responseURL.indexOf('file://')===0&&event.target.status===0));var success=!(event.target&&event.target.status!==200)||localFileOk;if(xhr.readyState===4&&xhr.status>=400&&xhr.status<=599){success=false}this.state=CONST.FILE_LOADED;this.resetXHR();this.loader.nextFile(this,success)},onError:function(){this.resetXHR();this.loader.nextFile(this,false)},onProgress:function(event){if(event.lengthComputable){this.bytesLoaded=event.loaded;this.bytesTotal=event.total;this.percentComplete=Math.min((this.bytesLoaded/this.bytesTotal),1);this.loader.emit(Events.FILE_PROGRESS,this,this.percentComplete)}},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.onProcessComplete()},onProcessComplete:function(){this.state=CONST.FILE_COMPLETE;if(this.multiFile){this.multiFile.onFileComplete(this)}this.loader.fileProcessComplete(this)},onProcessError:function(){this.state=CONST.FILE_ERRORED;if(this.multiFile){this.multiFile.onFileFailed(this)}this.loader.fileProcessComplete(this)},hasCacheConflict:function(){return(this.cache&&this.cache.exists(this.key))},addToCache:function(){if(this.cache){this.cache.add(this.key,this.data)}this.pendingDestroy()},pendingDestroy:function(data){if(data===undefined){data=this.data}var key=this.key;var type=this.type;this.loader.emit(Events.FILE_COMPLETE,key,type,data);this.loader.emit(Events.FILE_KEY_COMPLETE+type+'-'+key,key,type,data);this.loader.flagForRemoval(this)},destroy:function(){this.loader=null;this.cache=null;this.xhrSettings=null;this.multiFile=null;this.linkFile=null;this.data=null}});File.createObjectURL=function(image,blob,defaultType){if(typeof URL==='function'){image.src=URL.createObjectURL(blob)}else{var reader=new FileReader();reader.onload=function(){image.removeAttribute('crossOrigin');image.src='data:'+(blob.type||defaultType)+';base64,'+reader.result.split(',')[1]};reader.onerror=image.onerror;reader.readAsDataURL(blob)}};File.revokeObjectURL=function(image){if(typeof URL==='function'){URL.revokeObjectURL(image.src)}};module.exports=File}),(function(module,exports,__webpack_require__){module.exports={BOOT:__webpack_require__(709),CREATE:__webpack_require__(710),DESTROY:__webpack_require__(711),PAUSE:__webpack_require__(712),POST_UPDATE:__webpack_require__(713),PRE_UPDATE:__webpack_require__(714),READY:__webpack_require__(715),RENDER:__webpack_require__(716),RESUME:__webpack_require__(717),SHUTDOWN:__webpack_require__(718),SLEEP:__webpack_require__(719),START:__webpack_require__(720),TRANSITION_COMPLETE:__webpack_require__(721),TRANSITION_INIT:__webpack_require__(722),TRANSITION_OUT:__webpack_require__(723),TRANSITION_START:__webpack_require__(724),TRANSITION_WAKE:__webpack_require__(725),UPDATE:__webpack_require__(726),WAKE:__webpack_require__(727)}}),(function(module,exports){var corePlugins={};var customPlugins={};var PluginCache={};PluginCache.register=function(key,plugin,mapping,custom){if(custom===undefined){custom=false}corePlugins[key]={plugin:plugin,mapping:mapping,custom:custom}};PluginCache.registerCustom=function(key,plugin,mapping,data){customPlugins[key]={plugin:plugin,mapping:mapping,data:data}};PluginCache.hasCore=function(key){return corePlugins.hasOwnProperty(key)};PluginCache.hasCustom=function(key){return customPlugins.hasOwnProperty(key)};PluginCache.getCore=function(key){return corePlugins[key]};PluginCache.getCustom=function(key){return customPlugins[key]};PluginCache.getCustomClass=function(key){return(customPlugins.hasOwnProperty(key))?customPlugins[key].plugin:null};PluginCache.remove=function(key){if(corePlugins.hasOwnProperty(key)){delete corePlugins[key]}};PluginCache.removeCustom=function(key){if(customPlugins.hasOwnProperty(key)){delete customPlugins[key]}};PluginCache.destroyCorePlugins=function(){for(var key in corePlugins){if(corePlugins.hasOwnProperty(key)){delete corePlugins[key]}}};PluginCache.destroyCustomPlugins=function(){for(var key in customPlugins){if(customPlugins.hasOwnProperty(key)){delete customPlugins[key]}}};module.exports=PluginCache}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var GetTilesWithin=function(tileX,tileY,width,height,filteringOptions,layer){if(tileX===undefined){tileX=0}if(tileY===undefined){tileY=0}if(width===undefined){width=layer.width}if(height===undefined){height=layer.height}var isNotEmpty=GetFastValue(filteringOptions,'isNotEmpty',false);var isColliding=GetFastValue(filteringOptions,'isColliding',false);var hasInterestingFace=GetFastValue(filteringOptions,'hasInterestingFace',false);if(tileX<0){width+=tileX;tileX=0}if(tileY<0){height+=tileY;tileY=0}if(tileX+width>layer.width){width=Math.max(layer.width-tileX,0)}if(tileY+height>layer.height){height=Math.max(layer.height-tileY,0)}var results=[];for(var ty=tileY;ty<tileY+height;ty++){for(var tx=tileX;tx<tileX+width;tx++){var tile=layer.data[ty][tx];if(tile!==null){if(isNotEmpty&&tile.index===-1){continue}if(isColliding&&!tile.collides){continue}if(hasInterestingFace&&!tile.hasInterestingFace){continue}results.push(tile)}}}return results};module.exports=GetTilesWithin}),(function(module,exports){var PropertyValueSet=function(items,key,value,step,index,direction){if(step===undefined){step=0}if(index===undefined){index=0}if(direction===undefined){direction=1}var i;var t=0;var end=items.length;if(direction===1){for(i=index;i<end;i++){items[i][key]=value+(t*step);t++}}else{for(i=index;i>=0;i--){items[i][key]=value+(t*step);t++}}return items};module.exports=PropertyValueSet}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(33);var Smoothing=__webpack_require__(167);var pool=[];var _disableContextSmoothing=false;var CanvasPool=function(){var create=function(parent,width,height,canvasType,selfParent){if(width===undefined){width=1}if(height===undefined){height=1}if(canvasType===undefined){canvasType=CONST.CANVAS}if(selfParent===undefined){selfParent=false}var canvas;var container=first(canvasType);if(container===null){container={parent:parent,canvas:document.createElement('canvas'),type:canvasType};if(canvasType===CONST.CANVAS){pool.push(container)}canvas=container.canvas}else{container.parent=parent;canvas=container.canvas}if(selfParent){container.parent=canvas}canvas.width=width;canvas.height=height;if(_disableContextSmoothing&&canvasType===CONST.CANVAS){Smoothing.disable(canvas.getContext('2d'))}return canvas};var create2D=function(parent,width,height){return create(parent,width,height,CONST.CANVAS)};var createWebGL=function(parent,width,height){return create(parent,width,height,CONST.WEBGL)};var first=function(canvasType){if(canvasType===undefined){canvasType=CONST.CANVAS}if(canvasType===CONST.WEBGL){return null}for(var i=0;i<pool.length;i++){var container=pool[i];if(!container.parent&&container.type===canvasType){return container}}return null};var remove=function(parent){var isCanvas=parent instanceof HTMLCanvasElement;pool.forEach(function(container){if((isCanvas&&container.canvas===parent)||(!isCanvas&&container.parent===parent)){container.parent=null;container.canvas.width=1;container.canvas.height=1}})};var total=function(){var c=0;pool.forEach(function(container){if(container.parent){c++}});return c};var free=function(){return pool.length-total()};var disableSmoothing=function(){_disableContextSmoothing=true};var enableSmoothing=function(){_disableContextSmoothing=false};return{create2D:create2D,create:create,createWebGL:createWebGL,disableSmoothing:disableSmoothing,enableSmoothing:enableSmoothing,first:first,free:free,pool:pool,remove:remove,total:total}};module.exports=CanvasPool()}),(function(module,exports,__webpack_require__){var BlendModes=__webpack_require__(52);var GetAdvancedValue=__webpack_require__(15);var BuildGameObject=function(scene,gameObject,config){gameObject.x=GetAdvancedValue(config,'x',0);gameObject.y=GetAdvancedValue(config,'y',0);gameObject.depth=GetAdvancedValue(config,'depth',0);gameObject.flipX=GetAdvancedValue(config,'flipX',false);gameObject.flipY=GetAdvancedValue(config,'flipY',false);var scale=GetAdvancedValue(config,'scale',null);if(typeof scale==='number'){gameObject.setScale(scale)}else if(scale!==null){gameObject.scaleX=GetAdvancedValue(scale,'x',1);gameObject.scaleY=GetAdvancedValue(scale,'y',1)}var scrollFactor=GetAdvancedValue(config,'scrollFactor',null);if(typeof scrollFactor==='number'){gameObject.setScrollFactor(scrollFactor)}else if(scrollFactor!==null){gameObject.scrollFactorX=GetAdvancedValue(scrollFactor,'x',1);gameObject.scrollFactorY=GetAdvancedValue(scrollFactor,'y',1)}gameObject.rotation=GetAdvancedValue(config,'rotation',0);var angle=GetAdvancedValue(config,'angle',null);if(angle!==null){gameObject.angle=angle}gameObject.alpha=GetAdvancedValue(config,'alpha',1);var origin=GetAdvancedValue(config,'origin',null);if(typeof origin==='number'){gameObject.setOrigin(origin)}else if(origin!==null){var ox=GetAdvancedValue(origin,'x',0.5);var oy=GetAdvancedValue(origin,'y',0.5);gameObject.setOrigin(ox,oy)}gameObject.blendMode=GetAdvancedValue(config,'blendMode',BlendModes.NORMAL);gameObject.visible=GetAdvancedValue(config,'visible',true);var add=GetAdvancedValue(config,'add',true);if(add){scene.sys.displayList.add(gameObject)}if(gameObject.preUpdate){scene.sys.updateList.add(gameObject)}return gameObject};module.exports=BuildGameObject}),(function(module,exports){var SetTransform=function(renderer,ctx,src,camera,parentMatrix){var alpha=camera.alpha*src.alpha;if(alpha<=0){return false}var camMatrix=renderer._tempMatrix1.copyFromArray(camera.matrix.matrix);var gameObjectMatrix=renderer._tempMatrix2.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);var calcMatrix=renderer._tempMatrix3;if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);gameObjectMatrix.e=src.x;gameObjectMatrix.f=src.y;camMatrix.multiply(gameObjectMatrix,calcMatrix)}else{gameObjectMatrix.e-=camera.scrollX*src.scrollFactorX;gameObjectMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(gameObjectMatrix,calcMatrix)}ctx.globalCompositeOperation=renderer.blendModes[src.blendMode];ctx.globalAlpha=alpha;ctx.save();calcMatrix.setToContext(ctx);ctx.imageSmoothingEnabled=!(!renderer.antialias||(src.frame&&src.frame.source.scaleMode));return true};module.exports=SetTransform}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var MATH_CONST=__webpack_require__(13);var Vector2=__webpack_require__(3);var TransformMatrix=new Class({initialize:function TransformMatrix(a,b,c,d,tx,ty){if(a===undefined){a=1}if(b===undefined){b=0}if(c===undefined){c=0}if(d===undefined){d=1}if(tx===undefined){tx=0}if(ty===undefined){ty=0}this.matrix=new Float32Array([a,b,c,d,tx,ty,0,0,1]);this.decomposedMatrix={translateX:0,translateY:0,scaleX:1,scaleY:1,rotation:0}},a:{get:function(){return this.matrix[0]},set:function(value){this.matrix[0]=value}},b:{get:function(){return this.matrix[1]},set:function(value){this.matrix[1]=value}},c:{get:function(){return this.matrix[2]},set:function(value){this.matrix[2]=value}},d:{get:function(){return this.matrix[3]},set:function(value){this.matrix[3]=value}},e:{get:function(){return this.matrix[4]},set:function(value){this.matrix[4]=value}},f:{get:function(){return this.matrix[5]},set:function(value){this.matrix[5]=value}},tx:{get:function(){return this.matrix[4]},set:function(value){this.matrix[4]=value}},ty:{get:function(){return this.matrix[5]},set:function(value){this.matrix[5]=value}},rotation:{get:function(){return Math.acos(this.a/this.scaleX)*((Math.atan(-this.c/this.a)<0)?-1:1)}},rotationNormalized:{get:function(){var matrix=this.matrix;var a=matrix[0];var b=matrix[1];var c=matrix[2];var d=matrix[3];if(a||b){return(b>0)?Math.acos(a/this.scaleX):-Math.acos(a/this.scaleX)}else if(c||d){return MATH_CONST.TAU-((d>0)?Math.acos(-c/this.scaleY):-Math.acos(c/this.scaleY))}else{return 0}}},scaleX:{get:function(){return Math.sqrt((this.a*this.a)+(this.b*this.b))}},scaleY:{get:function(){return Math.sqrt((this.c*this.c)+(this.d*this.d))}},loadIdentity:function(){var matrix=this.matrix;matrix[0]=1;matrix[1]=0;matrix[2]=0;matrix[3]=1;matrix[4]=0;matrix[5]=0;return this},translate:function(x,y){var matrix=this.matrix;matrix[4]=matrix[0]*x+matrix[2]*y+matrix[4];matrix[5]=matrix[1]*x+matrix[3]*y+matrix[5];return this},scale:function(x,y){var matrix=this.matrix;matrix[0]*=x;matrix[1]*=x;matrix[2]*=y;matrix[3]*=y;return this},rotate:function(angle){var sin=Math.sin(angle);var cos=Math.cos(angle);var matrix=this.matrix;var a=matrix[0];var b=matrix[1];var c=matrix[2];var d=matrix[3];matrix[0]=a*cos+c*sin;matrix[1]=b*cos+d*sin;matrix[2]=a*-sin+c*cos;matrix[3]=b*-sin+d*cos;return this},multiply:function(rhs,out){var matrix=this.matrix;var source=rhs.matrix;var localA=matrix[0];var localB=matrix[1];var localC=matrix[2];var localD=matrix[3];var localE=matrix[4];var localF=matrix[5];var sourceA=source[0];var sourceB=source[1];var sourceC=source[2];var sourceD=source[3];var sourceE=source[4];var sourceF=source[5];var destinationMatrix=(out===undefined)?this:out;destinationMatrix.a=(sourceA*localA)+(sourceB*localC);destinationMatrix.b=(sourceA*localB)+(sourceB*localD);destinationMatrix.c=(sourceC*localA)+(sourceD*localC);destinationMatrix.d=(sourceC*localB)+(sourceD*localD);destinationMatrix.e=(sourceE*localA)+(sourceF*localC)+localE;destinationMatrix.f=(sourceE*localB)+(sourceF*localD)+localF;return destinationMatrix},multiplyWithOffset:function(src,offsetX,offsetY){var matrix=this.matrix;var otherMatrix=src.matrix;var a0=matrix[0];var b0=matrix[1];var c0=matrix[2];var d0=matrix[3];var tx0=matrix[4];var ty0=matrix[5];var pse=offsetX*a0+offsetY*c0+tx0;var psf=offsetX*b0+offsetY*d0+ty0;var a1=otherMatrix[0];var b1=otherMatrix[1];var c1=otherMatrix[2];var d1=otherMatrix[3];var tx1=otherMatrix[4];var ty1=otherMatrix[5];matrix[0]=a1*a0+b1*c0;matrix[1]=a1*b0+b1*d0;matrix[2]=c1*a0+d1*c0;matrix[3]=c1*b0+d1*d0;matrix[4]=tx1*a0+ty1*c0+pse;matrix[5]=tx1*b0+ty1*d0+psf;return this},transform:function(a,b,c,d,tx,ty){var matrix=this.matrix;var a0=matrix[0];var b0=matrix[1];var c0=matrix[2];var d0=matrix[3];var tx0=matrix[4];var ty0=matrix[5];matrix[0]=a*a0+b*c0;matrix[1]=a*b0+b*d0;matrix[2]=c*a0+d*c0;matrix[3]=c*b0+d*d0;matrix[4]=tx*a0+ty*c0+tx0;matrix[5]=tx*b0+ty*d0+ty0;return this},transformPoint:function(x,y,point){if(point===undefined){point={x:0,y:0}}var matrix=this.matrix;var a=matrix[0];var b=matrix[1];var c=matrix[2];var d=matrix[3];var tx=matrix[4];var ty=matrix[5];point.x=x*a+y*c+tx;point.y=x*b+y*d+ty;return point},invert:function(){var matrix=this.matrix;var a=matrix[0];var b=matrix[1];var c=matrix[2];var d=matrix[3];var tx=matrix[4];var ty=matrix[5];var n=a*d-b*c;matrix[0]=d/n;matrix[1]=-b/n;matrix[2]=-c/n;matrix[3]=a/n;matrix[4]=(c*ty-d*tx)/n;matrix[5]=-(a*ty-b*tx)/n;return this},copyFrom:function(src){var matrix=this.matrix;matrix[0]=src.a;matrix[1]=src.b;matrix[2]=src.c;matrix[3]=src.d;matrix[4]=src.e;matrix[5]=src.f;return this},copyFromArray:function(src){var matrix=this.matrix;matrix[0]=src[0];matrix[1]=src[1];matrix[2]=src[2];matrix[3]=src[3];matrix[4]=src[4];matrix[5]=src[5];return this},copyToContext:function(ctx){var matrix=this.matrix;ctx.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]);return ctx},setToContext:function(ctx){var matrix=this.matrix;ctx.setTransform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]);return ctx},copyToArray:function(out){var matrix=this.matrix;if(out===undefined){out=[matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]]}else{out[0]=matrix[0];out[1]=matrix[1];out[2]=matrix[2];out[3]=matrix[3];out[4]=matrix[4];out[5]=matrix[5]}return out},setTransform:function(a,b,c,d,tx,ty){var matrix=this.matrix;matrix[0]=a;matrix[1]=b;matrix[2]=c;matrix[3]=d;matrix[4]=tx;matrix[5]=ty;return this},decomposeMatrix:function(){var decomposedMatrix=this.decomposedMatrix;var matrix=this.matrix;var a=matrix[0];var b=matrix[1];var c=matrix[2];var d=matrix[3];var determ=a*d-b*c;decomposedMatrix.translateX=matrix[4];decomposedMatrix.translateY=matrix[5];if(a||b){var r=Math.sqrt(a*a+b*b);decomposedMatrix.rotation=(b>0)?Math.acos(a/r):-Math.acos(a/r);decomposedMatrix.scaleX=r;decomposedMatrix.scaleY=determ/r}else if(c||d){var s=Math.sqrt(c*c+d*d);decomposedMatrix.rotation=Math.PI*0.5-(d>0?Math.acos(-c/s):-Math.acos(c/s));decomposedMatrix.scaleX=determ/s;decomposedMatrix.scaleY=s}else{decomposedMatrix.rotation=0;decomposedMatrix.scaleX=0;decomposedMatrix.scaleY=0}return decomposedMatrix},applyITRS:function(x,y,rotation,scaleX,scaleY){var matrix=this.matrix;var radianSin=Math.sin(rotation);var radianCos=Math.cos(rotation);matrix[4]=x;matrix[5]=y;matrix[0]=radianCos*scaleX;matrix[1]=radianSin*scaleX;matrix[2]=-radianSin*scaleY;matrix[3]=radianCos*scaleY;return this},applyInverse:function(x,y,output){if(output===undefined){output=new Vector2()}var matrix=this.matrix;var a=matrix[0];var b=matrix[1];var c=matrix[2];var d=matrix[3];var tx=matrix[4];var ty=matrix[5];var id=1/((a*d)+(c*-b));output.x=(d*id*x)+(-c*id*y)+(((ty*c)-(tx*d))*id);output.y=(a*id*y)+(-b*id*x)+(((-ty*a)+(tx*b))*id);return output},getX:function(x,y){return x*this.a+y*this.c+this.e},getY:function(x,y){return x*this.b+y*this.d+this.f},getCSSMatrix:function(){var m=this.matrix;return'matrix('+m[0]+','+m[1]+','+m[2]+','+m[3]+','+m[4]+','+m[5]+')'},destroy:function(){this.matrix=null;this.decomposedMatrix=null}});module.exports=TransformMatrix}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var Line=__webpack_require__(56);var Shape=new Class({Extends:GameObject,Mixins:[Components.AlphaSingle,Components.BlendMode,Components.ComputedSize,Components.Depth,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Transform,Components.Visible],initialize:function Shape(scene,type,data){if(type===undefined){type='Shape'}GameObject.call(this,scene,type);this.geom=data;this.pathData=[];this.pathIndexes=[];this.fillColor=0xffffff;this.fillAlpha=1;this.strokeColor=0xffffff;this.strokeAlpha=1;this.lineWidth=1;this.isFilled=false;this.isStroked=false;this.closePath=true;this._tempLine=new Line();this.initPipeline()},setFillStyle:function(color,alpha){if(alpha===undefined){alpha=1}if(color===undefined){this.isFilled=false}else{this.fillColor=color;this.fillAlpha=alpha;this.isFilled=true}return this},setStrokeStyle:function(lineWidth,color,alpha){if(alpha===undefined){alpha=1}if(lineWidth===undefined){this.isStroked=false}else{this.lineWidth=lineWidth;this.strokeColor=color;this.strokeAlpha=alpha;this.isStroked=true}return this},setClosePath:function(value){this.closePath=value;return this},preDestroy:function(){this.geom=null;this._tempLine=null;this.pathData=[];this.pathIndexes=[]}});module.exports=Shape}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetColor=__webpack_require__(165);var GetColor32=__webpack_require__(295);var HSVToRGB=__webpack_require__(166);var RGBToHSV=__webpack_require__(296);var Color=new Class({initialize:function Color(red,green,blue,alpha){if(red===undefined){red=0}if(green===undefined){green=0}if(blue===undefined){blue=0}if(alpha===undefined){alpha=255}this.r=0;this.g=0;this.b=0;this.a=255;this._h=0;this._s=0;this._v=0;this._locked=false;this.gl=[0,0,0,1];this._color=0;this._color32=0;this._rgba='';this.setTo(red,green,blue,alpha)},transparent:function(){this._locked=true;this.red=0;this.green=0;this.blue=0;this.alpha=0;this._locked=false;return this.update(true)},setTo:function(red,green,blue,alpha,updateHSV){if(alpha===undefined){alpha=255}if(updateHSV===undefined){updateHSV=true}this._locked=true;this.red=red;this.green=green;this.blue=blue;this.alpha=alpha;this._locked=false;return this.update(updateHSV)},setGLTo:function(red,green,blue,alpha){if(alpha===undefined){alpha=1}this._locked=true;this.redGL=red;this.greenGL=green;this.blueGL=blue;this.alphaGL=alpha;this._locked=false;return this.update(true)},setFromRGB:function(color){this._locked=true;this.red=color.r;this.green=color.g;this.blue=color.b;if(color.hasOwnProperty('a')){this.alpha=color.a}this._locked=false;return this.update(true)},setFromHSV:function(h,s,v){return HSVToRGB(h,s,v,this)},update:function(updateHSV){if(updateHSV===undefined){updateHSV=false}if(this._locked){return this}var r=this.r;var g=this.g;var b=this.b;var a=this.a;this._color=GetColor(r,g,b);this._color32=GetColor32(r,g,b,a);this._rgba='rgba('+r+','+g+','+b+','+(a/255)+')';if(updateHSV){RGBToHSV(r,g,b,this)}return this},updateHSV:function(){var r=this.r;var g=this.g;var b=this.b;RGBToHSV(r,g,b,this);return this},clone:function(){return new Color(this.r,this.g,this.b,this.a)},gray:function(shade){return this.setTo(shade,shade,shade)},random:function(min,max){if(min===undefined){min=0}if(max===undefined){max=255}var r=Math.floor(min+Math.random()*(max-min));var g=Math.floor(min+Math.random()*(max-min));var b=Math.floor(min+Math.random()*(max-min));return this.setTo(r,g,b)},randomGray:function(min,max){if(min===undefined){min=0}if(max===undefined){max=255}var s=Math.floor(min+Math.random()*(max-min));return this.setTo(s,s,s)},saturate:function(amount){this.s+=amount/100;return this},desaturate:function(amount){this.s-=amount/100;return this},lighten:function(amount){this.v+=amount/100;return this},darken:function(amount){this.v-=amount/100;return this},brighten:function(amount){var r=this.r;var g=this.g;var b=this.b;r=Math.max(0,Math.min(255,r-Math.round(255*-(amount/100))));g=Math.max(0,Math.min(255,g-Math.round(255*-(amount/100))));b=Math.max(0,Math.min(255,b-Math.round(255*-(amount/100))));return this.setTo(r,g,b)},color:{get:function(){return this._color}},color32:{get:function(){return this._color32}},rgba:{get:function(){return this._rgba}},redGL:{get:function(){return this.gl[0]},set:function(value){this.gl[0]=Math.min(Math.abs(value),1);this.r=Math.floor(this.gl[0]*255);this.update(true)}},greenGL:{get:function(){return this.gl[1]},set:function(value){this.gl[1]=Math.min(Math.abs(value),1);this.g=Math.floor(this.gl[1]*255);this.update(true)}},blueGL:{get:function(){return this.gl[2]},set:function(value){this.gl[2]=Math.min(Math.abs(value),1);this.b=Math.floor(this.gl[2]*255);this.update(true)}},alphaGL:{get:function(){return this.gl[3]},set:function(value){this.gl[3]=Math.min(Math.abs(value),1);this.a=Math.floor(this.gl[3]*255);this.update()}},red:{get:function(){return this.r},set:function(value){value=Math.floor(Math.abs(value));this.r=Math.min(value,255);this.gl[0]=value/255;this.update(true)}},green:{get:function(){return this.g},set:function(value){value=Math.floor(Math.abs(value));this.g=Math.min(value,255);this.gl[1]=value/255;this.update(true)}},blue:{get:function(){return this.b},set:function(value){value=Math.floor(Math.abs(value));this.b=Math.min(value,255);this.gl[2]=value/255;this.update(true)}},alpha:{get:function(){return this.a},set:function(value){value=Math.floor(Math.abs(value));this.a=Math.min(value,255);this.gl[3]=value/255;this.update()}},h:{get:function(){return this._h},set:function(value){this._h=value;HSVToRGB(value,this._s,this._v,this)}},s:{get:function(){return this._s},set:function(value){this._s=value;HSVToRGB(this._h,value,this._v,this)}},v:{get:function(){return this._v},set:function(value){this._v=value;HSVToRGB(this._h,this._s,value,this)}}});module.exports=Color}),(function(module,exports){module.exports={CSV:0,TILED_JSON:1,ARRAY_2D:2,WELTMEISTER:3}}),(function(module,exports,__webpack_require__){var CONST={VERSION:'3.24.1',BlendModes:__webpack_require__(52),ScaleModes:__webpack_require__(234),AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,FOREVER:-1,NONE:4,UP:5,DOWN:6,LEFT:7,RIGHT:8};module.exports=CONST}),(function(module,exports){var GetBottom=function(gameObject){return(gameObject.y+gameObject.height)-(gameObject.height*gameObject.originY)};module.exports=GetBottom}),(function(module,exports){var GetLeft=function(gameObject){return gameObject.x-(gameObject.width*gameObject.originX)};module.exports=GetLeft}),(function(module,exports){var GetRight=function(gameObject){return(gameObject.x+gameObject.width)-(gameObject.width*gameObject.originX)};module.exports=GetRight}),(function(module,exports){var GetTop=function(gameObject){return gameObject.y-(gameObject.height*gameObject.originY)};module.exports=GetTop}),(function(module,exports){var PropertyValueInc=function(items,key,value,step,index,direction){if(step===undefined){step=0}if(index===undefined){index=0}if(direction===undefined){direction=1}var i;var t=0;var end=items.length;if(direction===1){for(i=index;i<end;i++){items[i][key]+=value+(t*step);t++}}else{for(i=index;i>=0;i--){items[i][key]+=value+(t*step);t++}}return items};module.exports=PropertyValueInc}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(13);var DegToRad=function(degrees){return degrees*CONST.DEG_TO_RAD};module.exports=DegToRad}),(function(module,exports,__webpack_require__){module.exports={DESTROY:__webpack_require__(647),FADE_IN_COMPLETE:__webpack_require__(648),FADE_IN_START:__webpack_require__(649),FADE_OUT_COMPLETE:__webpack_require__(650),FADE_OUT_START:__webpack_require__(651),FLASH_COMPLETE:__webpack_require__(652),FLASH_START:__webpack_require__(653),PAN_COMPLETE:__webpack_require__(654),PAN_START:__webpack_require__(655),POST_RENDER:__webpack_require__(656),PRE_RENDER:__webpack_require__(657),ROTATE_COMPLETE:__webpack_require__(658),ROTATE_START:__webpack_require__(659),SHAKE_COMPLETE:__webpack_require__(660),SHAKE_START:__webpack_require__(661),ZOOM_COMPLETE:__webpack_require__(662),ZOOM_START:__webpack_require__(663)}}),(function(module,exports){var FillStyleCanvas=function(ctx,src,altColor,altAlpha){var fillColor=(altColor)?altColor:src.fillColor;var fillAlpha=(altAlpha)?altAlpha:src.fillAlpha;var red=((fillColor&0xFF0000)>>>16);var green=((fillColor&0xFF00)>>>8);var blue=(fillColor&0xFF);ctx.fillStyle='rgba('+red+','+green+','+blue+','+fillAlpha+')'};module.exports=FillStyleCanvas}),(function(module,exports){var Common={};module.exports=Common;(function(){Common._nextId=0;Common._seed=0;Common._nowStartTime=+(new Date());Common.extend=function(obj,deep){var argsStart,args,deepClone;if(typeof deep==='boolean'){argsStart=2;deepClone=deep}else{argsStart=1;deepClone=true}for(var i=argsStart;i<arguments.length;i++){var source=arguments[i];if(source){for(var prop in source){if(deepClone&&source[prop]&&source[prop].constructor===Object){if(!obj[prop]||obj[prop].constructor===Object){obj[prop]=obj[prop]||{};Common.extend(obj[prop],deepClone,source[prop])}else{obj[prop]=source[prop]}}else{obj[prop]=source[prop]}}}}return obj};Common.clone=function(obj,deep){return Common.extend({},deep,obj)};Common.keys=function(obj){if(Object.keys)return Object.keys(obj);var keys=[];for(var key in obj)keys.push(key);return keys};Common.values=function(obj){var values=[];if(Object.keys){var keys=Object.keys(obj);for(var i=0;i<keys.length;i++){values.push(obj[keys[i]])}return values}for(var key in obj)values.push(obj[key]);return values};Common.get=function(obj,path,begin,end){path=path.split('.').slice(begin,end);for(var i=0;i<path.length;i+=1){obj=obj[path[i]]}return obj};Common.set=function(obj,path,val,begin,end){var parts=path.split('.').slice(begin,end);Common.get(obj,path,0,-1)[parts[parts.length-1]]=val;return val};Common.shuffle=function(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Common.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp}return array};Common.choose=function(choices){return choices[Math.floor(Common.random()*choices.length)]};Common.isElement=function(obj){if(typeof HTMLElement!=='undefined'){return obj instanceof HTMLElement}return!!(obj&&obj.nodeType&&obj.nodeName)};Common.isArray=function(obj){return Object.prototype.toString.call(obj)==='[object Array]'};Common.isFunction=function(obj){return typeof obj==="function"};Common.isPlainObject=function(obj){return typeof obj==='object'&&obj.constructor===Object};Common.isString=function(obj){return Object.prototype.toString.call(obj)==='[object String]'};Common.clamp=function(value,min,max){if(value<min)return min;if(value>max)return max;return value};Common.sign=function(value){return value<0?-1:1};Common.now=function(){if(typeof window!=='undefined'&&window.performance){if(window.performance.now){return window.performance.now()}else if(window.performance.webkitNow){return window.performance.webkitNow()}}return(new Date())-Common._nowStartTime};Common.random=function(min,max){min=(typeof min!=="undefined")?min:0;max=(typeof max!=="undefined")?max:1;return min+_seededRandom()*(max-min)};var _seededRandom=function(){Common._seed=(Common._seed*9301+49297)%233280;return Common._seed/233280};Common.colorToNumber=function(colorString){colorString=colorString.replace('#','');if(colorString.length==3){colorString=colorString.charAt(0)+colorString.charAt(0)+colorString.charAt(1)+colorString.charAt(1)+colorString.charAt(2)+colorString.charAt(2)}return parseInt(colorString,16)};Common.logLevel=1;Common.log=function(){if(console&&Common.logLevel>0&&Common.logLevel<=3){console.log.apply(console,['matter-js:'].concat(Array.prototype.slice.call(arguments)))}};Common.info=function(){if(console&&Common.logLevel>0&&Common.logLevel<=2){console.info.apply(console,['matter-js:'].concat(Array.prototype.slice.call(arguments)))}};Common.warn=function(){if(console&&Common.logLevel>0&&Common.logLevel<=3){console.warn.apply(console,['matter-js:'].concat(Array.prototype.slice.call(arguments)))}};Common.nextId=function(){return Common._nextId++};Common.indexOf=function(haystack,needle){if(haystack.indexOf)return haystack.indexOf(needle);for(var i=0;i<haystack.length;i++){if(haystack[i]===needle)return i}return-1};Common.map=function(list,func){if(list.map){return list.map(func)}var mapped=[];for(var i=0;i<list.length;i+=1){mapped.push(func(list[i]))}return mapped};Common.topologicalSort=function(graph){var result=[],visited=[],temp=[];for(var node in graph){if(!visited[node]&&!temp[node]){Common._topologicalSort(node,visited,temp,graph,result)}}return result};Common._topologicalSort=function(node,visited,temp,graph,result){var neighbors=graph[node]||[];temp[node]=true;for(var i=0;i<neighbors.length;i+=1){var neighbor=neighbors[i];if(temp[neighbor]){continue}if(!visited[neighbor]){Common._topologicalSort(neighbor,visited,temp,graph,result)}}temp[node]=false;visited[node]=true;result.push(node)};Common.chain=function(){var funcs=[];for(var i=0;i<arguments.length;i+=1){var func=arguments[i];if(func._chained){funcs.push.apply(funcs,func._chained)}else{funcs.push(func)}}var chain=function(){var lastResult,args=new Array(arguments.length);for(var i=0,l=arguments.length;i<l;i++){args[i]=arguments[i]}for(i=0;i<funcs.length;i+=1){var result=funcs[i].apply(lastResult,args);if(typeof result!=='undefined'){lastResult=result}}return lastResult};chain._chained=funcs;return chain};Common.chainPathBefore=function(base,path,func){return Common.set(base,path,Common.chain(func,Common.get(base,path)))};Common.chainPathAfter=function(base,path,func){return Common.set(base,path,Common.chain(Common.get(base,path),func))}})()}),(function(module,exports){var SetTop=function(gameObject,value){gameObject.y=value+(gameObject.height*gameObject.originY);return gameObject};module.exports=SetTop}),(function(module,exports){var SetLeft=function(gameObject,value){gameObject.x=value+(gameObject.width*gameObject.originX);return gameObject};module.exports=SetLeft}),(function(module,exports){var SetRight=function(gameObject,value){gameObject.x=(value-gameObject.width)+(gameObject.width*gameObject.originX);return gameObject};module.exports=SetRight}),(function(module,exports){var SetBottom=function(gameObject,value){gameObject.y=(value-gameObject.height)+(gameObject.height*gameObject.originY);return gameObject};module.exports=SetBottom}),(function(module,exports){var GEOM_CONST={CIRCLE:0,ELLIPSE:1,LINE:2,POINT:3,POLYGON:4,RECTANGLE:5,TRIANGLE:6};module.exports=GEOM_CONST}),(function(module,exports){var Contains=function(rect,x,y){if(rect.width<=0||rect.height<=0){return false}return(rect.x<=x&&rect.x+rect.width>=x&&rect.y<=y&&rect.y+rect.height>=y)};module.exports=Contains}),(function(module,exports){var LineStyleCanvas=function(ctx,src,altColor,altAlpha){var strokeColor=(altColor)?altColor:src.strokeColor;var strokeAlpha=(altAlpha)?altAlpha:src.strokeAlpha;var red=((strokeColor&0xFF0000)>>>16);var green=((strokeColor&0xFF00)>>>8);var blue=(strokeColor&0xFF);ctx.strokeStyle='rgba('+red+','+green+','+blue+','+strokeAlpha+')';ctx.lineWidth=src.lineWidth};module.exports=LineStyleCanvas}),(function(module,exports){var CONST={DYNAMIC_BODY:0,STATIC_BODY:1,GROUP:2,TILEMAPLAYER:3,FACING_NONE:10,FACING_UP:11,FACING_DOWN:12,FACING_LEFT:13,FACING_RIGHT:14};module.exports=CONST}),(function(module,exports,__webpack_require__){var GetTileAt=__webpack_require__(142);var GetTilesWithin=__webpack_require__(24);var CalculateFacesWithin=function(tileX,tileY,width,height,layer){var above=null;var below=null;var left=null;var right=null;var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);for(var i=0;i<tiles.length;i++){var tile=tiles[i];if(tile){if(tile.collides){above=GetTileAt(tile.x,tile.y-1,true,layer);below=GetTileAt(tile.x,tile.y+1,true,layer);left=GetTileAt(tile.x-1,tile.y,true,layer);right=GetTileAt(tile.x+1,tile.y,true,layer);tile.faceTop=(above&&above.collides)?false:true;tile.faceBottom=(below&&below.collides)?false:true;tile.faceLeft=(left&&left.collides)?false:true;tile.faceRight=(right&&right.collides)?false:true}else{tile.resetFaces()}}}};module.exports=CalculateFacesWithin}),(function(module,exports){module.exports={SKIP_CHECK:-1,NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16,ERASE:17,SOURCE_IN:18,SOURCE_OUT:19,SOURCE_ATOP:20,DESTINATION_OVER:21,DESTINATION_IN:22,DESTINATION_OUT:23,DESTINATION_ATOP:24,LIGHTER:25,COPY:26,XOR:27}}),(function(module,exports){var DistanceBetween=function(x1,y1,x2,y2){var dx=x1-x2;var dy=y1-y2;return Math.sqrt(dx*dx+dy*dy)};module.exports=DistanceBetween}),(function(module,exports,__webpack_require__){module.exports={BOOT:__webpack_require__(823),DESTROY:__webpack_require__(824),DRAG_END:__webpack_require__(825),DRAG_ENTER:__webpack_require__(826),DRAG:__webpack_require__(827),DRAG_LEAVE:__webpack_require__(828),DRAG_OVER:__webpack_require__(829),DRAG_START:__webpack_require__(830),DROP:__webpack_require__(831),GAME_OUT:__webpack_require__(832),GAME_OVER:__webpack_require__(833),GAMEOBJECT_DOWN:__webpack_require__(834),GAMEOBJECT_DRAG_END:__webpack_require__(835),GAMEOBJECT_DRAG_ENTER:__webpack_require__(836),GAMEOBJECT_DRAG:__webpack_require__(837),GAMEOBJECT_DRAG_LEAVE:__webpack_require__(838),GAMEOBJECT_DRAG_OVER:__webpack_require__(839),GAMEOBJECT_DRAG_START:__webpack_require__(840),GAMEOBJECT_DROP:__webpack_require__(841),GAMEOBJECT_MOVE:__webpack_require__(842),GAMEOBJECT_OUT:__webpack_require__(843),GAMEOBJECT_OVER:__webpack_require__(844),GAMEOBJECT_POINTER_DOWN:__webpack_require__(845),GAMEOBJECT_POINTER_MOVE:__webpack_require__(846),GAMEOBJECT_POINTER_OUT:__webpack_require__(847),GAMEOBJECT_POINTER_OVER:__webpack_require__(848),GAMEOBJECT_POINTER_UP:__webpack_require__(849),GAMEOBJECT_POINTER_WHEEL:__webpack_require__(850),GAMEOBJECT_UP:__webpack_require__(851),GAMEOBJECT_WHEEL:__webpack_require__(852),MANAGER_BOOT:__webpack_require__(853),MANAGER_PROCESS:__webpack_require__(854),MANAGER_UPDATE:__webpack_require__(855),POINTER_DOWN:__webpack_require__(856),POINTER_DOWN_OUTSIDE:__webpack_require__(857),POINTER_MOVE:__webpack_require__(858),POINTER_OUT:__webpack_require__(859),POINTER_OVER:__webpack_require__(860),POINTER_UP:__webpack_require__(861),POINTER_UP_OUTSIDE:__webpack_require__(862),POINTER_WHEEL:__webpack_require__(863),POINTERLOCK_CHANGE:__webpack_require__(864),PRE_UPDATE:__webpack_require__(865),SHUTDOWN:__webpack_require__(866),START:__webpack_require__(867),UPDATE:__webpack_require__(868)}}),(function(module,exports){var Contains=function(circle,x,y){if(circle.radius>0&&x>=circle.left&&x<=circle.right&&y>=circle.top&&y<=circle.bottom){var dx=(circle.x-x)*(circle.x-x);var dy=(circle.y-y)*(circle.y-y);return(dx+dy)<=(circle.radius*circle.radius)}else{return false}};module.exports=Contains}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetPoint=__webpack_require__(275);var GetPoints=__webpack_require__(153);var GEOM_CONST=__webpack_require__(47);var Random=__webpack_require__(154);var Vector2=__webpack_require__(3);var Line=new Class({initialize:function Line(x1,y1,x2,y2){if(x1===undefined){x1=0}if(y1===undefined){y1=0}if(x2===undefined){x2=0}if(y2===undefined){y2=0}this.type=GEOM_CONST.LINE;this.x1=x1;this.y1=y1;this.x2=x2;this.y2=y2},getPoint:function(position,output){return GetPoint(this,position,output)},getPoints:function(quantity,stepRate,output){return GetPoints(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random(this,point)},setTo:function(x1,y1,x2,y2){if(x1===undefined){x1=0}if(y1===undefined){y1=0}if(x2===undefined){x2=0}if(y2===undefined){y2=0}this.x1=x1;this.y1=y1;this.x2=x2;this.y2=y2;return this},getPointA:function(vec2){if(vec2===undefined){vec2=new Vector2()}vec2.set(this.x1,this.y1);return vec2},getPointB:function(vec2){if(vec2===undefined){vec2=new Vector2()}vec2.set(this.x2,this.y2);return vec2},left:{get:function(){return Math.min(this.x1,this.x2)},set:function(value){if(this.x1<=this.x2){this.x1=value}else{this.x2=value}}},right:{get:function(){return Math.max(this.x1,this.x2)},set:function(value){if(this.x1>this.x2){this.x1=value}else{this.x2=value}}},top:{get:function(){return Math.min(this.y1,this.y2)},set:function(value){if(this.y1<=this.y2){this.y1=value}else{this.y2=value}}},bottom:{get:function(){return Math.max(this.y1,this.y2)},set:function(value){if(this.y1>this.y2){this.y1=value}else{this.y2=value}}}});module.exports=Line}),(function(module,exports){var Length=function(line){return Math.sqrt((line.x2-line.x1)*(line.x2-line.x1)+(line.y2-line.y1)*(line.y2-line.y1))};module.exports=Length}),(function(module,exports){var Wrap=function(value,min,max){var range=max-min;return(min+((((value-min)%range)+range)%range))};module.exports=Wrap}),(function(module,exports,__webpack_require__){module.exports={COMPLETE:__webpack_require__(891),DECODED:__webpack_require__(892),DECODED_ALL:__webpack_require__(893),DESTROY:__webpack_require__(894),DETUNE:__webpack_require__(895),GLOBAL_DETUNE:__webpack_require__(896),GLOBAL_MUTE:__webpack_require__(897),GLOBAL_RATE:__webpack_require__(898),GLOBAL_VOLUME:__webpack_require__(899),LOOP:__webpack_require__(900),LOOPED:__webpack_require__(901),MUTE:__webpack_require__(902),PAUSE_ALL:__webpack_require__(903),PAUSE:__webpack_require__(904),PLAY:__webpack_require__(905),RATE:__webpack_require__(906),RESUME_ALL:__webpack_require__(907),RESUME:__webpack_require__(908),SEEK:__webpack_require__(909),STOP_ALL:__webpack_require__(910),STOP:__webpack_require__(911),UNLOCKED:__webpack_require__(912),VOLUME:__webpack_require__(913)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var GetValue=__webpack_require__(6);var IsPlainObject=__webpack_require__(7);var JSONFile=new Class({Extends:File,initialize:function JSONFile(loader,key,url,xhrSettings,dataKey){var extension='json';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension);dataKey=GetFastValue(config,'dataKey',dataKey)}var fileConfig={type:'json',cache:loader.cacheManager.json,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings,config:dataKey};File.call(this,loader,fileConfig);if(IsPlainObject(url)){if(dataKey){this.data=GetValue(url,dataKey)}else{this.data=url}this.state=CONST.FILE_POPULATED}},onProcess:function(){if(this.state!==CONST.FILE_POPULATED){this.state=CONST.FILE_PROCESSING;var json=JSON.parse(this.xhrLoader.responseText);var key=this.config;if(typeof key==='string'){this.data=GetValue(json,key,json)}else{this.data=json}}this.onProcessComplete()}});FileTypesManager.register('json',function(key,url,dataKey,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new JSONFile(this,key[i]))}}else{this.addFile(new JSONFile(this,key,url,xhrSettings,dataKey))}return this});module.exports=JSONFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var MultiFile=new Class({initialize:function MultiFile(loader,type,key,files){this.loader=loader;this.type=type;this.key=key;this.multiKeyIndex=loader.multiKeyIndex++;this.files=files;this.complete=false;this.pending=files.length;this.failed=0;this.config={};this.baseURL=loader.baseURL;this.path=loader.path;this.prefix=loader.prefix;for(var i=0;i<files.length;i++){files[i].multiFile=this}},isReadyToProcess:function(){return(this.pending===0&&this.failed===0&&!this.complete)},addToMultiFile:function(file){this.files.push(file);file.multiFile=this;this.pending++;this.complete=false;return this},onFileComplete:function(file){var index=this.files.indexOf(file);if(index!==-1){this.pending--}},onFileFailed:function(file){var index=this.files.indexOf(file);if(index!==-1){this.failed++}}});module.exports=MultiFile}),(function(module,exports,__webpack_require__){var Body={};module.exports=Body;var Vertices=__webpack_require__(86);var Vector=__webpack_require__(99);var Sleeping=__webpack_require__(239);var Common=__webpack_require__(42);var Bounds=__webpack_require__(100);var Axes=__webpack_require__(513);(function(){Body._inertiaScale=4;Body._nextCollidingGroupId=1;Body._nextNonCollidingGroupId=-1;Body._nextCategory=0x0001;Body.create=function(options){var defaults={id:Common.nextId(),type:'body',label:'Body',parts:[],plugin:{},angle:0,vertices:null,position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},previousPositionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:false,isStatic:false,isSleeping:false,motion:0,sleepThreshold:60,density:0.001,restitution:0,friction:0.1,frictionStatic:0.5,frictionAir:0.01,collisionFilter:{category:0x0001,mask:0xFFFFFFFF,group:0},slop:0.05,timeScale:1,events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inverseMass:0,inertia:0,inverseInertia:0,_original:null,render:{visible:true,opacity:1,sprite:{xOffset:0,yOffset:0},fillColor:null,fillOpacity:null,lineColor:null,lineOpacity:null,lineThickness:null},gameObject:null,scale:{x:1,y:1},centerOfMass:{x:0,y:0},centerOffset:{x:0,y:0},gravityScale:{x:1,y:1},ignoreGravity:false,ignorePointer:false,onCollideCallback:null,onCollideEndCallback:null,onCollideActiveCallback:null,onCollideWith:{}};if(!options.hasOwnProperty('position')&&options.hasOwnProperty('vertices')){options.position=Vertices.centre(options.vertices)}else if(!options.hasOwnProperty('vertices')){defaults.vertices=Vertices.fromPath('L 0 0 L 40 0 L 40 40 L 0 40')}var body=Common.extend(defaults,options);_initProperties(body,options);body.setOnCollideWith=function(body,callback){if(callback){this.onCollideWith[body.id]=callback}else{delete this.onCollideWith[body.id]}return this}return body};Body.nextGroup=function(isNonColliding){if(isNonColliding)return Body._nextNonCollidingGroupId--;return Body._nextCollidingGroupId++};Body.nextCategory=function(){Body._nextCategory=Body._nextCategory<<1;return Body._nextCategory};var _initProperties=function(body,options){options=options||{};Body.set(body,{bounds:body.bounds||Bounds.create(body.vertices),positionPrev:body.positionPrev||Vector.clone(body.position),anglePrev:body.anglePrev||body.angle,vertices:body.vertices,parts:body.parts||[body],isStatic:body.isStatic,isSleeping:body.isSleeping,parent:body.parent||body});var bounds=body.bounds;Vertices.rotate(body.vertices,body.angle,body.position);Axes.rotate(body.axes,body.angle);Bounds.update(bounds,body.vertices,body.velocity);Body.set(body,{axes:options.axes||body.axes,area:options.area||body.area,mass:options.mass||body.mass,inertia:options.inertia||body.inertia});if(body.parts.length===1){var centerOfMass=body.centerOfMass;var centerOffset=body.centerOffset;var bodyWidth=bounds.max.x-bounds.min.x;var bodyHeight=bounds.max.y-bounds.min.y;centerOfMass.x=-(bounds.min.x-body.position.x)/bodyWidth;centerOfMass.y=-(bounds.min.y-body.position.y)/bodyHeight;centerOffset.x=bodyWidth*centerOfMass.x;centerOffset.y=bodyHeight*centerOfMass.y}};Body.set=function(body,settings,value){var property;if(typeof settings==='string'){property=settings;settings={};settings[property]=value}for(property in settings){if(!Object.prototype.hasOwnProperty.call(settings,property))continue;value=settings[property];switch(property){case'isStatic':Body.setStatic(body,value);break;case'isSleeping':Sleeping.set(body,value);break;case'mass':Body.setMass(body,value);break;case'density':Body.setDensity(body,value);break;case'inertia':Body.setInertia(body,value);break;case'vertices':Body.setVertices(body,value);break;case'position':Body.setPosition(body,value);break;case'angle':Body.setAngle(body,value);break;case'velocity':Body.setVelocity(body,value);break;case'angularVelocity':Body.setAngularVelocity(body,value);break;case'parts':Body.setParts(body,value);break;case'centre':Body.setCentre(body,value);break;default:body[property]=value}}};Body.setStatic=function(body,isStatic){for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.isStatic=isStatic;if(isStatic){part._original={restitution:part.restitution,friction:part.friction,mass:part.mass,inertia:part.inertia,density:part.density,inverseMass:part.inverseMass,inverseInertia:part.inverseInertia};part.restitution=0;part.friction=1;part.mass=part.inertia=part.density=Infinity;part.inverseMass=part.inverseInertia=0;part.positionPrev.x=part.position.x;part.positionPrev.y=part.position.y;part.anglePrev=part.angle;part.angularVelocity=0;part.speed=0;part.angularSpeed=0;part.motion=0}else if(part._original){part.restitution=part._original.restitution;part.friction=part._original.friction;part.mass=part._original.mass;part.inertia=part._original.inertia;part.density=part._original.density;part.inverseMass=part._original.inverseMass;part.inverseInertia=part._original.inverseInertia;part._original=null}}};Body.setMass=function(body,mass){var moment=body.inertia/(body.mass/6);body.inertia=moment*(mass/6);body.inverseInertia=1/body.inertia;body.mass=mass;body.inverseMass=1/body.mass;body.density=body.mass/body.area};Body.setDensity=function(body,density){Body.setMass(body,density*body.area);body.density=density};Body.setInertia=function(body,inertia){body.inertia=inertia;body.inverseInertia=1/body.inertia};Body.setVertices=function(body,vertices){if(vertices[0].body===body){body.vertices=vertices}else{body.vertices=Vertices.create(vertices,body)}body.axes=Axes.fromVertices(body.vertices);body.area=Vertices.area(body.vertices);Body.setMass(body,body.density*body.area);var centre=Vertices.centre(body.vertices);Vertices.translate(body.vertices,centre,-1);Body.setInertia(body,Body._inertiaScale*Vertices.inertia(body.vertices,body.mass));Vertices.translate(body.vertices,body.position);Bounds.update(body.bounds,body.vertices,body.velocity)};Body.setParts=function(body,parts,autoHull){var i;parts=parts.slice(0);body.parts.length=0;body.parts.push(body);body.parent=body;for(i=0;i<parts.length;i++){var part=parts[i];if(part!==body){part.parent=body;body.parts.push(part)}}if(body.parts.length===1)return;autoHull=typeof autoHull!=='undefined'?autoHull:true;if(autoHull){var vertices=[];for(i=0;i<parts.length;i++){vertices=vertices.concat(parts[i].vertices)}Vertices.clockwiseSort(vertices);var hull=Vertices.hull(vertices),hullCentre=Vertices.centre(hull);Body.setVertices(body,hull);Vertices.translate(body.vertices,hullCentre)}var total=Body._totalProperties(body);var cx=total.centre.x;var cy=total.centre.y;var bounds=body.bounds;var centerOfMass=body.centerOfMass;var centerOffset=body.centerOffset;Bounds.update(bounds,body.vertices,body.velocity);centerOfMass.x=-(bounds.min.x-cx)/(bounds.max.x-bounds.min.x);centerOfMass.y=-(bounds.min.y-cy)/(bounds.max.y-bounds.min.y);centerOffset.x=cx;centerOffset.y=cy;body.area=total.area;body.parent=body;body.position.x=cx;body.position.y=cy;body.positionPrev.x=cx;body.positionPrev.y=cy;Body.setMass(body,total.mass);Body.setInertia(body,total.inertia);Body.setPosition(body,total.centre)};Body.setCentre=function(body,centre,relative){if(!relative){body.positionPrev.x=centre.x-(body.position.x-body.positionPrev.x);body.positionPrev.y=centre.y-(body.position.y-body.positionPrev.y);body.position.x=centre.x;body.position.y=centre.y}else{body.positionPrev.x+=centre.x;body.positionPrev.y+=centre.y;body.position.x+=centre.x;body.position.y+=centre.y}};Body.setPosition=function(body,position){var delta=Vector.sub(position,body.position);body.positionPrev.x+=delta.x;body.positionPrev.y+=delta.y;for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.position.x+=delta.x;part.position.y+=delta.y;Vertices.translate(part.vertices,delta);Bounds.update(part.bounds,part.vertices,body.velocity)}};Body.setAngle=function(body,angle){var delta=angle-body.angle;body.anglePrev+=delta;for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.angle+=delta;Vertices.rotate(part.vertices,delta,body.position);Axes.rotate(part.axes,delta);Bounds.update(part.bounds,part.vertices,body.velocity);if(i>0){Vector.rotateAbout(part.position,delta,body.position,part.position)}}};Body.setVelocity=function(body,velocity){body.positionPrev.x=body.position.x-velocity.x;body.positionPrev.y=body.position.y-velocity.y;body.velocity.x=velocity.x;body.velocity.y=velocity.y;body.speed=Vector.magnitude(body.velocity)};Body.setAngularVelocity=function(body,velocity){body.anglePrev=body.angle-velocity;body.angularVelocity=velocity;body.angularSpeed=Math.abs(body.angularVelocity)};Body.translate=function(body,translation){Body.setPosition(body,Vector.add(body.position,translation))};Body.rotate=function(body,rotation,point){if(!point){Body.setAngle(body,body.angle+rotation)}else{var cos=Math.cos(rotation),sin=Math.sin(rotation),dx=body.position.x-point.x,dy=body.position.y-point.y;Body.setPosition(body,{x:point.x+(dx*cos-dy*sin),y:point.y+(dx*sin+dy*cos)});Body.setAngle(body,body.angle+rotation)}};Body.scale=function(body,scaleX,scaleY,point){var totalArea=0,totalInertia=0;point=point||body.position;for(var i=0;i<body.parts.length;i++){var part=body.parts[i];part.scale.x=scaleX;part.scale.y=scaleY;Vertices.scale(part.vertices,scaleX,scaleY,point);part.axes=Axes.fromVertices(part.vertices);part.area=Vertices.area(part.vertices);Body.setMass(part,body.density*part.area);Vertices.translate(part.vertices,{x:-part.position.x,y:-part.position.y});Body.setInertia(part,Body._inertiaScale*Vertices.inertia(part.vertices,part.mass));Vertices.translate(part.vertices,{x:part.position.x,y:part.position.y});if(i>0){totalArea+=part.area;totalInertia+=part.inertia}part.position.x=point.x+(part.position.x-point.x)*scaleX;part.position.y=point.y+(part.position.y-point.y)*scaleY;Bounds.update(part.bounds,part.vertices,body.velocity)}if(body.parts.length>1){body.area=totalArea;if(!body.isStatic){Body.setMass(body,body.density*totalArea);Body.setInertia(body,totalInertia)}}if(body.circleRadius){if(scaleX===scaleY){body.circleRadius*=scaleX}else{body.circleRadius=null}}};Body.update=function(body,deltaTime,timeScale,correction){var deltaTimeSquared=Math.pow(deltaTime*timeScale*body.timeScale,2);var frictionAir=1-body.frictionAir*timeScale*body.timeScale,velocityPrevX=body.position.x-body.positionPrev.x,velocityPrevY=body.position.y-body.positionPrev.y;body.velocity.x=(velocityPrevX*frictionAir*correction)+(body.force.x/body.mass)*deltaTimeSquared;body.velocity.y=(velocityPrevY*frictionAir*correction)+(body.force.y/body.mass)*deltaTimeSquared;body.positionPrev.x=body.position.x;body.positionPrev.y=body.position.y;body.position.x+=body.velocity.x;body.position.y+=body.velocity.y;body.angularVelocity=((body.angle-body.anglePrev)*frictionAir*correction)+(body.torque/body.inertia)*deltaTimeSquared;body.anglePrev=body.angle;body.angle+=body.angularVelocity;body.speed=Vector.magnitude(body.velocity);body.angularSpeed=Math.abs(body.angularVelocity);for(var i=0;i<body.parts.length;i++){var part=body.parts[i];Vertices.translate(part.vertices,body.velocity);if(i>0){part.position.x+=body.velocity.x;part.position.y+=body.velocity.y}if(body.angularVelocity!==0){Vertices.rotate(part.vertices,body.angularVelocity,body.position);Axes.rotate(part.axes,body.angularVelocity);if(i>0){Vector.rotateAbout(part.position,body.angularVelocity,body.position,part.position)}}Bounds.update(part.bounds,part.vertices,body.velocity)}};Body.applyForce=function(body,position,force){body.force.x+=force.x;body.force.y+=force.y;var offset={x:position.x-body.position.x,y:position.y-body.position.y};body.torque+=offset.x*force.y-offset.y*force.x};Body._totalProperties=function(body){var properties={mass:0,area:0,inertia:0,centre:{x:0,y:0}};for(var i=body.parts.length===1?0:1;i<body.parts.length;i++){var part=body.parts[i],mass=part.mass!==Infinity?part.mass:1;properties.mass+=mass;properties.area+=part.area;properties.inertia+=part.inertia;properties.centre=Vector.add(properties.centre,Vector.mult(part.position,mass))}properties.centre=Vector.div(properties.centre,properties.mass);return properties}})()}),(function(module,exports){var WorldToTileX=function(worldX,snapToFloor,camera,layer){if(snapToFloor===undefined){snapToFloor=true}var tileWidth=layer.baseTileWidth;var tilemapLayer=layer.tilemapLayer;if(tilemapLayer){if(camera===undefined){camera=tilemapLayer.scene.cameras.main}worldX=worldX-(tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX));tileWidth*=tilemapLayer.scaleX}return snapToFloor?Math.floor(worldX/tileWidth):worldX/tileWidth};module.exports=WorldToTileX}),(function(module,exports){var WorldToTileY=function(worldY,snapToFloor,camera,layer){if(snapToFloor===undefined){snapToFloor=true}var tileHeight=layer.baseTileHeight;var tilemapLayer=layer.tilemapLayer;if(tilemapLayer){if(camera===undefined){camera=tilemapLayer.scene.cameras.main}worldY=worldY-(tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY));tileHeight*=tilemapLayer.scaleY}return snapToFloor?Math.floor(worldY/tileHeight):worldY/tileHeight};module.exports=WorldToTileY}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Contains=__webpack_require__(55);var GetPoint=__webpack_require__(266);var GetPoints=__webpack_require__(267);var GEOM_CONST=__webpack_require__(47);var Random=__webpack_require__(150);var Circle=new Class({initialize:function Circle(x,y,radius){if(x===undefined){x=0}if(y===undefined){y=0}if(radius===undefined){radius=0}this.type=GEOM_CONST.CIRCLE;this.x=x;this.y=y;this._radius=radius;this._diameter=radius*2},contains:function(x,y){return Contains(this,x,y)},getPoint:function(position,point){return GetPoint(this,position,point)},getPoints:function(quantity,stepRate,output){return GetPoints(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random(this,point)},setTo:function(x,y,radius){this.x=x;this.y=y;this._radius=radius;this._diameter=radius*2;return this},setEmpty:function(){this._radius=0;this._diameter=0;return this},setPosition:function(x,y){if(y===undefined){y=x}this.x=x;this.y=y;return this},isEmpty:function(){return(this._radius<=0)},radius:{get:function(){return this._radius},set:function(value){this._radius=value;this._diameter=value*2}},diameter:{get:function(){return this._diameter},set:function(value){this._diameter=value;this._radius=value*0.5}},left:{get:function(){return this.x-this._radius},set:function(value){this.x=value+this._radius}},right:{get:function(){return this.x+this._radius},set:function(value){this.x=value-this._radius}},top:{get:function(){return this.y-this._radius},set:function(value){this.y=value+this._radius}},bottom:{get:function(){return this.y+this._radius},set:function(value){this.y=value-this._radius}}});module.exports=Circle}),(function(module,exports,__webpack_require__){"use strict";module.exports=earcut;function earcut(data,holeIndices,dim){dim=dim||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=linkedList(data,0,outerLen,dim,true),triangles=[];if(!outerNode||outerNode.next===outerNode.prev)return triangles;var minX,minY,maxX,maxY,x,y,invSize;if(hasHoles)outerNode=eliminateHoles(data,holeIndices,outerNode,dim);if(data.length>80*dim){minX=maxX=data[0];minY=maxY=data[1];for(var i=dim;i<outerLen;i+=dim){x=data[i];y=data[i+1];if(x<minX)minX=x;if(y<minY)minY=y;if(x>maxX)maxX=x;if(y>maxY)maxY=y}invSize=Math.max(maxX-minX,maxY-minY);invSize=invSize!==0?1/invSize:0}earcutLinked(outerNode,triangles,dim,minX,minY,invSize);return triangles}function linkedList(data,start,end,dim,clockwise){var i,last;if(clockwise===(signedArea(data,start,end,dim)>0)){for(i=start;i<end;i+=dim)last=insertNode(i,data[i],data[i+1],last)}else{for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last)}if(last&&equals(last,last.next)){removeNode(last);last=last.next}return last}function filterPoints(start,end){if(!start)return start;if(!end)end=start;var p=start,again;do{again=false;if(!p.steiner&&(equals(p,p.next)||area(p.prev,p,p.next)===0)){removeNode(p);p=end=p.prev;if(p===p.next)break;again=true}else{p=p.next}}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,invSize,pass){if(!ear)return;if(!pass&&invSize)indexCurve(ear,minX,minY,invSize);var stop=ear,prev,next;while(ear.prev!==ear.next){prev=ear.prev;next=ear.next;if(invSize?isEarHashed(ear,minX,minY,invSize):isEar(ear)){triangles.push(prev.i/dim);triangles.push(ear.i/dim);triangles.push(next.i/dim);removeNode(ear);ear=next.next;stop=next.next;continue}ear=next;if(ear===stop){if(!pass){earcutLinked(filterPoints(ear),triangles,dim,minX,minY,invSize,1)}else if(pass===1){ear=cureLocalIntersections(ear,triangles,dim);earcutLinked(ear,triangles,dim,minX,minY,invSize,2)}else if(pass===2){splitEarcut(ear,triangles,dim,minX,minY,invSize)}break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return false;var p=ear.next.next;while(p!==ear.prev){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.next}return true}function isEarHashed(ear,minX,minY,invSize){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return false;var minTX=a.x<b.x?(a.x<c.x?a.x:c.x):(b.x<c.x?b.x:c.x),minTY=a.y<b.y?(a.y<c.y?a.y:c.y):(b.y<c.y?b.y:c.y),maxTX=a.x>b.x?(a.x>c.x?a.x:c.x):(b.x>c.x?b.x:c.x),maxTY=a.y>b.y?(a.y>c.y?a.y:c.y):(b.y>c.y?b.y:c.y);var minZ=zOrder(minTX,minTY,minX,minY,invSize),maxZ=zOrder(maxTX,maxTY,minX,minY,invSize);var p=ear.prevZ,n=ear.nextZ;while(p&&p.z>=minZ&&n&&n.z<=maxZ){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.prevZ;if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return false;n=n.nextZ}while(p&&p.z>=minZ){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return false;p=p.prevZ}while(n&&n.z<=maxZ){if(n!==ear.prev&&n!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,n.x,n.y)&&area(n.prev,n,n.next)>=0)return false;n=n.nextZ}return true}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;if(!equals(a,b)&&intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)){triangles.push(a.i/dim);triangles.push(p.i/dim);triangles.push(b.i/dim);removeNode(p);removeNode(p.next);p=start=b}p=p.next}while(p!==start);return p}function splitEarcut(start,triangles,dim,minX,minY,invSize){var a=start;do{var b=a.next.next;while(b!==a.prev){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);a=filterPoints(a,a.next);c=filterPoints(c,c.next);earcutLinked(a,triangles,dim,minX,minY,invSize);earcutLinked(c,triangles,dim,minX,minY,invSize);return}b=b.next}a=a.next}while(a!==start)}function eliminateHoles(data,holeIndices,outerNode,dim){var queue=[],i,len,start,end,list;for(i=0,len=holeIndices.length;i<len;i++){start=holeIndices[i]*dim;end=i<len-1?holeIndices[i+1]*dim:data.length;list=linkedList(data,start,end,dim,false);if(list===list.next)list.steiner=true;queue.push(getLeftmost(list))}queue.sort(compareX);for(i=0;i<queue.length;i++){eliminateHole(queue[i],outerNode);outerNode=filterPoints(outerNode,outerNode.next)}return outerNode}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){outerNode=findHoleBridge(hole,outerNode);if(outerNode){var b=splitPolygon(outerNode,hole);filterPoints(b,b.next)}}function findHoleBridge(hole,outerNode){var p=outerNode,hx=hole.x,hy=hole.y,qx=-Infinity,m;do{if(hy<=p.y&&hy>=p.next.y&&p.next.y!==p.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(x<=hx&&x>qx){qx=x;if(x===hx){if(hy===p.y)return p;if(hy===p.next.y)return p.next}m=p.x<p.next.x?p:p.next}}p=p.next}while(p!==outerNode);if(!m)return null;if(hx===qx)return m.prev;var stop=m,mx=m.x,my=m.y,tanMin=Infinity,tan;p=m.next;while(p!==stop){if(hx>=p.x&&p.x>=mx&&hx!==p.x&&pointInTriangle(hy<my?hx:qx,hy,mx,my,hy<my?qx:hx,hy,p.x,p.y)){tan=Math.abs(hy-p.y)/(hx-p.x); if((tan<tanMin||(tan===tanMin&&p.x>m.x))&&locallyInside(p,hole)){m=p;tanMin=tan}}p=p.next}return m}function indexCurve(start,minX,minY,invSize){var p=start;do{if(p.z===null)p.z=zOrder(p.x,p.y,minX,minY,invSize);p.prevZ=p.prev;p.nextZ=p.next;p=p.next}while(p!==start);p.prevZ.nextZ=null;p.prevZ=null;sortLinked(p)}function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{p=list;list=null;tail=null;numMerges=0;while(p){numMerges++;q=p;pSize=0;for(i=0;i<inSize;i++){pSize++;q=q.nextZ;if(!q)break}qSize=inSize;while(pSize>0||(qSize>0&&q)){if(pSize!==0&&(qSize===0||!q||p.z<=q.z)){e=p;p=p.nextZ;pSize--}else{e=q;q=q.nextZ;qSize--}if(tail)tail.nextZ=e;else list=e;e.prevZ=tail;tail=e}p=q}tail.nextZ=null;inSize*=2}while(numMerges>1);return list}function zOrder(x,y,minX,minY,invSize){x=32767*(x-minX)*invSize;y=32767*(y-minY)*invSize;x=(x|(x<<8))&0x00FF00FF;x=(x|(x<<4))&0x0F0F0F0F;x=(x|(x<<2))&0x33333333;x=(x|(x<<1))&0x55555555;y=(y|(y<<8))&0x00FF00FF;y=(y|(y<<4))&0x0F0F0F0F;y=(y|(y<<2))&0x33333333;y=(y|(y<<1))&0x55555555;return x|(y<<1)}function getLeftmost(start){var p=start,leftmost=start;do{if(p.x<leftmost.x)leftmost=p;p=p.next}while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!intersectsPolygon(a,b)&&locallyInside(a,b)&&locallyInside(b,a)&&middleInside(a,b)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){if((equals(p1,q1)&&equals(p2,q2))||(equals(p1,q2)&&equals(p2,q1)))return true;return area(p1,q1,p2)>0!==area(p1,q1,q2)>0&&area(p2,q2,p1)>0!==area(p2,q2,q1)>0}function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return true;p=p.next}while(p!==a);return false}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function middleInside(a,b){var p=a,inside=false,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do{if(((p.y>py)!==(p.next.y>py))&&p.next.y!==p.y&&(px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x))inside=!inside;p=p.next}while(p!==a);return inside}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;a.next=b;b.prev=a;a2.next=an;an.prev=a2;b2.next=a2;a2.prev=b2;bp.next=b2;b2.prev=bp;return b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);if(!last){p.prev=p;p.next=p}else{p.next=last.next;p.prev=last;last.next.prev=p;last.next=p}return p}function removeNode(p){p.next.prev=p.prev;p.prev.next=p.next;if(p.prevZ)p.prevZ.nextZ=p.nextZ;if(p.nextZ)p.nextZ.prevZ=p.prevZ}function Node(i,x,y){this.i=i;this.x=x;this.y=y;this.prev=null;this.next=null;this.z=null;this.prevZ=null;this.nextZ=null;this.steiner=false}earcut.deviation=function(data,holeIndices,dim,triangles){var hasHoles=holeIndices&&holeIndices.length;var outerLen=hasHoles?holeIndices[0]*dim:data.length;var polygonArea=Math.abs(signedArea(data,0,outerLen,dim));if(hasHoles){for(var i=0,len=holeIndices.length;i<len;i++){var start=holeIndices[i]*dim;var end=i<len-1?holeIndices[i+1]*dim:data.length;polygonArea-=Math.abs(signedArea(data,start,end,dim))}}var trianglesArea=0;for(i=0;i<triangles.length;i+=3){var a=triangles[i]*dim;var b=triangles[i+1]*dim;var c=triangles[i+2]*dim;trianglesArea+=Math.abs((data[a]-data[c])*(data[b+1]-data[a+1])-(data[a]-data[b])*(data[c+1]-data[a+1]))}return polygonArea===0&&trianglesArea===0?0:Math.abs((trianglesArea-polygonArea)/polygonArea)};function signedArea(data,start,end,dim){var sum=0;for(var i=start,j=end-dim;i<end;i+=dim){sum+=(data[j]-data[i])*(data[i+1]+data[j+1]);j=i}return sum}earcut.flatten=function(data){var dim=data[0][0].length,result={vertices:[],holes:[],dimensions:dim},holeIndex=0;for(var i=0;i<data.length;i++){for(var j=0;j<data[i].length;j++){for(var d=0;d<dim;d++)result.vertices.push(data[i][j][d])}if(i>0){holeIndex+=data[i-1].length;result.holes.push(holeIndex)}}return result}}),(function(module,exports){var Clone=function(obj){var clone={};for(var key in obj){if(Array.isArray(obj[key])){clone[key]=obj[key].slice(0)}else{clone[key]=obj[key]}}return clone};module.exports=Clone}),(function(module,exports){var SafeRange=function(array,startIndex,endIndex,throwError){var len=array.length;if(startIndex<0||startIndex>len||startIndex>=endIndex||endIndex>len||startIndex+endIndex>len){if(throwError){throw new Error('Range Error: Values outside acceptable range')}return false}else{return true}};module.exports=SafeRange}),(function(module,exports,__webpack_require__){var EaseMap=__webpack_require__(115);var UppercaseFirst=__webpack_require__(181);var GetEaseFunction=function(ease,easeParams){var easeFunction=EaseMap.Power0;if(typeof ease==='string'){if(EaseMap.hasOwnProperty(ease)){easeFunction=EaseMap[ease]}else{var direction='';if(ease.indexOf('.')){direction=ease.substr(ease.indexOf('.')+1);if(direction.toLowerCase()==='in'){direction='easeIn'}else if(direction.toLowerCase()==='out'){direction='easeOut'}else if(direction.toLowerCase()==='inout'){direction='easeInOut'}}ease=UppercaseFirst(ease.substr(0,ease.indexOf('.')+1)+direction);if(EaseMap.hasOwnProperty(ease)){easeFunction=EaseMap[ease]}}}else if(typeof ease==='function'){easeFunction=ease}else if(Array.isArray(ease)&&ease.length===4){}if(!easeParams){return easeFunction}var cloneParams=easeParams.slice(0);cloneParams.unshift(0);return function(v){cloneParams[0]=v;return easeFunction.apply(this,cloneParams)}};module.exports=GetEaseFunction}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var StrokePathWebGL=function(pipeline,src,alpha,dx,dy){var strokeTint=pipeline.strokeTint;var strokeTintColor=Utils.getTintAppendFloatAlphaAndSwap(src.strokeColor,src.strokeAlpha*alpha);strokeTint.TL=strokeTintColor;strokeTint.TR=strokeTintColor;strokeTint.BL=strokeTintColor;strokeTint.BR=strokeTintColor;var path=src.pathData;var pathLength=path.length-1;var lineWidth=src.lineWidth;var halfLineWidth=lineWidth/2;var px1=path[0]-dx;var py1=path[1]-dy;if(!src.closePath){pathLength-=2}for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx;var py2=path[i+1]-dy;pipeline.setTexture2D();pipeline.batchLine(px1,py1,px2,py2,halfLineWidth,halfLineWidth,lineWidth,i-2,(src.closePath)?(i===pathLength-1):false);px1=px2;py1=py2}};module.exports=StrokePathWebGL}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Contains=__webpack_require__(83);var GetPoint=__webpack_require__(425);var GetPoints=__webpack_require__(426);var GEOM_CONST=__webpack_require__(47);var Line=__webpack_require__(56);var Random=__webpack_require__(158);var Triangle=new Class({initialize:function Triangle(x1,y1,x2,y2,x3,y3){if(x1===undefined){x1=0}if(y1===undefined){y1=0}if(x2===undefined){x2=0}if(y2===undefined){y2=0}if(x3===undefined){x3=0}if(y3===undefined){y3=0}this.type=GEOM_CONST.TRIANGLE;this.x1=x1;this.y1=y1;this.x2=x2;this.y2=y2;this.x3=x3;this.y3=y3},contains:function(x,y){return Contains(this,x,y)},getPoint:function(position,output){return GetPoint(this,position,output)},getPoints:function(quantity,stepRate,output){return GetPoints(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random(this,point)},setTo:function(x1,y1,x2,y2,x3,y3){if(x1===undefined){x1=0}if(y1===undefined){y1=0}if(x2===undefined){x2=0}if(y2===undefined){y2=0}if(x3===undefined){x3=0}if(y3===undefined){y3=0}this.x1=x1;this.y1=y1;this.x2=x2;this.y2=y2;this.x3=x3;this.y3=y3;return this},getLineA:function(line){if(line===undefined){line=new Line()}line.setTo(this.x1,this.y1,this.x2,this.y2);return line},getLineB:function(line){if(line===undefined){line=new Line()}line.setTo(this.x2,this.y2,this.x3,this.y3);return line},getLineC:function(line){if(line===undefined){line=new Line()}line.setTo(this.x3,this.y3,this.x1,this.y1);return line},left:{get:function(){return Math.min(this.x1,this.x2,this.x3)},set:function(value){var diff=0;if(this.x1<=this.x2&&this.x1<=this.x3){diff=this.x1-value}else if(this.x2<=this.x1&&this.x2<=this.x3){diff=this.x2-value}else{diff=this.x3-value}this.x1-=diff;this.x2-=diff;this.x3-=diff}},right:{get:function(){return Math.max(this.x1,this.x2,this.x3)},set:function(value){var diff=0;if(this.x1>=this.x2&&this.x1>=this.x3){diff=this.x1-value}else if(this.x2>=this.x1&&this.x2>=this.x3){diff=this.x2-value}else{diff=this.x3-value}this.x1-=diff;this.x2-=diff;this.x3-=diff}},top:{get:function(){return Math.min(this.y1,this.y2,this.y3)},set:function(value){var diff=0;if(this.y1<=this.y2&&this.y1<=this.y3){diff=this.y1-value}else if(this.y2<=this.y1&&this.y2<=this.y3){diff=this.y2-value}else{diff=this.y3-value}this.y1-=diff;this.y2-=diff;this.y3-=diff}},bottom:{get:function(){return Math.max(this.y1,this.y2,this.y3)},set:function(value){var diff=0;if(this.y1>=this.y2&&this.y1>=this.y3){diff=this.y1-value}else if(this.y2>=this.y1&&this.y2>=this.y3){diff=this.y2-value}else{diff=this.y3-value}this.y1-=diff;this.y2-=diff;this.y3-=diff}}});module.exports=Triangle}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var ImageFile=new Class({Extends:File,initialize:function ImageFile(loader,key,url,xhrSettings,frameConfig){var extension='png';var normalMapURL;if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');normalMapURL=GetFastValue(config,'normalMap');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension);frameConfig=GetFastValue(config,'frameConfig')}if(Array.isArray(url)){normalMapURL=url[1];url=url[0]}var fileConfig={type:'image',cache:loader.textureManager,extension:extension,responseType:'blob',key:key,url:url,xhrSettings:xhrSettings,config:frameConfig};File.call(this,loader,fileConfig);if(normalMapURL){var normalMap=new ImageFile(loader,this.key,normalMapURL,xhrSettings,frameConfig);normalMap.type='normalMap';this.setLink(normalMap);loader.addFile(normalMap)}},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=new Image();this.data.crossOrigin=this.crossOrigin;var _this=this;this.data.onload=function(){File.revokeObjectURL(_this.data);_this.onProcessComplete()};this.data.onerror=function(){File.revokeObjectURL(_this.data);_this.onProcessError()};File.createObjectURL(this.data,this.xhrLoader.response,'image/png')},addToCache:function(){var texture;var linkFile=this.linkFile;if(linkFile&&linkFile.state===CONST.FILE_COMPLETE){if(this.type==='image'){texture=this.cache.addImage(this.key,this.data,linkFile.data)}else{texture=this.cache.addImage(linkFile.key,linkFile.data,this.data)}this.pendingDestroy(texture);linkFile.pendingDestroy(texture)}else if(!linkFile){texture=this.cache.addImage(this.key,this.data);this.pendingDestroy(texture)}}});FileTypesManager.register('image',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new ImageFile(this,key[i]))}}else{this.addFile(new ImageFile(this,key,url,xhrSettings))}return this});module.exports=ImageFile}),(function(module,exports){var SetTileCollision=function(tile,collides){if(collides){tile.setCollision(true,true,true,true,false)}else{tile.resetCollision(false)}};module.exports=SetTileCollision}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var Rectangle=__webpack_require__(444);var Tile=new Class({Mixins:[Components.Alpha,Components.Flip,Components.Visible],initialize:function Tile(layer,index,x,y,width,height,baseWidth,baseHeight){this.layer=layer;this.index=index;this.x=x;this.y=y;this.width=width;this.height=height;this.baseWidth=(baseWidth!==undefined)?baseWidth:width;this.baseHeight=(baseHeight!==undefined)?baseHeight:height;this.pixelX=0;this.pixelY=0;this.updatePixelXY();this.properties={};this.rotation=0;this.collideLeft=false;this.collideRight=false;this.collideUp=false;this.collideDown=false;this.faceLeft=false;this.faceRight=false;this.faceTop=false;this.faceBottom=false;this.collisionCallback=null;this.collisionCallbackContext=this;this.tint=0xffffff;this.physics={}},containsPoint:function(x,y){return!(x<this.pixelX||y<this.pixelY||x>this.right||y>this.bottom)},copy:function(tile){this.index=tile.index;this.alpha=tile.alpha;this.properties=tile.properties;this.visible=tile.visible;this.setFlip(tile.flipX,tile.flipY);this.tint=tile.tint;this.rotation=tile.rotation;this.collideUp=tile.collideUp;this.collideDown=tile.collideDown;this.collideLeft=tile.collideLeft;this.collideRight=tile.collideRight;this.collisionCallback=tile.collisionCallback;this.collisionCallbackContext=tile.collisionCallbackContext;return this},getCollisionGroup:function(){return this.tileset?this.tileset.getTileCollisionGroup(this.index):null},getTileData:function(){return this.tileset?this.tileset.getTileData(this.index):null},getLeft:function(camera){var tilemapLayer=this.tilemapLayer;return(tilemapLayer)?tilemapLayer.tileToWorldX(this.x,camera):this.x*this.baseWidth},getRight:function(camera){var tilemapLayer=this.tilemapLayer;return(tilemapLayer)?this.getLeft(camera)+this.width*tilemapLayer.scaleX:this.getLeft(camera)+this.width},getTop:function(camera){var tilemapLayer=this.tilemapLayer;return tilemapLayer?tilemapLayer.tileToWorldY(this.y,camera)-(this.height-this.baseHeight)*tilemapLayer.scaleY:this.y*this.baseHeight-(this.height-this.baseHeight)},getBottom:function(camera){var tilemapLayer=this.tilemapLayer;return tilemapLayer?this.getTop(camera)+this.height*tilemapLayer.scaleY:this.getTop(camera)+this.height},getBounds:function(camera,output){if(output===undefined){output=new Rectangle()}output.x=this.getLeft();output.y=this.getTop();output.width=this.getRight()-output.x;output.height=this.getBottom()-output.y;return output},getCenterX:function(camera){return(this.getLeft(camera)+this.getRight(camera))/2},getCenterY:function(camera){return(this.getTop(camera)+this.getBottom(camera))/2},destroy:function(){this.collisionCallback=undefined;this.collisionCallbackContext=undefined;this.properties=undefined},intersects:function(x,y,right,bottom){return!(right<=this.pixelX||bottom<=this.pixelY||x>=this.right||y>=this.bottom)},isInteresting:function(collides,faces){if(collides&&faces){return(this.canCollide||this.hasInterestingFace)}else if(collides){return this.collides}else if(faces){return this.hasInterestingFace}return false},resetCollision:function(recalculateFaces){if(recalculateFaces===undefined){recalculateFaces=true}this.collideLeft=false;this.collideRight=false;this.collideUp=false;this.collideDown=false;this.faceTop=false;this.faceBottom=false;this.faceLeft=false;this.faceRight=false;if(recalculateFaces){var tilemapLayer=this.tilemapLayer;if(tilemapLayer){this.tilemapLayer.calculateFacesAt(this.x,this.y)}}return this},resetFaces:function(){this.faceTop=false;this.faceBottom=false;this.faceLeft=false;this.faceRight=false;return this},setCollision:function(left,right,up,down,recalculateFaces){if(right===undefined){right=left}if(up===undefined){up=left}if(down===undefined){down=left}if(recalculateFaces===undefined){recalculateFaces=true}this.collideLeft=left;this.collideRight=right;this.collideUp=up;this.collideDown=down;this.faceLeft=left;this.faceRight=right;this.faceTop=up;this.faceBottom=down;if(recalculateFaces){var tilemapLayer=this.tilemapLayer;if(tilemapLayer){this.tilemapLayer.calculateFacesAt(this.x,this.y)}}return this},setCollisionCallback:function(callback,context){if(callback===null){this.collisionCallback=undefined;this.collisionCallbackContext=undefined}else{this.collisionCallback=callback;this.collisionCallbackContext=context}return this},setSize:function(tileWidth,tileHeight,baseWidth,baseHeight){if(tileWidth!==undefined){this.width=tileWidth}if(tileHeight!==undefined){this.height=tileHeight}if(baseWidth!==undefined){this.baseWidth=baseWidth}if(baseHeight!==undefined){this.baseHeight=baseHeight}this.updatePixelXY();return this},updatePixelXY:function(){this.pixelX=this.x*this.baseWidth;this.pixelY=this.y*this.baseHeight;return this},canCollide:{get:function(){return(this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback)}},collides:{get:function(){return(this.collideLeft||this.collideRight||this.collideUp||this.collideDown)}},hasInterestingFace:{get:function(){return(this.faceTop||this.faceBottom||this.faceLeft||this.faceRight)}},tileset:{get:function(){var tilemapLayer=this.layer.tilemapLayer;if(tilemapLayer){var tileset=tilemapLayer.gidMap[this.index];if(tileset){return tileset}}return null}},tilemapLayer:{get:function(){return this.layer.tilemapLayer}},tilemap:{get:function(){var tilemapLayer=this.tilemapLayer;return tilemapLayer?tilemapLayer.tilemap:null}}});module.exports=Tile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var SpriteRender=__webpack_require__(967);var Sprite=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Size,Components.TextureCrop,Components.Tint,Components.Transform,Components.Visible,SpriteRender],initialize:function Sprite(scene,x,y,texture,frame){GameObject.call(this,scene,'Sprite');this._crop=this.resetCropObject();this.anims=new Components.Animation(this);this.setTexture(texture,frame);this.setPosition(x,y);this.setSizeToFrame();this.setOriginFromFrame();this.initPipeline()},preUpdate:function(time,delta){this.anims.update(time,delta)},play:function(key,ignoreIfPlaying,startFrame){this.anims.play(key,ignoreIfPlaying,startFrame);return this},toJSON:function(){var data=Components.ToJSON(this);return data},preDestroy:function(){this.anims.destroy();this.anims=undefined}});module.exports=Sprite}),(function(module,exports){var GetCenterX=function(gameObject){return gameObject.x-(gameObject.width*gameObject.originX)+(gameObject.width*0.5)};module.exports=GetCenterX}),(function(module,exports){var SetCenterX=function(gameObject,x){var offsetX=gameObject.width*gameObject.originX;gameObject.x=(x+offsetX)-(gameObject.width*0.5);return gameObject};module.exports=SetCenterX}),(function(module,exports){var GetCenterY=function(gameObject){return gameObject.y-(gameObject.height*gameObject.originY)+(gameObject.height*0.5)};module.exports=GetCenterY}),(function(module,exports){var SetCenterY=function(gameObject,y){var offsetY=gameObject.height*gameObject.originY;gameObject.y=(y+offsetY)-(gameObject.height*0.5);return gameObject};module.exports=SetCenterY}),(function(module,exports){var SpliceOne=function(array,index){if(index>=array.length){return}var len=array.length-1;var item=array[index];for(var i=index;i<len;i++){array[i]=array[i+1]}array.length=len;return item};module.exports=SpliceOne}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FromPoints=__webpack_require__(176);var Rectangle=__webpack_require__(11);var Vector2=__webpack_require__(3);var Curve=new Class({initialize:function Curve(type){this.type=type;this.defaultDivisions=5;this.arcLengthDivisions=100;this.cacheArcLengths=[];this.needsUpdate=true;this.active=true;this._tmpVec2A=new Vector2();this._tmpVec2B=new Vector2()},draw:function(graphics,pointsTotal){if(pointsTotal===undefined){pointsTotal=32}return graphics.strokePoints(this.getPoints(pointsTotal))},getBounds:function(out,accuracy){if(!out){out=new Rectangle()}if(accuracy===undefined){accuracy=16}var len=this.getLength();if(accuracy>len){accuracy=len/2}var spaced=Math.max(1,Math.round(len/accuracy));return FromPoints(this.getSpacedPoints(spaced),out)},getDistancePoints:function(distance){var len=this.getLength();var spaced=Math.max(1,len/distance);return this.getSpacedPoints(spaced)},getEndPoint:function(out){if(out===undefined){out=new Vector2()}return this.getPointAt(1,out)},getLength:function(){var lengths=this.getLengths();return lengths[lengths.length-1]},getLengths:function(divisions){if(divisions===undefined){divisions=this.arcLengthDivisions}if((this.cacheArcLengths.length===divisions+1)&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=false;var cache=[];var current;var last=this.getPoint(0,this._tmpVec2A);var sum=0;cache.push(0);for(var p=1;p<=divisions;p++){current=this.getPoint(p/divisions,this._tmpVec2B);sum+=current.distance(last);cache.push(sum);last.copy(current)}this.cacheArcLengths=cache;return cache},getPointAt:function(u,out){var t=this.getUtoTmapping(u);return this.getPoint(t,out)},getPoints:function(divisions,stepRate,out){if(out===undefined){out=[]}if(!divisions){if(!stepRate){divisions=this.defaultDivisions}else{divisions=this.getLength()/stepRate}}for(var d=0;d<=divisions;d++){out.push(this.getPoint(d/divisions))}return out},getRandomPoint:function(out){if(out===undefined){out=new Vector2()}return this.getPoint(Math.random(),out)},getSpacedPoints:function(divisions,stepRate,out){if(out===undefined){out=[]}if(!divisions){if(!stepRate){divisions=this.defaultDivisions}else{divisions=this.getLength()/stepRate}}for(var d=0;d<=divisions;d++){var t=this.getUtoTmapping(d/divisions,null,divisions);out.push(this.getPoint(t))}return out},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return this.getPointAt(0,out)},getTangent:function(t,out){if(out===undefined){out=new Vector2()}var delta=0.0001;var t1=t-delta;var t2=t+delta;if(t1<0){t1=0}if(t2>1){t2=1}this.getPoint(t1,this._tmpVec2A);this.getPoint(t2,out);return out.subtract(this._tmpVec2A).normalize()},getTangentAt:function(u,out){var t=this.getUtoTmapping(u);return this.getTangent(t,out)},getTFromDistance:function(distance,divisions){if(distance<=0){return 0}return this.getUtoTmapping(0,distance,divisions)},getUtoTmapping:function(u,distance,divisions){var arcLengths=this.getLengths(divisions);var i=0;var il=arcLengths.length;var targetArcLength;if(distance){targetArcLength=Math.min(distance,arcLengths[il-1])}else{targetArcLength=u*arcLengths[il-1]}var low=0;var high=il-1;var comparison;while(low<=high){i=Math.floor(low+(high-low)/2); comparison=arcLengths[i]-targetArcLength;if(comparison<0){low=i+1}else if(comparison>0){high=i-1}else{high=i;break}}i=high;if(arcLengths[i]===targetArcLength){return i/(il-1)}var lengthBefore=arcLengths[i];var lengthAfter=arcLengths[i+1];var segmentLength=lengthAfter-lengthBefore;var segmentFraction=(targetArcLength-lengthBefore)/segmentLength;return(i+segmentFraction)/(il-1)},updateArcLengths:function(){this.needsUpdate=true;this.getLengths()}});module.exports=Curve}),(function(module,exports,__webpack_require__){module.exports={ADD:__webpack_require__(870),COMPLETE:__webpack_require__(871),FILE_COMPLETE:__webpack_require__(872),FILE_KEY_COMPLETE:__webpack_require__(873),FILE_LOAD_ERROR:__webpack_require__(874),FILE_LOAD:__webpack_require__(875),FILE_PROGRESS:__webpack_require__(876),POST_PROCESS:__webpack_require__(877),PROGRESS:__webpack_require__(878),START:__webpack_require__(879)}}),(function(module,exports){var Contains=function(triangle,x,y){var v0x=triangle.x3-triangle.x1;var v0y=triangle.y3-triangle.y1;var v1x=triangle.x2-triangle.x1;var v1y=triangle.y2-triangle.y1;var v2x=x-triangle.x1;var v2y=y-triangle.y1;var dot00=(v0x*v0x)+(v0y*v0y);var dot01=(v0x*v1x)+(v0y*v1y);var dot02=(v0x*v2x)+(v0y*v2y);var dot11=(v1x*v1x)+(v1y*v1y);var dot12=(v1x*v2x)+(v1y*v2y);var b=((dot00*dot11)-(dot01*dot01));var inv=(b===0)?0:(1/b);var u=((dot11*dot02)-(dot01*dot12))*inv;var v=((dot00*dot12)-(dot01*dot02))*inv;return(u>=0&&v>=0&&(u+v<1))};module.exports=Contains}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var LineToLine=function(line1,line2,out){if(out===undefined){out=new Point()}var x1=line1.x1;var y1=line1.y1;var x2=line1.x2;var y2=line1.y2;var x3=line2.x1;var y3=line2.y1;var x4=line2.x2;var y4=line2.y2;var numA=(x4-x3)*(y1-y3)-(y4-y3)*(x1-x3);var numB=(x2-x1)*(y1-y3)-(y2-y1)*(x1-x3);var deNom=(y4-y3)*(x2-x1)-(x4-x3)*(y2-y1);if(deNom===0){return false}var uA=numA/deNom;var uB=numB/deNom;if(uA>=0&&uA<=1&&uB>=0&&uB<=1){out.x=x1+(uA*(x2-x1));out.y=y1+(uA*(y2-y1));return true}return false};module.exports=LineToLine}),(function(module,exports){var Angle=function(line){return Math.atan2(line.y2-line.y1,line.x2-line.x1)};module.exports=Angle}),(function(module,exports,__webpack_require__){var Vertices={};module.exports=Vertices;var Vector=__webpack_require__(99);var Common=__webpack_require__(42);(function(){Vertices.create=function(points,body){var vertices=[];for(var i=0;i<points.length;i++){var point=points[i],vertex={x:point.x,y:point.y,index:i,body:body,isInternal:false,contact:null,offset:null};vertex.contact={vertex:vertex,normalImpulse:0,tangentImpulse:0};vertices.push(vertex)}return vertices};Vertices.fromPath=function(path,body){var pathPattern=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,points=[];path.replace(pathPattern,function(match,x,y){points.push({x:parseFloat(x),y:parseFloat(y)})});return Vertices.create(points,body)};Vertices.centre=function(vertices){var area=Vertices.area(vertices,true),centre={x:0,y:0},cross,temp,j;for(var i=0;i<vertices.length;i++){j=(i+1)%vertices.length;cross=Vector.cross(vertices[i],vertices[j]);temp=Vector.mult(Vector.add(vertices[i],vertices[j]),cross);centre=Vector.add(centre,temp)}return Vector.div(centre,6*area)};Vertices.mean=function(vertices){var average={x:0,y:0};for(var i=0;i<vertices.length;i++){average.x+=vertices[i].x;average.y+=vertices[i].y}return Vector.div(average,vertices.length)};Vertices.area=function(vertices,signed){var area=0,j=vertices.length-1;for(var i=0;i<vertices.length;i++){area+=(vertices[j].x-vertices[i].x)*(vertices[j].y+vertices[i].y);j=i}if(signed)return area/2;return Math.abs(area)/2};Vertices.inertia=function(vertices,mass){var numerator=0,denominator=0,v=vertices,cross,j;for(var n=0;n<v.length;n++){j=(n+1)%v.length;cross=Math.abs(Vector.cross(v[j],v[n]));numerator+=cross*(Vector.dot(v[j],v[j])+Vector.dot(v[j],v[n])+Vector.dot(v[n],v[n]));denominator+=cross}return(mass/6)*(numerator/denominator)};Vertices.translate=function(vertices,vector,scalar){var i;if(scalar){for(i=0;i<vertices.length;i++){vertices[i].x+=vector.x*scalar;vertices[i].y+=vector.y*scalar}}else{for(i=0;i<vertices.length;i++){vertices[i].x+=vector.x;vertices[i].y+=vector.y}}return vertices};Vertices.rotate=function(vertices,angle,point){if(angle===0)return;var cos=Math.cos(angle),sin=Math.sin(angle);for(var i=0;i<vertices.length;i++){var vertice=vertices[i],dx=vertice.x-point.x,dy=vertice.y-point.y;vertice.x=point.x+(dx*cos-dy*sin);vertice.y=point.y+(dx*sin+dy*cos)}return vertices};Vertices.contains=function(vertices,point){for(var i=0;i<vertices.length;i++){var vertice=vertices[i],nextVertice=vertices[(i+1)%vertices.length];if((point.x-vertice.x)*(nextVertice.y-vertice.y)+(point.y-vertice.y)*(vertice.x-nextVertice.x)>0){return false}}return true};Vertices.scale=function(vertices,scaleX,scaleY,point){if(scaleX===1&&scaleY===1)return vertices;point=point||Vertices.centre(vertices);var vertex,delta;for(var i=0;i<vertices.length;i++){vertex=vertices[i];delta=Vector.sub(vertex,point);vertices[i].x=point.x+delta.x*scaleX;vertices[i].y=point.y+delta.y*scaleY}return vertices};Vertices.chamfer=function(vertices,radius,quality,qualityMin,qualityMax){if(typeof radius==='number'){radius=[radius]}else{radius=radius||[8]}quality=(typeof quality!=='undefined')?quality:-1;qualityMin=qualityMin||2;qualityMax=qualityMax||14;var newVertices=[];for(var i=0;i<vertices.length;i++){var prevVertex=vertices[i-1>=0?i-1:vertices.length-1],vertex=vertices[i],nextVertex=vertices[(i+1)%vertices.length],currentRadius=radius[i<radius.length?i:radius.length-1];if(currentRadius===0){newVertices.push(vertex);continue}var prevNormal=Vector.normalise({x:vertex.y-prevVertex.y,y:prevVertex.x-vertex.x});var nextNormal=Vector.normalise({x:nextVertex.y-vertex.y,y:vertex.x-nextVertex.x});var diagonalRadius=Math.sqrt(2*Math.pow(currentRadius,2)),radiusVector=Vector.mult(Common.clone(prevNormal),currentRadius),midNormal=Vector.normalise(Vector.mult(Vector.add(prevNormal,nextNormal),0.5)),scaledVertex=Vector.sub(vertex,Vector.mult(midNormal,diagonalRadius));var precision=quality;if(quality===-1){precision=Math.pow(currentRadius,0.32)*1.75}precision=Common.clamp(precision,qualityMin,qualityMax);if(precision%2===1)precision+=1;var alpha=Math.acos(Vector.dot(prevNormal,nextNormal)),theta=alpha/precision;for(var j=0;j<precision;j++){newVertices.push(Vector.add(Vector.rotate(radiusVector,theta*j),scaledVertex))}}return newVertices};Vertices.clockwiseSort=function(vertices){var centre=Vertices.mean(vertices);vertices.sort(function(vertexA,vertexB){return Vector.angle(centre,vertexA)-Vector.angle(centre,vertexB)});return vertices};Vertices.isConvex=function(vertices){var flag=0,n=vertices.length,i,j,k,z;if(n<3)return null;for(i=0;i<n;i++){j=(i+1)%n;k=(i+2)%n;z=(vertices[j].x-vertices[i].x)*(vertices[k].y-vertices[j].y);z-=(vertices[j].y-vertices[i].y)*(vertices[k].x-vertices[j].x);if(z<0){flag|=1}else if(z>0){flag|=2}if(flag===3){return false}}if(flag!==0){return true}else{return null}};Vertices.hull=function(vertices){var upper=[],lower=[],vertex,i;vertices=vertices.slice(0);vertices.sort(function(vertexA,vertexB){var dx=vertexA.x-vertexB.x;return dx!==0?dx:vertexA.y-vertexB.y});for(i=0;i<vertices.length;i+=1){vertex=vertices[i];while(lower.length>=2&&Vector.cross3(lower[lower.length-2],lower[lower.length-1],vertex)<=0){lower.pop()}lower.push(vertex)}for(i=vertices.length-1;i>=0;i-=1){vertex=vertices[i];while(upper.length>=2&&Vector.cross3(upper[upper.length-2],upper[upper.length-1],vertex)<=0){upper.pop()}upper.push(vertex)}upper.pop();lower.pop();return upper.concat(lower)}})()}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var FromPercent=function(percent,min,max){percent=Clamp(percent,0,1);return(max-min)*percent};module.exports=FromPercent}),(function(module,exports){var GetBoolean=function(source,key,defaultValue){if(!source){return defaultValue}else if(source.hasOwnProperty(key)){return source[key]}else{return defaultValue}};module.exports=GetBoolean}),(function(module,exports){var TWEEN_CONST={CREATED:0,INIT:1,DELAY:2,OFFSET_DELAY:3,PENDING_RENDER:4,PLAYING_FORWARD:5,PLAYING_BACKWARD:6,HOLD_DELAY:7,REPEAT_DELAY:8,COMPLETE:9,PENDING_ADD:20,PAUSED:21,LOOP_DELAY:22,ACTIVE:23,COMPLETE_DELAY:24,PENDING_REMOVE:25,REMOVED:26};module.exports=TWEEN_CONST}),(function(module,exports,__webpack_require__){module.exports={DESTROY:__webpack_require__(582),VIDEO_COMPLETE:__webpack_require__(583),VIDEO_CREATED:__webpack_require__(584),VIDEO_ERROR:__webpack_require__(585),VIDEO_LOOP:__webpack_require__(586),VIDEO_PLAY:__webpack_require__(587),VIDEO_SEEKED:__webpack_require__(588),VIDEO_SEEKING:__webpack_require__(589),VIDEO_STOP:__webpack_require__(590),VIDEO_TIMEOUT:__webpack_require__(591),VIDEO_UNLOCKED:__webpack_require__(592)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var DegToRad=__webpack_require__(39);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(40);var Rectangle=__webpack_require__(11);var TransformMatrix=__webpack_require__(29);var ValueToColor=__webpack_require__(164);var Vector2=__webpack_require__(3);var BaseCamera=new Class({Extends:EventEmitter,Mixins:[Components.Alpha,Components.Visible],initialize:function BaseCamera(x,y,width,height){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=0}if(height===undefined){height=0}EventEmitter.call(this);this.scene;this.sceneManager;this.scaleManager;this.cameraManager;this.id=0;this.name='';this.resolution=1;this.roundPixels=false;this.useBounds=false;this.worldView=new Rectangle();this.dirty=true;this._x=x;this._y=y;this._cx=0;this._cy=0;this._cw=0;this._ch=0;this._width=width;this._height=height;this._bounds=new Rectangle();this._scrollX=0;this._scrollY=0;this._zoom=1;this._rotation=0;this.matrix=new TransformMatrix();this.transparent=true;this.backgroundColor=ValueToColor('rgba(0,0,0,0)');this.disableCull=false;this.culledObjects=[];this.midPoint=new Vector2(width/2,height/2);this.originX=0.5;this.originY=0.5;this._customViewport=false;this.mask=null;this._maskCamera=null},setOrigin:function(x,y){if(x===undefined){x=0.5}if(y===undefined){y=x}this.originX=x;this.originY=y;return this},getScroll:function(x,y,out){if(out===undefined){out=new Vector2()}var originX=this.width*0.5;var originY=this.height*0.5;out.x=x-originX;out.y=y-originY;if(this.useBounds){out.x=this.clampX(out.x);out.y=this.clampY(out.y)}return out},centerOnX:function(x){var originX=this.width*0.5;this.midPoint.x=x;this.scrollX=x-originX;if(this.useBounds){this.scrollX=this.clampX(this.scrollX)}return this},centerOnY:function(y){var originY=this.height*0.5;this.midPoint.y=y;this.scrollY=y-originY;if(this.useBounds){this.scrollY=this.clampY(this.scrollY)}return this},centerOn:function(x,y){this.centerOnX(x);this.centerOnY(y);return this},centerToBounds:function(){if(this.useBounds){var bounds=this._bounds;var originX=this.width*0.5;var originY=this.height*0.5;this.midPoint.set(bounds.centerX,bounds.centerY);this.scrollX=bounds.centerX-originX;this.scrollY=bounds.centerY-originY}return this},centerToSize:function(){this.scrollX=this.width*0.5;this.scrollY=this.height*0.5;return this},cull:function(renderableObjects){if(this.disableCull){return renderableObjects}var cameraMatrix=this.matrix.matrix;var mva=cameraMatrix[0];var mvb=cameraMatrix[1];var mvc=cameraMatrix[2];var mvd=cameraMatrix[3];var determinant=(mva*mvd)-(mvb*mvc);if(!determinant){return renderableObjects}var mve=cameraMatrix[4];var mvf=cameraMatrix[5];var scrollX=this.scrollX;var scrollY=this.scrollY;var cameraW=this.width;var cameraH=this.height;var cullTop=this.y;var cullBottom=cullTop+cameraH;var cullLeft=this.x;var cullRight=cullLeft+cameraW;var culledObjects=this.culledObjects;var length=renderableObjects.length;determinant=1/determinant;culledObjects.length=0;for(var index=0;index<length;++index){var object=renderableObjects[index];if(!object.hasOwnProperty('width')||object.parentContainer){culledObjects.push(object);continue}var objectW=object.width;var objectH=object.height;var objectX=(object.x-(scrollX*object.scrollFactorX))-(objectW*object.originX);var objectY=(object.y-(scrollY*object.scrollFactorY))-(objectH*object.originY);var tx=(objectX*mva+objectY*mvc+mve);var ty=(objectX*mvb+objectY*mvd+mvf);var tw=((objectX+objectW)*mva+(objectY+objectH)*mvc+mve);var th=((objectX+objectW)*mvb+(objectY+objectH)*mvd+mvf);if((tw>cullLeft&&tx<cullRight)&&(th>cullTop&&ty<cullBottom)){culledObjects.push(object)}}return culledObjects},getWorldPoint:function(x,y,output){if(output===undefined){output=new Vector2()}var cameraMatrix=this.matrix.matrix;var mva=cameraMatrix[0];var mvb=cameraMatrix[1];var mvc=cameraMatrix[2];var mvd=cameraMatrix[3];var mve=cameraMatrix[4];var mvf=cameraMatrix[5];var determinant=(mva*mvd)-(mvb*mvc);if(!determinant){output.x=x;output.y=y;return output}determinant=1/determinant;var ima=mvd*determinant;var imb=-mvb*determinant;var imc=-mvc*determinant;var imd=mva*determinant;var ime=(mvc*mvf-mvd*mve)*determinant;var imf=(mvb*mve-mva*mvf)*determinant;var c=Math.cos(this.rotation);var s=Math.sin(this.rotation);var zoom=this.zoom;var res=this.resolution;var scrollX=this.scrollX;var scrollY=this.scrollY;var sx=x+((scrollX*c-scrollY*s)*zoom);var sy=y+((scrollX*s+scrollY*c)*zoom);output.x=(sx*ima+sy*imc)*res+ime;output.y=(sx*imb+sy*imd)*res+imf;return output},ignore:function(entries){var id=this.id;if(!Array.isArray(entries)){entries=[entries]}for(var i=0;i<entries.length;i++){var entry=entries[i];if(Array.isArray(entry)){this.ignore(entry)}else if(entry.isParent){this.ignore(entry.getChildren())}else{entry.cameraFilter|=id}}return this},preRender:function(resolution){var width=this.width;var height=this.height;var halfWidth=width*0.5;var halfHeight=height*0.5;var zoom=this.zoom*resolution;var matrix=this.matrix;var originX=width*this.originX;var originY=height*this.originY;var sx=this.scrollX;var sy=this.scrollY;if(this.useBounds){sx=this.clampX(sx);sy=this.clampY(sy)}if(this.roundPixels){originX=Math.round(originX);originY=Math.round(originY)}this.scrollX=sx;this.scrollY=sy;var midX=sx+halfWidth;var midY=sy+halfHeight;this.midPoint.set(midX,midY);var displayWidth=width/zoom;var displayHeight=height/zoom;this.worldView.setTo(midX-(displayWidth/2),midY-(displayHeight/2),displayWidth,displayHeight);matrix.applyITRS(this.x+originX,this.y+originY,this.rotation,zoom,zoom);matrix.translate(-originX,-originY)},clampX:function(x){var bounds=this._bounds;var dw=this.displayWidth;var bx=bounds.x+((dw-this.width)/2);var bw=Math.max(bx,bx+bounds.width-dw);if(x<bx){x=bx}else if(x>bw){x=bw}return x},clampY:function(y){var bounds=this._bounds;var dh=this.displayHeight;var by=bounds.y+((dh-this.height)/2);var bh=Math.max(by,by+bounds.height-dh);if(y<by){y=by}else if(y>bh){y=bh}return y},removeBounds:function(){this.useBounds=false;this.dirty=true;this._bounds.setEmpty();return this},setAngle:function(value){if(value===undefined){value=0}this.rotation=DegToRad(value);return this},setBackgroundColor:function(color){if(color===undefined){color='rgba(0,0,0,0)'}this.backgroundColor=ValueToColor(color);this.transparent=(this.backgroundColor.alpha===0);return this},setBounds:function(x,y,width,height,centerOn){if(centerOn===undefined){centerOn=false}this._bounds.setTo(x,y,width,height);this.dirty=true;this.useBounds=true;if(centerOn){this.centerToBounds()}else{this.scrollX=this.clampX(this.scrollX);this.scrollY=this.clampY(this.scrollY)}return this},getBounds:function(out){if(out===undefined){out=new Rectangle()}var source=this._bounds;out.setTo(source.x,source.y,source.width,source.height);return out},setName:function(value){if(value===undefined){value=''}this.name=value;return this},setPosition:function(x,y){if(y===undefined){y=x}this.x=x;this.y=y;return this},setRotation:function(value){if(value===undefined){value=0}this.rotation=value;return this},setRoundPixels:function(value){this.roundPixels=value;return this},setScene:function(scene){if(this.scene&&this._customViewport){this.sceneManager.customViewports--}this.scene=scene;var sys=scene.sys;this.sceneManager=sys.game.scene;this.scaleManager=sys.scale;this.cameraManager=sys.cameras;var res=this.scaleManager.resolution;this.resolution=res;this._cx=this._x*res;this._cy=this._y*res;this._cw=this._width*res;this._ch=this._height*res;this.updateSystem();return this},setScroll:function(x,y){if(y===undefined){y=x}this.scrollX=x;this.scrollY=y;return this},setSize:function(width,height){if(height===undefined){height=width}this.width=width;this.height=height;return this},setViewport:function(x,y,width,height){this.x=x;this.y=y;this.width=width;this.height=height;return this},setZoom:function(value){if(value===undefined){value=1}if(value===0){value=0.001}this.zoom=value;return this},setMask:function(mask,fixedPosition){if(fixedPosition===undefined){fixedPosition=true}this.mask=mask;this._maskCamera=(fixedPosition)?this.cameraManager.default:this;return this},clearMask:function(destroyMask){if(destroyMask===undefined){destroyMask=false}if(destroyMask&&this.mask){this.mask.destroy()}this.mask=null;return this},toJSON:function(){var output={name:this.name,x:this.x,y:this.y,width:this.width,height:this.height,zoom:this.zoom,rotation:this.rotation,roundPixels:this.roundPixels,scrollX:this.scrollX,scrollY:this.scrollY,backgroundColor:this.backgroundColor.rgba};if(this.useBounds){output['bounds']={x:this._bounds.x,y:this._bounds.y,width:this._bounds.width,height:this._bounds.height}}return output},update:function(){},updateSystem:function(){if(!this.scaleManager){return}var custom=(this._x!==0||this._y!==0||this.scaleManager.width!==this._width||this.scaleManager.height!==this._height);var sceneManager=this.sceneManager;if(custom&&!this._customViewport){sceneManager.customViewports++}else if(!custom&&this._customViewport){sceneManager.customViewports--}this.dirty=true;this._customViewport=custom},destroy:function(){this.emit(Events.DESTROY,this);this.removeAllListeners();this.matrix.destroy();this.culledObjects=[];if(this._customViewport){this.sceneManager.customViewports--}this._bounds=null;this.scene=null;this.scaleManager=null;this.sceneManager=null;this.cameraManager=null},x:{get:function(){return this._x},set:function(value){this._x=value;this._cx=value*this.resolution;this.updateSystem()}},y:{get:function(){return this._y},set:function(value){this._y=value;this._cy=value*this.resolution;this.updateSystem()}},width:{get:function(){return this._width},set:function(value){this._width=value;this._cw=value*this.resolution;this.updateSystem()}},height:{get:function(){return this._height},set:function(value){this._height=value;this._ch=value*this.resolution;this.updateSystem()}},scrollX:{get:function(){return this._scrollX},set:function(value){this._scrollX=value;this.dirty=true}},scrollY:{get:function(){return this._scrollY},set:function(value){this._scrollY=value;this.dirty=true}},zoom:{get:function(){return this._zoom},set:function(value){this._zoom=value;this.dirty=true}},rotation:{get:function(){return this._rotation},set:function(value){this._rotation=value;this.dirty=true}},centerX:{get:function(){return this.x+(0.5*this.width)}},centerY:{get:function(){return this.y+(0.5*this.height)}},displayWidth:{get:function(){return this.width/this.zoom}},displayHeight:{get:function(){return this.height/this.zoom}}});module.exports=BaseCamera}),(function(module,exports,__webpack_require__){module.exports={ENTER_FULLSCREEN:__webpack_require__(703),FULLSCREEN_FAILED:__webpack_require__(704),FULLSCREEN_UNSUPPORTED:__webpack_require__(705),LEAVE_FULLSCREEN:__webpack_require__(706),ORIENTATION_CHANGE:__webpack_require__(707),RESIZE:__webpack_require__(708)}}),(function(module,exports){var SnapFloor=function(value,gap,start,divide){if(start===undefined){start=0}if(gap===0){return value}value-=start;value=gap*Math.floor(value/gap);return(divide)?(start+value)/gap:start+value};module.exports=SnapFloor}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Clamp=__webpack_require__(19);var Extend=__webpack_require__(18);var Frame=new Class({initialize:function Frame(texture,name,sourceIndex,x,y,width,height){this.texture=texture;this.name=name;this.source=texture.source[sourceIndex];this.sourceIndex=sourceIndex;this.glTexture=this.source.glTexture;this.cutX;this.cutY;this.cutWidth;this.cutHeight;this.x=0;this.y=0;this.width;this.height;this.halfWidth;this.halfHeight;this.centerX;this.centerY;this.pivotX=0;this.pivotY=0;this.customPivot=false;this.rotated=false;this.autoRound=-1;this.customData={};this.u0=0;this.v0=0;this.u1=0;this.v1=0;this.data={cut:{x:0,y:0,w:0,h:0,r:0,b:0},trim:false,sourceSize:{w:0,h:0},spriteSourceSize:{x:0,y:0,w:0,h:0,r:0,b:0},radius:0,drawImage:{x:0,y:0,width:0,height:0}};this.setSize(width,height,x,y)},setSize:function(width,height,x,y){if(x===undefined){x=0}if(y===undefined){y=0}this.cutX=x;this.cutY=y;this.cutWidth=width;this.cutHeight=height;this.width=width;this.height=height;this.halfWidth=Math.floor(width*0.5);this.halfHeight=Math.floor(height*0.5);this.centerX=Math.floor(width/2);this.centerY=Math.floor(height/2);var data=this.data;var cut=data.cut;cut.x=x;cut.y=y;cut.w=width;cut.h=height;cut.r=x+width;cut.b=y+height;data.sourceSize.w=width;data.sourceSize.h=height;data.spriteSourceSize.w=width;data.spriteSourceSize.h=height;data.radius=0.5*Math.sqrt(width*width+height*height);var drawImage=data.drawImage;drawImage.x=x;drawImage.y=y;drawImage.width=width;drawImage.height=height;return this.updateUVs()},setTrim:function(actualWidth,actualHeight,destX,destY,destWidth,destHeight){var data=this.data;var ss=data.spriteSourceSize;data.trim=true;data.sourceSize.w=actualWidth;data.sourceSize.h=actualHeight;ss.x=destX;ss.y=destY;ss.w=destWidth;ss.h=destHeight;ss.r=destX+destWidth;ss.b=destY+destHeight;this.x=destX;this.y=destY;this.width=destWidth;this.height=destHeight;this.halfWidth=destWidth*0.5;this.halfHeight=destHeight*0.5;this.centerX=Math.floor(destWidth/2);this.centerY=Math.floor(destHeight/2);return this.updateUVs()},setCropUVs:function(crop,x,y,width,height,flipX,flipY){var cx=this.cutX;var cy=this.cutY;var cw=this.cutWidth;var ch=this.cutHeight;var rw=this.realWidth;var rh=this.realHeight;x=Clamp(x,0,rw);y=Clamp(y,0,rh);width=Clamp(width,0,rw-x);height=Clamp(height,0,rh-y);var ox=cx+x;var oy=cy+y;var ow=width;var oh=height;var data=this.data;if(data.trim){var ss=data.spriteSourceSize;width=Clamp(width,0,cw-x);height=Clamp(height,0,ch-y);var cropRight=x+width;var cropBottom=y+height;var intersects=!(ss.r<x||ss.b<y||ss.x>cropRight||ss.y>cropBottom);if(intersects){var ix=Math.max(ss.x,x);var iy=Math.max(ss.y,y);var iw=Math.min(ss.r,cropRight)-ix;var ih=Math.min(ss.b,cropBottom)-iy;ow=iw;oh=ih;if(flipX){ox=cx+(cw-(ix-ss.x)-iw)}else{ox=cx+(ix-ss.x)}if(flipY){oy=cy+(ch-(iy-ss.y)-ih)}else{oy=cy+(iy-ss.y)}x=ix;y=iy;width=iw;height=ih}else{ox=0;oy=0;ow=0;oh=0}}else{if(flipX){ox=cx+(cw-x-width)}if(flipY){oy=cy+(ch-y-height)}}var tw=this.source.width;var th=this.source.height;crop.u0=Math.max(0,ox/tw);crop.v0=Math.max(0,oy/th);crop.u1=Math.min(1,(ox+ow)/tw);crop.v1=Math.min(1,(oy+oh)/th);crop.x=x;crop.y=y;crop.cx=ox;crop.cy=oy;crop.cw=ow;crop.ch=oh;crop.width=width;crop.height=height;crop.flipX=flipX;crop.flipY=flipY;return crop},updateCropUVs:function(crop,flipX,flipY){return this.setCropUVs(crop,crop.x,crop.y,crop.width,crop.height,flipX,flipY)},updateUVs:function(){var cx=this.cutX;var cy=this.cutY;var cw=this.cutWidth;var ch=this.cutHeight;var cd=this.data.drawImage;cd.width=cw;cd.height=ch;var tw=this.source.width;var th=this.source.height;this.u0=cx/tw;this.v0=cy/th;this.u1=(cx+cw)/tw;this.v1=(cy+ch)/th;return this},updateUVsInverted:function(){var tw=this.source.width;var th=this.source.height;this.u0=(this.cutX+this.cutHeight)/tw;this.v0=this.cutY/th;this.u1=this.cutX/tw;this.v1=(this.cutY+this.cutWidth)/th;return this},clone:function(){var clone=new Frame(this.texture,this.name,this.sourceIndex);clone.cutX=this.cutX;clone.cutY=this.cutY;clone.cutWidth=this.cutWidth;clone.cutHeight=this.cutHeight;clone.x=this.x;clone.y=this.y;clone.width=this.width;clone.height=this.height;clone.halfWidth=this.halfWidth;clone.halfHeight=this.halfHeight;clone.centerX=this.centerX;clone.centerY=this.centerY;clone.rotated=this.rotated;clone.data=Extend(true,clone.data,this.data);clone.updateUVs();return clone},destroy:function(){this.source=null;this.texture=null;this.glTexture=null;this.customData=null;this.data=null},realWidth:{get:function(){return this.data.sourceSize.w}},realHeight:{get:function(){return this.data.sourceSize.h}},radius:{get:function(){return this.data.radius}},trimmed:{get:function(){return this.data.trim}},canvasData:{get:function(){return this.data.drawImage}}});module.exports=Frame}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Contains=__webpack_require__(96);var GetPoint=__webpack_require__(398);var GetPoints=__webpack_require__(399);var GEOM_CONST=__webpack_require__(47);var Random=__webpack_require__(157);var Ellipse=new Class({initialize:function Ellipse(x,y,width,height){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=0}if(height===undefined){height=0}this.type=GEOM_CONST.ELLIPSE;this.x=x;this.y=y;this.width=width;this.height=height},contains:function(x,y){return Contains(this,x,y)},getPoint:function(position,point){return GetPoint(this,position,point)},getPoints:function(quantity,stepRate,output){return GetPoints(this,quantity,stepRate,output)},getRandomPoint:function(point){return Random(this,point)},setTo:function(x,y,width,height){this.x=x;this.y=y;this.width=width;this.height=height;return this},setEmpty:function(){this.width=0;this.height=0;return this},setPosition:function(x,y){if(y===undefined){y=x}this.x=x;this.y=y;return this},setSize:function(width,height){if(height===undefined){height=width}this.width=width;this.height=height;return this},isEmpty:function(){return(this.width<=0||this.height<=0)},getMinorRadius:function(){return Math.min(this.width,this.height)/2},getMajorRadius:function(){return Math.max(this.width,this.height)/2},left:{get:function(){return this.x-(this.width/2)},set:function(value){this.x=value+(this.width/2)}},right:{get:function(){return this.x+(this.width/2)},set:function(value){this.x=value-(this.width/2)}},top:{get:function(){return this.y-(this.height/2)},set:function(value){this.y=value+(this.height/2)}},bottom:{get:function(){return this.y+(this.height/2)},set:function(value){this.y=value-(this.height/2)}}});module.exports=Ellipse}),(function(module,exports){var Contains=function(ellipse,x,y){if(ellipse.width<=0||ellipse.height<=0){return false}var normx=((x-ellipse.x)/ellipse.width);var normy=((y-ellipse.y)/ellipse.height);normx*=normx;normy*=normy;return(normx+normy<0.25)};module.exports=Contains}),(function(module,exports,__webpack_require__){var Actions=__webpack_require__(241);var Class=__webpack_require__(0);var Events=__webpack_require__(90);var GetFastValue=__webpack_require__(2);var GetValue=__webpack_require__(6);var IsPlainObject=__webpack_require__(7);var Range=__webpack_require__(392);var Set=__webpack_require__(133);var Sprite=__webpack_require__(75);var Group=new Class({initialize:function Group(scene,children,config){if(config){if(children&&!Array.isArray(children)){children=[children]}}else if(Array.isArray(children)){if(IsPlainObject(children[0])){config=children;children=null}}else if(IsPlainObject(children)){config=children;children=null}this.scene=scene;this.children=new Set();this.isParent=true;this.type='Group';this.classType=GetFastValue(config,'classType',Sprite);this.name=GetFastValue(config,'name','');this.active=GetFastValue(config,'active',true);this.maxSize=GetFastValue(config,'maxSize',-1);this.defaultKey=GetFastValue(config,'defaultKey',null);this.defaultFrame=GetFastValue(config,'defaultFrame',null);this.runChildUpdate=GetFastValue(config,'runChildUpdate',false);this.createCallback=GetFastValue(config,'createCallback',null);this.removeCallback=GetFastValue(config,'removeCallback',null);this.createMultipleCallback=GetFastValue(config,'createMultipleCallback',null);this.internalCreateCallback=GetFastValue(config,'internalCreateCallback',null);this.internalRemoveCallback=GetFastValue(config,'internalRemoveCallback',null);if(children){this.addMultiple(children)}if(config){this.createMultiple(config)}},create:function(x,y,key,frame,visible,active){if(x===undefined){x=0}if(y===undefined){y=0}if(key===undefined){key=this.defaultKey}if(frame===undefined){frame=this.defaultFrame}if(visible===undefined){visible=true}if(active===undefined){active=true}if(this.isFull()){return null}var child=new this.classType(this.scene,x,y,key,frame);this.scene.sys.displayList.add(child);if(child.preUpdate){this.scene.sys.updateList.add(child)}child.visible=visible;child.setActive(active);this.add(child);return child},createMultiple:function(config){if(this.isFull()){return[]}if(!Array.isArray(config)){config=[config]}var output=[];if(config[0].key){for(var i=0;i<config.length;i++){var entries=this.createFromConfig(config[i]);output=output.concat(entries)}}return output},createFromConfig:function(options){if(this.isFull()){return[]}this.classType=GetFastValue(options,'classType',this.classType);var key=GetFastValue(options,'key',undefined);var frame=GetFastValue(options,'frame',null);var visible=GetFastValue(options,'visible',true);var active=GetFastValue(options,'active',true);var entries=[];if(key===undefined){return entries}else{if(!Array.isArray(key)){key=[key]}if(!Array.isArray(frame)){frame=[frame]}}var repeat=GetFastValue(options,'repeat',0);var randomKey=GetFastValue(options,'randomKey',false);var randomFrame=GetFastValue(options,'randomFrame',false);var yoyo=GetFastValue(options,'yoyo',false);var quantity=GetFastValue(options,'quantity',false);var frameQuantity=GetFastValue(options,'frameQuantity',1);var max=GetFastValue(options,'max',0);var range=Range(key,frame,{max:max,qty:(quantity)?quantity:frameQuantity,random:randomKey,randomB:randomFrame,repeat:repeat,yoyo:yoyo});if(options.createCallback){this.createCallback=options.createCallback}if(options.removeCallback){this.removeCallback=options.removeCallback}for(var c=0;c<range.length;c++){var created=this.create(0,0,range[c].a,range[c].b,visible,active);if(!created){break}entries.push(created)}var x=GetValue(options,'setXY.x',0);var y=GetValue(options,'setXY.y',0);var stepX=GetValue(options,'setXY.stepX',0);var stepY=GetValue(options,'setXY.stepY',0);Actions.SetXY(entries,x,y,stepX,stepY);var rotation=GetValue(options,'setRotation.value',0);var stepRotation=GetValue(options,'setRotation.step',0);Actions.SetRotation(entries,rotation,stepRotation);var scaleX=GetValue(options,'setScale.x',1);var scaleY=GetValue(options,'setScale.y',scaleX);var stepScaleX=GetValue(options,'setScale.stepX',0);var stepScaleY=GetValue(options,'setScale.stepY',0);Actions.SetScale(entries,scaleX,scaleY,stepScaleX,stepScaleY);var alpha=GetValue(options,'setAlpha.value',1);var stepAlpha=GetValue(options,'setAlpha.step',0);Actions.SetAlpha(entries,alpha,stepAlpha);var depth=GetValue(options,'setDepth.value',0);var stepDepth=GetValue(options,'setDepth.step',0);Actions.SetDepth(entries,depth,stepDepth);var scrollFactorX=GetValue(options,'setScrollFactor.x',1);var scrollFactorY=GetValue(options,'setScrollFactor.y',scrollFactorX);var stepScrollFactorX=GetValue(options,'setScrollFactor.stepX',0);var stepScrollFactorY=GetValue(options,'setScrollFactor.stepY',0);Actions.SetScrollFactor(entries,scrollFactorX,scrollFactorY,stepScrollFactorX,stepScrollFactorY);var hitArea=GetFastValue(options,'hitArea',null);var hitAreaCallback=GetFastValue(options,'hitAreaCallback',null);if(hitArea){Actions.SetHitArea(entries,hitArea,hitAreaCallback)}var grid=GetFastValue(options,'gridAlign',false);if(grid){Actions.GridAlign(entries,grid)}if(this.createMultipleCallback){this.createMultipleCallback.call(this,entries)}return entries},preUpdate:function(time,delta){if(!this.runChildUpdate||this.children.size===0){return}var temp=this.children.entries.slice();for(var i=0;i<temp.length;i++){var item=temp[i];if(item.active){item.update(time,delta)}}},add:function(child,addToScene){if(addToScene===undefined){addToScene=false}if(this.isFull()){return this}this.children.set(child);if(this.internalCreateCallback){this.internalCreateCallback.call(this,child)}if(this.createCallback){this.createCallback.call(this,child)}if(addToScene){this.scene.sys.displayList.add(child);if(child.preUpdate){this.scene.sys.updateList.add(child)}}child.on(Events.DESTROY,this.remove,this);return this},addMultiple:function(children,addToScene){if(addToScene===undefined){addToScene=false}if(Array.isArray(children)){for(var i=0;i<children.length;i++){this.add(children[i],addToScene)}}return this},remove:function(child,removeFromScene,destroyChild){if(removeFromScene===undefined){removeFromScene=false}if(destroyChild===undefined){destroyChild=false}if(!this.children.contains(child)){return this}this.children.delete(child);if(this.internalRemoveCallback){this.internalRemoveCallback.call(this,child)}if(this.removeCallback){this.removeCallback.call(this,child)}child.off(Events.DESTROY,this.remove,this);if(destroyChild){child.destroy()}else if(removeFromScene){child.scene.sys.displayList.remove(child);if(child.preUpdate){child.scene.sys.updateList.remove(child)}}return this},clear:function(removeFromScene,destroyChild){if(removeFromScene===undefined){removeFromScene=false}if(destroyChild===undefined){destroyChild=false}var children=this.children;for(var i=0;i<children.size;i++){var gameObject=children.entries[i];gameObject.off(Events.DESTROY,this.remove,this);if(destroyChild){gameObject.destroy()}else if(removeFromScene){gameObject.scene.sys.displayList.remove(gameObject);if(gameObject.preUpdate){gameObject.scene.sys.updateList.remove(gameObject)}}}this.children.clear();return this},contains:function(child){return this.children.contains(child)},getChildren:function(){return this.children.entries},getLength:function(){return this.children.size},getFirst:function(state,createIfNull,x,y,key,frame,visible){return this.getHandler(true,1,state,createIfNull,x,y,key,frame,visible)},getFirstNth:function(nth,state,createIfNull,x,y,key,frame,visible){return this.getHandler(true,nth,state,createIfNull,x,y,key,frame,visible)},getLast:function(state,createIfNull,x,y,key,frame,visible){return this.getHandler(false,1,state,createIfNull,x,y,key,frame,visible)},getLastNth:function(nth,state,createIfNull,x,y,key,frame,visible){return this.getHandler(false,nth,state,createIfNull,x,y,key,frame,visible)},getHandler:function(forwards,nth,state,createIfNull,x,y,key,frame,visible){if(state===undefined){state=false}if(createIfNull===undefined){createIfNull=false}var gameObject;var i;var total=0;var children=this.children.entries;if(forwards){for(i=0;i<children.length;i++){gameObject=children[i];if(gameObject.active===state){total++;if(total===nth){break}}else{gameObject=null}}}else{for(i=children.length-1;i>=0;i--){gameObject=children[i];if(gameObject.active===state){total++;if(total===nth){break}}else{gameObject=null}}}if(gameObject){if(typeof(x)==='number'){gameObject.x=x}if(typeof(y)==='number'){gameObject.y=y}return gameObject}if(createIfNull){return this.create(x,y,key,frame,visible)}else{return null}},get:function(x,y,key,frame,visible){return this.getFirst(false,true,x,y,key,frame,visible)},getFirstAlive:function(createIfNull,x,y,key,frame,visible){return this.getFirst(true,createIfNull,x,y,key,frame,visible)},getFirstDead:function(createIfNull,x,y,key,frame,visible){return this.getFirst(false,createIfNull,x,y,key,frame,visible)},playAnimation:function(key,startFrame){Actions.PlayAnimation(this.children.entries,key,startFrame);return this},isFull:function(){if(this.maxSize===-1){return false}else{return(this.children.size>=this.maxSize)}},countActive:function(value){if(value===undefined){value=true}var total=0;for(var i=0;i<this.children.size;i++){if(this.children.entries[i].active===value){total++}}return total},getTotalUsed:function(){return this.countActive()},getTotalFree:function(){var used=this.getTotalUsed();var capacity=(this.maxSize===-1)?999999999999:this.maxSize;return(capacity-used)},setActive:function(value){this.active=value;return this},setName:function(value){this.name=value;return this},propertyValueSet:function(key,value,step,index,direction){Actions.PropertyValueSet(this.children.entries,key,value,step,index,direction);return this},propertyValueInc:function(key,value,step,index,direction){Actions.PropertyValueInc(this.children.entries,key,value,step,index,direction);return this},setX:function(value,step){Actions.SetX(this.children.entries,value,step);return this},setY:function(value,step){Actions.SetY(this.children.entries,value,step);return this},setXY:function(x,y,stepX,stepY){Actions.SetXY(this.children.entries,x,y,stepX,stepY);return this},incX:function(value,step){Actions.IncX(this.children.entries,value,step);return this},incY:function(value,step){Actions.IncY(this.children.entries,value,step);return this},incXY:function(x,y,stepX,stepY){Actions.IncXY(this.children.entries,x,y,stepX,stepY);return this},shiftPosition:function(x,y,direction){Actions.ShiftPosition(this.children.entries,x,y,direction);return this},angle:function(value,step){Actions.Angle(this.children.entries,value,step);return this},rotate:function(value,step){Actions.Rotate(this.children.entries,value,step);return this},rotateAround:function(point,angle){Actions.RotateAround(this.children.entries,point,angle);return this},rotateAroundDistance:function(point,angle,distance){Actions.RotateAroundDistance(this.children.entries,point,angle,distance);return this},setAlpha:function(value,step){Actions.SetAlpha(this.children.entries,value,step);return this},setTint:function(topLeft,topRight,bottomLeft,bottomRight){Actions.SetTint(this.children.entries,topLeft,topRight,bottomLeft,bottomRight);return this},setOrigin:function(originX,originY,stepX,stepY){Actions.SetOrigin(this.children.entries,originX,originY,stepX,stepY);return this},scaleX:function(value,step){Actions.ScaleX(this.children.entries,value,step);return this},scaleY:function(value,step){Actions.ScaleY(this.children.entries,value,step);return this},scaleXY:function(scaleX,scaleY,stepX,stepY){Actions.ScaleXY(this.children.entries,scaleX,scaleY,stepX,stepY);return this},setDepth:function(value,step){Actions.SetDepth(this.children.entries,value,step);return this},setBlendMode:function(value){Actions.SetBlendMode(this.children.entries,value);return this},setHitArea:function(hitArea,hitAreaCallback){Actions.SetHitArea(this.children.entries,hitArea,hitAreaCallback);return this},shuffle:function(){Actions.Shuffle(this.children.entries);return this},kill:function(gameObject){if(this.children.contains(gameObject)){gameObject.setActive(false)}},killAndHide:function(gameObject){if(this.children.contains(gameObject)){gameObject.setActive(false);gameObject.setVisible(false)}},setVisible:function(value,index,direction){Actions.SetVisible(this.children.entries,value,index,direction);return this},toggleVisible:function(){Actions.ToggleVisible(this.children.entries);return this},destroy:function(destroyChildren){if(destroyChildren===undefined){destroyChildren=false}if(!this.scene||this.ignoreDestroy){return}this.clear(false,destroyChildren);this.scene=undefined;this.children=undefined}});module.exports=Group}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var FillPathWebGL=function(pipeline,calcMatrix,src,alpha,dx,dy){var fillTintColor=Utils.getTintAppendFloatAlphaAndSwap(src.fillColor,src.fillAlpha*alpha);var path=src.pathData;var pathIndexes=src.pathIndexes;for(var i=0;i<pathIndexes.length;i+=3){var p0=pathIndexes[i]*2;var p1=pathIndexes[i+1]*2;var p2=pathIndexes[i+2]*2;var x0=path[p0+0]-dx;var y0=path[p0+1]-dy;var x1=path[p1+0]-dx;var y1=path[p1+1]-dy;var x2=path[p2+0]-dx;var y2=path[p2+1]-dy;var tx0=calcMatrix.getX(x0,y0);var ty0=calcMatrix.getY(x0,y0);var tx1=calcMatrix.getX(x1,y1);var ty1=calcMatrix.getY(x1,y1);var tx2=calcMatrix.getX(x2,y2);var ty2=calcMatrix.getY(x2,y2);pipeline.setTexture2D();pipeline.batchTri(tx0,ty0,tx1,ty1,tx2,ty2,0,0,1,1,fillTintColor,fillTintColor,fillTintColor,pipeline.tintEffect)}};module.exports=FillPathWebGL}),(function(module,exports){var Vector={};module.exports=Vector;(function(){Vector.create=function(x,y){return{x:x||0,y:y||0}};Vector.clone=function(vector){return{x:vector.x,y:vector.y}};Vector.magnitude=function(vector){return Math.sqrt((vector.x*vector.x)+(vector.y*vector.y))};Vector.magnitudeSquared=function(vector){return(vector.x*vector.x)+(vector.y*vector.y)};Vector.rotate=function(vector,angle,output){var cos=Math.cos(angle),sin=Math.sin(angle);if(!output)output={};var x=vector.x*cos-vector.y*sin;output.y=vector.x*sin+vector.y*cos;output.x=x;return output};Vector.rotateAbout=function(vector,angle,point,output){var cos=Math.cos(angle),sin=Math.sin(angle);if(!output)output={};var x=point.x+((vector.x-point.x)*cos-(vector.y-point.y)*sin);output.y=point.y+((vector.x-point.x)*sin+(vector.y-point.y)*cos);output.x=x;return output};Vector.normalise=function(vector){var magnitude=Vector.magnitude(vector);if(magnitude===0)return{x:0,y:0};return{x:vector.x/magnitude,y:vector.y/magnitude}};Vector.dot=function(vectorA,vectorB){return(vectorA.x*vectorB.x)+(vectorA.y*vectorB.y)};Vector.cross=function(vectorA,vectorB){return(vectorA.x*vectorB.y)-(vectorA.y*vectorB.x)};Vector.cross3=function(vectorA,vectorB,vectorC){return(vectorB.x-vectorA.x)*(vectorC.y-vectorA.y)-(vectorB.y-vectorA.y)*(vectorC.x-vectorA.x)};Vector.add=function(vectorA,vectorB,output){if(!output)output={};output.x=vectorA.x+vectorB.x;output.y=vectorA.y+vectorB.y;return output};Vector.sub=function(vectorA,vectorB,output){if(!output)output={};output.x=vectorA.x-vectorB.x;output.y=vectorA.y-vectorB.y;return output};Vector.mult=function(vector,scalar){return{x:vector.x*scalar,y:vector.y*scalar}};Vector.div=function(vector,scalar){return{x:vector.x/scalar,y:vector.y/scalar}};Vector.perp=function(vector,negate){negate=negate===true?-1:1;return{x:negate*-vector.y,y:negate*vector.x}};Vector.neg=function(vector){return{x:-vector.x,y:-vector.y}};Vector.angle=function(vectorA,vectorB){return Math.atan2(vectorB.y-vectorA.y,vectorB.x-vectorA.x)};Vector._temp=[Vector.create(),Vector.create(),Vector.create(),Vector.create(),Vector.create(),Vector.create()]})()}),(function(module,exports){var Bounds={};module.exports=Bounds;(function(){Bounds.create=function(vertices){var bounds={min:{x:0,y:0},max:{x:0,y:0}};if(vertices)Bounds.update(bounds,vertices);return bounds};Bounds.update=function(bounds,vertices,velocity){bounds.min.x=Infinity;bounds.max.x=-Infinity;bounds.min.y=Infinity;bounds.max.y=-Infinity;for(var i=0;i<vertices.length;i++){var vertex=vertices[i];if(vertex.x>bounds.max.x)bounds.max.x=vertex.x;if(vertex.x<bounds.min.x)bounds.min.x=vertex.x;if(vertex.y>bounds.max.y)bounds.max.y=vertex.y;if(vertex.y<bounds.min.y)bounds.min.y=vertex.y}if(velocity){if(velocity.x>0){bounds.max.x+=velocity.x}else{bounds.min.x+=velocity.x}if(velocity.y>0){bounds.max.y+=velocity.y}else{bounds.min.y+=velocity.y}}};Bounds.contains=function(bounds,point){return point.x>=bounds.min.x&&point.x<=bounds.max.x&&point.y>=bounds.min.y&&point.y<=bounds.max.y};Bounds.overlaps=function(boundsA,boundsB){return(boundsA.min.x<=boundsB.max.x&&boundsA.max.x>=boundsB.min.x&&boundsA.max.y>=boundsB.min.y&&boundsA.min.y<=boundsB.max.y)};Bounds.translate=function(bounds,vector){bounds.min.x+=vector.x;bounds.max.x+=vector.x;bounds.min.y+=vector.y;bounds.max.y+=vector.y};Bounds.shift=function(bounds,position){var deltaX=bounds.max.x-bounds.min.x,deltaY=bounds.max.y-bounds.min.y;bounds.min.x=position.x;bounds.max.x=position.x+deltaX;bounds.min.y=position.y;bounds.max.y=position.y+deltaY}})()}),(function(module,exports){var IsInLayerBounds=function(tileX,tileY,layer){return(tileX>=0&&tileX<layer.width&&tileY>=0&&tileY<layer.height)};module.exports=IsInLayerBounds}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var LayerData=new Class({initialize:function LayerData(config){if(config===undefined){config={}}this.name=GetFastValue(config,'name','layer');this.x=GetFastValue(config,'x',0);this.y=GetFastValue(config,'y',0);this.width=GetFastValue(config,'width',0);this.height=GetFastValue(config,'height',0);this.tileWidth=GetFastValue(config,'tileWidth',0);this.tileHeight=GetFastValue(config,'tileHeight',0);this.baseTileWidth=GetFastValue(config,'baseTileWidth',this.tileWidth);this.baseTileHeight=GetFastValue(config,'baseTileHeight',this.tileHeight);this.widthInPixels=GetFastValue(config,'widthInPixels',this.width*this.baseTileWidth);this.heightInPixels=GetFastValue(config,'heightInPixels',this.height*this.baseTileHeight);this.alpha=GetFastValue(config,'alpha',1);this.visible=GetFastValue(config,'visible',true);this.properties=GetFastValue(config,'properties',[]);this.indexes=GetFastValue(config,'indexes',[]);this.collideIndexes=GetFastValue(config,'collideIndexes',[]);this.callbacks=GetFastValue(config,'callbacks',[]);this.bodies=GetFastValue(config,'bodies',[]);this.data=GetFastValue(config,'data',[]);this.tilemapLayer=GetFastValue(config,'tilemapLayer',null)}});module.exports=LayerData}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var MapData=new Class({initialize:function MapData(config){if(config===undefined){config={}}this.name=GetFastValue(config,'name','map');this.width=GetFastValue(config,'width',0);this.height=GetFastValue(config,'height',0);this.infinite=GetFastValue(config,'infinite',false);this.tileWidth=GetFastValue(config,'tileWidth',0);this.tileHeight=GetFastValue(config,'tileHeight',0);this.widthInPixels=GetFastValue(config,'widthInPixels',this.width*this.tileWidth);this.heightInPixels=GetFastValue(config,'heightInPixels',this.height*this.tileHeight);this.format=GetFastValue(config,'format',null);this.orientation=GetFastValue(config,'orientation','orthogonal');this.renderOrder=GetFastValue(config,'renderOrder','right-down');this.version=GetFastValue(config,'version','1');this.properties=GetFastValue(config,'properties',{});this.layers=GetFastValue(config,'layers',[]);this.images=GetFastValue(config,'images',[]);this.objects=GetFastValue(config,'objects',{});this.collision=GetFastValue(config,'collision',{});this.tilesets=GetFastValue(config,'tilesets',[]);this.imageCollections=GetFastValue(config,'imageCollections',[]);this.tiles=GetFastValue(config,'tiles',[])}});module.exports=MapData}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Tileset=new Class({initialize:function Tileset(name,firstgid,tileWidth,tileHeight,tileMargin,tileSpacing,tileProperties,tileData){if(tileWidth===undefined||tileWidth<=0){tileWidth=32}if(tileHeight===undefined||tileHeight<=0){tileHeight=32}if(tileMargin===undefined){tileMargin=0}if(tileSpacing===undefined){tileSpacing=0}if(tileProperties===undefined){tileProperties={}}if(tileData===undefined){tileData={}}this.name=name;this.firstgid=firstgid;this.tileWidth=tileWidth;this.tileHeight=tileHeight;this.tileMargin=tileMargin;this.tileSpacing=tileSpacing;this.tileProperties=tileProperties;this.tileData=tileData;this.image=null;this.glTexture=null;this.rows=0;this.columns=0;this.total=0;this.texCoordinates=[]},getTileProperties:function(tileIndex){if(!this.containsTileIndex(tileIndex)){return null}return this.tileProperties[tileIndex-this.firstgid]},getTileData:function(tileIndex){if(!this.containsTileIndex(tileIndex)){return null}return this.tileData[tileIndex-this.firstgid]},getTileCollisionGroup:function(tileIndex){var data=this.getTileData(tileIndex);return(data&&data.objectgroup)?data.objectgroup:null},containsTileIndex:function(tileIndex){return(tileIndex>=this.firstgid&&tileIndex<(this.firstgid+this.total))},getTileTextureCoordinates:function(tileIndex){if(!this.containsTileIndex(tileIndex)){return null}return this.texCoordinates[tileIndex-this.firstgid]},setImage:function(texture){this.image=texture;this.glTexture=texture.get().source.glTexture;this.updateTileData(this.image.source[0].width,this.image.source[0].height);return this},setTileSize:function(tileWidth,tileHeight){if(tileWidth!==undefined){this.tileWidth=tileWidth}if(tileHeight!==undefined){this.tileHeight=tileHeight}if(this.image){this.updateTileData(this.image.source[0].width,this.image.source[0].height)}return this},setSpacing:function(margin,spacing){if(margin!==undefined){this.tileMargin=margin}if(spacing!==undefined){this.tileSpacing=spacing}if(this.image){this.updateTileData(this.image.source[0].width,this.image.source[0].height)}return this},updateTileData:function(imageWidth,imageHeight){var rowCount=(imageHeight-this.tileMargin*2+this.tileSpacing)/(this.tileHeight+this.tileSpacing);var colCount=(imageWidth-this.tileMargin*2+this.tileSpacing)/(this.tileWidth+this.tileSpacing);if(rowCount%1!==0||colCount%1!==0){console.warn('Image tile area not tile size multiple in: '+this.name)}rowCount=Math.floor(rowCount);colCount=Math.floor(colCount);this.rows=rowCount;this.columns=colCount;this.total=rowCount*colCount;this.texCoordinates.length=0;var tx=this.tileMargin;var ty=this.tileMargin;for(var y=0;y<this.rows;y++){for(var x=0;x<this.columns;x++){this.texCoordinates.push({x:tx,y:ty});tx+=this.tileWidth+this.tileSpacing}tx=this.tileMargin;ty+=this.tileHeight+this.tileSpacing}return this}});module.exports=Tileset}),(function(module,exports){var ALIGN_CONST={TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12};module.exports=ALIGN_CONST}),(function(module,exports){var Equal=function(a,b,epsilon){if(epsilon===undefined){epsilon=0.0001}return Math.abs(a-b)<epsilon};module.exports=Equal}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var ImageRender=__webpack_require__(970);var Image=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Size,Components.TextureCrop,Components.Tint,Components.Transform,Components.Visible,ImageRender],initialize:function Image(scene,x,y,texture,frame){GameObject.call(this,scene,'Image');this._crop=this.resetCropObject();this.setTexture(texture,frame);this.setPosition(x,y);this.setSizeToFrame();this.setOriginFromFrame();this.initPipeline()}});module.exports=Image}),(function(module,exports){var HasValue=function(source,key){return(source.hasOwnProperty(key))};module.exports=HasValue}),(function(module,exports,__webpack_require__){var Bodies={};module.exports=Bodies;var Vertices=__webpack_require__(86);var Common=__webpack_require__(42);var Body=__webpack_require__(62);var Bounds=__webpack_require__(100);var Vector=__webpack_require__(99);var decomp=__webpack_require__(1386);(function(){Bodies.rectangle=function(x,y,width,height,options){options=options||{};var rectangle={label:'Rectangle Body',position:{x:x,y:y},vertices:Vertices.fromPath('L 0 0 L '+width+' 0 L '+width+' '+height+' L 0 '+height)};if(options.chamfer){var chamfer=options.chamfer;rectangle.vertices=Vertices.chamfer(rectangle.vertices,chamfer.radius,chamfer.quality,chamfer.qualityMin,chamfer.qualityMax);delete options.chamfer}return Body.create(Common.extend({},rectangle,options))};Bodies.trapezoid=function(x,y,width,height,slope,options){options=options||{};slope*=0.5;var roof=(1-(slope*2))*width;var x1=width*slope,x2=x1+roof,x3=x2+x1,verticesPath;if(slope<0.5){verticesPath='L 0 0 L '+x1+' '+(-height)+' L '+x2+' '+(-height)+' L '+x3+' 0'}else{verticesPath='L 0 0 L '+x2+' '+(-height)+' L '+x3+' 0'}var trapezoid={label:'Trapezoid Body',position:{x:x,y:y},vertices:Vertices.fromPath(verticesPath)};if(options.chamfer){var chamfer=options.chamfer;trapezoid.vertices=Vertices.chamfer(trapezoid.vertices,chamfer.radius,chamfer.quality,chamfer.qualityMin,chamfer.qualityMax);delete options.chamfer}return Body.create(Common.extend({},trapezoid,options))};Bodies.circle=function(x,y,radius,options,maxSides){options=options||{};var circle={label:'Circle Body',circleRadius:radius};maxSides=maxSides||25;var sides=Math.ceil(Math.max(10,Math.min(maxSides,radius)));if(sides%2===1)sides+=1;return Bodies.polygon(x,y,sides,radius,Common.extend({},circle,options))};Bodies.polygon=function(x,y,sides,radius,options){options=options||{};if(sides<3)return Bodies.circle(x,y,radius,options);var theta=2*Math.PI/sides,path='',offset=theta*0.5;for(var i=0;i<sides;i+=1){var angle=offset+(i*theta),xx=Math.cos(angle)*radius,yy=Math.sin(angle)*radius;path+='L '+xx.toFixed(3)+' '+yy.toFixed(3)+' '}var polygon={label:'Polygon Body',position:{x:x,y:y},vertices:Vertices.fromPath(path)};if(options.chamfer){var chamfer=options.chamfer;polygon.vertices=Vertices.chamfer(polygon.vertices,chamfer.radius,chamfer.quality,chamfer.qualityMin,chamfer.qualityMax);delete options.chamfer}return Body.create(Common.extend({},polygon,options))};Bodies.fromVertices=function(x,y,vertexSets,options,flagInternal,removeCollinear,minimumArea){var body,parts,isConvex,vertices,i,j,k,v,z;options=options||{};parts=[];flagInternal=typeof flagInternal!=='undefined'?flagInternal:false;removeCollinear=typeof removeCollinear!=='undefined'?removeCollinear:0.01;minimumArea=typeof minimumArea!=='undefined'?minimumArea:10;if(!decomp){Common.warn('Bodies.fromVertices: poly-decomp.js required. Could not decompose vertices. Fallback to convex hull.')}if(!Common.isArray(vertexSets[0])){vertexSets=[vertexSets]}for(v=0;v<vertexSets.length;v+=1){vertices=vertexSets[v];isConvex=Vertices.isConvex(vertices);if(isConvex||!decomp){if(isConvex){vertices=Vertices.clockwiseSort(vertices)}else{vertices=Vertices.hull(vertices)}parts.push({position:{x:x,y:y},vertices:vertices})}else{var concave=vertices.map(function(vertex){return[vertex.x,vertex.y]});decomp.makeCCW(concave);if(removeCollinear!==false)decomp.removeCollinearPoints(concave,removeCollinear);var decomposed=decomp.quickDecomp(concave);for(i=0;i<decomposed.length;i++){var chunk=decomposed[i];var chunkVertices=chunk.map(function(vertices){return{x:vertices[0],y:vertices[1]}});if(minimumArea>0&&Vertices.area(chunkVertices)<minimumArea)continue;parts.push({position:Vertices.centre(chunkVertices),vertices:chunkVertices})}}}for(i=0;i<parts.length;i++){parts[i]=Body.create(Common.extend(parts[i],options))}if(flagInternal){Bodies.flagCoincidentParts(parts,5)}if(parts.length>1){body=Body.create(Common.extend({parts:parts.slice(0)},options));Body.setPosition(body,{x:x,y:y});return body}else{return parts[0]}};Bodies.flagCoincidentParts=function(parts,maxDistance){if(maxDistance===undefined){maxDistance=5}for(var i=0;i<parts.length;i++){var partA=parts[i];for(var j=i+1;j<parts.length;j++){var partB=parts[j];if(Bounds.overlaps(partA.bounds,partB.bounds)){var pav=partA.vertices;var pbv=partB.vertices;for(var k=0;k<partA.vertices.length;k++){for(var z=0;z<partB.vertices.length;z++){var da=Vector.magnitudeSquared(Vector.sub(pav[(k+1)%pav.length],pbv[z]));var db=Vector.magnitudeSquared(Vector.sub(pav[k],pbv[(z+1)%pbv.length]));if(da<maxDistance&&db<maxDistance){pav[k].isInternal=true;pbv[z].isInternal=true}}}}}}return parts}})()}),(function(module,exports,__webpack_require__){var BlendModes=__webpack_require__(52);var Circle=__webpack_require__(65);var CircleContains=__webpack_require__(55);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var Rectangle=__webpack_require__(11);var RectangleContains=__webpack_require__(48);var Zone=new Class({Extends:GameObject,Mixins:[Components.Depth,Components.GetBounds,Components.Origin,Components.Transform,Components.ScrollFactor,Components.Visible],initialize:function Zone(scene,x,y,width,height){if(width===undefined){width=1}if(height===undefined){height=width}GameObject.call(this,scene,'Zone');this.setPosition(x,y);this.width=width;this.height=height;this.blendMode=BlendModes.NORMAL;this.updateDisplayOrigin()},displayWidth:{get:function(){return this.scaleX*this.width},set:function(value){this.scaleX=value/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(value){this.scaleY=value/this.height}},setSize:function(width,height,resizeInput){if(resizeInput===undefined){resizeInput=true}this.width=width;this.height=height;this.updateDisplayOrigin();var input=this.input;if(resizeInput&&input&&!input.customHitArea){input.hitArea.width=width;input.hitArea.height=height}return this},setDisplaySize:function(width,height){this.displayWidth=width;this.displayHeight=height;return this},setCircleDropZone:function(radius){return this.setDropZone(new Circle(0,0,radius),CircleContains)},setRectangleDropZone:function(width,height){return this.setDropZone(new Rectangle(0,0,width,height),RectangleContains)},setDropZone:function(shape,callback){if(shape===undefined){this.setRectangleDropZone(this.width,this.height)}else if(!this.input){this.setInteractive(shape,callback,true)}return this},setAlpha:function(){},setBlendMode:function(){},renderCanvas:function(){},renderWebGL:function(){}});module.exports=Zone}),(function(module,exports,__webpack_require__){module.exports={ADD_ANIMATION:__webpack_require__(534),ANIMATION_COMPLETE:__webpack_require__(535),ANIMATION_REPEAT:__webpack_require__(536),ANIMATION_RESTART:__webpack_require__(537),ANIMATION_START:__webpack_require__(538),PAUSE_ALL:__webpack_require__(539),REMOVE_ANIMATION:__webpack_require__(540),RESUME_ALL:__webpack_require__(541),SPRITE_ANIMATION_COMPLETE:__webpack_require__(542),SPRITE_ANIMATION_KEY_COMPLETE:__webpack_require__(543),SPRITE_ANIMATION_KEY_REPEAT:__webpack_require__(544),SPRITE_ANIMATION_KEY_RESTART:__webpack_require__(545),SPRITE_ANIMATION_KEY_START:__webpack_require__(546),SPRITE_ANIMATION_KEY_UPDATE:__webpack_require__(547),SPRITE_ANIMATION_REPEAT:__webpack_require__(548),SPRITE_ANIMATION_RESTART:__webpack_require__(549),SPRITE_ANIMATION_START:__webpack_require__(550),SPRITE_ANIMATION_UPDATE:__webpack_require__(551)}}),(function(module,exports){var Perimeter=function(rect){return 2*(rect.width+rect.height)};module.exports=Perimeter}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Events=__webpack_require__(284);var DataManager=new Class({initialize:function DataManager(parent,eventEmitter){this.parent=parent;this.events=eventEmitter;if(!eventEmitter){this.events=(parent.events)?parent.events:parent}this.list={};this.values={};this._frozen=false;if(!parent.hasOwnProperty('sys')&&this.events){this.events.once('destroy',this.destroy,this)}},get:function(key){var list=this.list;if(Array.isArray(key)){var output=[];for(var i=0;i<key.length;i++){output.push(list[key[i]])}return output}else{return list[key]}},getAll:function(){var results={};for(var key in this.list){if(this.list.hasOwnProperty(key)){results[key]=this.list[key]}}return results},query:function(search){var results={};for(var key in this.list){if(this.list.hasOwnProperty(key)&&key.match(search)){results[key]=this.list[key]}}return results},set:function(key,data){if(this._frozen){return this}if(typeof key==='string'){return this.setValue(key,data)}else{for(var entry in key){this.setValue(entry,key[entry])}}return this},inc:function(key,data){if(this._frozen){return this}if(data===undefined){data=1}var value=this.get(key);if(value===undefined){value=0}this.set(key,(value+data));return this},toggle:function(key){if(this._frozen){return this}this.set(key,!this.get(key));return this},setValue:function(key,data){if(this._frozen){return this}if(this.has(key)){this.values[key]=data}else{var _this=this;var list=this.list;var events=this.events;var parent=this.parent;Object.defineProperty(this.values,key,{enumerable:true,configurable:true,get:function(){return list[key]},set:function(value){if(!_this._frozen){var previousValue=list[key];list[key]=value;events.emit(Events.CHANGE_DATA,parent,key,value,previousValue);events.emit(Events.CHANGE_DATA_KEY+key,parent,value,previousValue)}}});list[key]=data;events.emit(Events.SET_DATA,parent,key,data)}return this},each:function(callback,context){var args=[this.parent,null,undefined];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}for(var key in this.list){args[1]=key;args[2]=this.list[key];callback.apply(context,args)}return this},merge:function(data,overwrite){if(overwrite===undefined){overwrite=true}for(var key in data){if(data.hasOwnProperty(key)&&(overwrite||(!overwrite&&!this.has(key)))){this.setValue(key,data[key])}}return this},remove:function(key){if(this._frozen){return this}if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.removeValue(key[i])}}else{return this.removeValue(key)}return this},removeValue:function(key){if(this.has(key)){var data=this.list[key];delete this.list[key];delete this.values[key];this.events.emit(Events.REMOVE_DATA,this.parent,key,data)}return this},pop:function(key){var data=undefined;if(!this._frozen&&this.has(key)){data=this.list[key];delete this.list[key];delete this.values[key];this.events.emit(Events.REMOVE_DATA,this.parent,key,data)}return data},has:function(key){return this.list.hasOwnProperty(key)},setFreeze:function(value){this._frozen=value;return this},reset:function(){for(var key in this.list){delete this.list[key];delete this.values[key]}this._frozen=false;return this},destroy:function(){this.reset();this.events.off(Events.CHANGE_DATA);this.events.off(Events.SET_DATA);this.events.off(Events.REMOVE_DATA);this.parent=null},freeze:{get:function(){return this._frozen},set:function(value){this._frozen=(value)?true:false}},count:{get:function(){var i=0;for(var key in this.list){if(this.list[key]!==undefined){i++}}return i}}});module.exports=DataManager}),(function(module,exports){var Shuffle=function(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp}return array};module.exports=Shuffle}),(function(module,exports,__webpack_require__){var Back=__webpack_require__(302);var Bounce=__webpack_require__(303);var Circular=__webpack_require__(304);var Cubic=__webpack_require__(305);var Elastic=__webpack_require__(306);var Expo=__webpack_require__(307);var Linear=__webpack_require__(308);var Quadratic=__webpack_require__(309);var Quartic=__webpack_require__(310);var Quintic=__webpack_require__(311);var Sine=__webpack_require__(312);var Stepped=__webpack_require__(313);module.exports={Power0:Linear,Power1:Quadratic.Out,Power2:Cubic.Out,Power3:Quartic.Out,Power4:Quintic.Out,Linear:Linear,Quad:Quadratic.Out,Cubic:Cubic.Out,Quart:Quartic.Out,Quint:Quintic.Out,Sine:Sine.Out,Expo:Expo.Out,Circ:Circular.Out,Elastic:Elastic.Out,Back:Back.Out,Bounce:Bounce.Out,Stepped:Stepped,'Quad.easeIn':Quadratic.In,'Cubic.easeIn':Cubic.In,'Quart.easeIn':Quartic.In,'Quint.easeIn':Quintic.In,'Sine.easeIn':Sine.In,'Expo.easeIn':Expo.In,'Circ.easeIn':Circular.In,'Elastic.easeIn':Elastic.In,'Back.easeIn':Back.In,'Bounce.easeIn':Bounce.In,'Quad.easeOut':Quadratic.Out,'Cubic.easeOut':Cubic.Out,'Quart.easeOut':Quartic.Out,'Quint.easeOut':Quintic.Out,'Sine.easeOut':Sine.Out,'Expo.easeOut':Expo.Out,'Circ.easeOut':Circular.Out,'Elastic.easeOut':Elastic.Out,'Back.easeOut':Back.Out,'Bounce.easeOut':Bounce.Out,'Quad.easeInOut':Quadratic.InOut,'Cubic.easeInOut':Cubic.InOut,'Quart.easeInOut':Quartic.InOut,'Quint.easeInOut':Quintic.InOut,'Sine.easeInOut':Sine.InOut,'Expo.easeInOut':Expo.InOut,'Circ.easeInOut':Circular.InOut,'Elastic.easeInOut':Elastic.InOut,'Back.easeInOut':Back.InOut,'Bounce.easeInOut':Bounce.InOut}}),(function(module,exports){var Linear=function(p0,p1,t){return(p1-p0)*t+p0};module.exports=Linear}),(function(module,exports,__webpack_require__){(function(process){var OS={android:false,chromeOS:false,cordova:false,crosswalk:false,desktop:false,ejecta:false,electron:false,iOS:false,iOSVersion:0,iPad:false,iPhone:false,kindle:false,linux:false,macOS:false,node:false,nodeWebkit:false,pixelRatio:1,webApp:false,windows:false,windowsPhone:false};function init(){var ua=navigator.userAgent;if((/Windows/).test(ua)){OS.windows=true}else if((/Mac OS/).test(ua)&&!((/like Mac OS/).test(ua))){OS.macOS=true}else if((/Android/).test(ua)){OS.android=true}else if((/Linux/).test(ua)){OS.linux=true}else if((/iP[ao]d|iPhone/i).test(ua)){OS.iOS=true;(navigator.appVersion).match(/OS (\d+)/);OS.iOSVersion=parseInt(RegExp.$1,10);OS.iPhone=ua.toLowerCase().indexOf('iphone')!==-1;OS.iPad=ua.toLowerCase().indexOf('ipad')!==-1}else if((/Kindle/).test(ua)||(/\bKF[A-Z][A-Z]+/).test(ua)||(/Silk.*Mobile Safari/).test(ua)){OS.kindle=true}else if((/CrOS/).test(ua)){OS.chromeOS=true}if((/Windows Phone/i).test(ua)||(/IEMobile/i).test(ua)){OS.android=false;OS.iOS=false;OS.macOS=false;OS.windows=true;OS.windowsPhone=true}var silk=(/Silk/).test(ua);if(OS.windows||OS.macOS||(OS.linux&&!silk)||OS.chromeOS){OS.desktop=true}if(OS.windowsPhone||(((/Windows NT/i).test(ua))&&((/Touch/i).test(ua)))){OS.desktop=false}if(navigator.standalone){OS.webApp=true}if(window.cordova!==undefined){OS.cordova=true}if(typeof process!=='undefined'&&process.versions&&process.versions.node){OS.node=true}if(OS.node&&typeof process.versions==='object'){OS.nodeWebkit=!!process.versions['node-webkit'];OS.electron=!!process.versions.electron}if(window.ejecta!==undefined){OS.ejecta=true}if((/Crosswalk/).test(ua)){OS.crosswalk=true}OS.pixelRatio=window['devicePixelRatio']||1;return OS}module.exports=init()}.call(this,__webpack_require__(729)))}),(function(module,exports,__webpack_require__){var OS=__webpack_require__(117);var Browser={chrome:false,chromeVersion:0,edge:false,firefox:false,firefoxVersion:0,ie:false,ieVersion:0,mobileSafari:false,opera:false,safari:false,safariVersion:0,silk:false,trident:false,tridentVersion:0};function init(){var ua=navigator.userAgent;if((/Edge\/\d+/).test(ua)){Browser.edge=true}else if((/Chrome\/(\d+)/).test(ua)&&!OS.windowsPhone){Browser.chrome=true;Browser.chromeVersion=parseInt(RegExp.$1,10)}else if((/Firefox\D+(\d+)/).test(ua)){Browser.firefox=true;Browser.firefoxVersion=parseInt(RegExp.$1,10)}else if((/AppleWebKit/).test(ua)&&OS.iOS){Browser.mobileSafari=true}else if((/MSIE (\d+\.\d+);/).test(ua)){Browser.ie=true;Browser.ieVersion=parseInt(RegExp.$1,10)}else if((/Opera/).test(ua)){Browser.opera=true}else if((/Safari/).test(ua)&&!OS.windowsPhone){Browser.safari=true}else if((/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/).test(ua)){Browser.ie=true;Browser.trident=true;Browser.tridentVersion=parseInt(RegExp.$1,10);Browser.ieVersion=parseInt(RegExp.$3,10)}if((/Silk/).test(ua)){Browser.silk=true}return Browser}module.exports=init()}),(function(module,exports){var FloatBetween=function(min,max){return Math.random()*(max-min)+min};module.exports=FloatBetween}),(function(module,exports){var IsSizePowerOfTwo=function(width,height){return(width>0&&(width&(width-1))===0&&height>0&&(height&(height-1))===0)};module.exports=IsSizePowerOfTwo}),(function(module,exports,__webpack_require__){module.exports={ADD:__webpack_require__(781),ERROR:__webpack_require__(782),LOAD:__webpack_require__(783),READY:__webpack_require__(784),REMOVE:__webpack_require__(785)}}),(function(module,exports){var AddToDOM=function(element,parent){var target;if(parent){if(typeof parent==='string'){target=document.getElementById(parent)}else if(typeof parent==='object'&&parent.nodeType===1){target=parent}}else if(element.parentElement||parent===null){return element}if(!target){target=document.body}target.appendChild(element);return element};module.exports=AddToDOM}),(function(module,exports,__webpack_require__){var SpliceOne=__webpack_require__(80);var Remove=function(array,item,callback,context){if(context===undefined){context=array}var index;if(!Array.isArray(item)){index=array.indexOf(item);if(index!==-1){SpliceOne(array,index);if(callback){callback.call(context,item)}return item}else{return null}}var itemLength=item.length-1;while(itemLength>=0){var entry=item[itemLength];index=array.indexOf(entry);if(index!==-1){SpliceOne(array,index);if(callback){callback.call(context,entry)}}else{item.pop()}itemLength--}return item};module.exports=Remove}),(function(module,exports){var KeyCodes={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:42,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ADD:107,NUMPAD_SUBTRACT:109,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,PLUS:187,COMMA:188,MINUS:189,PERIOD:190,FORWARD_SLASH:191,BACK_SLASH:220,QUOTES:222,BACKTICK:192,OPEN_BRACKET:219,CLOSED_BRACKET:221,SEMICOLON_FIREFOX:59,COLON:58,COMMA_FIREFOX_WINDOWS:60,COMMA_FIREFOX:62,BRACKET_RIGHT_FIREFOX:174,BRACKET_LEFT_FIREFOX:175};module.exports=KeyCodes}),(function(module,exports){var CONST={PENDING:0,INIT:1,START:2,LOADING:3,CREATING:4,RUNNING:5,PAUSED:6,SLEEPING:7,SHUTDOWN:8,DESTROYED:9};module.exports=CONST}),(function(module,exports,__webpack_require__){var Clone=__webpack_require__(67);var Merge=function(obj1,obj2){var clone=Clone(obj1);for(var key in obj2){if(!clone.hasOwnProperty(key)){clone[key]=obj2[key]}}return clone};module.exports=Merge}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Clone=__webpack_require__(67);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(59);var GameEvents=__webpack_require__(20);var NOOP=__webpack_require__(1);var GetAll=__webpack_require__(382);var GetFirst=__webpack_require__(383);var BaseSoundManager=new Class({Extends:EventEmitter,initialize:function BaseSoundManager(game){EventEmitter.call(this);this.game=game;this.jsonCache=game.cache.json;this.sounds=[];this.mute=false;this.volume=1;this.pauseOnBlur=true;this._rate=1;this._detune=0;this.locked=this.locked||false;this.unlocked=false;game.events.on(GameEvents.BLUR,this.onGameBlur,this);game.events.on(GameEvents.FOCUS,this.onGameFocus,this);game.events.on(GameEvents.PRE_STEP,this.update,this);game.events.once(GameEvents.DESTROY,this.destroy,this)},add:NOOP,addAudioSprite:function(key,config){if(config===undefined){config={}}var sound=this.add(key,config);sound.spritemap=this.jsonCache.get(key).spritemap;for(var markerName in sound.spritemap){if(!sound.spritemap.hasOwnProperty(markerName)){continue}var markerConfig=Clone(config);var marker=sound.spritemap[markerName];markerConfig.loop=(marker.hasOwnProperty('loop'))?marker.loop:false;sound.addMarker({name:markerName,start:marker.start,duration:marker.end-marker.start,config:markerConfig})}return sound},get:function(key){return GetFirst(this.sounds,'key',key)},getAll:function(key){return GetAll(this.sounds,'key',key)},play:function(key,extra){var sound=this.add(key);sound.once(Events.COMPLETE,sound.destroy,sound);if(extra){if(extra.name){sound.addMarker(extra);return sound.play(extra.name)}else{return sound.play(extra)}}else{return sound.play()}},playAudioSprite:function(key,spriteName,config){var sound=this.addAudioSprite(key);sound.once(Events.COMPLETE,sound.destroy,sound);return sound.play(spriteName,config)},remove:function(sound){var index=this.sounds.indexOf(sound);if(index!==-1){sound.destroy();this.sounds.splice(index,1);return true}return false},removeAll:function(){this.sounds.forEach(function(sound){sound.destroy()});this.sounds.length=0},removeByKey:function(key){var removed=0;for(var i=this.sounds.length-1;i>=0;i--){var sound=this.sounds[i];if(sound.key===key){sound.destroy();this.sounds.splice(i,1);removed++}}return removed},pauseAll:function(){this.forEachActiveSound(function(sound){sound.pause()});this.emit(Events.PAUSE_ALL,this)},resumeAll:function(){this.forEachActiveSound(function(sound){sound.resume()});this.emit(Events.RESUME_ALL,this)},stopAll:function(){this.forEachActiveSound(function(sound){sound.stop()});this.emit(Events.STOP_ALL,this)},stopByKey:function(key){var stopped=0;this.getAll(key).forEach(function(sound){if(sound.stop()){stopped++}});return stopped},unlock:NOOP,onBlur:NOOP,onFocus:NOOP,onGameBlur:function(){if(this.pauseOnBlur){this.onBlur()}},onGameFocus:function(){if(this.pauseOnBlur){this.onFocus()}},update:function(time,delta){if(this.unlocked){this.unlocked=false;this.locked=false;this.emit(Events.UNLOCKED,this)}for(var i=this.sounds.length-1;i>=0;i--){if(this.sounds[i].pendingRemove){this.sounds.splice(i,1)}}this.sounds.forEach(function(sound){sound.update(time,delta)})},destroy:function(){this.game.events.off(GameEvents.BLUR,this.onGameBlur,this);this.game.events.off(GameEvents.FOCUS,this.onGameFocus,this);this.game.events.off(GameEvents.PRE_STEP,this.update,this);this.removeAllListeners();this.removeAll();this.sounds.length=0;this.sounds=null;this.game=null},forEachActiveSound:function(callback,scope){var _this=this;this.sounds.forEach(function(sound,index){if(sound&&!sound.pendingRemove){callback.call(scope||_this,sound,index,_this.sounds)}})},setRate:function(value){this.rate=value;return this},rate:{get:function(){return this._rate},set:function(value){this._rate=value;this.forEachActiveSound(function(sound){sound.calculateRate()});this.emit(Events.GLOBAL_RATE,this,value)}},setDetune:function(value){this.detune=value;return this},detune:{get:function(){return this._detune},set:function(value){this._detune=value;this.forEachActiveSound(function(sound){sound.calculateRate()});this.emit(Events.GLOBAL_DETUNE,this,value)}}});module.exports=BaseSoundManager}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(59);var Extend=__webpack_require__(18);var NOOP=__webpack_require__(1);var BaseSound=new Class({Extends:EventEmitter,initialize:function BaseSound(manager,key,config){EventEmitter.call(this);this.manager=manager;this.key=key;this.isPlaying=false;this.isPaused=false;this.totalRate=1;this.duration=this.duration||0;this.totalDuration=this.totalDuration||0;this.config={mute:false,volume:1,rate:1,detune:0,seek:0,loop:false,delay:0};this.currentConfig=this.config;this.config=Extend(this.config,config);this.markers={};this.currentMarker=null;this.pendingRemove=false},addMarker:function(marker){if(!marker||!marker.name||typeof marker.name!=='string'){return false}if(this.markers[marker.name]){console.error('addMarker '+marker.name+' already exists in Sound');return false}marker=Extend(true,{name:'',start:0,duration:this.totalDuration-(marker.start||0),config:{mute:false,volume:1,rate:1,detune:0,seek:0,loop:false,delay:0}},marker);this.markers[marker.name]=marker;return true},updateMarker:function(marker){if(!marker||!marker.name||typeof marker.name!=='string'){return false}if(!this.markers[marker.name]){console.warn('Audio Marker: '+marker.name+' missing in Sound: '+this.key);return false}this.markers[marker.name]=Extend(true,this.markers[marker.name],marker);return true},removeMarker:function(markerName){var marker=this.markers[markerName];if(!marker){return null}this.markers[markerName]=null;return marker},play:function(markerName,config){if(markerName===undefined){markerName=''}if(typeof markerName==='object'){config=markerName;markerName=''}if(typeof markerName!=='string'){return false}if(!markerName){this.currentMarker=null;this.currentConfig=this.config;this.duration=this.totalDuration}else{if(!this.markers[markerName]){console.warn('Marker: '+markerName+' missing in Sound: '+this.key);return false}this.currentMarker=this.markers[markerName];this.currentConfig=this.currentMarker.config;this.duration=this.currentMarker.duration}this.resetConfig();this.currentConfig=Extend(this.currentConfig,config);this.isPlaying=true;this.isPaused=false;return true},pause:function(){if(this.isPaused||!this.isPlaying){return false}this.isPlaying=false;this.isPaused=true;return true},resume:function(){if(!this.isPaused||this.isPlaying){return false}this.isPlaying=true;this.isPaused=false;return true},stop:function(){if(!this.isPaused&&!this.isPlaying){return false}this.isPlaying=false;this.isPaused=false;this.resetConfig();return true},applyConfig:function(){this.mute=this.currentConfig.mute;this.volume=this.currentConfig.volume;this.rate=this.currentConfig.rate;this.detune=this.currentConfig.detune;this.loop=this.currentConfig.loop},resetConfig:function(){this.currentConfig.seek=0;this.currentConfig.delay=0},update:NOOP,calculateRate:function(){var cent=1.0005777895065548;var totalDetune=this.currentConfig.detune+this.manager.detune;var detuneRate=Math.pow(cent,totalDetune);this.totalRate=this.currentConfig.rate*this.manager.rate*detuneRate},destroy:function(){if(this.pendingRemove){return}this.emit(Events.DESTROY,this);this.pendingRemove=true;this.manager=null;this.key='';this.removeAllListeners();this.isPlaying=false;this.isPaused=false;this.config=null;this.currentConfig=null;this.markers=null;this.currentMarker=null}});module.exports=BaseSound}),(function(module,exports,__webpack_require__){var ArrayUtils=__webpack_require__(183);var Class=__webpack_require__(0);var NOOP=__webpack_require__(1);var StableSort=__webpack_require__(131);var List=new Class({initialize:function List(parent){this.parent=parent;this.list=[];this.position=0;this.addCallback=NOOP;this.removeCallback=NOOP;this._sortKey=''},add:function(child,skipCallback){if(skipCallback){return ArrayUtils.Add(this.list,child)}else{return ArrayUtils.Add(this.list,child,0,this.addCallback,this)}},addAt:function(child,index,skipCallback){if(skipCallback){return ArrayUtils.AddAt(this.list,child,index)}else{return ArrayUtils.AddAt(this.list,child,index,0,this.addCallback,this)}},getAt:function(index){return this.list[index]},getIndex:function(child){return this.list.indexOf(child)},sort:function(property,handler){if(!property){return this}if(handler===undefined){handler=function(childA,childB){return childA[property]-childB[property]}}StableSort.inplace(this.list,handler);return this},getByName:function(name){return ArrayUtils.GetFirst(this.list,'name',name)},getRandom:function(startIndex,length){return ArrayUtils.GetRandom(this.list,startIndex,length)},getFirst:function(property,value,startIndex,endIndex){return ArrayUtils.GetFirst(this.list,property,value,startIndex,endIndex)},getAll:function(property,value,startIndex,endIndex){return ArrayUtils.GetAll(this.list,property,value,startIndex,endIndex)},count:function(property,value){return ArrayUtils.CountAllMatching(this.list,property,value)},swap:function(child1,child2){ArrayUtils.Swap(this.list,child1,child2)},moveTo:function(child,index){return ArrayUtils.MoveTo(this.list,child,index)},remove:function(child,skipCallback){if(skipCallback){return ArrayUtils.Remove(this.list,child)}else{return ArrayUtils.Remove(this.list,child,this.removeCallback,this)}},removeAt:function(index,skipCallback){if(skipCallback){return ArrayUtils.RemoveAt(this.list,index)}else{return ArrayUtils.RemoveAt(this.list,index,this.removeCallback,this)}},removeBetween:function(startIndex,endIndex,skipCallback){if(skipCallback){return ArrayUtils.RemoveBetween(this.list,startIndex,endIndex)}else{return ArrayUtils.RemoveBetween(this.list,startIndex,endIndex,this.removeCallback,this)}},removeAll:function(skipCallback){var i=this.list.length;while(i--){this.remove(this.list[i],skipCallback)}return this},bringToTop:function(child){return ArrayUtils.BringToTop(this.list,child)},sendToBack:function(child){return ArrayUtils.SendToBack(this.list,child)},moveUp:function(child){ArrayUtils.MoveUp(this.list,child);return child},moveDown:function(child){ArrayUtils.MoveDown(this.list,child);return child},reverse:function(){this.list.reverse();return this},shuffle:function(){ArrayUtils.Shuffle(this.list);return this},replace:function(oldChild,newChild){return ArrayUtils.Replace(this.list,oldChild,newChild)},exists:function(child){return(this.list.indexOf(child)>-1)},setAll:function(property,value,startIndex,endIndex){ArrayUtils.SetAll(this.list,property,value,startIndex,endIndex);return this},each:function(callback,context){var args=[null];for(var i=2;i<arguments.length;i++){args.push(arguments[i])}for(i=0;i<this.list.length;i++){args[0]=this.list[i];callback.apply(context,args)}},shutdown:function(){this.removeAll();this.list=[]},destroy:function(){this.removeAll();this.parent=null;this.addCallback=null;this.removeCallback=null},length:{get:function(){return this.list.length}},first:{get:function(){this.position=0;if(this.list.length>0){return this.list[0]}else{return null}}},last:{get:function(){if(this.list.length>0){this.position=this.list.length-1;return this.list[this.position]}else{return null}}},next:{get:function(){if(this.position<this.list.length){this.position++;return this.list[this.position]}else{return null}}},previous:{get:function(){if(this.position>0){this.position--;return this.list[this.position]}else{return null}}}});module.exports=List}),(function(module,exports,__webpack_require__){var CheckMatrix=__webpack_require__(184);var TransposeMatrix=__webpack_require__(390);var RotateMatrix=function(matrix,direction){if(direction===undefined){direction=90}if(!CheckMatrix(matrix)){return null}if(typeof direction!=='string'){direction=((direction%360)+360)%360}if(direction===90||direction===-270||direction==='rotateLeft'){matrix=TransposeMatrix(matrix);matrix.reverse()}else if(direction===-90||direction===270||direction==='rotateRight'){matrix.reverse();matrix=TransposeMatrix(matrix)}else if(Math.abs(direction)===180||direction==='rotate180'){for(var i=0;i<matrix.length;i++){matrix[i].reverse()}matrix.reverse()}return matrix};module.exports=RotateMatrix}),(function(module,exports,__webpack_require__){(function(){var stable=function(arr,comp){return exec(arr.slice(),comp)};stable.inplace=function(arr,comp){var result=exec(arr,comp);if(result!==arr){pass(result,null,arr.length,arr)}return arr};function exec(arr,comp){if(typeof(comp)!=='function'){comp=function(a,b){return String(a).localeCompare(b)}}var len=arr.length;if(len<=1){return arr}var buffer=new Array(len);for(var chk=1;chk<len;chk*=2){pass(arr,comp,chk,buffer);var tmp=arr;arr=buffer;buffer=tmp}return arr}var pass=function(arr,comp,chk,result){var len=arr.length;var i=0;var dbl=chk*2;var l,r,e;var li,ri;for(l=0;l<len;l+=dbl){r=l+chk;e=r+chk;if(r>len)r=len;if(e>len)e=len;li=l;ri=r;while(true){if(li<r&&ri<e){if(comp(arr[li],arr[ri])<=0){result[i++]=arr[li++]}else{result[i++]=arr[ri++]}}else if(li<r){result[i++]=arr[li++]}else if(ri<e){result[i++]=arr[ri++]}else{break}}}};if(true){module.exports=stable}else{}})()}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var GetBitmapTextSize=__webpack_require__(945);var ParseFromAtlas=__webpack_require__(946);var ParseXMLBitmapFont=__webpack_require__(187);var Render=__webpack_require__(947);var BitmapText=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.Depth,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Texture,Components.Tint,Components.Transform,Components.Visible,Render],initialize:function BitmapText(scene,x,y,font,text,size,align){if(text===undefined){text=''}if(align===undefined){align=0}GameObject.call(this,scene,'BitmapText');this.font=font;var entry=this.scene.sys.cache.bitmapFont.get(font);this.fontData=entry.data;this._text='';this._fontSize=size||this.fontData.size;this._letterSpacing=0;this._align=align;this._bounds=GetBitmapTextSize();this._dirty=true;this._maxWidth=0;this.wordWrapCharCode=32;this.setTexture(entry.texture,entry.frame);this.setPosition(x,y);this.setOrigin(0,0);this.initPipeline();this.setText(text)},setLeftAlign:function(){this._align=BitmapText.ALIGN_LEFT;this._dirty=true;return this},setCenterAlign:function(){this._align=BitmapText.ALIGN_CENTER;this._dirty=true;return this},setRightAlign:function(){this._align=BitmapText.ALIGN_RIGHT;this._dirty=true;return this},setFontSize:function(size){this._fontSize=size;this._dirty=true;return this},setLetterSpacing:function(spacing){if(spacing===undefined){spacing=0}this._letterSpacing=spacing;this._dirty=true;return this},setText:function(value){if(!value&&value!==0){value=''}if(Array.isArray(value)){value=value.join('\n')}if(value!==this.text){this._text=value.toString();this._dirty=true;this.updateDisplayOrigin()}return this},getTextBounds:function(round){var bounds=this._bounds;if(this._dirty||this.scaleX!==bounds.scaleX||this.scaleY!==bounds.scaleY){GetBitmapTextSize(this,round,bounds);this._dirty=false;this.updateDisplayOrigin()}return bounds},updateDisplayOrigin:function(){this._displayOriginX=this.originX*this.width;this._displayOriginY=this.originY*this.height;this._dirty=true;return this},setFont:function(key,size,align){if(size===undefined){size=this._fontSize}if(align===undefined){align=this._align}if(key!==this.font){var entry=this.scene.sys.cache.bitmapFont.get(key);if(entry){this.font=key;this.fontData=entry.data;this._fontSize=size;this._align=align;this.setTexture(entry.texture,entry.frame);GetBitmapTextSize(this,false,this._bounds)}}return this},setMaxWidth:function(value,wordWrapCharCode){this._maxWidth=value;this._dirty=true;if(wordWrapCharCode!==undefined){this.wordWrapCharCode=wordWrapCharCode}return this},align:{set:function(value){this._align=value;this._dirty=true},get:function(){return this._align}},text:{set:function(value){this.setText(value)},get:function(){return this._text}},fontSize:{set:function(value){this._fontSize=value;this._dirty=true},get:function(){return this._fontSize}},letterSpacing:{set:function(value){this._letterSpacing=value;this._dirty=true},get:function(){return this._letterSpacing}},maxWidth:{set:function(value){this._maxWidth=value;this._dirty=true},get:function(){return this._maxWidth}},width:{get:function(){this.getTextBounds(false);return this._bounds.global.width}},height:{get:function(){this.getTextBounds(false);return this._bounds.global.height}},toJSON:function(){var out=Components.ToJSON(this);var data={font:this.font,text:this.text,fontSize:this.fontSize,letterSpacing:this.letterSpacing,align:this.align};out.data=data;return out}});BitmapText.ALIGN_LEFT=0;BitmapText.ALIGN_CENTER=1;BitmapText.ALIGN_RIGHT=2;BitmapText.ParseFromAtlas=ParseFromAtlas;BitmapText.ParseXMLBitmapFont=ParseXMLBitmapFont;module.exports=BitmapText}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Set=new Class({initialize:function Set(elements){this.entries=[];if(Array.isArray(elements)){for(var i=0;i<elements.length;i++){this.set(elements[i])}}},set:function(value){if(this.entries.indexOf(value)===-1){this.entries.push(value)}return this},get:function(property,value){for(var i=0;i<this.entries.length;i++){var entry=this.entries[i];if(entry[property]===value){return entry}}},getArray:function(){return this.entries.slice(0)},delete:function(value){var index=this.entries.indexOf(value);if(index>-1){this.entries.splice(index,1)}return this},dump:function(){console.group('Set');for(var i=0;i<this.entries.length;i++){var entry=this.entries[i];console.log(entry)}console.groupEnd()},each:function(callback,callbackScope){var i;var temp=this.entries.slice();var len=temp.length;if(callbackScope){for(i=0;i<len;i++){if(callback.call(callbackScope,temp[i],i)===false){break}}}else{for(i=0;i<len;i++){if(callback(temp[i],i)===false){break}}}return this},iterate:function(callback,callbackScope){var i;var len=this.entries.length;if(callbackScope){for(i=0;i<len;i++){if(callback.call(callbackScope,this.entries[i],i)===false){break}}}else{for(i=0;i<len;i++){if(callback(this.entries[i],i)===false){break}}}return this},iterateLocal:function(callbackKey){var i;var args=[];for(i=1;i<arguments.length;i++){args.push(arguments[i])}var len=this.entries.length;for(i=0;i<len;i++){var entry=this.entries[i];entry[callbackKey].apply(entry,args)}return this},clear:function(){this.entries.length=0;return this},contains:function(value){return(this.entries.indexOf(value)>-1)},union:function(set){var newSet=new Set();set.entries.forEach(function(value){newSet.set(value)});this.entries.forEach(function(value){newSet.set(value)});return newSet},intersect:function(set){var newSet=new Set();this.entries.forEach(function(value){if(set.contains(value)){newSet.set(value)}});return newSet},difference:function(set){var newSet=new Set();this.entries.forEach(function(value){if(!set.contains(value)){newSet.set(value)}});return newSet},size:{get:function(){return this.entries.length},set:function(value){if(value<this.entries.length){return this.entries.length=value}else{return this.entries.length}}}});module.exports=Set}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var MeshRender=__webpack_require__(1077);var NOOP=__webpack_require__(1);var Mesh=new Class({Extends:GameObject,Mixins:[Components.BlendMode,Components.Depth,Components.Mask,Components.Pipeline,Components.Size,Components.Texture,Components.Transform,Components.Visible,Components.ScrollFactor,MeshRender],initialize:function Mesh(scene,x,y,vertices,uv,colors,alphas,texture,frame){GameObject.call(this,scene,'Mesh');if(vertices.length!==uv.length){throw new Error('Mesh Vertex count must match UV count')}var verticesUB=(vertices.length/2)|0;if(colors.length>0&&colors.length<verticesUB){throw new Error('Mesh Color count must match Vertex count')}if(alphas.length>0&&alphas.length<verticesUB){throw new Error('Mesh Alpha count must match Vertex count')}var i;if(colors.length===0){for(i=0;i<verticesUB;++i){colors[i]=0xFFFFFF}}if(alphas.length===0){for(i=0;i<verticesUB;++i){alphas[i]=1.0}}this.vertices=new Float32Array(vertices);this.uv=new Float32Array(uv);this.colors=new Uint32Array(colors);this.alphas=new Float32Array(alphas);this.tintFill=false;this.setTexture(texture,frame);this.setPosition(x,y);this.setSizeToFrame();this.initPipeline()},setAlpha:NOOP});module.exports=Mesh}),(function(module,exports){var RectangleToRectangle=function(rectA,rectB){if(rectA.width<=0||rectA.height<=0||rectB.width<=0||rectB.height<=0){return false}return!(rectA.right<rectB.x||rectA.bottom<rectB.y||rectA.x>rectB.right||rectA.y>rectB.bottom)};module.exports=RectangleToRectangle}),(function(module,exports,__webpack_require__){var GetValue=__webpack_require__(6);var inputPlugins={};var InputPluginCache={};InputPluginCache.register=function(key,plugin,mapping,settingsKey,configKey){inputPlugins[key]={plugin:plugin,mapping:mapping,settingsKey:settingsKey,configKey:configKey}};InputPluginCache.getPlugin=function(key){return inputPlugins[key]};InputPluginCache.install=function(target){var sys=target.scene.sys;var settings=sys.settings.input;var config=sys.game.config;for(var key in inputPlugins){var source=inputPlugins[key].plugin;var mapping=inputPlugins[key].mapping;var settingsKey=inputPlugins[key].settingsKey;var configKey=inputPlugins[key].configKey;if(GetValue(settings,settingsKey,config[configKey])){target[mapping]=new source(target)}}};InputPluginCache.remove=function(key){if(inputPlugins.hasOwnProperty(key)){delete inputPlugins[key]}};module.exports=InputPluginCache}),(function(module,exports,__webpack_require__){module.exports={ANY_KEY_DOWN:__webpack_require__(1217),ANY_KEY_UP:__webpack_require__(1218),COMBO_MATCH:__webpack_require__(1219),DOWN:__webpack_require__(1220),KEY_DOWN:__webpack_require__(1221),KEY_UP:__webpack_require__(1222),UP:__webpack_require__(1223)}}),(function(module,exports){var GetURL=function(file,baseURL){if(!file.url){return false}if(file.url.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)){return file.url}else{return baseURL+file.url}};module.exports=GetURL}),(function(module,exports){var XHRSettings=function(responseType,async,user,password,timeout,withCredentials){if(responseType===undefined){responseType=''}if(async===undefined){async=true}if(user===undefined){user=''}if(password===undefined){password=''}if(timeout===undefined){timeout=0}if(withCredentials===undefined){withCredentials=false}return{responseType:responseType,async:async,user:user,password:password,timeout:timeout,headers:undefined,header:undefined,headerValue:undefined,requestedWith:false,overrideMimeType:undefined,withCredentials:withCredentials}};module.exports=XHRSettings}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(217);var Sprite=__webpack_require__(75);var ArcadeSprite=new Class({Extends:Sprite,Mixins:[Components.Acceleration,Components.Angular,Components.Bounce,Components.Debug,Components.Drag,Components.Enable,Components.Friction,Components.Gravity,Components.Immovable,Components.Mass,Components.Size,Components.Velocity],initialize:function ArcadeSprite(scene,x,y,texture,frame){Sprite.call(this,scene,x,y,texture,frame);this.body=null}});module.exports=ArcadeSprite}),(function(module,exports,__webpack_require__){module.exports={CalculateFacesAt:__webpack_require__(220),CalculateFacesWithin:__webpack_require__(51),Copy:__webpack_require__(1313),CreateFromTiles:__webpack_require__(1314),CullTiles:__webpack_require__(1315),Fill:__webpack_require__(1316),FilterTiles:__webpack_require__(1317),FindByIndex:__webpack_require__(1318),FindTile:__webpack_require__(1319),ForEachTile:__webpack_require__(1320),GetTileAt:__webpack_require__(142),GetTileAtWorldXY:__webpack_require__(1321),GetTilesWithin:__webpack_require__(24),GetTilesWithinShape:__webpack_require__(1322),GetTilesWithinWorldXY:__webpack_require__(1323),HasTileAt:__webpack_require__(476),HasTileAtWorldXY:__webpack_require__(1324),IsInLayerBounds:__webpack_require__(101),PutTileAt:__webpack_require__(221),PutTileAtWorldXY:__webpack_require__(1325),PutTilesAt:__webpack_require__(1326),Randomize:__webpack_require__(1327),RemoveTileAt:__webpack_require__(477),RemoveTileAtWorldXY:__webpack_require__(1328),RenderDebug:__webpack_require__(1329),ReplaceByIndex:__webpack_require__(475),SetCollision:__webpack_require__(1330),SetCollisionBetween:__webpack_require__(1331),SetCollisionByExclusion:__webpack_require__(1332),SetCollisionByProperty:__webpack_require__(1333),SetCollisionFromCollisionGroup:__webpack_require__(1334),SetTileIndexCallback:__webpack_require__(1335),SetTileLocationCallback:__webpack_require__(1336),Shuffle:__webpack_require__(1337),SwapByIndex:__webpack_require__(1338),TileToWorldX:__webpack_require__(143),TileToWorldXY:__webpack_require__(1339),TileToWorldY:__webpack_require__(144),WeightedRandomize:__webpack_require__(1340),WorldToTileX:__webpack_require__(63),WorldToTileXY:__webpack_require__(1341),WorldToTileY:__webpack_require__(64)}}),(function(module,exports,__webpack_require__){var IsInLayerBounds=__webpack_require__(101);var GetTileAt=function(tileX,tileY,nonNull,layer){if(nonNull===undefined){nonNull=false}if(IsInLayerBounds(tileX,tileY,layer)){var tile=layer.data[tileY][tileX]||null;if(tile===null){return null}else if(tile.index===-1){return nonNull?tile:null}else{return tile}}else{return null}};module.exports=GetTileAt}),(function(module,exports){var TileToWorldX=function(tileX,camera,layer){var tileWidth=layer.baseTileWidth;var tilemapLayer=layer.tilemapLayer;var layerWorldX=0;if(tilemapLayer){if(camera===undefined){camera=tilemapLayer.scene.cameras.main}layerWorldX=tilemapLayer.x+camera.scrollX*(1-tilemapLayer.scrollFactorX);tileWidth*=tilemapLayer.scaleX}return layerWorldX+tileX*tileWidth};module.exports=TileToWorldX}),(function(module,exports){var TileToWorldY=function(tileY,camera,layer){var tileHeight=layer.baseTileHeight;var tilemapLayer=layer.tilemapLayer;var layerWorldY=0;if(tilemapLayer){if(camera===undefined){camera=tilemapLayer.scene.cameras.main}layerWorldY=(tilemapLayer.y+camera.scrollY*(1-tilemapLayer.scrollFactorY));tileHeight*=tilemapLayer.scaleY}return layerWorldY+tileY*tileHeight};module.exports=TileToWorldY}),(function(module,exports){var GetNewValue=function(source,key,defaultValue){var valueCallback;if(source.hasOwnProperty(key)){var t=typeof(source[key]);if(t==='function'){valueCallback=function(target,targetKey,value,targetIndex,totalTargets,tween){return source[key](target,targetKey,value,targetIndex,totalTargets,tween)}}else{valueCallback=function(){return source[key]}}}else if(typeof defaultValue==='function'){valueCallback=defaultValue}else{valueCallback=function(){return defaultValue}}return valueCallback};module.exports=GetNewValue}),(function(module,exports,__webpack_require__){var Defaults=__webpack_require__(230);var GetAdvancedValue=__webpack_require__(15);var GetBoolean=__webpack_require__(88);var GetEaseFunction=__webpack_require__(69);var GetNewValue=__webpack_require__(145);var GetProps=__webpack_require__(498);var GetTargets=__webpack_require__(228);var GetValue=__webpack_require__(6);var GetValueOp=__webpack_require__(229);var Tween=__webpack_require__(231);var TweenData=__webpack_require__(233);var TweenBuilder=function(parent,config,defaults){if(defaults===undefined){defaults=Defaults}var targets=(defaults.targets)?defaults.targets:GetTargets(config);var props=GetProps(config);var delay=GetNewValue(config,'delay',defaults.delay);var duration=GetNewValue(config,'duration',defaults.duration);var easeParams=GetValue(config,'easeParams',defaults.easeParams);var ease=GetEaseFunction(GetValue(config,'ease',defaults.ease),easeParams);var hold=GetNewValue(config,'hold',defaults.hold);var repeat=GetNewValue(config,'repeat',defaults.repeat);var repeatDelay=GetNewValue(config,'repeatDelay',defaults.repeatDelay);var yoyo=GetBoolean(config,'yoyo',defaults.yoyo);var flipX=GetBoolean(config,'flipX',defaults.flipX);var flipY=GetBoolean(config,'flipY',defaults.flipY);var data=[];for(var p=0;p<props.length;p++){var key=props[p].key;var value=props[p].value;for(var t=0;t<targets.length;t++){var ops=GetValueOp(key,value);var tweenData=TweenData(targets[t],t,key,ops.getEnd,ops.getStart,ops.getActive,GetEaseFunction(GetValue(value,'ease',ease),easeParams),GetNewValue(value,'delay',delay),GetNewValue(value,'duration',duration),GetBoolean(value,'yoyo',yoyo),GetNewValue(value,'hold',hold),GetNewValue(value,'repeat',repeat),GetNewValue(value,'repeatDelay',repeatDelay),GetBoolean(value,'flipX',flipX),GetBoolean(value,'flipY',flipY));data.push(tweenData)}}var tween=new Tween(parent,data,targets);tween.offset=GetAdvancedValue(config,'offset',null);tween.completeDelay=GetAdvancedValue(config,'completeDelay',0);tween.loop=Math.round(GetAdvancedValue(config,'loop',0));tween.loopDelay=Math.round(GetAdvancedValue(config,'loopDelay',0));tween.paused=GetBoolean(config,'paused',false);tween.useFrames=GetBoolean(config,'useFrames',false);var scope=GetValue(config,'callbackScope',tween);var tweenArray=[tween,null];var callbacks=Tween.TYPES;for(var i=0;i<callbacks.length;i++){var type=callbacks[i];var callback=GetValue(config,type,false);if(callback){var callbackScope=GetValue(config,type+'Scope',scope);var callbackParams=GetValue(config,type+'Params',[]);tween.setCallback(type,callback,tweenArray.concat(callbackParams),callbackScope)}}return tween};module.exports=TweenBuilder}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Utils=__webpack_require__(9);var WebGLPipeline=new Class({initialize:function WebGLPipeline(config){this.name='WebGLPipeline';this.game=config.game;this.view=config.game.canvas;this.resolution=1;this.width=0;this.height=0;this.gl=config.gl;this.vertexCount=0;this.vertexCapacity=config.vertexCapacity;this.renderer=config.renderer;this.vertexData=(config.vertices?config.vertices:new ArrayBuffer(config.vertexCapacity*config.vertexSize));this.vertexBuffer=this.renderer.createVertexBuffer((config.vertices?config.vertices:this.vertexData.byteLength),this.gl.STREAM_DRAW);this.program=this.renderer.createProgram(config.vertShader,config.fragShader);this.attributes=config.attributes;this.vertexSize=config.vertexSize;this.topology=config.topology;this.bytes=new Uint8Array(this.vertexData);this.vertexComponentCount=Utils.getComponentCount(config.attributes,this.gl);this.flushLocked=false;this.active=false},boot:function(){},addAttribute:function(name,size,type,normalized,offset){this.attributes.push({name:name,size:size,type:this.renderer.glFormats[type],normalized:normalized,offset:offset});this.vertexComponentCount=Utils.getComponentCount(this.attributes,this.gl);return this},shouldFlush:function(){return(this.vertexCount>=this.vertexCapacity)},resize:function(width,height,resolution){this.width=width*resolution;this.height=height*resolution;this.resolution=resolution;return this},bind:function(){var gl=this.gl;var vertexBuffer=this.vertexBuffer;var attributes=this.attributes;var program=this.program;var renderer=this.renderer;var vertexSize=this.vertexSize;renderer.setProgram(program);renderer.setVertexBuffer(vertexBuffer);for(var index=0;index<attributes.length;++index){var element=attributes[index];var location=gl.getAttribLocation(program,element.name);if(location>=0){gl.enableVertexAttribArray(location);gl.vertexAttribPointer(location,element.size,element.type,element.normalized,vertexSize,element.offset)}else if(location!==-1){gl.disableVertexAttribArray(location)}}return this},onBind:function(){return this},onPreRender:function(){return this},onRender:function(){return this},onPostRender:function(){return this},flush:function(){if(this.flushLocked){return this}this.flushLocked=true;var gl=this.gl;var vertexCount=this.vertexCount;var topology=this.topology;var vertexSize=this.vertexSize;if(vertexCount===0){this.flushLocked=false;return}gl.bufferSubData(gl.ARRAY_BUFFER,0,this.bytes.subarray(0,vertexCount*vertexSize));gl.drawArrays(topology,0,vertexCount);this.vertexCount=0;this.flushLocked=false;return this},destroy:function(){var gl=this.gl;gl.deleteProgram(this.program);gl.deleteBuffer(this.vertexBuffer);delete this.program;delete this.vertexBuffer;delete this.gl;return this},setFloat1:function(name,x){this.renderer.setFloat1(this.program,name,x);return this},setFloat2:function(name,x,y){this.renderer.setFloat2(this.program,name,x,y);return this},setFloat3:function(name,x,y,z){this.renderer.setFloat3(this.program,name,x,y,z);return this},setFloat4:function(name,x,y,z,w){this.renderer.setFloat4(this.program,name,x,y,z,w);return this},setFloat1v:function(name,arr){this.renderer.setFloat1v(this.program,name,arr);return this},setFloat2v:function(name,arr){this.renderer.setFloat2v(this.program,name,arr);return this},setFloat3v:function(name,arr){this.renderer.setFloat3v(this.program,name,arr);return this},setFloat4v:function(name,arr){this.renderer.setFloat4v(this.program,name,arr);return this},setInt1:function(name,x){this.renderer.setInt1(this.program,name,x);return this},setInt2:function(name,x,y){this.renderer.setInt2(this.program,name,x,y);return this},setInt3:function(name,x,y,z){this.renderer.setInt3(this.program,name,x,y,z);return this},setInt4:function(name,x,y,z,w){this.renderer.setInt4(this.program,name,x,y,z,w);return this},setMatrix2:function(name,transpose,matrix){this.renderer.setMatrix2(this.program,name,transpose,matrix);return this},setMatrix3:function(name,transpose,matrix){this.renderer.setMatrix3(this.program,name,transpose,matrix);return this},setMatrix4:function(name,transpose,matrix){this.renderer.setMatrix4(this.program,name,transpose,matrix);return this}});module.exports=WebGLPipeline}),(function(module,exports,__webpack_require__){var Composite={};module.exports=Composite;var Events=__webpack_require__(240);var Common=__webpack_require__(42);var Bounds=__webpack_require__(100);var Body=__webpack_require__(62);(function(){Composite.create=function(options){return Common.extend({id:Common.nextId(),type:'composite',parent:null,isModified:false,bodies:[],constraints:[],composites:[],label:'Composite',plugin:{}},options)};Composite.setModified=function(composite,isModified,updateParents,updateChildren){Events.trigger(composite,'compositeModified',composite);composite.isModified=isModified;if(updateParents&&composite.parent){Composite.setModified(composite.parent,isModified,updateParents,updateChildren)}if(updateChildren){for(var i=0;i<composite.composites.length;i++){var childComposite=composite.composites[i];Composite.setModified(childComposite,isModified,updateParents,updateChildren)}}};Composite.add=function(composite,object){var objects=[].concat(object);Events.trigger(composite,'beforeAdd',{object:object});for(var i=0;i<objects.length;i++){var obj=objects[i];switch(obj.type){case'body':if(obj.parent!==obj){Common.warn('Composite.add: skipped adding a compound body part (you must add its parent instead)');break}Composite.addBody(composite,obj);break;case'constraint':Composite.addConstraint(composite,obj);break;case'composite':Composite.addComposite(composite,obj);break;case'mouseConstraint':Composite.addConstraint(composite,obj.constraint);break}}Events.trigger(composite,'afterAdd',{object:object});return composite};Composite.remove=function(composite,object,deep){var objects=[].concat(object);Events.trigger(composite,'beforeRemove',{object:object});for(var i=0;i<objects.length;i++){var obj=objects[i];switch(obj.type){case'body':Composite.removeBody(composite,obj,deep);break;case'constraint':Composite.removeConstraint(composite,obj,deep);break;case'composite':Composite.removeComposite(composite,obj,deep);break;case'mouseConstraint':Composite.removeConstraint(composite,obj.constraint);break}}Events.trigger(composite,'afterRemove',{object:object});return composite};Composite.addComposite=function(compositeA,compositeB){compositeA.composites.push(compositeB);compositeB.parent=compositeA;Composite.setModified(compositeA,true,true,false);return compositeA};Composite.removeComposite=function(compositeA,compositeB,deep){var position=compositeA.composites.indexOf(compositeB);if(position!==-1){Composite.removeCompositeAt(compositeA,position);Composite.setModified(compositeA,true,true,false)}if(deep){for(var i=0;i<compositeA.composites.length;i++){Composite.removeComposite(compositeA.composites[i],compositeB,true)}}return compositeA};Composite.removeCompositeAt=function(composite,position){composite.composites.splice(position,1);Composite.setModified(composite,true,true,false);return composite};Composite.addBody=function(composite,body){composite.bodies.push(body);Composite.setModified(composite,true,true,false);return composite};Composite.removeBody=function(composite,body,deep){var position=composite.bodies.indexOf(body);if(position!==-1){Composite.removeBodyAt(composite,position);Composite.setModified(composite,true,true,false)}if(deep){for(var i=0;i<composite.composites.length;i++){Composite.removeBody(composite.composites[i],body,true)}}return composite};Composite.removeBodyAt=function(composite,position){composite.bodies.splice(position,1);Composite.setModified(composite,true,true,false);return composite};Composite.addConstraint=function(composite,constraint){composite.constraints.push(constraint);Composite.setModified(composite,true,true,false);return composite};Composite.removeConstraint=function(composite,constraint,deep){var position=composite.constraints.indexOf(constraint);if(position!==-1){Composite.removeConstraintAt(composite,position)}if(deep){for(var i=0;i<composite.composites.length;i++){Composite.removeConstraint(composite.composites[i],constraint,true)}}return composite};Composite.removeConstraintAt=function(composite,position){composite.constraints.splice(position,1);Composite.setModified(composite,true,true,false);return composite};Composite.clear=function(composite,keepStatic,deep){if(deep){for(var i=0;i<composite.composites.length;i++){Composite.clear(composite.composites[i],keepStatic,true)}}if(keepStatic){composite.bodies=composite.bodies.filter(function(body){return body.isStatic})}else{composite.bodies.length=0}composite.constraints.length=0;composite.composites.length=0;Composite.setModified(composite,true,true,false);return composite};Composite.allBodies=function(composite){var bodies=[].concat(composite.bodies);for(var i=0;i<composite.composites.length;i++)bodies=bodies.concat(Composite.allBodies(composite.composites[i]));return bodies};Composite.allConstraints=function(composite){var constraints=[].concat(composite.constraints);for(var i=0;i<composite.composites.length;i++)constraints=constraints.concat(Composite.allConstraints(composite.composites[i]));return constraints};Composite.allComposites=function(composite){var composites=[].concat(composite.composites);for(var i=0;i<composite.composites.length;i++)composites=composites.concat(Composite.allComposites(composite.composites[i]));return composites};Composite.get=function(composite,id,type){var objects,object;switch(type){case'body':objects=Composite.allBodies(composite);break;case'constraint':objects=Composite.allConstraints(composite);break;case'composite':objects=Composite.allComposites(composite).concat(composite);break}if(!objects)return null;object=objects.filter(function(object){return object.id.toString()===id.toString()});return object.length===0?null:object[0]};Composite.move=function(compositeA,objects,compositeB){Composite.remove(compositeA,objects);Composite.add(compositeB,objects);return compositeA};Composite.rebase=function(composite){var objects=Composite.allBodies(composite).concat(Composite.allConstraints(composite)).concat(Composite.allComposites(composite));for(var i=0;i<objects.length;i++){objects[i].id=Common.nextId()}Composite.setModified(composite,true,true,false);return composite};Composite.translate=function(composite,translation,recursive){var bodies=recursive?Composite.allBodies(composite):composite.bodies;for(var i=0;i<bodies.length;i++){Body.translate(bodies[i],translation)}Composite.setModified(composite,true,true,false);return composite};Composite.rotate=function(composite,rotation,point,recursive){var cos=Math.cos(rotation),sin=Math.sin(rotation),bodies=recursive?Composite.allBodies(composite):composite.bodies;for(var i=0;i<bodies.length;i++){var body=bodies[i],dx=body.position.x-point.x,dy=body.position.y-point.y;Body.setPosition(body,{x:point.x+(dx*cos-dy*sin),y:point.y+(dx*sin+dy*cos)});Body.rotate(body,rotation)}Composite.setModified(composite,true,true,false);return composite};Composite.scale=function(composite,scaleX,scaleY,point,recursive){var bodies=recursive?Composite.allBodies(composite):composite.bodies;for(var i=0;i<bodies.length;i++){var body=bodies[i],dx=body.position.x-point.x,dy=body.position.y-point.y;Body.setPosition(body,{x:point.x+dx*scaleX,y:point.y+dy*scaleY});Body.scale(body,scaleX,scaleY)}Composite.setModified(composite,true,true,false);return composite};Composite.bounds=function(composite){var bodies=Composite.allBodies(composite),vertices=[];for(var i=0;i<bodies.length;i+=1){var body=bodies[i];vertices.push(body.bounds.min,body.bounds.max)}return Bounds.create(vertices)}})()}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var CircumferencePoint=function(circle,angle,out){if(out===undefined){out=new Point()}out.x=circle.x+(circle.radius*Math.cos(angle));out.y=circle.y+(circle.radius*Math.sin(angle));return out};module.exports=CircumferencePoint}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Random=function(circle,out){if(out===undefined){out=new Point()}var t=2*Math.PI*Math.random();var u=Math.random()+Math.random();var r=(u>1)?2-u:u;var x=r*Math.cos(t);var y=r*Math.sin(t);out.x=circle.x+(x*circle.radius);out.y=circle.y+(y*circle.radius);return out};module.exports=Random}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(111);var FindClosestInSorted=__webpack_require__(270);var Frame=__webpack_require__(271);var GetValue=__webpack_require__(6);var Animation=new Class({Extends:EventEmitter,initialize:function Animation(manager,key,config){EventEmitter.call(this);this.manager=manager;this.key=key;this.type='frame';this.frames=this.getFrames(manager.textureManager,GetValue(config,'frames',[]),GetValue(config,'defaultTextureKey',null));this.frameRate=GetValue(config,'frameRate',null);this.duration=GetValue(config,'duration',null);if(this.duration===null&&this.frameRate===null){this.frameRate=24;this.duration=(this.frameRate/this.frames.length)*1000}else if(this.duration&&this.frameRate===null){this.frameRate=this.frames.length/(this.duration/1000)}else{this.duration=(this.frames.length/this.frameRate)*1000}this.msPerFrame=1000/this.frameRate;this.skipMissedFrames=GetValue(config,'skipMissedFrames',true);this.delay=GetValue(config,'delay',0);this.repeat=GetValue(config,'repeat',0);this.repeatDelay=GetValue(config,'repeatDelay',0);this.yoyo=GetValue(config,'yoyo',false);this.showOnStart=GetValue(config,'showOnStart',false);this.hideOnComplete=GetValue(config,'hideOnComplete',false);this.paused=false;this.manager.on(Events.PAUSE_ALL,this.pause,this);this.manager.on(Events.RESUME_ALL,this.resume,this)},addFrame:function(config){return this.addFrameAt(this.frames.length,config)},addFrameAt:function(index,config){var newFrames=this.getFrames(this.manager.textureManager,config);if(newFrames.length>0){if(index===0){this.frames=newFrames.concat(this.frames)}else if(index===this.frames.length){this.frames=this.frames.concat(newFrames)}else{var pre=this.frames.slice(0,index);var post=this.frames.slice(index);this.frames=pre.concat(newFrames,post)}this.updateFrameSequence()}return this},checkFrame:function(index){return(index>=0&&index<this.frames.length)},completeAnimation:function(component){if(this.hideOnComplete){component.parent.visible=false}component.stop()},getFirstTick:function(component,includeDelay){if(includeDelay===undefined){includeDelay=true}component.accumulator=0;component.nextTick=component.msPerFrame+component.currentFrame.duration;if(includeDelay){component.nextTick+=component._delay}},getFrameAt:function(index){return this.frames[index]},getFrames:function(textureManager,frames,defaultTextureKey){var out=[];var prev;var animationFrame;var index=1;var i;var textureKey;if(typeof frames==='string'){textureKey=frames;var texture=textureManager.get(textureKey);var frameKeys=texture.getFrameNames();frames=[];frameKeys.forEach(function(idx,value){frames.push({key:textureKey,frame:value})})}if(!Array.isArray(frames)||frames.length===0){return out}for(i=0;i<frames.length;i++){var item=frames[i];var key=GetValue(item,'key',defaultTextureKey);if(!key){continue}var frame=GetValue(item,'frame',0);var textureFrame=textureManager.getFrame(key,frame);animationFrame=new Frame(key,frame,index,textureFrame);animationFrame.duration=GetValue(item,'duration',0);animationFrame.isFirst=(!prev);if(prev){prev.nextFrame=animationFrame;animationFrame.prevFrame=prev}out.push(animationFrame);prev=animationFrame;index++}if(out.length>0){animationFrame.isLast=true;animationFrame.nextFrame=out[0];out[0].prevFrame=animationFrame;var slice=1/(out.length-1);for(i=0;i<out.length;i++){out[i].progress=i*slice}}return out},getNextTick:function(component){component.accumulator-=component.nextTick;component.nextTick=component.msPerFrame+component.currentFrame.duration},load:function(component,startFrame){if(startFrame>=this.frames.length){startFrame=0}if(component.currentAnim!==this){component.currentAnim=this;component.frameRate=this.frameRate;component.duration=this.duration;component.msPerFrame=this.msPerFrame;component.skipMissedFrames=this.skipMissedFrames;component._delay=this.delay;component._repeat=this.repeat;component._repeatDelay=this.repeatDelay;component._yoyo=this.yoyo}var frame=this.frames[startFrame];if(startFrame===0&&!component.forward){frame=this.getLastFrame()}component.updateFrame(frame)},getFrameByProgress:function(value){value=Clamp(value,0,1);return FindClosestInSorted(value,this.frames,'progress')},nextFrame:function(component){var frame=component.currentFrame;if(frame.isLast){if(component._yoyo){this.handleYoyoFrame(component,false)}else if(component.repeatCounter>0){if(component._reverse&&component.forward){component.forward=false}else{this.repeatAnimation(component)}}else{this.completeAnimation(component)}}else{this.updateAndGetNextTick(component,frame.nextFrame)}},handleYoyoFrame:function(component,isReverse){if(!isReverse){isReverse=false}if(component._reverse===!isReverse&&component.repeatCounter>0){if(!component._repeatDelay||component.pendingRepeat){component.forward=isReverse}this.repeatAnimation(component);return}if(component._reverse!==isReverse&&component.repeatCounter===0){this.completeAnimation(component);return}component.forward=isReverse;var frame=(isReverse)?component.currentFrame.nextFrame:component.currentFrame.prevFrame;this.updateAndGetNextTick(component,frame)},getLastFrame:function(){return this.frames[this.frames.length-1]},previousFrame:function(component){var frame=component.currentFrame;if(frame.isFirst){if(component._yoyo){this.handleYoyoFrame(component,true)}else if(component.repeatCounter>0){if(component._reverse&&!component.forward){component.currentFrame=this.getLastFrame();this.repeatAnimation(component)}else{component.forward=true;this.repeatAnimation(component)}}else{this.completeAnimation(component)}}else{this.updateAndGetNextTick(component,frame.prevFrame)}},updateAndGetNextTick:function(component,frame){component.updateFrame(frame);this.getNextTick(component)},removeFrame:function(frame){var index=this.frames.indexOf(frame);if(index!==-1){this.removeFrameAt(index)}return this},removeFrameAt:function(index){this.frames.splice(index,1);this.updateFrameSequence();return this},repeatAnimation:function(component){if(component._pendingStop===2){return this.completeAnimation(component)}if(component._repeatDelay>0&&component.pendingRepeat===false){component.pendingRepeat=true;component.accumulator-=component.nextTick;component.nextTick+=component._repeatDelay}else{component.repeatCounter--;component.updateFrame(component.currentFrame[(component.forward)?'nextFrame':'prevFrame']);if(component.isPlaying){this.getNextTick(component);component.pendingRepeat=false;var frame=component.currentFrame;var parent=component.parent;this.emit(Events.ANIMATION_REPEAT,this,frame);parent.emit(Events.SPRITE_ANIMATION_KEY_REPEAT+this.key,this,frame,component.repeatCounter,parent);parent.emit(Events.SPRITE_ANIMATION_REPEAT,this,frame,component.repeatCounter,parent)}}},setFrame:function(component){if(component.forward){this.nextFrame(component)}else{this.previousFrame(component)}},toJSON:function(){var output={key:this.key,type:this.type,frames:[],frameRate:this.frameRate,duration:this.duration,skipMissedFrames:this.skipMissedFrames,delay:this.delay,repeat:this.repeat,repeatDelay:this.repeatDelay,yoyo:this.yoyo,showOnStart:this.showOnStart,hideOnComplete:this.hideOnComplete};this.frames.forEach(function(frame){output.frames.push(frame.toJSON())});return output},updateFrameSequence:function(){var len=this.frames.length;var slice=1/(len-1);var frame;for(var i=0;i<len;i++){frame=this.frames[i];frame.index=i+1;frame.isFirst=false;frame.isLast=false;frame.progress=i*slice;if(i===0){frame.isFirst=true;if(len===1){frame.isLast=true;frame.nextFrame=frame;frame.prevFrame=frame}else{frame.isLast=false;frame.prevFrame=this.frames[len-1];frame.nextFrame=this.frames[i+1]}}else if(i===len-1&&len>1){frame.isLast=true;frame.prevFrame=this.frames[len-2];frame.nextFrame=this.frames[0]}else if(len>1){frame.prevFrame=this.frames[i-1];frame.nextFrame=this.frames[i+1]}}return this},pause:function(){this.paused=true;return this},resume:function(){this.paused=false;return this},destroy:function(){this.removeAllListeners();this.manager.off(Events.PAUSE_ALL,this.pause,this);this.manager.off(Events.RESUME_ALL,this.resume,this);this.manager.remove(this.key);for(var i=0;i<this.frames.length;i++){this.frames[i].destroy()}this.frames=[];this.manager=null}});module.exports=Animation}),(function(module,exports,__webpack_require__){var Perimeter=__webpack_require__(112);var Point=__webpack_require__(4);var GetPoint=function(rectangle,position,out){if(out===undefined){out=new Point()}if(position<=0||position>=1){out.x=rectangle.x;out.y=rectangle.y;return out}var p=Perimeter(rectangle)*position;if(position>0.5){p-=(rectangle.width+rectangle.height);if(p<=rectangle.width){out.x=rectangle.right-p;out.y=rectangle.bottom}else{out.x=rectangle.x;out.y=rectangle.bottom-(p-rectangle.width)}}else if(p<=rectangle.width){out.x=rectangle.x+p;out.y=rectangle.y}else{out.x=rectangle.right;out.y=rectangle.y+(p-rectangle.width)}return out};module.exports=GetPoint}),(function(module,exports,__webpack_require__){var Length=__webpack_require__(57);var Point=__webpack_require__(4);var GetPoints=function(line,quantity,stepRate,out){if(out===undefined){out=[]}if(!quantity&&stepRate>0){quantity=Length(line)/stepRate}var x1=line.x1;var y1=line.y1;var x2=line.x2;var y2=line.y2;for(var i=0;i<quantity;i++){var position=i/quantity;var x=x1+(x2-x1)*position;var y=y1+(y2-y1)*position;out.push(new Point(x,y))}return out};module.exports=GetPoints}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Random=function(line,out){if(out===undefined){out=new Point()}var t=Math.random();out.x=line.x1+t*(line.x2-line.x1);out.y=line.y1+t*(line.y2-line.y1);return out};module.exports=Random}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Random=function(rect,out){if(out===undefined){out=new Point()}out.x=rect.x+(Math.random()*rect.width);out.y=rect.y+(Math.random()*rect.height);return out};module.exports=Random}),(function(module,exports){var Pipeline={defaultPipeline:null,pipeline:null,initPipeline:function(pipelineName){if(pipelineName===undefined){pipelineName='TextureTintPipeline'}var renderer=this.scene.sys.game.renderer;if(renderer&&renderer.gl&&renderer.hasPipeline(pipelineName)){this.defaultPipeline=renderer.getPipeline(pipelineName);this.pipeline=this.defaultPipeline;return true}return false},setPipeline:function(pipelineName){var renderer=this.scene.sys.game.renderer;if(renderer&&renderer.gl&&renderer.hasPipeline(pipelineName)){this.pipeline=renderer.getPipeline(pipelineName)}return this},resetPipeline:function(){this.pipeline=this.defaultPipeline;return(this.pipeline!==null)},getPipelineName:function(){return this.pipeline.name}};module.exports=Pipeline}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Random=function(ellipse,out){if(out===undefined){out=new Point()}var p=Math.random()*Math.PI*2;var s=Math.sqrt(Math.random());out.x=ellipse.x+((s*Math.cos(p))*ellipse.width/2);out.y=ellipse.y+((s*Math.sin(p))*ellipse.height/2);return out};module.exports=Random}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Random=function(triangle,out){if(out===undefined){out=new Point()}var ux=triangle.x2-triangle.x1;var uy=triangle.y2-triangle.y1;var vx=triangle.x3-triangle.x1;var vy=triangle.y3-triangle.y1;var r=Math.random();var s=Math.random();if(r+s>=1){r=1-r;s=1-s}out.x=triangle.x1+((ux*r)+(vx*s));out.y=triangle.y1+((uy*r)+(vy*s));return out};module.exports=Random}),(function(module,exports){var RotateAroundDistance=function(point,x,y,angle,distance){var t=angle+Math.atan2(point.y-y,point.x-x);point.x=x+(distance*Math.cos(t));point.y=y+(distance*Math.sin(t));return point};module.exports=RotateAroundDistance}),(function(module,exports){var SmootherStep=function(x,min,max){x=Math.max(0,Math.min(1,(x-min)/(max-min)));return x*x*x*(x*(x*6-15)+10)};module.exports=SmootherStep}),(function(module,exports){var SmoothStep=function(x,min,max){if(x<=min){return 0}if(x>=max){return 1}x=(x-min)/(max-min);return x*x*(3-2*x)};module.exports=SmoothStep}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Map=new Class({initialize:function Map(elements){this.entries={};this.size=0;if(Array.isArray(elements)){for(var i=0;i<elements.length;i++){this.set(elements[i][0],elements[i][1])}}},set:function(key,value){if(!this.has(key)){this.size++}this.entries[key]=value;return this},get:function(key){if(this.has(key)){return this.entries[key]}},getArray:function(){var output=[];var entries=this.entries;for(var key in entries){output.push(entries[key])}return output},has:function(key){return(this.entries.hasOwnProperty(key))},delete:function(key){if(this.has(key)){delete this.entries[key];this.size--}return this},clear:function(){Object.keys(this.entries).forEach(function(prop){delete this.entries[prop]},this);this.size=0;return this},keys:function(){return Object.keys(this.entries)},values:function(){var output=[];var entries=this.entries;for(var key in entries){output.push(entries[key])}return output},dump:function(){var entries=this.entries;console.group('Map');for(var key in entries){console.log(key,entries[key])}console.groupEnd()},each:function(callback){var entries=this.entries;for(var key in entries){if(callback(key,entries[key])===false){break}}return this},contains:function(value){var entries=this.entries;for(var key in entries){if(entries[key]===value){return true}}return false},merge:function(map,override){if(override===undefined){override=false}var local=this.entries;var source=map.entries;for(var key in source){if(local.hasOwnProperty(key)&&override){local[key]=source[key]}else{this.set(key,source[key])}}return this}});module.exports=Map}),(function(module,exports){var Pad=function(str,len,pad,dir){if(len===undefined){len=0}if(pad===undefined){pad=' '}if(dir===undefined){dir=3}str=str.toString();var padlen=0;if(len+1>=str.length){switch(dir){case 1:str=new Array(len+1-str.length).join(pad)+str;break;case 3:var right=Math.ceil((padlen=len-str.length)/2);var left=padlen-right;str=new Array(left+1).join(pad)+str+new Array(right+1).join(pad);break;default:str=str+new Array(len+1-str.length).join(pad);break}}return str};module.exports=Pad}),(function(module,exports,__webpack_require__){var HexStringToColor=__webpack_require__(294);var IntegerToColor=__webpack_require__(297);var ObjectToColor=__webpack_require__(299);var RGBStringToColor=__webpack_require__(300);var ValueToColor=function(input){var t=typeof input;switch(t){case'string':if(input.substr(0,3).toLowerCase()==='rgb'){return RGBStringToColor(input)}else{return HexStringToColor(input)}case'number':return IntegerToColor(input);case'object':return ObjectToColor(input)}};module.exports=ValueToColor}),(function(module,exports){var GetColor=function(red,green,blue){return red<<16|green<<8|blue};module.exports=GetColor}),(function(module,exports,__webpack_require__){var GetColor=__webpack_require__(165);var HSVToRGB=function(h,s,v,out){if(s===undefined){s=1}if(v===undefined){v=1}var i=Math.floor(h*6);var f=h*6-i;var p=Math.floor((v*(1-s))*255);var q=Math.floor((v*(1-f*s))*255);var t=Math.floor((v*(1-(1-f)*s))*255);v=Math.floor(v*=255);var r=v;var g=v;var b=v;var c=i%6;if(c===0){g=t;b=p}else if(c===1){r=q;b=p}else if(c===2){r=p;b=t}else if(c===3){r=p;g=q}else if(c===4){r=t;g=p}else if(c===5){g=p;b=q}if(!out){return{r:r,g:g,b:b,color:GetColor(r,g,b)}}else if(out.setTo){return out.setTo(r,g,b,out.alpha,false)}else{out.r=r;out.g=g;out.b=b;out.color=GetColor(r,g,b);return out}};module.exports=HSVToRGB}),(function(module,exports){var prefix='';var Smoothing=function(){var getPrefix=function(context){var vendors=['i','webkitI','msI','mozI','oI'];for(var i=0;i<vendors.length;i++){var s=vendors[i]+'mageSmoothingEnabled';if(s in context){return s}}return null};var enable=function(context){if(prefix===''){prefix=getPrefix(context)}if(prefix){context[prefix]=true}return context};var disable=function(context){if(prefix===''){prefix=getPrefix(context)}if(prefix){context[prefix]=false}return context};var isEnabled=function(context){return(prefix!==null)?context[prefix]:null};return{disable:disable,enable:enable,getPrefix:getPrefix,isEnabled:isEnabled}};module.exports=Smoothing()}),(function(module,exports){var CenterOn=function(rect,x,y){rect.x=x-(rect.width/2);rect.y=y-(rect.height/2);return rect};module.exports=CenterOn}),(function(module,exports,__webpack_require__){var OS=__webpack_require__(117);var Browser=__webpack_require__(118);var CanvasPool=__webpack_require__(26);var Features={canvas:false,canvasBitBltShift:null,file:false,fileSystem:false,getUserMedia:true,littleEndian:false,localStorage:false,pointerLock:false,support32bit:false,vibration:false,webGL:false,worker:false};function checkIsLittleEndian(){var a=new ArrayBuffer(4);var b=new Uint8Array(a);var c=new Uint32Array(a);b[0]=0xa1;b[1]=0xb2;b[2]=0xc3;b[3]=0xd4;if(c[0]===0xd4c3b2a1){return true}if(c[0]===0xa1b2c3d4){return false}else{return null}}function init(){Features.canvas=!!window['CanvasRenderingContext2D'];try{Features.localStorage=!!localStorage.getItem}catch(error){Features.localStorage=false}Features.file=!!window['File']&&!!window['FileReader']&&!!window['FileList']&&!!window['Blob'];Features.fileSystem=!!window['requestFileSystem'];var isUint8=false;var testWebGL=function(){if(window['WebGLRenderingContext']){try{var canvas=CanvasPool.createWebGL(this);var ctx=canvas.getContext('webgl')||canvas.getContext('experimental-webgl');var canvas2D=CanvasPool.create2D(this);var ctx2D=canvas2D.getContext('2d');var image=ctx2D.createImageData(1,1);isUint8=image.data instanceof Uint8ClampedArray;CanvasPool.remove(canvas);CanvasPool.remove(canvas2D);return!!ctx}catch(e){return false}}return false};Features.webGL=testWebGL();Features.worker=!!window['Worker'];Features.pointerLock='pointerLockElement'in document||'mozPointerLockElement'in document||'webkitPointerLockElement'in document;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;Features.getUserMedia=Features.getUserMedia&&!!navigator.getUserMedia&&!!window.URL;if(Browser.firefox&&Browser.firefoxVersion<21){Features.getUserMedia=false}if(!OS.iOS&&(Browser.ie||Browser.firefox||Browser.chrome)){Features.canvasBitBltShift=true}if(Browser.safari||Browser.mobileSafari){Features.canvasBitBltShift=false}navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate;if(navigator.vibrate){Features.vibration=true}if(typeof ArrayBuffer!=='undefined'&&typeof Uint8Array!=='undefined'&&typeof Uint32Array!=='undefined'){Features.littleEndian=checkIsLittleEndian()}Features.support32bit=(typeof ArrayBuffer!=='undefined'&&typeof Uint8ClampedArray!=='undefined'&&typeof Int32Array!=='undefined'&&Features.littleEndian!==null&&isUint8);return Features}module.exports=init()}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(13);var Extend=__webpack_require__(18);var PhaserMath={Angle:__webpack_require__(734),Distance:__webpack_require__(743),Easing:__webpack_require__(748),Fuzzy:__webpack_require__(749),Interpolation:__webpack_require__(752),Pow2:__webpack_require__(757),Snap:__webpack_require__(759),RandomDataGenerator:__webpack_require__(761),Average:__webpack_require__(762),Bernstein:__webpack_require__(324),Between:__webpack_require__(172),CatmullRom:__webpack_require__(171),CeilTo:__webpack_require__(763),Clamp:__webpack_require__(19),DegToRad:__webpack_require__(39),Difference:__webpack_require__(764),Factorial:__webpack_require__(325),FloatBetween:__webpack_require__(119),FloorTo:__webpack_require__(765),FromPercent:__webpack_require__(87),GetSpeed:__webpack_require__(766),IsEven:__webpack_require__(767),IsEvenStrict:__webpack_require__(768),Linear:__webpack_require__(116),MaxAdd:__webpack_require__(769),MinSub:__webpack_require__(770),Percent:__webpack_require__(771),RadToDeg:__webpack_require__(173),RandomXY:__webpack_require__(772),RandomXYZ:__webpack_require__(773),RandomXYZW:__webpack_require__(774),Rotate:__webpack_require__(331),RotateAround:__webpack_require__(276),RotateAroundDistance:__webpack_require__(159),RotateTo:__webpack_require__(775),RoundAwayFromZero:__webpack_require__(332),RoundTo:__webpack_require__(776),SinCosTableGenerator:__webpack_require__(777),SmootherStep:__webpack_require__(160),SmoothStep:__webpack_require__(161),ToXY:__webpack_require__(778),TransformXY:__webpack_require__(333),Within:__webpack_require__(779),Wrap:__webpack_require__(58),Vector2:__webpack_require__(3),Vector3:__webpack_require__(174),Vector4:__webpack_require__(334),Matrix3:__webpack_require__(335),Matrix4:__webpack_require__(336),Quaternion:__webpack_require__(337),RotateVec3:__webpack_require__(780)};PhaserMath=Extend(false,PhaserMath,CONST);module.exports=PhaserMath}),(function(module,exports){var CatmullRom=function(t,p0,p1,p2,p3){var v0=(p2-p0)*0.5;var v1=(p3-p1)*0.5;var t2=t*t;var t3=t*t2;return(2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1};module.exports=CatmullRom}),(function(module,exports){var Between=function(min,max){return Math.floor(Math.random()*(max-min+1)+min)};module.exports=Between}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(13);var RadToDeg=function(radians){return radians*CONST.RAD_TO_DEG};module.exports=RadToDeg}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Vector3=new Class({initialize:function Vector3(x,y,z){this.x=0;this.y=0;this.z=0;if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0}else{this.x=x||0;this.y=y||0;this.z=z||0}},up:function(){this.x=0;this.y=1;this.z=0;return this},clone:function(){return new Vector3(this.x,this.y,this.z)},crossVectors:function(a,b){var ax=a.x;var ay=a.y;var az=a.z;var bx=b.x;var by=b.y;var bz=b.z;this.x=ay*bz-az*by;this.y=az*bx-ax*bz;this.z=ax*by-ay*bx;return this},equals:function(v){return((this.x===v.x)&&(this.y===v.y)&&(this.z===v.z))},copy:function(src){this.x=src.x;this.y=src.y;this.z=src.z||0;return this},set:function(x,y,z){if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0}else{this.x=x||0;this.y=y||0;this.z=z||0}return this},add:function(v){this.x+=v.x;this.y+=v.y;this.z+=v.z||0;return this},subtract:function(v){this.x-=v.x;this.y-=v.y;this.z-=v.z||0;return this},multiply:function(v){this.x*=v.x;this.y*=v.y;this.z*=v.z||1;return this},scale:function(scale){if(isFinite(scale)){this.x*=scale;this.y*=scale;this.z*=scale}else{this.x=0;this.y=0;this.z=0}return this},divide:function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z||1;return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},distance:function(v){var dx=v.x-this.x;var dy=v.y-this.y;var dz=v.z-this.z||0;return Math.sqrt(dx*dx+dy*dy+dz*dz)},distanceSq:function(v){var dx=v.x-this.x;var dy=v.y-this.y;var dz=v.z-this.z||0;return dx*dx+dy*dy+dz*dz},length:function(){var x=this.x;var y=this.y;var z=this.z;return Math.sqrt(x*x+y*y+z*z)},lengthSq:function(){var x=this.x;var y=this.y;var z=this.z;return x*x+y*y+z*z},normalize:function(){var x=this.x;var y=this.y;var z=this.z;var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);this.x=x*len;this.y=y*len;this.z=z*len}return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},cross:function(v){var ax=this.x;var ay=this.y;var az=this.z;var bx=v.x;var by=v.y;var bz=v.z;this.x=ay*bz-az*by;this.y=az*bx-ax*bz;this.z=ax*by-ay*bx;return this},lerp:function(v,t){if(t===undefined){t=0}var ax=this.x;var ay=this.y;var az=this.z;this.x=ax+t*(v.x-ax);this.y=ay+t*(v.y-ay);this.z=az+t*(v.z-az);return this},transformMat3:function(mat){var x=this.x;var y=this.y;var z=this.z;var m=mat.val;this.x=x*m[0]+y*m[3]+z*m[6];this.y=x*m[1]+y*m[4]+z*m[7];this.z=x*m[2]+y*m[5]+z*m[8];return this},transformMat4:function(mat){var x=this.x;var y=this.y;var z=this.z;var m=mat.val;this.x=m[0]*x+m[4]*y+m[8]*z+m[12];this.y=m[1]*x+m[5]*y+m[9]*z+m[13];this.z=m[2]*x+m[6]*y+m[10]*z+m[14];return this},transformCoordinates:function(mat){var x=this.x;var y=this.y;var z=this.z;var m=mat.val;var tx=(x*m[0])+(y*m[4])+(z*m[8])+m[12];var ty=(x*m[1])+(y*m[5])+(z*m[9])+m[13];var tz=(x*m[2])+(y*m[6])+(z*m[10])+m[14];var tw=(x*m[3])+(y*m[7])+(z*m[11])+m[15];this.x=tx/tw;this.y=ty/tw;this.z=tz/tw;return this},transformQuat:function(q){var x=this.x;var y=this.y;var z=this.z;var qx=q.x;var qy=q.y;var qz=q.z;var qw=q.w;var ix=qw*x+qy*z-qz*y;var iy=qw*y+qz*x-qx*z;var iz=qw*z+qx*y-qy*x;var iw=-qx*x-qy*y-qz*z;this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;return this},project:function(mat){var x=this.x;var y=this.y;var z=this.z;var m=mat.val;var a00=m[0];var a01=m[1];var a02=m[2];var a03=m[3];var a10=m[4];var a11=m[5];var a12=m[6];var a13=m[7];var a20=m[8];var a21=m[9];var a22=m[10];var a23=m[11];var a30=m[12];var a31=m[13];var a32=m[14];var a33=m[15];var lw=1/(x*a03+y*a13+z*a23+a33);this.x=(x*a00+y*a10+z*a20+a30)*lw;this.y=(x*a01+y*a11+z*a21+a31)*lw;this.z=(x*a02+y*a12+z*a22+a32)*lw;return this},unproject:function(viewport,invProjectionView){var viewX=viewport.x;var viewY=viewport.y;var viewWidth=viewport.z;var viewHeight=viewport.w;var x=this.x-viewX;var y=(viewHeight-this.y-1)-viewY;var z=this.z;this.x=(2*x)/viewWidth-1;this.y=(2*y)/viewHeight-1;this.z=2*z-1;return this.project(invProjectionView)},reset:function(){this.x=0;this.y=0;this.z=0;return this}});Vector3.ZERO=new Vector3();Vector3.RIGHT=new Vector3(1,0,0);Vector3.LEFT=new Vector3(-1,0,0);Vector3.UP=new Vector3(0,-1,0);Vector3.DOWN=new Vector3(0,1,0);Vector3.FORWARD=new Vector3(0,0,1);Vector3.BACK=new Vector3(0,0,-1);Vector3.ONE=new Vector3(1,1,1);module.exports=Vector3}),(function(module,exports,__webpack_require__){var DefaultPlugins={Global:['game','anims','cache','plugins','registry','scale','sound','textures'],CoreScene:['EventEmitter','CameraManager','GameObjectCreator','GameObjectFactory','ScenePlugin','DisplayList','UpdateList'],DefaultScene:['Clock','DataManagerPlugin','InputPlugin','Loader','TweenManager','LightsPlugin']};if(false){}if(false){}module.exports=DefaultPlugins}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var MATH_CONST=__webpack_require__(13);var FromPoints=function(points,out){if(out===undefined){out=new Rectangle()}if(points.length===0){return out}var minX=Number.MAX_VALUE;var minY=Number.MAX_VALUE;var maxX=MATH_CONST.MIN_SAFE_INTEGER;var maxY=MATH_CONST.MIN_SAFE_INTEGER;var p;var px;var py;for(var i=0;i<points.length;i++){p=points[i];if(Array.isArray(p)){px=p[0];py=p[1]}else{px=p.x;py=p.y}minX=Math.min(minX,px);minY=Math.min(minY,py);maxX=Math.max(maxX,px);maxY=Math.max(maxY,py)}out.x=minX;out.y=minY;out.width=maxX-minX;out.height=maxY-minY;return out};module.exports=FromPoints}),(function(module,exports,__webpack_require__){var CONST={CENTER:__webpack_require__(359),ORIENTATION:__webpack_require__(360),SCALE_MODE:__webpack_require__(361),ZOOM:__webpack_require__(362)};module.exports=CONST}),(function(module,exports){var RemoveFromDOM=function(element){if(element.parentNode){element.parentNode.removeChild(element)}};module.exports=RemoveFromDOM}),(function(module,exports){var INPUT_CONST={MOUSE_DOWN:0,MOUSE_MOVE:1,MOUSE_UP:2,TOUCH_START:3,TOUCH_MOVE:4,TOUCH_END:5,POINTER_LOCK_CHANGE:6,TOUCH_CANCEL:7,MOUSE_WHEEL:8};module.exports=INPUT_CONST}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(125);var DefaultPlugins=__webpack_require__(175);var Events=__webpack_require__(22);var GetPhysicsPlugins=__webpack_require__(880);var GetScenePlugins=__webpack_require__(881);var NOOP=__webpack_require__(1);var Settings=__webpack_require__(375);var Systems=new Class({initialize:function Systems(scene,config){this.scene=scene;this.game;this.renderer;if(false){}this.config=config;this.settings=Settings.create(config);this.canvas;this.context;this.anims;this.cache;this.plugins;this.registry;this.scale;this.sound;this.textures;this.add;this.cameras;this.displayList;this.events;this.make;this.scenePlugin;this.updateList;this.sceneUpdate=NOOP},init:function(game){this.settings.status=CONST.INIT;this.sceneUpdate=NOOP;this.game=game;this.renderer=game.renderer;this.canvas=game.canvas;this.context=game.context;var pluginManager=game.plugins;this.plugins=pluginManager;pluginManager.addToScene(this,DefaultPlugins.Global,[DefaultPlugins.CoreScene,GetScenePlugins(this),GetPhysicsPlugins(this)]);this.events.emit(Events.BOOT,this);this.settings.isBooted=true},install:function(plugin){if(!Array.isArray(plugin)){plugin=[plugin]}this.plugins.installLocal(this,plugin)},step:function(time,delta){this.events.emit(Events.PRE_UPDATE,time,delta);this.events.emit(Events.UPDATE,time,delta);this.sceneUpdate.call(this.scene,time,delta);this.events.emit(Events.POST_UPDATE,time,delta)},render:function(renderer){var displayList=this.displayList;displayList.depthSort();this.cameras.render(renderer,displayList);this.events.emit(Events.RENDER,renderer)},queueDepthSort:function(){this.displayList.queueDepthSort()},depthSort:function(){this.displayList.depthSort()},pause:function(data){if(this.settings.active){this.settings.status=CONST.PAUSED;this.settings.active=false;this.events.emit(Events.PAUSE,this,data)}return this},resume:function(data){if(!this.settings.active){this.settings.status=CONST.RUNNING;this.settings.active=true;this.events.emit(Events.RESUME,this,data)}return this},sleep:function(data){this.settings.status=CONST.SLEEPING;this.settings.active=false;this.settings.visible=false;this.events.emit(Events.SLEEP,this,data);return this},wake:function(data){var settings=this.settings;settings.status=CONST.RUNNING;settings.active=true;settings.visible=true;this.events.emit(Events.WAKE,this,data);if(settings.isTransition){this.events.emit(Events.TRANSITION_WAKE,settings.transitionFrom,settings.transitionDuration)}return this},getData:function(){return this.settings.data},isSleeping:function(){return(this.settings.status===CONST.SLEEPING)},isActive:function(){return(this.settings.status===CONST.RUNNING)},isPaused:function(){return(this.settings.status===CONST.PAUSED)},isTransitioning:function(){return(this.settings.isTransition||this.scenePlugin._target!==null)},isTransitionOut:function(){return(this.scenePlugin._target!==null&&this.scenePlugin._duration>0)},isTransitionIn:function(){return(this.settings.isTransition)},isVisible:function(){return this.settings.visible},setVisible:function(value){this.settings.visible=value;return this},setActive:function(value,data){if(value){return this.resume(data)}else{return this.pause(data)}},start:function(data){if(data){this.settings.data=data}this.settings.status=CONST.START;this.settings.active=true;this.settings.visible=true;this.events.emit(Events.START,this);this.events.emit(Events.READY,this,data)},shutdown:function(data){this.events.off(Events.TRANSITION_INIT);this.events.off(Events.TRANSITION_START);this.events.off(Events.TRANSITION_COMPLETE);this.events.off(Events.TRANSITION_OUT);this.settings.status=CONST.SHUTDOWN;this.settings.active=false;this.settings.visible=false;this.events.emit(Events.SHUTDOWN,this,data)},destroy:function(){this.settings.status=CONST.DESTROYED;this.settings.active=false;this.settings.visible=false;this.events.emit(Events.DESTROY,this);this.events.removeAllListeners();var props=['scene','game','anims','cache','plugins','registry','sound','textures','add','camera','displayList','events','make','scenePlugin','updateList'];for(var i=0;i<props.length;i++){this[props[i]]=null}}});module.exports=Systems}),(function(module,exports){var UppercaseFirst=function(str){return str&&str[0].toUpperCase()+str.slice(1)};module.exports=UppercaseFirst}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Frame=__webpack_require__(94);var TextureSource=__webpack_require__(378);var TEXTURE_MISSING_ERROR='Texture.frame missing: ';var Texture=new Class({initialize:function Texture(manager,key,source,width,height){if(!Array.isArray(source)){source=[source]}this.manager=manager;this.key=key;this.source=[];this.dataSource=[];this.frames={};this.customData={};this.firstFrame='__BASE';this.frameTotal=0;for(var i=0;i<source.length;i++){this.source.push(new TextureSource(this,source[i],width,height))}},add:function(name,sourceIndex,x,y,width,height){if(this.has(name)){return null}var frame=new Frame(this,name,sourceIndex,x,y,width,height);this.frames[name]=frame;if(this.firstFrame==='__BASE'){this.firstFrame=name}this.frameTotal++;return frame},remove:function(name){if(this.has(name)){var frame=this.get(name);frame.destroy();delete this.frames[name];return true}return false},has:function(name){return(this.frames[name])},get:function(name){if(!name){name=this.firstFrame}var frame=this.frames[name];if(!frame){console.warn(TEXTURE_MISSING_ERROR+name);frame=this.frames[this.firstFrame]}return frame},getTextureSourceIndex:function(source){for(var i=0;i<this.source.length;i++){if(this.source[i]===source){return i}}return-1},getFramesFromTextureSource:function(sourceIndex,includeBase){if(includeBase===undefined){includeBase=false}var out=[];for(var frameName in this.frames){if(frameName==='__BASE'&&!includeBase){continue}var frame=this.frames[frameName];if(frame.sourceIndex===sourceIndex){out.push(frame)}}return out},getFrameNames:function(includeBase){if(includeBase===undefined){includeBase=false}var out=Object.keys(this.frames);if(!includeBase){var idx=out.indexOf('__BASE');if(idx!==-1){out.splice(idx,1)}}return out},getSourceImage:function(name){if(name===undefined||name===null||this.frameTotal===1){name='__BASE'}var frame=this.frames[name];if(frame){return frame.source.image}else{console.warn(TEXTURE_MISSING_ERROR+name);return this.frames['__BASE'].source.image}},getDataSourceImage:function(name){if(name===undefined||name===null||this.frameTotal===1){name='__BASE'}var frame=this.frames[name];var idx;if(!frame){console.warn(TEXTURE_MISSING_ERROR+name);idx=this.frames['__BASE'].sourceIndex}else{idx=frame.sourceIndex}return this.dataSource[idx].image},setDataSource:function(data){if(!Array.isArray(data)){data=[data]}for(var i=0;i<data.length;i++){var source=this.source[i];this.dataSource.push(new TextureSource(this,data[i],source.width,source.height))}},setFilter:function(filterMode){var i;for(i=0;i<this.source.length;i++){this.source[i].setFilter(filterMode)}for(i=0;i<this.dataSource.length;i++){this.dataSource[i].setFilter(filterMode)}},destroy:function(){var i;for(i=0;i<this.source.length;i++){this.source[i].destroy()}for(i=0;i<this.dataSource.length;i++){this.dataSource[i].destroy()}for(var frameName in this.frames){var frame=this.frames[frameName];frame.destroy()}this.source=[];this.dataSource=[];this.frames={};this.manager.removeKey(this.key);this.manager=null}});module.exports=Texture}),(function(module,exports,__webpack_require__){module.exports={Matrix:__webpack_require__(916),Add:__webpack_require__(923),AddAt:__webpack_require__(924),BringToTop:__webpack_require__(925),CountAllMatching:__webpack_require__(926),Each:__webpack_require__(927),EachInRange:__webpack_require__(928),FindClosestInSorted:__webpack_require__(270),GetAll:__webpack_require__(382),GetFirst:__webpack_require__(383),GetRandom:__webpack_require__(185),MoveDown:__webpack_require__(929),MoveTo:__webpack_require__(930),MoveUp:__webpack_require__(931),NumberArray:__webpack_require__(932),NumberArrayStep:__webpack_require__(933),QuickSelect:__webpack_require__(391),Range:__webpack_require__(392),Remove:__webpack_require__(123),RemoveAt:__webpack_require__(934),RemoveBetween:__webpack_require__(935),RemoveRandomElement:__webpack_require__(936),Replace:__webpack_require__(937),RotateLeft:__webpack_require__(286),RotateRight:__webpack_require__(287),SafeRange:__webpack_require__(68),SendToBack:__webpack_require__(938),SetAll:__webpack_require__(939),Shuffle:__webpack_require__(114),SpliceOne:__webpack_require__(80),StableSort:__webpack_require__(131),Swap:__webpack_require__(940)}}),(function(module,exports){var CheckMatrix=function(matrix){if(!Array.isArray(matrix)||matrix.length<2||!Array.isArray(matrix[0])){return false}var size=matrix[0].length;for(var i=1;i<matrix.length;i++){if(matrix[i].length!==size){return false}}return true};module.exports=CheckMatrix}),(function(module,exports){var GetRandom=function(array,startIndex,length){if(startIndex===undefined){startIndex=0}if(length===undefined){length=array.length}var randomIndex=startIndex+Math.floor(Math.random()*length);return(array[randomIndex]===undefined)?null:array[randomIndex]};module.exports=GetRandom}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(942);var ProcessQueue=new Class({Extends:EventEmitter,initialize:function ProcessQueue(){EventEmitter.call(this);this._pending=[];this._active=[];this._destroy=[];this._toProcess=0},add:function(item){this._pending.push(item);this._toProcess++;return item},remove:function(item){this._destroy.push(item);this._toProcess++;return item},removeAll:function(){var list=this._active;var destroy=this._destroy;var i=list.length;while(i--){destroy.push(list[i]);this._toProcess++}return this},update:function(){if(this._toProcess===0){return this._active}var list=this._destroy;var active=this._active;var i;var item;for(i=0;i<list.length;i++){item=list[i];var idx=active.indexOf(item);if(idx!==-1){active.splice(idx,1);this.emit(Events.REMOVE,item)}}list.length=0;list=this._pending;for(i=0;i<list.length;i++){item=list[i];this._active.push(item);this.emit(Events.ADD,item)}list.length=0;this._toProcess=0;return this._active},getActive:function(){return this._active},length:{get:function(){return this._active.length}},destroy:function(){this._toProcess=0;this._pending=[];this._active=[];this._destroy=[]}});module.exports=ProcessQueue}),(function(module,exports){function getValue(node,attribute){return parseInt(node.getAttribute(attribute),10)}var ParseXMLBitmapFont=function(xml,xSpacing,ySpacing,frame){if(xSpacing===undefined){xSpacing=0}if(ySpacing===undefined){ySpacing=0}var data={};var info=xml.getElementsByTagName('info')[0];var common=xml.getElementsByTagName('common')[0];data.font=info.getAttribute('face');data.size=getValue(info,'size');data.lineHeight=getValue(common,'lineHeight')+ySpacing;data.chars={};var letters=xml.getElementsByTagName('char');var adjustForTrim=(frame!==undefined&&frame.trimmed);if(adjustForTrim){var top=frame.height;var left=frame.width}for(var i=0;i<letters.length;i++){var node=letters[i];var charCode=getValue(node,'id');var gx=getValue(node,'x');var gy=getValue(node,'y');var gw=getValue(node,'width');var gh=getValue(node,'height');if(adjustForTrim){if(gx<left){left=gx}if(gy<top){top=gy}}data.chars[charCode]={x:gx,y:gy,width:gw,height:gh,centerX:Math.floor(gw/2),centerY:Math.floor(gh/2),xOffset:getValue(node,'xoffset'),yOffset:getValue(node,'yoffset'),xAdvance:getValue(node,'xadvance')+xSpacing,data:{},kerning:{}}}if(adjustForTrim&&top!==0&&left!==0){for(var code in data.chars){var glyph=data.chars[code];glyph.x-=frame.x;glyph.y-=frame.y}}var kernings=xml.getElementsByTagName('kerning');for(i=0;i<kernings.length;i++){var kern=kernings[i];var first=getValue(kern,'first');var second=getValue(kern,'second');var amount=getValue(kern,'amount');data.chars[second].kerning[first]=amount}return data};module.exports=ParseXMLBitmapFont}),(function(module,exports,__webpack_require__){var BlitterRender=__webpack_require__(950);var Bob=__webpack_require__(953);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var Frame=__webpack_require__(94);var GameObject=__webpack_require__(14);var List=__webpack_require__(129);var Blitter=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.Depth,Components.Mask,Components.Pipeline,Components.ScrollFactor,Components.Size,Components.Texture,Components.Transform,Components.Visible,BlitterRender],initialize:function Blitter(scene,x,y,texture,frame){GameObject.call(this,scene,'Blitter');this.setTexture(texture,frame);this.setPosition(x,y);this.initPipeline();this.children=new List();this.renderList=[];this.dirty=false},create:function(x,y,frame,visible,index){if(visible===undefined){visible=true}if(index===undefined){index=this.children.length}if(frame===undefined){frame=this.frame}else if(!(frame instanceof Frame)){frame=this.texture.get(frame)}var bob=new Bob(this,x,y,frame,visible);this.children.addAt(bob,index,false);this.dirty=true;return bob},createFromCallback:function(callback,quantity,frame,visible){var bobs=this.createMultiple(quantity,frame,visible);for(var i=0;i<bobs.length;i++){var bob=bobs[i];callback.call(this,bob,i)}return bobs},createMultiple:function(quantity,frame,visible){if(frame===undefined){frame=this.frame.name}if(visible===undefined){visible=true}if(!Array.isArray(frame)){frame=[frame]}var bobs=[];var _this=this;frame.forEach(function(singleFrame){for(var i=0;i<quantity;i++){bobs.push(_this.create(0,0,singleFrame,visible))}});return bobs},childCanRender:function(child){return(child.visible&&child.alpha>0)},getRenderList:function(){if(this.dirty){this.renderList=this.children.list.filter(this.childCanRender,this);this.dirty=false}return this.renderList},clear:function(){this.children.removeAll();this.dirty=true},preDestroy:function(){this.children.destroy();this.renderList=[]}});module.exports=Blitter}),(function(module,exports,__webpack_require__){var ArrayUtils=__webpack_require__(183);var BlendModes=__webpack_require__(52);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var Events=__webpack_require__(90);var GameObject=__webpack_require__(14);var Rectangle=__webpack_require__(11);var Render=__webpack_require__(954);var Union=__webpack_require__(394);var Vector2=__webpack_require__(3);var Container=new Class({Extends:GameObject,Mixins:[Components.AlphaSingle,Components.BlendMode,Components.ComputedSize,Components.Depth,Components.Mask,Components.Transform,Components.Visible,Render],initialize:function Container(scene,x,y,children){GameObject.call(this,scene,'Container');this.list=[];this.exclusive=true;this.maxSize=-1;this.position=0;this.localTransform=new Components.TransformMatrix();this.tempTransformMatrix=new Components.TransformMatrix();this._displayList=scene.sys.displayList;this._sortKey='';this._sysEvents=scene.sys.events;this.scrollFactorX=1;this.scrollFactorY=1;this.setPosition(x,y);this.clearAlpha();this.setBlendMode(BlendModes.SKIP_CHECK);if(children){this.add(children)}},originX:{get:function(){return 0.5}},originY:{get:function(){return 0.5}},displayOriginX:{get:function(){return this.width*0.5}},displayOriginY:{get:function(){return this.height*0.5}},setExclusive:function(value){if(value===undefined){value=true}this.exclusive=value;return this},getBounds:function(output){if(output===undefined){output=new Rectangle()}output.setTo(this.x,this.y,0,0);if(this.parentContainer){var parentMatrix=this.parentContainer.getBoundsTransformMatrix();var transformedPosition=parentMatrix.transformPoint(this.x,this.y);output.setTo(transformedPosition.x,transformedPosition.y,0,0)}if(this.list.length>0){var children=this.list;var tempRect=new Rectangle();var hasSetFirst=false;output.setEmpty();for(var i=0;i<children.length;i++){var entry=children[i];if(entry.getBounds){entry.getBounds(tempRect);if(!hasSetFirst){output.setTo(tempRect.x,tempRect.y,tempRect.width,tempRect.height);hasSetFirst=true}else{Union(tempRect,output,output)}}}}return output},addHandler:function(gameObject){gameObject.once(Events.DESTROY,this.remove,this);if(this.exclusive){this._displayList.remove(gameObject);if(gameObject.parentContainer){gameObject.parentContainer.remove(gameObject)}gameObject.parentContainer=this}},removeHandler:function(gameObject){gameObject.off(Events.DESTROY,this.remove);if(this.exclusive){gameObject.parentContainer=null}},pointToContainer:function(source,output){if(output===undefined){output=new Vector2()}if(this.parentContainer){this.parentContainer.pointToContainer(source,output)}else{output=new Vector2(source.x,source.y)}var tempMatrix=this.tempTransformMatrix;tempMatrix.applyITRS(this.x,this.y,this.rotation,this.scaleX,this.scaleY);tempMatrix.invert();tempMatrix.transformPoint(source.x,source.y,output);return output},getBoundsTransformMatrix:function(){return this.getWorldTransformMatrix(this.tempTransformMatrix,this.localTransform)},add:function(child){ArrayUtils.Add(this.list,child,this.maxSize,this.addHandler,this);return this},addAt:function(child,index){ArrayUtils.AddAt(this.list,child,index,this.maxSize,this.addHandler,this);return this},getAt:function(index){return this.list[index]},getIndex:function(child){return this.list.indexOf(child)},sort:function(property,handler){if(!property){return this}if(handler===undefined){handler=function(childA,childB){return childA[property]-childB[property]}}ArrayUtils.StableSort.inplace(this.list,handler);return this},getByName:function(name){return ArrayUtils.GetFirst(this.list,'name',name)},getRandom:function(startIndex,length){return ArrayUtils.GetRandom(this.list,startIndex,length)},getFirst:function(property,value,startIndex,endIndex){return ArrayUtils.GetFirst(this.list,property,value,startIndex,endIndex)},getAll:function(property,value,startIndex,endIndex){return ArrayUtils.GetAll(this.list,property,value,startIndex,endIndex)},count:function(property,value,startIndex,endIndex){return ArrayUtils.CountAllMatching(this.list,property,value,startIndex,endIndex)},swap:function(child1,child2){ArrayUtils.Swap(this.list,child1,child2);return this},moveTo:function(child,index){ArrayUtils.MoveTo(this.list,child,index);return this},remove:function(child,destroyChild){var removed=ArrayUtils.Remove(this.list,child,this.removeHandler,this);if(destroyChild&&removed){if(!Array.isArray(removed)){removed=[removed]}for(var i=0;i<removed.length;i++){removed[i].destroy()}}return this},removeAt:function(index,destroyChild){var removed=ArrayUtils.RemoveAt(this.list,index,this.removeHandler,this);if(destroyChild&&removed){removed.destroy()}return this},removeBetween:function(startIndex,endIndex,destroyChild){var removed=ArrayUtils.RemoveBetween(this.list,startIndex,endIndex,this.removeHandler,this);if(destroyChild){for(var i=0;i<removed.length;i++){removed[i].destroy()}}return this},removeAll:function(destroyChild){var removed=ArrayUtils.RemoveBetween(this.list,0,this.list.length,this.removeHandler,this);if(destroyChild){for(var i=0;i<removed.length;i++){removed[i].destroy()}}return this},bringToTop:function(child){ArrayUtils.BringToTop(this.list,child);return this},sendToBack:function(child){ArrayUtils.SendToBack(this.list,child);return this},moveUp:function(child){ArrayUtils.MoveUp(this.list,child);return this},moveDown:function(child){ArrayUtils.MoveDown(this.list,child);return this},reverse:function(){this.list.reverse();return this},shuffle:function(){ArrayUtils.Shuffle(this.list);return this},replace:function(oldChild,newChild,destroyChild){var moved=ArrayUtils.Replace(this.list,oldChild,newChild);if(moved){this.addHandler(newChild);this.removeHandler(oldChild);if(destroyChild){oldChild.destroy()}}return this},exists:function(child){return(this.list.indexOf(child)>-1)},setAll:function(property,value,startIndex,endIndex){ArrayUtils.SetAll(this.list,property,value,startIndex,endIndex);return this},each:function(callback,context){var args=[null];var i;var temp=this.list.slice();var len=temp.length;for(i=2;i<arguments.length;i++){args.push(arguments[i])}for(i=0;i<len;i++){args[0]=temp[i];callback.apply(context,args)}return this},iterate:function(callback,context){var args=[null];var i;for(i=2;i<arguments.length;i++){args.push(arguments[i])}for(i=0;i<this.list.length;i++){args[0]=this.list[i];callback.apply(context,args)}return this},setScrollFactor:function(x,y,updateChildren){if(y===undefined){y=x}if(updateChildren===undefined){updateChildren=false}this.scrollFactorX=x;this.scrollFactorY=y;if(updateChildren){ArrayUtils.SetAll(this.list,'scrollFactorX',x);ArrayUtils.SetAll(this.list,'scrollFactorY',y)}return this},length:{get:function(){return this.list.length}},first:{get:function(){this.position=0;if(this.list.length>0){return this.list[0]}else{return null}}},last:{get:function(){if(this.list.length>0){this.position=this.list.length-1;return this.list[this.position]}else{return null}}},next:{get:function(){if(this.position<this.list.length){this.position++;return this.list[this.position]}else{return null}}},previous:{get:function(){if(this.position>0){this.position--;return this.list[this.position]}else{return null}}},preDestroy:function(){this.removeAll(!!this.exclusive);this.localTransform.destroy();this.tempTransformMatrix.destroy();this.list=[];this._displayList=null}});module.exports=Container}),(function(module,exports,__webpack_require__){var BitmapText=__webpack_require__(132);var Class=__webpack_require__(0);var Render=__webpack_require__(959);var DynamicBitmapText=new Class({Extends:BitmapText,Mixins:[Render],initialize:function DynamicBitmapText(scene,x,y,font,text,size,align){BitmapText.call(this,scene,x,y,font,text,size,align);this.type='DynamicBitmapText';this.scrollX=0;this.scrollY=0;this.cropWidth=0;this.cropHeight=0;this.displayCallback;this.callbackData={parent:this,color:0,tint:{topLeft:0,topRight:0,bottomLeft:0,bottomRight:0},index:0,charCode:0,x:0,y:0,scale:0,rotation:0,data:0}},setSize:function(width,height){this.cropWidth=width;this.cropHeight=height;return this},setDisplayCallback:function(callback){this.displayCallback=callback;return this},setScrollX:function(value){this.scrollX=value;return this},setScrollY:function(value){this.scrollY=value;return this}});module.exports=DynamicBitmapText}),(function(module,exports,__webpack_require__){var BaseCamera=__webpack_require__(91);var Class=__webpack_require__(0);var Commands=__webpack_require__(192);var ComponentsAlpha=__webpack_require__(269);var ComponentsBlendMode=__webpack_require__(272);var ComponentsDepth=__webpack_require__(273);var ComponentsMask=__webpack_require__(277);var ComponentsPipeline=__webpack_require__(156);var ComponentsTransform=__webpack_require__(282);var ComponentsVisible=__webpack_require__(283);var ComponentsScrollFactor=__webpack_require__(280);var TransformMatrix=__webpack_require__(29);var Ellipse=__webpack_require__(95);var GameObject=__webpack_require__(14);var GetFastValue=__webpack_require__(2);var GetValue=__webpack_require__(6);var MATH_CONST=__webpack_require__(13);var Render=__webpack_require__(965);var Graphics=new Class({Extends:GameObject,Mixins:[ComponentsAlpha,ComponentsBlendMode,ComponentsDepth,ComponentsMask,ComponentsPipeline,ComponentsTransform,ComponentsVisible,ComponentsScrollFactor,Render],initialize:function Graphics(scene,options){var x=GetValue(options,'x',0);var y=GetValue(options,'y',0);GameObject.call(this,scene,'Graphics');this.setPosition(x,y);this.initPipeline();this.displayOriginX=0;this.displayOriginY=0;this.commandBuffer=[];this.defaultFillColor=-1;this.defaultFillAlpha=1;this.defaultStrokeWidth=1;this.defaultStrokeColor=-1;this.defaultStrokeAlpha=1;this._lineWidth=1.0;this._tempMatrix1=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempMatrix3=new TransformMatrix();this.setDefaultStyles(options)},setDefaultStyles:function(options){if(GetValue(options,'lineStyle',null)){this.defaultStrokeWidth=GetValue(options,'lineStyle.width',1);this.defaultStrokeColor=GetValue(options,'lineStyle.color',0xffffff);this.defaultStrokeAlpha=GetValue(options,'lineStyle.alpha',1);this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)}if(GetValue(options,'fillStyle',null)){this.defaultFillColor=GetValue(options,'fillStyle.color',0xffffff);this.defaultFillAlpha=GetValue(options,'fillStyle.alpha',1);this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)}return this},lineStyle:function(lineWidth,color,alpha){if(alpha===undefined){alpha=1}this.commandBuffer.push(Commands.LINE_STYLE,lineWidth,color,alpha);this._lineWidth=lineWidth;return this},fillStyle:function(color,alpha){if(alpha===undefined){alpha=1}this.commandBuffer.push(Commands.FILL_STYLE,color,alpha);return this},fillGradientStyle:function(topLeft,topRight,bottomLeft,bottomRight,alpha){if(alpha===undefined){alpha=1}this.commandBuffer.push(Commands.GRADIENT_FILL_STYLE,alpha,topLeft,topRight,bottomLeft,bottomRight);return this},lineGradientStyle:function(lineWidth,topLeft,topRight,bottomLeft,bottomRight,alpha){if(alpha===undefined){alpha=1}this.commandBuffer.push(Commands.GRADIENT_LINE_STYLE,lineWidth,alpha,topLeft,topRight,bottomLeft,bottomRight);return this},setTexture:function(key,frame,mode){if(mode===undefined){mode=0}if(key===undefined){this.commandBuffer.push(Commands.CLEAR_TEXTURE)}else{var textureFrame=this.scene.sys.textures.getFrame(key,frame);if(textureFrame){if(mode===2){mode=3}this.commandBuffer.push(Commands.SET_TEXTURE,textureFrame,mode)}}return this},beginPath:function(){this.commandBuffer.push(Commands.BEGIN_PATH);return this},closePath:function(){this.commandBuffer.push(Commands.CLOSE_PATH);return this},fillPath:function(){this.commandBuffer.push(Commands.FILL_PATH);return this},fill:function(){this.commandBuffer.push(Commands.FILL_PATH);return this},strokePath:function(){this.commandBuffer.push(Commands.STROKE_PATH);return this},stroke:function(){this.commandBuffer.push(Commands.STROKE_PATH);return this},fillCircleShape:function(circle){return this.fillCircle(circle.x,circle.y,circle.radius)},strokeCircleShape:function(circle){return this.strokeCircle(circle.x,circle.y,circle.radius)},fillCircle:function(x,y,radius){this.beginPath();this.arc(x,y,radius,0,MATH_CONST.PI2);this.fillPath();return this},strokeCircle:function(x,y,radius){this.beginPath();this.arc(x,y,radius,0,MATH_CONST.PI2);this.strokePath();return this},fillRectShape:function(rect){return this.fillRect(rect.x,rect.y,rect.width,rect.height)},strokeRectShape:function(rect){return this.strokeRect(rect.x,rect.y,rect.width,rect.height)},fillRect:function(x,y,width,height){this.commandBuffer.push(Commands.FILL_RECT,x,y,width,height);return this},strokeRect:function(x,y,width,height){var lineWidthHalf=this._lineWidth/2;var minx=x-lineWidthHalf;var maxx=x+lineWidthHalf;this.beginPath();this.moveTo(x,y);this.lineTo(x,y+height);this.strokePath();this.beginPath();this.moveTo(x+width,y);this.lineTo(x+width,y+height);this.strokePath();this.beginPath();this.moveTo(minx,y);this.lineTo(maxx+width,y);this.strokePath();this.beginPath();this.moveTo(minx,y+height);this.lineTo(maxx+width,y+height);this.strokePath();return this},fillRoundedRect:function(x,y,width,height,radius){if(radius===undefined){radius=20}var tl=radius;var tr=radius;var bl=radius;var br=radius;if(typeof radius!=='number'){tl=GetFastValue(radius,'tl',20);tr=GetFastValue(radius,'tr',20);bl=GetFastValue(radius,'bl',20);br=GetFastValue(radius,'br',20)}this.beginPath();this.moveTo(x+tl,y);this.lineTo(x+width-tr,y);this.arc(x+width-tr,y+tr,tr,-MATH_CONST.TAU,0);this.lineTo(x+width,y+height-br);this.arc(x+width-br,y+height-br,br,0,MATH_CONST.TAU);this.lineTo(x+bl,y+height);this.arc(x+bl,y+height-bl,bl,MATH_CONST.TAU,Math.PI);this.lineTo(x,y+tl);this.arc(x+tl,y+tl,tl,-Math.PI,-MATH_CONST.TAU);this.fillPath();return this},strokeRoundedRect:function(x,y,width,height,radius){if(radius===undefined){radius=20}var tl=radius;var tr=radius;var bl=radius;var br=radius;if(typeof radius!=='number'){tl=GetFastValue(radius,'tl',20);tr=GetFastValue(radius,'tr',20);bl=GetFastValue(radius,'bl',20);br=GetFastValue(radius,'br',20)}this.beginPath();this.moveTo(x+tl,y);this.lineTo(x+width-tr,y);this.arc(x+width-tr,y+tr,tr,-MATH_CONST.TAU,0);this.lineTo(x+width,y+height-br);this.arc(x+width-br,y+height-br,br,0,MATH_CONST.TAU);this.lineTo(x+bl,y+height);this.arc(x+bl,y+height-bl,bl,MATH_CONST.TAU,Math.PI);this.lineTo(x,y+tl);this.arc(x+tl,y+tl,tl,-Math.PI,-MATH_CONST.TAU);this.strokePath();return this},fillPointShape:function(point,size){return this.fillPoint(point.x,point.y,size)},fillPoint:function(x,y,size){if(!size||size<1){size=1}else{x-=(size/2);y-=(size/2)}this.commandBuffer.push(Commands.FILL_RECT,x,y,size,size);return this},fillTriangleShape:function(triangle){return this.fillTriangle(triangle.x1,triangle.y1,triangle.x2,triangle.y2,triangle.x3,triangle.y3)},strokeTriangleShape:function(triangle){return this.strokeTriangle(triangle.x1,triangle.y1,triangle.x2,triangle.y2,triangle.x3,triangle.y3)},fillTriangle:function(x0,y0,x1,y1,x2,y2){this.commandBuffer.push(Commands.FILL_TRIANGLE,x0,y0,x1,y1,x2,y2);return this},strokeTriangle:function(x0,y0,x1,y1,x2,y2){this.commandBuffer.push(Commands.STROKE_TRIANGLE,x0,y0,x1,y1,x2,y2);return this},strokeLineShape:function(line){return this.lineBetween(line.x1,line.y1,line.x2,line.y2)},lineBetween:function(x1,y1,x2,y2){this.beginPath();this.moveTo(x1,y1);this.lineTo(x2,y2);this.strokePath();return this},lineTo:function(x,y){this.commandBuffer.push(Commands.LINE_TO,x,y);return this},moveTo:function(x,y){this.commandBuffer.push(Commands.MOVE_TO,x,y);return this},strokePoints:function(points,closeShape,closePath,endIndex){if(closeShape===undefined){closeShape=false}if(closePath===undefined){closePath=false}if(endIndex===undefined){endIndex=points.length}this.beginPath();this.moveTo(points[0].x,points[0].y);for(var i=1;i<endIndex;i++){this.lineTo(points[i].x,points[i].y)}if(closeShape){this.lineTo(points[0].x,points[0].y)}if(closePath){this.closePath()}this.strokePath();return this},fillPoints:function(points,closeShape,closePath,endIndex){if(closeShape===undefined){closeShape=false}if(closePath===undefined){closePath=false}if(endIndex===undefined){endIndex=points.length}this.beginPath();this.moveTo(points[0].x,points[0].y);for(var i=1;i<endIndex;i++){this.lineTo(points[i].x,points[i].y)}if(closeShape){this.lineTo(points[0].x,points[0].y)}if(closePath){this.closePath()}this.fillPath();return this},strokeEllipseShape:function(ellipse,smoothness){if(smoothness===undefined){smoothness=32}var points=ellipse.getPoints(smoothness);return this.strokePoints(points,true)},strokeEllipse:function(x,y,width,height,smoothness){if(smoothness===undefined){smoothness=32}var ellipse=new Ellipse(x,y,width,height);var points=ellipse.getPoints(smoothness);return this.strokePoints(points,true)},fillEllipseShape:function(ellipse,smoothness){if(smoothness===undefined){smoothness=32}var points=ellipse.getPoints(smoothness);return this.fillPoints(points,true)},fillEllipse:function(x,y,width,height,smoothness){if(smoothness===undefined){smoothness=32}var ellipse=new Ellipse(x,y,width,height);var points=ellipse.getPoints(smoothness);return this.fillPoints(points,true)},arc:function(x,y,radius,startAngle,endAngle,anticlockwise,overshoot){if(anticlockwise===undefined){anticlockwise=false}if(overshoot===undefined){overshoot=0}this.commandBuffer.push(Commands.ARC,x,y,radius,startAngle,endAngle,anticlockwise,overshoot);return this},slice:function(x,y,radius,startAngle,endAngle,anticlockwise,overshoot){if(anticlockwise===undefined){anticlockwise=false}if(overshoot===undefined){overshoot=0}this.commandBuffer.push(Commands.BEGIN_PATH);this.commandBuffer.push(Commands.MOVE_TO,x,y);this.commandBuffer.push(Commands.ARC,x,y,radius,startAngle,endAngle,anticlockwise,overshoot);this.commandBuffer.push(Commands.CLOSE_PATH);return this},save:function(){this.commandBuffer.push(Commands.SAVE);return this},restore:function(){this.commandBuffer.push(Commands.RESTORE);return this},translateCanvas:function(x,y){this.commandBuffer.push(Commands.TRANSLATE,x,y);return this},scaleCanvas:function(x,y){this.commandBuffer.push(Commands.SCALE,x,y);return this},rotateCanvas:function(radians){this.commandBuffer.push(Commands.ROTATE,radians);return this},clear:function(){this.commandBuffer.length=0;if(this.defaultFillColor>-1){this.fillStyle(this.defaultFillColor,this.defaultFillAlpha)}if(this.defaultStrokeColor>-1){this.lineStyle(this.defaultStrokeWidth,this.defaultStrokeColor,this.defaultStrokeAlpha)}return this},generateTexture:function(key,width,height){var sys=this.scene.sys;var renderer=sys.game.renderer;if(width===undefined){width=sys.scale.width}if(height===undefined){height=sys.scale.height}Graphics.TargetCamera.setScene(this.scene);Graphics.TargetCamera.setViewport(0,0,width,height);Graphics.TargetCamera.scrollX=this.x;Graphics.TargetCamera.scrollY=this.y;var texture;var ctx;if(typeof key==='string'){if(sys.textures.exists(key)){texture=sys.textures.get(key);var src=texture.getSourceImage();if(src instanceof HTMLCanvasElement){ctx=src.getContext('2d')}}else{texture=sys.textures.createCanvas(key,width,height);ctx=texture.getSourceImage().getContext('2d')}}else if(key instanceof HTMLCanvasElement){ctx=key.getContext('2d')}if(ctx){this.renderCanvas(renderer,this,0,Graphics.TargetCamera,null,ctx,false);if(texture){texture.refresh()}}return this},preDestroy:function(){this.commandBuffer=[]}});Graphics.TargetCamera=new BaseCamera();module.exports=Graphics}),(function(module,exports){module.exports={ARC:0,BEGIN_PATH:1,CLOSE_PATH:2,FILL_RECT:3,LINE_TO:4,MOVE_TO:5,LINE_STYLE:6,FILL_STYLE:7,FILL_PATH:8,STROKE_PATH:9,FILL_TRIANGLE:10,STROKE_TRIANGLE:11,SAVE:14,RESTORE:15,TRANSLATE:16,SCALE:17,ROTATE:18,SET_TEXTURE:19,CLEAR_TEXTURE:20,GRADIENT_FILL_STYLE:21,GRADIENT_LINE_STYLE:22}}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var CircumferencePoint=function(ellipse,angle,out){if(out===undefined){out=new Point()}var halfWidth=ellipse.width/2;var halfHeight=ellipse.height/2;out.x=ellipse.x+halfWidth*Math.cos(angle);out.y=ellipse.y+halfHeight*Math.sin(angle);return out};module.exports=CircumferencePoint}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var GravityWell=__webpack_require__(402);var List=__webpack_require__(129);var ParticleEmitter=__webpack_require__(404);var Render=__webpack_require__(975);var ParticleEmitterManager=new Class({Extends:GameObject,Mixins:[Components.Depth,Components.Mask,Components.Pipeline,Components.Transform,Components.Visible,Render],initialize:function ParticleEmitterManager(scene,texture,frame,emitters){GameObject.call(this,scene,'ParticleEmitterManager');this.blendMode=-1;this.timeScale=1;this.texture=null;this.frame=null;this.frameNames=[];if(frame!==null&&(typeof frame==='object'||Array.isArray(frame))){emitters=frame;frame=null}this.setTexture(texture,frame);this.initPipeline();this.emitters=new List(this);this.wells=new List(this);if(emitters){if(!Array.isArray(emitters)){emitters=[emitters]}for(var i=0;i<emitters.length;i++){this.createEmitter(emitters[i])}}},setTexture:function(key,frame){this.texture=this.scene.sys.textures.get(key);return this.setFrame(frame)},setFrame:function(frame){this.frame=this.texture.get(frame);var frames=this.texture.getFramesFromTextureSource(this.frame.sourceIndex);var names=[];frames.forEach(function(sourceFrame){names.push(sourceFrame.name)});this.frameNames=names;this.defaultFrame=this.frame;return this},setEmitterFrames:function(frames,emitter){if(!Array.isArray(frames)){frames=[frames]}var out=emitter.frames;out.length=0;for(var i=0;i<frames.length;i++){var frame=frames[i];if(this.frameNames.indexOf(frame)!==-1){out.push(this.texture.get(frame))}}if(out.length>0){emitter.defaultFrame=out[0]}else{emitter.defaultFrame=this.defaultFrame}return this},addEmitter:function(emitter){return this.emitters.add(emitter)},createEmitter:function(config){return this.addEmitter(new ParticleEmitter(this,config))},removeEmitter:function(emitter){return this.emitters.remove(emitter,true)},addGravityWell:function(well){return this.wells.add(well)},createGravityWell:function(config){return this.addGravityWell(new GravityWell(config))},emitParticle:function(count,x,y){var emitters=this.emitters.list;for(var i=0;i<emitters.length;i++){var emitter=emitters[i];if(emitter.active){emitter.emitParticle(count,x,y)}}return this},emitParticleAt:function(x,y,count){return this.emitParticle(count,x,y)},pause:function(){this.active=false;return this},resume:function(){this.active=true;return this},getProcessors:function(){return this.wells.getAll('active',true)},preUpdate:function(time,delta){delta*=this.timeScale;var emitters=this.emitters.list;for(var i=0;i<emitters.length;i++){var emitter=emitters[i];if(emitter.active){emitter.preUpdate(time,delta)}}},setAlpha:function(){},setScrollFactor:function(){},setBlendMode:function(){}});module.exports=ParticleEmitterManager}),(function(module,exports,__webpack_require__){var BlendModes=__webpack_require__(52);var Camera=__webpack_require__(91);var CanvasPool=__webpack_require__(26);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var CONST=__webpack_require__(33);var Frame=__webpack_require__(94);var GameObject=__webpack_require__(14);var NOOP=__webpack_require__(1);var Render=__webpack_require__(979);var Utils=__webpack_require__(9);var UUID=__webpack_require__(196);var RenderTexture=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.ComputedSize,Components.Crop,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Tint,Components.Transform,Components.Visible,Render],initialize:function RenderTexture(scene,x,y,width,height,key,frame){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=32}if(height===undefined){height=32}GameObject.call(this,scene,'RenderTexture');this.renderer=scene.sys.game.renderer;this.textureManager=scene.sys.textures;this.globalTint=0xffffff;this.globalAlpha=1;this.canvas=null;this.framebuffer=null;this.dirty=false;this._crop=this.resetCropObject();this.texture=null;this.frame=null;this._saved=false;if(key===undefined){this.canvas=CanvasPool.create2D(this,width,height);this.texture=scene.sys.textures.addCanvas(UUID(),this.canvas);this.frame=this.texture.get()}else{this.texture=scene.sys.textures.get(key);this.frame=this.texture.get(frame);this.canvas=this.frame.source.image;this._saved=true;this.dirty=true;this.width=this.frame.cutWidth;this.height=this.frame.cutHeight}this.context=this.canvas.getContext('2d');this._eraseMode=false;this.camera=new Camera(0,0,width,height);this.gl=null;this.glTexture=null;var renderer=this.renderer;if(!renderer){this.drawGameObject=NOOP}else if(renderer.type===CONST.WEBGL){var gl=renderer.gl;this.gl=gl;this.glTexture=this.frame.source.glTexture;this.drawGameObject=this.batchGameObjectWebGL;this.framebuffer=renderer.createFramebuffer(width,height,this.glTexture,false)}else if(renderer.type===CONST.CANVAS){this.drawGameObject=this.batchGameObjectCanvas}this.camera.setScene(scene);this.setPosition(x,y);if(key===undefined){this.setSize(width,height)}this.setOrigin(0,0);this.initPipeline()},setSize:function(width,height){return this.resize(width,height)},resize:function(width,height){if(height===undefined){height=width}if(width!==this.width||height!==this.height){if(this.frame.name==='__BASE'){this.canvas.width=width;this.canvas.height=height;this.texture.width=width;this.texture.height=height;if(this.gl){var gl=this.gl;this.renderer.deleteTexture(this.frame.source.glTexture);this.renderer.deleteFramebuffer(this.framebuffer);var glTexture=this.renderer.createTexture2D(0,gl.NEAREST,gl.NEAREST,gl.CLAMP_TO_EDGE,gl.CLAMP_TO_EDGE,gl.RGBA,null,width,height,false);this.framebuffer=this.renderer.createFramebuffer(width,height,glTexture,false);this.frame.source.isRenderTexture=true;this.frame.glTexture=glTexture;this.glTexture=glTexture}this.frame.source.width=width;this.frame.source.height=height;this.camera.setSize(width,height);this.frame.setSize(width,height);this.width=width;this.height=height}}else{var baseFrame=this.texture.getSourceImage();if(this.frame.cutX+width>baseFrame.width){width=baseFrame.width-this.frame.cutX}if(this.frame.cutY+height>baseFrame.height){height=baseFrame.height-this.frame.cutY}this.frame.setSize(width,height,this.frame.cutX,this.frame.cutY)}this.updateDisplayOrigin();var input=this.input;if(input&&!input.customHitArea){input.hitArea.width=width;input.hitArea.height=height}return this},setGlobalTint:function(tint){this.globalTint=tint;return this},setGlobalAlpha:function(alpha){this.globalAlpha=alpha;return this},saveTexture:function(key){this.textureManager.renameTexture(this.texture.key,key);this._saved=true;return this.texture},fill:function(rgb,alpha,x,y,width,height){if(alpha===undefined){alpha=1}if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.frame.cutWidth}if(height===undefined){height=this.frame.cutHeight}var r=((rgb>>16)|0)&0xff;var g=((rgb>>8)|0)&0xff;var b=(rgb|0)&0xff;var gl=this.gl;var frame=this.frame;this.camera.preRender(1,1);if(gl){var cx=this.camera._cx;var cy=this.camera._cy;var cw=this.camera._cw;var ch=this.camera._ch;this.renderer.setFramebuffer(this.framebuffer,false);this.renderer.pushScissor(cx,cy,cw,ch,ch);var pipeline=this.pipeline;pipeline.projOrtho(0,this.texture.width,0,this.texture.height,-1000.0,1000.0);pipeline.drawFillRect(x,y,width,height,Utils.getTintFromFloats(r/255,g/ 255, b /255,1),alpha);this.renderer.setFramebuffer(null,false);this.renderer.popScissor();pipeline.projOrtho(0,pipeline.width,pipeline.height,0,-1000.0,1000.0)}else{this.renderer.setContext(this.context);this.context.fillStyle='rgba('+r+','+g+','+b+','+alpha+')';this.context.fillRect(x+frame.cutX,y+frame.cutY,width,height);this.renderer.setContext()}this.dirty=true;return this},clear:function(){if(this.dirty){var gl=this.gl;if(gl){var renderer=this.renderer;renderer.setFramebuffer(this.framebuffer,true);if(this.frame.cutWidth!==this.canvas.width||this.frame.cutHeight!==this.canvas.height){gl.scissor(this.frame.cutX,this.frame.cutY,this.frame.cutWidth,this.frame.cutHeight)}gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT);renderer.setFramebuffer(null,true)}else{var ctx=this.context;ctx.save();ctx.setTransform(1,0,0,1,0,0);ctx.clearRect(this.frame.cutX,this.frame.cutY,this.frame.cutWidth,this.frame.cutHeight);ctx.restore()}this.dirty=false}return this},erase:function(entries,x,y){this._eraseMode=true;var blendMode=this.renderer.currentBlendMode;this.renderer.setBlendMode(BlendModes.ERASE);this.draw(entries,x,y,1,16777215);this.renderer.setBlendMode(blendMode);this._eraseMode=false;return this},draw:function(entries,x,y,alpha,tint){if(alpha===undefined){alpha=this.globalAlpha}if(tint===undefined){tint=(this.globalTint>>16)+(this.globalTint&0xff00)+((this.globalTint&0xff)<<16)}else{tint=(tint>>16)+(tint&0xff00)+((tint&0xff)<<16)}if(!Array.isArray(entries)){entries=[entries]}var gl=this.gl;this.camera.preRender(1,1);if(gl){var cx=this.camera._cx;var cy=this.camera._cy;var cw=this.camera._cw;var ch=this.camera._ch;this.renderer.setFramebuffer(this.framebuffer,false);this.renderer.pushScissor(cx,cy,cw,ch,ch);var pipeline=this.pipeline;pipeline.projOrtho(0,this.texture.width,0,this.texture.height,-1000.0,1000.0);this.batchList(entries,x,y,alpha,tint);pipeline.flush();this.renderer.setFramebuffer(null,false);this.renderer.popScissor();pipeline.projOrtho(0,pipeline.width,pipeline.height,0,-1000.0,1000.0)}else{this.renderer.setContext(this.context);this.batchList(entries,x,y,alpha,tint);this.renderer.setContext()}this.dirty=true;return this},drawFrame:function(key,frame,x,y,alpha,tint){if(x===undefined){x=0}if(y===undefined){y=0}if(alpha===undefined){alpha=this.globalAlpha}if(tint===undefined){tint=(this.globalTint>>16)+(this.globalTint&0xff00)+((this.globalTint&0xff)<<16)}else{tint=(tint>>16)+(tint&0xff00)+((tint&0xff)<<16)}var gl=this.gl;var textureFrame=this.textureManager.getFrame(key,frame);if(textureFrame){this.camera.preRender(1,1);if(gl){var cx=this.camera._cx;var cy=this.camera._cy;var cw=this.camera._cw;var ch=this.camera._ch;this.renderer.setFramebuffer(this.framebuffer,false);this.renderer.pushScissor(cx,cy,cw,ch,ch);var pipeline=this.pipeline;pipeline.projOrtho(0,this.texture.width,0,this.texture.height,-1000.0,1000.0);pipeline.batchTextureFrame(textureFrame,x+this.frame.cutX,y+this.frame.cutY,tint,alpha,this.camera.matrix,null);pipeline.flush();this.renderer.setFramebuffer(null,false);this.renderer.popScissor();pipeline.projOrtho(0,pipeline.width,pipeline.height,0,-1000.0,1000.0)}else{this.batchTextureFrame(textureFrame,x+this.frame.cutX,y+this.frame.cutY,alpha,tint)}this.dirty=true}return this},batchList:function(children,x,y,alpha,tint){for(var i=0;i<children.length;i++){var entry=children[i];if(!entry||entry===this){continue}if(entry.renderWebGL||entry.renderCanvas){this.drawGameObject(entry,x,y)}else if(entry.isParent||entry.list){this.batchGroup(entry.getChildren(),x,y)}else if(typeof entry==='string'){this.batchTextureFrameKey(entry,null,x,y,alpha,tint)}else if(entry instanceof Frame){this.batchTextureFrame(entry,x,y,alpha,tint)}else if(Array.isArray(entry)){this.batchList(entry,x,y,alpha,tint)}}},batchGroup:function(children,x,y){if(x===undefined){x=0}if(y===undefined){y=0}x+=this.frame.cutX;y+=this.frame.cutY;for(var i=0;i<children.length;i++){var entry=children[i];if(entry.willRender()){var tx=entry.x+x;var ty=entry.y+y;this.drawGameObject(entry,tx,ty)}}},batchGameObjectWebGL:function(gameObject,x,y){if(x===undefined){x=gameObject.x}if(y===undefined){y=gameObject.y}var prevX=gameObject.x;var prevY=gameObject.y;if(!this._eraseMode){this.renderer.setBlendMode(gameObject.blendMode)}gameObject.setPosition(x+this.frame.cutX,y+this.frame.cutY);gameObject.renderWebGL(this.renderer,gameObject,0,this.camera,null);gameObject.setPosition(prevX,prevY)},batchGameObjectCanvas:function(gameObject,x,y){if(x===undefined){x=gameObject.x}if(y===undefined){y=gameObject.y}var prevX=gameObject.x;var prevY=gameObject.y;if(this._eraseMode){var blendMode=gameObject.blendMode;gameObject.blendMode=BlendModes.ERASE}gameObject.setPosition(x+this.frame.cutX,y+this.frame.cutY);gameObject.renderCanvas(this.renderer,gameObject,0,this.camera,null);gameObject.setPosition(prevX,prevY);if(this._eraseMode){gameObject.blendMode=blendMode}},batchTextureFrameKey:function(key,frame,x,y,alpha,tint){var textureFrame=this.textureManager.getFrame(key,frame);if(textureFrame){this.batchTextureFrame(textureFrame,x,y,alpha,tint)}},batchTextureFrame:function(textureFrame,x,y,alpha,tint){if(x===undefined){x=0}if(y===undefined){y=0}x+=this.frame.cutX;y+=this.frame.cutY;if(this.gl){this.pipeline.batchTextureFrame(textureFrame,x,y,tint,alpha,this.camera.matrix,null)}else{var ctx=this.context;var cd=textureFrame.canvasData;var source=textureFrame.source.image;var matrix=this.camera.matrix;ctx.globalAlpha=this.globalAlpha;ctx.setTransform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]);ctx.drawImage(source,cd.x,cd.y,cd.width,cd.height,x,y,cd.width,cd.height)}},snapshotArea:function(x,y,width,height,callback,type,encoderOptions){if(this.gl){this.renderer.snapshotFramebuffer(this.framebuffer,this.width,this.height,callback,false,x,y,width,height,type,encoderOptions)}else{this.renderer.snapshotCanvas(this.canvas,callback,false,x,y,width,height,type,encoderOptions)}return this},snapshot:function(callback,type,encoderOptions){if(this.gl){this.renderer.snapshotFramebuffer(this.framebuffer,this.width,this.height,callback,false,0,0,this.width,this.height,type,encoderOptions)}else{this.renderer.snapshotCanvas(this.canvas,callback,false,0,0,this.width,this.height,type,encoderOptions)}return this},snapshotPixel:function(x,y,callback){if(this.gl){this.renderer.snapshotFramebuffer(this.framebuffer,this.width,this.height,callback,true,x,y)}else{this.renderer.snapshotCanvas(this.canvas,callback,true,x,y)}return this},preDestroy:function(){if(!this._saved){CanvasPool.remove(this.canvas);if(this.gl){this.renderer.deleteFramebuffer(this.framebuffer)}this.texture.destroy();this.camera.destroy();this.canvas=null;this.context=null;this.framebuffer=null;this.texture=null;this.glTexture=null}}});module.exports=RenderTexture}),(function(module,exports){var UUID=function(){return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0;var v=(c==='x')?r:(r&0x3|0x8);return v.toString(16)})};module.exports=UUID}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var RopeRender=__webpack_require__(985);var Vector2=__webpack_require__(3);var Rope=new Class({Extends:GameObject,Mixins:[Components.AlphaSingle,Components.BlendMode,Components.Depth,Components.Flip,Components.Mask,Components.Pipeline,Components.Size,Components.Texture,Components.Transform,Components.Visible,Components.ScrollFactor,RopeRender],initialize:function Rope(scene,x,y,texture,frame,points,horizontal,colors,alphas){if(texture===undefined){texture='__DEFAULT'}if(points===undefined){points=2}if(horizontal===undefined){horizontal=true}GameObject.call(this,scene,'Rope');this.anims=new Components.Animation(this);this.points=points;this.vertices;this.uv;this.colors;this.alphas;this.tintFill=(texture==='__DEFAULT')?2:0;this.dirty=false;this.horizontal=horizontal;this._flipX=false;this._flipY=false;this._perp=new Vector2();this.debugCallback=null;this.debugGraphic=null;this.setTexture(texture,frame);this.setPosition(x,y);this.setSizeToFrame();this.initPipeline('TextureTintStripPipeline');if(Array.isArray(points)){this.resizeArrays(points.length)}this.setPoints(points,colors,alphas);this.updateVertices()},preUpdate:function(time,delta){var prevFrame=this.anims.currentFrame;this.anims.update(time,delta);if(this.anims.currentFrame!==prevFrame){this.updateUVs();this.updateVertices()}},play:function(key,ignoreIfPlaying,startFrame){this.anims.play(key,ignoreIfPlaying,startFrame);return this},setDirty:function(){this.dirty=true;return this},setHorizontal:function(points,colors,alphas){if(points===undefined){points=this.points.length}if(this.horizontal){return this}this.horizontal=true;return this.setPoints(points,colors,alphas)},setVertical:function(points,colors,alphas){if(points===undefined){points=this.points.length}if(!this.horizontal){return this}this.horizontal=false;return this.setPoints(points,colors,alphas)},setTintFill:function(value){if(value===undefined){value=0}this.tintFill=value;return this},setAlphas:function(alphas,bottomAlpha){var total=this.points.length;if(total<1){return this}var currentAlphas=this.alphas;if(alphas===undefined){alphas=[1]}else if(!Array.isArray(alphas)&&bottomAlpha===undefined){alphas=[alphas]}var i;var index=0;if(bottomAlpha!==undefined){for(i=0;i<total;i++){index=i*2;currentAlphas[index]=alphas;currentAlphas[index+1]=bottomAlpha}}else if(alphas.length===total){for(i=0;i<total;i++){index=i*2;currentAlphas[index]=alphas[i];currentAlphas[index+1]=alphas[i]}}else{var prevAlpha=alphas[0];for(i=0;i<total;i++){index=i*2;if(alphas.length>index){prevAlpha=alphas[index]}currentAlphas[index]=prevAlpha;if(alphas.length>index+1){prevAlpha=alphas[index+1]}currentAlphas[index+1]=prevAlpha}}return this},setColors:function(colors){var total=this.points.length;if(total<1){return this}var currentColors=this.colors;if(colors===undefined){colors=[0xffffff]}else if(!Array.isArray(colors)){colors=[colors]}var i;var index=0;if(colors.length===total){for(i=0;i<total;i++){index=i*2;currentColors[index]=colors[i];currentColors[index+1]=colors[i]}}else{var prevColor=colors[0];for(i=0;i<total;i++){index=i*2;if(colors.length>index){prevColor=colors[index]}currentColors[index]=prevColor;if(colors.length>index+1){prevColor=colors[index+1]}currentColors[index+1]=prevColor}}return this},setPoints:function(points,colors,alphas){if(points===undefined){points=2}if(typeof points==='number'){var segments=points;if(segments<2){segments=2}points=[];var s;var frameSegment;var offset;if(this.horizontal){offset=-(this.frame.halfWidth);frameSegment=this.frame.width/(segments-1);for(s=0;s<segments;s++){points.push({x:offset+s*frameSegment,y:0})}}else{offset=-(this.frame.halfHeight);frameSegment=this.frame.height/(segments-1);for(s=0;s<segments;s++){points.push({x:0,y:offset+s*frameSegment})}}}var total=points.length;var currentTotal=this.points.length;if(total<1){console.warn('Rope: Not enough points given');return this}else if(total===1){points.unshift({x:0,y:0});total++}if(currentTotal!==total){this.resizeArrays(total)}this.points=points;this.updateUVs();if(colors!==undefined&&colors!==null){this.setColors(colors)}if(alphas!==undefined&&alphas!==null){this.setAlphas(alphas)}return this},updateUVs:function(){var currentUVs=this.uv;var total=this.points.length;var u0=this.frame.u0;var v0=this.frame.v0;var u1=this.frame.u1;var v1=this.frame.v1;var partH=(u1-u0)/(total-1);var partV=(v1-v0)/(total-1);for(var i=0;i<total;i++){var index=i*4;var uv0;var uv1;var uv2;var uv3;if(this.horizontal){if(this._flipX){uv0=u1-(i*partH);uv2=u1-(i*partH)}else{uv0=u0+(i*partH);uv2=u0+(i*partH)}if(this._flipY){uv1=v1;uv3=v0}else{uv1=v0;uv3=v1}}else{if(this._flipX){uv0=u0;uv2=u1}else{uv0=u1;uv2=u0}if(this._flipY){uv1=v1-(i*partV);uv3=v1-(i*partV)}else{uv1=v0+(i*partV);uv3=v0+(i*partV)}}currentUVs[index+0]=uv0;currentUVs[index+1]=uv1;currentUVs[index+2]=uv2;currentUVs[index+3]=uv3}return this},resizeArrays:function(newSize){var colors=this.colors;var alphas=this.alphas;this.vertices=new Float32Array(newSize*4);this.uv=new Float32Array(newSize*4);colors=new Uint32Array(newSize*2);alphas=new Float32Array(newSize*2);for(var i=0;i<newSize*2;i++){colors[i]=0xffffff;alphas[i]=1}this.colors=colors;this.alphas=alphas;this.dirty=true;return this},updateVertices:function(){var perp=this._perp;var points=this.points;var vertices=this.vertices;var total=points.length;this.dirty=false;if(total<1){return}var nextPoint;var lastPoint=points[0];var frameSize=(this.horizontal)?this.frame.halfHeight:this.frame.halfWidth;for(var i=0;i<total;i++){var point=points[i];var index=i*4;if(i<total-1){nextPoint=points[i+1]}else{nextPoint=point}perp.x=nextPoint.y-lastPoint.y;perp.y=-(nextPoint.x-lastPoint.x);var perpLength=perp.length();perp.x/=perpLength;perp.y/=perpLength;perp.x*=frameSize;perp.y*=frameSize;vertices[index]=point.x+perp.x;vertices[index+1]=point.y+perp.y;vertices[index+2]=point.x-perp.x;vertices[index+3]=point.y-perp.y;lastPoint=point}return this},setDebug:function(graphic,callback){this.debugGraphic=graphic;if(!graphic&&!callback){this.debugCallback=null}else if(!callback){this.debugCallback=this.renderDebugVerts}else{this.debugCallback=callback}return this},renderDebugVerts:function(src,meshLength,verts){var graphic=src.debugGraphic;var px0=verts[0];var py0=verts[1];var px1=verts[2];var py1=verts[3];graphic.lineBetween(px0,py0,px1,py1);for(var i=4;i<meshLength;i+=4){var x0=verts[i+0];var y0=verts[i+1];var x1=verts[i+2];var y1=verts[i+3];graphic.lineBetween(px0,py0,x0,y0);graphic.lineBetween(px1,py1,x1,y1);graphic.lineBetween(px1,py1,x0,y0);graphic.lineBetween(x0,y0,x1,y1);px0=x0;py0=y0;px1=x1;py1=y1}},preDestroy:function(){this.anims.destroy();this.anims=undefined;this.points=null;this.vertices=null;this.uv=null;this.colors=null;this.alphas=null;this.debugCallback=null;this.debugGraphic=null},flipX:{get:function(){return this._flipX},set:function(value){this._flipX=value;return this.updateUVs()}},flipY:{get:function(){return this._flipY},set:function(value){this._flipY=value;return this.updateUVs()}}});module.exports=Rope}),(function(module,exports,__webpack_require__){var AddToDOM=__webpack_require__(122);var CanvasPool=__webpack_require__(26);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameEvents=__webpack_require__(20);var GameObject=__webpack_require__(14);var GetTextSize=__webpack_require__(988);var GetValue=__webpack_require__(6);var RemoveFromDOM=__webpack_require__(178);var TextRender=__webpack_require__(989);var TextStyle=__webpack_require__(992);var Text=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.ComputedSize,Components.Crop,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Tint,Components.Transform,Components.Visible,TextRender],initialize:function Text(scene,x,y,text,style){if(x===undefined){x=0}if(y===undefined){y=0}GameObject.call(this,scene,'Text');this.renderer=scene.sys.game.renderer;this.setPosition(x,y);this.setOrigin(0,0);this.initPipeline();this.canvas=CanvasPool.create(this);this.context=this.canvas.getContext('2d');this.style=new TextStyle(this,style);this.autoRound=true;this.splitRegExp=/(?:\r\n|\r|\n)/;this._text=undefined;this.padding={left:0,right:0,top:0,bottom:0};this.width=1;this.height=1;this.lineSpacing=0;this.dirty=false;if(this.style.resolution===0){this.style.resolution=scene.sys.game.config.resolution}this._crop=this.resetCropObject();this.texture=scene.sys.textures.addCanvas(null,this.canvas,true);this.frame=this.texture.get();this.frame.source.resolution=this.style.resolution;if(this.renderer&&this.renderer.gl){this.renderer.deleteTexture(this.frame.source.glTexture);this.frame.source.glTexture=null}this.initRTL();this.setText(text);if(style&&style.padding){this.setPadding(style.padding)}if(style&&style.lineSpacing){this.setLineSpacing(style.lineSpacing)}scene.sys.game.events.on(GameEvents.CONTEXT_RESTORED,function(){this.dirty=true},this)},initRTL:function(){if(!this.style.rtl){return}this.canvas.dir='rtl';this.context.direction='rtl';this.canvas.style.display='none';AddToDOM(this.canvas,this.scene.sys.canvas);this.originX=1},runWordWrap:function(text){var style=this.style;if(style.wordWrapCallback){var wrappedLines=style.wordWrapCallback.call(style.wordWrapCallbackScope,text,this);if(Array.isArray(wrappedLines)){wrappedLines=wrappedLines.join('\n')}return wrappedLines}else if(style.wordWrapWidth){if(style.wordWrapUseAdvanced){return this.advancedWordWrap(text,this.context,this.style.wordWrapWidth)}else{return this.basicWordWrap(text,this.context,this.style.wordWrapWidth)}}else{return text}},advancedWordWrap:function(text,context,wordWrapWidth){var output='';var lines=text.replace(/ +/gi,' ').split(this.splitRegExp);var linesCount=lines.length;for(var i=0;i<linesCount;i++){var line=lines[i];var out='';line=line.replace(/^ *|\s*$/gi,'');var lineWidth=context.measureText(line).width;if(lineWidth<wordWrapWidth){output+=line+'\n';continue}var currentLineWidth=wordWrapWidth;var words=line.split(' ');for(var j=0;j<words.length;j++){var word=words[j];var wordWithSpace=word+' ';var wordWidth=context.measureText(wordWithSpace).width;if(wordWidth>currentLineWidth){if(j===0){var newWord=wordWithSpace;while(newWord.length){newWord=newWord.slice(0,-1);wordWidth=context.measureText(newWord).width;if(wordWidth<=currentLineWidth){break}}if(!newWord.length){throw new Error('This text\'s wordWrapWidth setting is less than a single character!')}var secondPart=word.substr(newWord.length);words[j]=secondPart;out+=newWord}var offset=(words[j].length)?j:j+1;var remainder=words.slice(offset).join(' ').replace(/[ \n]*$/gi,'');lines[i+1]=remainder+' '+(lines[i+1]||'');linesCount=lines.length;break}else{out+=wordWithSpace;currentLineWidth-=wordWidth}}output+=out.replace(/[ \n]*$/gi,'')+'\n'}output=output.replace(/[\s|\n]*$/gi,'');return output},basicWordWrap:function(text,context,wordWrapWidth){var result='';var lines=text.split(this.splitRegExp);var lastLineIndex=lines.length-1;var whiteSpaceWidth=context.measureText(' ').width;for(var i=0;i<=lastLineIndex;i++){var spaceLeft=wordWrapWidth;var words=lines[i].split(' ');var lastWordIndex=words.length-1;for(var j=0;j<=lastWordIndex;j++){var word=words[j];var wordWidth=context.measureText(word).width;var wordWidthWithSpace=wordWidth+whiteSpaceWidth;if(wordWidthWithSpace>spaceLeft){if(j>0){result+='\n';spaceLeft=wordWrapWidth}}result+=word;if(j<lastWordIndex){result+=' ';spaceLeft-=wordWidthWithSpace}else{spaceLeft-=wordWidth}}if(i<lastLineIndex){result+='\n'}}return result},getWrappedText:function(text){if(text===undefined){text=this._text}this.style.syncFont(this.canvas,this.context);var wrappedLines=this.runWordWrap(text);return wrappedLines.split(this.splitRegExp)},setText:function(value){if(!value&&value!==0){value=''}if(Array.isArray(value)){value=value.join('\n')}if(value!==this._text){this._text=value.toString();this.updateText()}return this},setStyle:function(style){return this.style.setStyle(style)},setFont:function(font){return this.style.setFont(font)},setFontFamily:function(family){return this.style.setFontFamily(family)},setFontSize:function(size){return this.style.setFontSize(size)},setFontStyle:function(style){return this.style.setFontStyle(style)},setFixedSize:function(width,height){return this.style.setFixedSize(width,height)},setBackgroundColor:function(color){return this.style.setBackgroundColor(color)},setFill:function(fillStyle){return this.style.setFill(fillStyle)},setColor:function(color){return this.style.setColor(color)},setStroke:function(color,thickness){return this.style.setStroke(color,thickness)},setShadow:function(x,y,color,blur,shadowStroke,shadowFill){return this.style.setShadow(x,y,color,blur,shadowStroke,shadowFill)},setShadowOffset:function(x,y){return this.style.setShadowOffset(x,y)},setShadowColor:function(color){return this.style.setShadowColor(color)},setShadowBlur:function(blur){return this.style.setShadowBlur(blur)},setShadowStroke:function(enabled){return this.style.setShadowStroke(enabled)},setShadowFill:function(enabled){return this.style.setShadowFill(enabled)},setWordWrapWidth:function(width,useAdvancedWrap){return this.style.setWordWrapWidth(width,useAdvancedWrap)},setWordWrapCallback:function(callback,scope){return this.style.setWordWrapCallback(callback,scope)},setAlign:function(align){return this.style.setAlign(align)},setResolution:function(value){return this.style.setResolution(value)},setLineSpacing:function(value){this.lineSpacing=value;return this.updateText()},setPadding:function(left,top,right,bottom){if(typeof left==='object'){var config=left;var x=GetValue(config,'x',null);if(x!==null){left=x;right=x}else{left=GetValue(config,'left',0);right=GetValue(config,'right',left)}var y=GetValue(config,'y',null);if(y!==null){top=y;bottom=y}else{top=GetValue(config,'top',0);bottom=GetValue(config,'bottom',top)}}else{if(left===undefined){left=0}if(top===undefined){top=left}if(right===undefined){right=left}if(bottom===undefined){bottom=top}}this.padding.left=left;this.padding.top=top;this.padding.right=right;this.padding.bottom=bottom;return this.updateText()},setMaxLines:function(max){return this.style.setMaxLines(max)},updateText:function(){var canvas=this.canvas;var context=this.context;var style=this.style;var resolution=style.resolution;var size=style.metrics;style.syncFont(canvas,context);var outputText=this._text;if(style.wordWrapWidth||style.wordWrapCallback){outputText=this.runWordWrap(this._text)}var lines=outputText.split(this.splitRegExp);var textSize=GetTextSize(this,size,lines);var padding=this.padding;var textWidth;if(style.fixedWidth===0){this.width=textSize.width+padding.left+padding.right;textWidth=textSize.width}else{this.width=style.fixedWidth;textWidth=this.width-padding.left-padding.right;if(textWidth<textSize.width){textWidth=textSize.width}}if(style.fixedHeight===0){this.height=textSize.height+padding.top+padding.bottom}else{this.height=style.fixedHeight}var w=this.width;var h=this.height;this.updateDisplayOrigin();w*=resolution;h*=resolution;w=Math.max(w,1);h=Math.max(h,1);if(canvas.width!==w||canvas.height!==h){canvas.width=w;canvas.height=h;this.frame.setSize(w,h);style.syncFont(canvas,context)}else{context.clearRect(0,0,w,h)}context.save();context.scale(resolution,resolution);if(style.backgroundColor){context.fillStyle=style.backgroundColor;context.fillRect(0,0,w,h)}style.syncStyle(canvas,context);context.textBaseline='alphabetic';context.translate(padding.left,padding.top);var linePositionX;var linePositionY;for(var i=0;i<textSize.lines;i++){linePositionX=style.strokeThickness/2;linePositionY=(style.strokeThickness/2+i*textSize.lineHeight)+size.ascent;if(i>0){linePositionY+=(textSize.lineSpacing*i)}if(style.rtl){linePositionX=w-linePositionX}else if(style.align==='right'){linePositionX+=textWidth-textSize.lineWidths[i]}else if(style.align==='center'){linePositionX+=(textWidth-textSize.lineWidths[i])/2}else if(style.align==='justify'){var minimumLengthToApplyJustification=0.85;if(textSize.lineWidths[i]/textSize.width>=minimumLengthToApplyJustification){var extraSpace=textSize.width-textSize.lineWidths[i];var spaceSize=context.measureText(' ').width;var trimmedLine=lines[i].trim();var array=trimmedLine.split(' ');extraSpace+=(lines[i].length-trimmedLine.length)*spaceSize;var extraSpaceCharacters=Math.floor(extraSpace/spaceSize);var idx=0;while(extraSpaceCharacters>0){array[idx]+=' ';idx=(idx+1)%(array.length-1||1);--extraSpaceCharacters}lines[i]=array.join(' ')}}if(this.autoRound){linePositionX=Math.round(linePositionX);linePositionY=Math.round(linePositionY)}if(style.strokeThickness){this.style.syncShadow(context,style.shadowStroke);context.strokeText(lines[i],linePositionX,linePositionY)}if(style.color){this.style.syncShadow(context,style.shadowFill);context.fillText(lines[i],linePositionX,linePositionY)}}context.restore();if(this.renderer&&this.renderer.gl){this.frame.source.glTexture=this.renderer.canvasToTexture(canvas,this.frame.source.glTexture,true);this.frame.glTexture=this.frame.source.glTexture}this.dirty=true;var input=this.input;if(input&&!input.customHitArea){input.hitArea.width=this.width;input.hitArea.height=this.height}return this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(value){this.setText(value)}},toJSON:function(){var out=Components.ToJSON(this);var data={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};out.data=data;return out},preDestroy:function(){if(this.style.rtl){RemoveFromDOM(this.canvas)}CanvasPool.remove(this.canvas);this.texture.destroy()}});module.exports=Text}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameEvents=__webpack_require__(20);var GameObject=__webpack_require__(14);var GetPowerOfTwo=__webpack_require__(329);var Smoothing=__webpack_require__(167);var TileSpriteRender=__webpack_require__(994);var Vector2=__webpack_require__(3);var _FLAG=8;var TileSprite=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.ComputedSize,Components.Crop,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Tint,Components.Transform,Components.Visible,TileSpriteRender],initialize:function TileSprite(scene,x,y,width,height,textureKey,frameKey){var renderer=scene.sys.game.renderer;GameObject.call(this,scene,'TileSprite');var displayTexture=scene.sys.textures.get(textureKey);var displayFrame=displayTexture.get(frameKey);if(!width||!height){width=displayFrame.width;height=displayFrame.height}else{width=Math.floor(width);height=Math.floor(height)}this._tilePosition=new Vector2();this._tileScale=new Vector2(1,1);this.dirty=false;this.renderer=renderer;this.canvas=CanvasPool.create(this,width,height);this.context=this.canvas.getContext('2d');this.displayTexture=displayTexture;this.displayFrame=displayFrame;this._crop=this.resetCropObject();this.texture=scene.sys.textures.addCanvas(null,this.canvas,true);this.frame=this.texture.get();this.potWidth=GetPowerOfTwo(displayFrame.width);this.potHeight=GetPowerOfTwo(displayFrame.height);this.fillCanvas=CanvasPool.create2D(this,this.potWidth,this.potHeight);this.fillContext=this.fillCanvas.getContext('2d');this.fillPattern=null;this.setPosition(x,y);this.setSize(width,height);this.setFrame(frameKey);this.setOriginFromFrame();this.initPipeline();scene.sys.game.events.on(GameEvents.CONTEXT_RESTORED,function(renderer){var gl=renderer.gl;this.dirty=true;this.fillPattern=null;this.fillPattern=renderer.createTexture2D(0,gl.LINEAR,gl.LINEAR,gl.REPEAT,gl.REPEAT,gl.RGBA,this.fillCanvas,this.potWidth,this.potHeight)},this)},setTexture:function(key,frame){this.displayTexture=this.scene.sys.textures.get(key);return this.setFrame(frame)},setFrame:function(frame){var newFrame=this.displayTexture.get(frame);this.potWidth=GetPowerOfTwo(newFrame.width);this.potHeight=GetPowerOfTwo(newFrame.height);this.canvas.width=0;if(!newFrame.cutWidth||!newFrame.cutHeight){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}this.displayFrame=newFrame;this.dirty=true;this.updateTileTexture();return this},setTilePosition:function(x,y){if(x!==undefined){this.tilePositionX=x}if(y!==undefined){this.tilePositionY=y}return this},setTileScale:function(x,y){if(x===undefined){x=this.tileScaleX}if(y===undefined){y=x}this.tileScaleX=x;this.tileScaleY=y;return this},updateTileTexture:function(){if(!this.dirty||!this.renderer){return}var frame=this.displayFrame;if(frame.source.isRenderTexture||frame.source.isGLTexture){console.warn('TileSprites can only use Image or Canvas based textures');this.dirty=false;return}var ctx=this.fillContext;var canvas=this.fillCanvas;var fw=this.potWidth;var fh=this.potHeight;if(!this.renderer.gl){fw=frame.cutWidth;fh=frame.cutHeight}ctx.clearRect(0,0,fw,fh);canvas.width=fw;canvas.height=fh;ctx.drawImage(frame.source.image,frame.cutX,frame.cutY,frame.cutWidth,frame.cutHeight,0,0,fw,fh);if(this.renderer.gl){this.fillPattern=this.renderer.canvasToTexture(canvas,this.fillPattern)}else{this.fillPattern=ctx.createPattern(canvas,'repeat')}this.updateCanvas();this.dirty=false},updateCanvas:function(){var canvas=this.canvas;if(canvas.width!==this.width||canvas.height!==this.height){canvas.width=this.width;canvas.height=this.height;this.frame.setSize(this.width,this.height);this.updateDisplayOrigin();this.dirty=true}if(!this.dirty||this.renderer&&this.renderer.gl){this.dirty=false;return}var ctx=this.context;if(!this.scene.sys.game.config.antialias){Smoothing.disable(ctx)}var scaleX=this._tileScale.x;var scaleY=this._tileScale.y;var positionX=this._tilePosition.x;var positionY=this._tilePosition.y;ctx.clearRect(0,0,this.width,this.height);ctx.save();ctx.scale(scaleX,scaleY);ctx.translate(-positionX,-positionY);ctx.fillStyle=this.fillPattern;ctx.fillRect(positionX,positionY,this.width/scaleX,this.height/scaleY);ctx.restore();this.dirty=false},preDestroy:function(){if(this.renderer&&this.renderer.gl){this.renderer.deleteTexture(this.fillPattern)}CanvasPool.remove(this.canvas);CanvasPool.remove(this.fillCanvas);this.fillPattern=null;this.fillContext=null;this.fillCanvas=null;this.displayTexture=null;this.displayFrame=null;this.texture.destroy();this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(value){this._tilePosition.x=value;this.dirty=true}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(value){this._tilePosition.y=value;this.dirty=true}},tileScaleX:{get:function(){return this._tileScale.x},set:function(value){this._tileScale.x=value;this.dirty=true}},tileScaleY:{get:function(){return this._tileScale.y},set:function(value){this._tileScale.y=value;this.dirty=true}}});module.exports=TileSprite}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Clamp=__webpack_require__(19);var Components=__webpack_require__(12);var Events=__webpack_require__(90);var GameEvents=__webpack_require__(20);var GameObject=__webpack_require__(14);var SoundEvents=__webpack_require__(59);var UUID=__webpack_require__(196);var VideoRender=__webpack_require__(997);var MATH_CONST=__webpack_require__(13);var Video=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScrollFactor,Components.Size,Components.TextureCrop,Components.Tint,Components.Transform,Components.Visible,VideoRender],initialize:function Video(scene,x,y,key){GameObject.call(this,scene,'Video');this.video=null;this.videoTexture=null;this.videoTextureSource=null;this.snapshotTexture=null;this.flipY=false;this._key=UUID();this.touchLocked=true;this.playWhenUnlocked=false;this.retryLimit=20;this.retry=0;this.retryInterval=500;this._retryID=null;this._systemMuted=false;this._codeMuted=false;this._systemPaused=false;this._codePaused=false;this._callbacks={play:this.playHandler.bind(this),error:this.loadErrorHandler.bind(this),end:this.completeHandler.bind(this),time:this.timeUpdateHandler.bind(this),seeking:this.seekingHandler.bind(this),seeked:this.seekedHandler.bind(this)};this._crop=this.resetCropObject();this.markers={};this._markerIn=-1;this._markerOut=MATH_CONST.MAX_SAFE_INTEGER;this._lastUpdate=0;this._cacheKey='';this._isSeeking=false;this.removeVideoElementOnDestroy=false;this.setPosition(x,y);this.initPipeline();if(key){this.changeSource(key,false)}var game=scene.sys.game.events;game.on(GameEvents.PAUSE,this.globalPause,this);game.on(GameEvents.RESUME,this.globalResume,this);var sound=scene.sys.sound;if(sound){sound.on(SoundEvents.GLOBAL_MUTE,this.globalMute,this)}},play:function(loop,markerIn,markerOut){if((this.touchLocked&&this.playWhenUnlocked)||this.isPlaying()){return this}var video=this.video;if(!video){console.warn('Video not loaded');return this}if(loop===undefined){loop=video.loop}var sound=this.scene.sys.sound;if(sound&&sound.mute){this.setMute(true)}if(!isNaN(markerIn)){this._markerIn=markerIn}if(!isNaN(markerOut)&&markerOut>markerIn){this._markerOut=markerOut}video.loop=loop;var callbacks=this._callbacks;var playPromise=video.play();if(playPromise!==undefined){playPromise.then(this.playPromiseSuccessHandler.bind(this)).catch(this.playPromiseErrorHandler.bind(this))}else{video.addEventListener('playing',callbacks.play,true);if(video.readyState<2){this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)}}video.addEventListener('ended',callbacks.end,true);video.addEventListener('timeupdate',callbacks.time,true);video.addEventListener('seeking',callbacks.seeking,true);video.addEventListener('seeked',callbacks.seeked,true);return this},changeSource:function(key,autoplay,loop,markerIn,markerOut){if(autoplay===undefined){autoplay=true}var currentVideo=this.video;if(currentVideo){this.stop()}var newVideo=this.scene.sys.cache.video.get(key);if(newVideo){this.video=newVideo;this._cacheKey=key;this._codePaused=newVideo.paused;this._codeMuted=newVideo.muted;if(this.videoTexture){this.scene.sys.textures.remove(this._key);this.videoTexture=this.scene.sys.textures.create(this._key,newVideo,newVideo.videoWidth,newVideo.videoHeight);this.videoTextureSource=this.videoTexture.source[0];this.videoTexture.add('__BASE',0,0,0,newVideo.videoWidth,newVideo.videoHeight);this.setTexture(this.videoTexture);this.setSizeToFrame();this.updateDisplayOrigin();this.emit(Events.VIDEO_CREATED,this,newVideo.videoWidth,newVideo.videoHeight)}else{this.updateTexture()}newVideo.currentTime=0;this._lastUpdate=0;if(autoplay){this.play(loop,markerIn,markerOut)}}else{this.video=null}return this},addMarker:function(key,markerIn,markerOut){if(!isNaN(markerIn)&&markerIn>=0&&!isNaN(markerOut)){this.markers[key]=[markerIn,markerOut]}return this},playMarker:function(key,loop){var marker=this.markers[key];if(marker){this.play(loop,marker[0],marker[1])}return this},removeMarker:function(key){delete this.markers[key];return this},snapshot:function(width,height){if(width===undefined){width=this.width}if(height===undefined){height=this.height}return this.snapshotArea(0,0,this.width,this.height,width,height)},snapshotArea:function(x,y,srcWidth,srcHeight,destWidth,destHeight){if(x===undefined){x=0}if(y===undefined){y=0}if(srcWidth===undefined){srcWidth=this.width}if(srcHeight===undefined){srcHeight=this.height}if(destWidth===undefined){destWidth=srcWidth}if(destHeight===undefined){destHeight=srcHeight}var video=this.video;var snap=this.snapshotTexture;if(!snap){snap=this.scene.sys.textures.createCanvas(UUID(),destWidth,destHeight);this.snapshotTexture=snap;if(video){snap.context.drawImage(video,x,y,srcWidth,srcHeight,0,0,destWidth,destHeight)}}else{snap.setSize(destWidth,destHeight);if(video){snap.context.drawImage(video,x,y,srcWidth,srcHeight,0,0,destWidth,destHeight)}}return snap.update()},saveSnapshotTexture:function(key){if(this.snapshotTexture){this.scene.sys.textures.renameTexture(this.snapshotTexture.key,key)}else{this.snapshotTexture=this.scene.sys.textures.createCanvas(key,this.width,this.height)}return this.snapshotTexture},loadURL:function(url,loadEvent,noAudio){if(loadEvent===undefined){loadEvent='loadeddata'}if(noAudio===undefined){noAudio=false}if(this.video){this.stop()}if(this.videoTexture){this.scene.sys.textures.remove(this._key)}var video=document.createElement('video');video.controls=false;if(noAudio){video.muted=true;video.defaultMuted=true;video.setAttribute('autoplay','autoplay')}video.setAttribute('playsinline','playsinline');video.setAttribute('preload','auto');video.addEventListener('error',this._callbacks.error,true);video.src=url;video.load();this.video=video;return this},playPromiseSuccessHandler:function(){this.touchLocked=false;this.emit(Events.VIDEO_PLAY,this);if(this._markerIn>-1){this.video.currentTime=this._markerIn}},playPromiseErrorHandler:function(error){this.scene.sys.input.once('pointerdown',this.unlockHandler,this);this.touchLocked=true;this.playWhenUnlocked=true;this.emit(Events.VIDEO_ERROR,this,error)},playHandler:function(){this.touchLocked=false;this.emit(Events.VIDEO_PLAY,this);this.video.removeEventListener('playing',this._callbacks.play,true)},loadErrorHandler:function(event){this.stop();this.emit(Events.VIDEO_ERROR,this,event)},unlockHandler:function(){this.touchLocked=false;this.playWhenUnlocked=false;this.emit(Events.VIDEO_UNLOCKED,this);if(this._markerIn>-1){this.video.currentTime=this._markerIn}this.video.play();this.emit(Events.VIDEO_PLAY,this)},completeHandler:function(){this.emit(Events.VIDEO_COMPLETE,this)},timeUpdateHandler:function(){if(this.video&&this.video.currentTime<this._lastUpdate){this.emit(Events.VIDEO_LOOP,this);this._lastUpdate=0}},preUpdate:function(){var video=this.video;if(video){var currentTime=video.currentTime;if(currentTime!==this._lastUpdate){this._lastUpdate=currentTime;this.updateTexture();if(currentTime>=this._markerOut){if(video.loop){video.currentTime=this._markerIn;this.updateTexture();this._lastUpdate=currentTime;this.emit(Events.VIDEO_LOOP,this)}else{this.emit(Events.VIDEO_COMPLETE,this);this.stop()}}}}},checkVideoProgress:function(){if(this.video.readyState>=2){this.updateTexture()}else{this.retry--;if(this.retry>0){this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)}else{this.emit(Events.VIDEO_TIMEOUT,this)}}},updateTexture:function(){var video=this.video;var width=video.videoWidth;var height=video.videoHeight;if(!this.videoTexture){this.videoTexture=this.scene.sys.textures.create(this._key,video,width,height);this.videoTextureSource=this.videoTexture.source[0];this.videoTexture.add('__BASE',0,0,0,width,height);this.setTexture(this.videoTexture);this.setSizeToFrame();this.updateDisplayOrigin();this.emit(Events.VIDEO_CREATED,this,width,height)}else{var textureSource=this.videoTextureSource;if(textureSource.source!==video){textureSource.source=video;textureSource.width=width;textureSource.height=height}textureSource.update()}},getVideoKey:function(){return this._cacheKey},seekTo:function(value){var video=this.video;if(video){var duration=video.duration;if(duration!==Infinity&&!isNaN(duration)){var seekTime=duration*value;this.setCurrentTime(seekTime)}}return this},getCurrentTime:function(){return(this.video)?this.video.currentTime:0},setCurrentTime:function(value){var video=this.video;if(video){if(typeof value==='string'){var op=value[0];var num=parseFloat(value.substr(1));if(op==='+'){value=video.currentTime+num}else if(op==='-'){value=video.currentTime-num}}video.currentTime=value;this._lastUpdate=value}return this},isSeeking:function(){return this._isSeeking},seekingHandler:function(){this._isSeeking=true;this.emit(Events.VIDEO_SEEKING,this)},seekedHandler:function(){this._isSeeking=false;this.emit(Events.VIDEO_SEEKED,this);var video=this.video;if(video){this.updateTexture()}},getProgress:function(){var video=this.video;if(video){var now=video.currentTime;var duration=video.duration;if(duration!==Infinity&&!isNaN(duration)){return now/duration}}return 0},getDuration:function(){return(this.video)?this.video.duration:0},setMute:function(value){if(value===undefined){value=true}this._codeMuted=value;var video=this.video;if(video){video.muted=(this._systemMuted)?true:value}return this},isMuted:function(){return this._codeMuted},globalMute:function(soundManager,value){this._systemMuted=value;var video=this.video;if(video){video.muted=(this._codeMuted)?true:value}},globalPause:function(){this._systemPaused=true;if(this.video){this.video.pause()}},globalResume:function(){this._systemPaused=false;if(this.video&&!this._codePaused){this.video.play()}},setPaused:function(value){if(value===undefined){value=true}var video=this.video;this._codePaused=value;if(video){if(value){if(!video.paused){video.pause()}}else if(!value){if(video.paused&&!this._systemPaused){video.play()}}}return this},getVolume:function(){return(this.video)?this.video.volume:1},setVolume:function(value){if(value===undefined){value=1}if(this.video){this.video.volume=Clamp(value,0,1)}return this},getPlaybackRate:function(){return(this.video)?this.video.playbackRate:1},setPlaybackRate:function(rate){if(this.video){this.video.playbackRate=rate}return this},getLoop:function(){return(this.video)?this.video.loop:false},setLoop:function(value){if(value===undefined){value=true}if(this.video){this.video.loop=value}return this},isPlaying:function(){return(this.video)?!(this.video.paused||this.video.ended):false},isPaused:function(){return((this.video&&this.video.paused)||this._codePaused||this._systemPaused)},saveTexture:function(key,flipY){if(flipY===undefined){flipY=false}if(this.videoTexture){this.scene.sys.textures.renameTexture(this._key,key)}this._key=key;this.flipY=flipY;if(this.videoTextureSource){this.videoTextureSource.setFlipY(flipY)}return this.videoTexture},stop:function(){var video=this.video;if(video){var callbacks=this._callbacks;for(var callback in callbacks){video.removeEventListener(callback,callbacks[callback],true)}video.pause()}if(this._retryID){window.clearTimeout(this._retryID)}this.emit(Events.VIDEO_STOP,this);return this},removeVideoElement:function(){var video=this.video;if(!video){return}if(video.parentNode){video.parentNode.removeChild(video)}while(video.hasChildNodes()){video.removeChild(video.firstChild)}video.removeAttribute('autoplay');video.removeAttribute('src');this.video=null},preDestroy:function(){this.stop();if(this.removeVideoElementOnDestroy){this.removeVideoElement()}var game=this.scene.sys.game.events;game.off(GameEvents.PAUSE,this.globalPause,this);game.off(GameEvents.RESUME,this.globalResume,this);var sound=this.scene.sys.sound;if(sound){sound.off(SoundEvents.GLOBAL_MUTE,this.globalMute,this)}if(this._retryID){window.clearTimeout(this._retryID)}}});module.exports=Video}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Contains=__webpack_require__(202);var GetPoints=__webpack_require__(419);var GEOM_CONST=__webpack_require__(47);var Polygon=new Class({initialize:function Polygon(points){this.type=GEOM_CONST.POLYGON;this.area=0;this.points=[];if(points){this.setTo(points)}},contains:function(x,y){return Contains(this,x,y)},setTo:function(points){this.area=0;this.points=[];if(typeof points==='string'){points=points.split(' ')}if(!Array.isArray(points)){return this}var p;var y0=Number.MAX_VALUE;for(var i=0;i<points.length;i++){p={x:0,y:0};if(typeof points[i]==='number'||typeof points[i]==='string'){p.x=parseFloat(points[i]);p.y=parseFloat(points[i+1]);i++}else if(Array.isArray(points[i])){p.x=points[i][0];p.y=points[i][1]}else{p.x=points[i].x;p.y=points[i].y}this.points.push(p);if(p.y<y0){y0=p.y}}this.calculateArea(y0);return this},calculateArea:function(){if(this.points.length<3){this.area=0;return this.area}var sum=0;var p1;var p2;for(var i=0;i<this.points.length-1;i++){p1=this.points[i];p2=this.points[i+1];sum+=(p2.x-p1.x)*(p1.y+p2.y)}p1=this.points[0];p2=this.points[this.points.length-1];sum+=(p1.x-p2.x)*(p2.y+p1.y);this.area=-sum*0.5;return this.area},getPoints:function(quantity,step,output){return GetPoints(this,quantity,step,output)}});module.exports=Polygon}),(function(module,exports){var Contains=function(polygon,x,y){var inside=false;for(var i=-1,j=polygon.points.length-1;++i<polygon.points.length;j=i){var ix=polygon.points[i].x;var iy=polygon.points[i].y;var jx=polygon.points[j].x;var jy=polygon.points[j].y;if(((iy<=y&&y<jy)||(jy<=y&&y<iy))&&(x<(jx-ix)*(y-iy)/(jy-iy)+ix)){inside=!inside}}return inside};module.exports=Contains}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Mesh=__webpack_require__(134);var Quad=new Class({Extends:Mesh,initialize:function Quad(scene,x,y,texture,frame){var vertices=[0,0,0,0,0,0,0,0,0,0,0,0];var uv=[0,0,0,1,1,1,0,0,1,1,1,0];var colors=[0xffffff,0xffffff,0xffffff,0xffffff,0xffffff,0xffffff];var alphas=[1,1,1,1,1,1];Mesh.call(this,scene,x,y,vertices,uv,colors,alphas,texture,frame);this.resetPosition()},setFrame:function(frame){this.frame=this.texture.get(frame);if(!this.frame.cutWidth||!this.frame.cutHeight){this.renderFlags&=~8}else{this.renderFlags|=8}frame=this.frame;this.uv[0]=frame.u0;this.uv[1]=frame.v0;this.uv[2]=frame.u0;this.uv[3]=frame.v1;this.uv[4]=frame.u1;this.uv[5]=frame.v1;this.uv[6]=frame.u0;this.uv[7]=frame.v0;this.uv[8]=frame.u1;this.uv[9]=frame.v1;this.uv[10]=frame.u1;this.uv[11]=frame.v0;return this},topLeftX:{get:function(){return this.x+this.vertices[0]},set:function(value){this.vertices[0]=value-this.x;this.vertices[6]=value-this.x}},topLeftY:{get:function(){return this.y+this.vertices[1]},set:function(value){this.vertices[1]=value-this.y;this.vertices[7]=value-this.y}},topRightX:{get:function(){return this.x+this.vertices[10]},set:function(value){this.vertices[10]=value-this.x}},topRightY:{get:function(){return this.y+this.vertices[11]},set:function(value){this.vertices[11]=value-this.y}},bottomLeftX:{get:function(){return this.x+this.vertices[2]},set:function(value){this.vertices[2]=value-this.x}},bottomLeftY:{get:function(){return this.y+this.vertices[3]},set:function(value){this.vertices[3]=value-this.y}},bottomRightX:{get:function(){return this.x+this.vertices[4]},set:function(value){this.vertices[4]=value-this.x;this.vertices[8]=value-this.x}},bottomRightY:{get:function(){return this.y+this.vertices[5]},set:function(value){this.vertices[5]=value-this.y;this.vertices[9]=value-this.y}},topLeftAlpha:{get:function(){return this.alphas[0]},set:function(value){this.alphas[0]=value;this.alphas[3]=value}},topRightAlpha:{get:function(){return this.alphas[5]},set:function(value){this.alphas[5]=value}},bottomLeftAlpha:{get:function(){return this.alphas[1]},set:function(value){this.alphas[1]=value}},bottomRightAlpha:{get:function(){return this.alphas[2]},set:function(value){this.alphas[2]=value;this.alphas[4]=value}},topLeftColor:{get:function(){return this.colors[0]},set:function(value){this.colors[0]=value;this.colors[3]=value}},topRightColor:{get:function(){return this.colors[5]},set:function(value){this.colors[5]=value}},bottomLeftColor:{get:function(){return this.colors[1]},set:function(value){this.colors[1]=value}},bottomRightColor:{get:function(){return this.colors[2]},set:function(value){this.colors[2]=value;this.colors[4]=value}},setTopLeft:function(x,y){this.topLeftX=x;this.topLeftY=y;return this},setTopRight:function(x,y){this.topRightX=x;this.topRightY=y;return this},setBottomLeft:function(x,y){this.bottomLeftX=x;this.bottomLeftY=y;return this},setBottomRight:function(x,y){this.bottomRightX=x;this.bottomRightY=y;return this},resetPosition:function(){var x=this.x;var y=this.y;var halfWidth=Math.floor(this.width/2);var halfHeight=Math.floor(this.height/2);this.setTopLeft(x-halfWidth,y-halfHeight);this.setTopRight(x+halfWidth,y-halfHeight);this.setBottomLeft(x-halfWidth,y+halfHeight);this.setBottomRight(x+halfWidth,y+halfHeight);return this},resetAlpha:function(){var alphas=this.alphas;alphas[0]=1;alphas[1]=1;alphas[2]=1;alphas[3]=1;alphas[4]=1;alphas[5]=1;return this},resetColors:function(){var colors=this.colors;colors[0]=0xffffff;colors[1]=0xffffff;colors[2]=0xffffff;colors[3]=0xffffff;colors[4]=0xffffff;colors[5]=0xffffff;return this},reset:function(){this.resetPosition();this.resetAlpha();return this.resetColors()}});module.exports=Quad}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var GetFastValue=__webpack_require__(2);var Extend=__webpack_require__(18);var SetValue=__webpack_require__(427);var ShaderRender=__webpack_require__(1080);var TransformMatrix=__webpack_require__(29);var Shader=new Class({Extends:GameObject,Mixins:[Components.ComputedSize,Components.Depth,Components.GetBounds,Components.Mask,Components.Origin,Components.ScrollFactor,Components.Transform,Components.Visible,ShaderRender],initialize:function Shader(scene,key,x,y,width,height,textures,textureData){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=128}if(height===undefined){height=128}GameObject.call(this,scene,'Shader');this.blendMode=-1;this.shader;var renderer=scene.sys.renderer;this.renderer=renderer;this.gl=renderer.gl;this.vertexData=new ArrayBuffer(6*(Float32Array.BYTES_PER_ELEMENT*2));this.vertexBuffer=renderer.createVertexBuffer(this.vertexData.byteLength,this.gl.STREAM_DRAW);this.program=null;this.bytes=new Uint8Array(this.vertexData);this.vertexViewF32=new Float32Array(this.vertexData);this._tempMatrix1=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempMatrix3=new TransformMatrix();this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.uniforms={};this.pointer=null;this._rendererWidth=renderer.width;this._rendererHeight=renderer.height;this._textureCount=0;this.framebuffer=null;this.glTexture=null;this.renderToTexture=false;this.texture=null;this.setPosition(x,y);this.setSize(width,height);this.setOrigin(0.5,0.5);this.setShader(key,textures,textureData)},willRender:function(camera){if(this.renderToTexture){return true}else{return!(GameObject.RENDER_MASK!==this.renderFlags||(this.cameraFilter!==0&&(this.cameraFilter&camera.id)))}},setRenderToTexture:function(key,flipY){if(flipY===undefined){flipY=false}if(!this.renderToTexture){var width=this.width;var height=this.height;var renderer=this.renderer;this.glTexture=renderer.createTextureFromSource(null,width,height,0);this.glTexture.flipY=flipY;this.framebuffer=renderer.createFramebuffer(width,height,this.glTexture,false);this._rendererWidth=width;this._rendererHeight=height;this.renderToTexture=true;this.projOrtho(0,this.width,this.height,0);if(key){this.texture=this.scene.sys.textures.addGLTexture(key,this.glTexture,width,height)}}if(this.shader){var pipeline=renderer.currentPipeline;renderer.clearPipeline();this.load();this.flush();renderer.rebindPipeline(pipeline)}return this},setShader:function(key,textures,textureData){if(textures===undefined){textures=[]}if(typeof key==='string'){var cache=this.scene.sys.cache.shader;if(!cache.has(key)){console.warn('Shader missing: '+key);return this}this.shader=cache.get(key)}else{this.shader=key}var gl=this.gl;var renderer=this.renderer;if(this.program){gl.deleteProgram(this.program)}var program=renderer.createProgram(this.shader.vertexSrc,this.shader.fragmentSrc);renderer.setMatrix4(program,'uViewMatrix',false,this.viewMatrix);renderer.setMatrix4(program,'uProjectionMatrix',false,this.projectionMatrix);renderer.setFloat2(program,'uResolution',this.width,this.height);this.program=program;var d=new Date();var defaultUniforms={resolution:{type:'2f',value:{x:this.width,y:this.height}},time:{type:'1f',value:0},mouse:{type:'2f',value:{x:this.width/2,y:this.height/2}},date:{type:'4fv',value:[d.getFullYear(),d.getMonth(),d.getDate(),d.getHours()*60*60+d.getMinutes()*60+d.getSeconds()]},sampleRate:{type:'1f',value:44100.0},iChannel0:{type:'sampler2D',value:null,textureData:{repeat:true}},iChannel1:{type:'sampler2D',value:null,textureData:{repeat:true}},iChannel2:{type:'sampler2D',value:null,textureData:{repeat:true}},iChannel3:{type:'sampler2D',value:null,textureData:{repeat:true}}};if(this.shader.uniforms){this.uniforms=Extend(true,{},this.shader.uniforms,defaultUniforms)}else{this.uniforms=defaultUniforms}for(var i=0;i<4;i++){if(textures[i]){this.setSampler2D('iChannel'+i,textures[i],i,textureData)}}this.initUniforms();this.projOrtho(0,this._rendererWidth,this._rendererHeight,0);return this},setPointer:function(pointer){this.pointer=pointer;return this},projOrtho:function(left,right,bottom,top){var near=-1000;var far=1000;var leftRight=1/(left-right);var bottomTop=1/(bottom-top);var nearFar=1/(near-far);var pm=this.projectionMatrix;pm[0]=-2*leftRight;pm[5]=-2*bottomTop;pm[10]=2*nearFar;pm[12]=(left+right)*leftRight;pm[13]=(top+bottom)*bottomTop;pm[14]=(far+near)*nearFar;var program=this.program;this.renderer.setMatrix4(program,'uProjectionMatrix',false,this.projectionMatrix);this._rendererWidth=right;this._rendererHeight=bottom},initUniforms:function(){var gl=this.gl;var map=this.renderer.glFuncMap;var program=this.program;this._textureCount=0;for(var key in this.uniforms){var uniform=this.uniforms[key];var type=uniform.type;var data=map[type];uniform.uniformLocation=gl.getUniformLocation(program,key);if(type!=='sampler2D'){uniform.glMatrix=data.matrix;uniform.glValueLength=data.length;uniform.glFunc=data.func}}},setSampler2DBuffer:function(uniformKey,texture,width,height,textureIndex,textureData){if(textureIndex===undefined){textureIndex=0}if(textureData===undefined){textureData={}}var uniform=this.uniforms[uniformKey];uniform.value=texture;textureData.width=width;textureData.height=height;uniform.textureData=textureData;this._textureCount=textureIndex;this.initSampler2D(uniform);return this},setSampler2D:function(uniformKey,textureKey,textureIndex,textureData){if(textureIndex===undefined){textureIndex=0}var textureManager=this.scene.sys.textures;if(textureManager.exists(textureKey)){var frame=textureManager.getFrame(textureKey);var uniform=this.uniforms[uniformKey];var source=frame.source;uniform.textureKey=textureKey;uniform.source=source.image;uniform.value=frame.glTexture;if(source.isGLTexture){if(!textureData){textureData={}}textureData.width=source.width;textureData.height=source.height}if(textureData){uniform.textureData=textureData}this._textureCount=textureIndex;this.initSampler2D(uniform)}return this},setUniform:function(key,value){SetValue(this.uniforms,key,value);return this},getUniform:function(key){return GetFastValue(this.uniforms,key,null)},setChannel0:function(textureKey,textureData){return this.setSampler2D('iChannel0',textureKey,0,textureData)},setChannel1:function(textureKey,textureData){return this.setSampler2D('iChannel1',textureKey,1,textureData)},setChannel2:function(textureKey,textureData){return this.setSampler2D('iChannel2',textureKey,2,textureData)},setChannel3:function(textureKey,textureData){return this.setSampler2D('iChannel3',textureKey,3,textureData)},initSampler2D:function(uniform){if(!uniform.value){return}var gl=this.gl;gl.activeTexture(gl.TEXTURE0+this._textureCount);gl.bindTexture(gl.TEXTURE_2D,uniform.value);var data=uniform.textureData;if(data){var magFilter=gl[GetFastValue(data,'magFilter','linear').toUpperCase()];var minFilter=gl[GetFastValue(data,'minFilter','linear').toUpperCase()];var wrapS=gl[GetFastValue(data,'wrapS','repeat').toUpperCase()];var wrapT=gl[GetFastValue(data,'wrapT','repeat').toUpperCase()];var format=gl[GetFastValue(data,'format','rgba').toUpperCase()];if(data.repeat){wrapS=gl.REPEAT;wrapT=gl.REPEAT}gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!!data.flipY);if(data.width){var width=GetFastValue(data,'width',512);var height=GetFastValue(data,'height',2);var border=GetFastValue(data,'border',0);gl.texImage2D(gl.TEXTURE_2D,0,format,width,height,border,format,gl.UNSIGNED_BYTE,null)}else{gl.texImage2D(gl.TEXTURE_2D,0,format,gl.RGBA,gl.UNSIGNED_BYTE,uniform.source)}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT)}this.renderer.setProgram(this.program);gl.uniform1i(uniform.uniformLocation,this._textureCount);this._textureCount++},syncUniforms:function(){var gl=this.gl;var uniforms=this.uniforms;var uniform;var length;var glFunc;var location;var value;var textureCount=0;for(var key in uniforms){uniform=uniforms[key];glFunc=uniform.glFunc;length=uniform.glValueLength;location=uniform.uniformLocation;value=uniform.value;if(value===null){continue}if(length===1){if(uniform.glMatrix){glFunc.call(gl,location,uniform.transpose,value)}else{glFunc.call(gl,location,value)}}else if(length===2){glFunc.call(gl,location,value.x,value.y)}else if(length===3){glFunc.call(gl,location,value.x,value.y,value.z)}else if(length===4){glFunc.call(gl,location,value.x,value.y,value.z,value.w)}else if(uniform.type==='sampler2D'){gl.activeTexture(gl['TEXTURE'+textureCount]);gl.bindTexture(gl.TEXTURE_2D,value);gl.uniform1i(location,textureCount);textureCount++}}},load:function(matrix2D){var gl=this.gl;var width=this.width;var height=this.height;var renderer=this.renderer;var program=this.program;var vm=this.viewMatrix;if(!this.renderToTexture){var x=-this._displayOriginX;var y=-this._displayOriginY;vm[0]=matrix2D[0];vm[1]=matrix2D[1];vm[4]=matrix2D[2];vm[5]=matrix2D[3];vm[8]=matrix2D[4];vm[9]=matrix2D[5];vm[12]=vm[0]*x+vm[4]*y;vm[13]=vm[1]*x+vm[5]*y}gl.useProgram(program);gl.uniformMatrix4fv(gl.getUniformLocation(program,'uViewMatrix'),false,vm);gl.uniform2f(gl.getUniformLocation(program,'uResolution'),this.width,this.height);var uniforms=this.uniforms;var res=uniforms.resolution;res.value.x=width;res.value.y=height;uniforms.time.value=renderer.game.loop.getDuration();var pointer=this.pointer;if(pointer){var mouse=uniforms.mouse;var px=pointer.x/width;var py=1-pointer.y/height;mouse.value.x=px.toFixed(2);mouse.value.y=py.toFixed(2)}this.syncUniforms()},flush:function(){var width=this.width;var height=this.height;var program=this.program;var gl=this.gl;var vertexBuffer=this.vertexBuffer;var renderer=this.renderer;var vertexSize=Float32Array.BYTES_PER_ELEMENT*2;if(this.renderToTexture){renderer.setFramebuffer(this.framebuffer);gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT)}gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);var location=gl.getAttribLocation(program,'inPosition');if(location!==-1){gl.enableVertexAttribArray(location);gl.vertexAttribPointer(location,2,gl.FLOAT,false,vertexSize,0)}var vf=this.vertexViewF32;vf[3]=height;vf[4]=width;vf[5]=height;vf[8]=width;vf[9]=height;vf[10]=width;var vertexCount=6;gl.bufferSubData(gl.ARRAY_BUFFER,0,this.bytes.subarray(0,vertexCount*vertexSize));gl.drawArrays(gl.TRIANGLES,0,vertexCount);if(this.renderToTexture){renderer.setFramebuffer(null,false)}},setAlpha:function(){},setBlendMode:function(){},preDestroy:function(){var gl=this.gl;gl.deleteProgram(this.program);gl.deleteBuffer(this.vertexBuffer);if(this.renderToTexture){this.renderer.deleteFramebuffer(this.framebuffer);this.texture.destroy();this.framebuffer=null;this.glTexture=null;this.texture=null}}});module.exports=Shader}),(function(module,exports,__webpack_require__){var DistanceBetween=__webpack_require__(53);var CircleToCircle=function(circleA,circleB){return(DistanceBetween(circleA.x,circleA.y,circleB.x,circleB.y)<=(circleA.radius+circleB.radius))};module.exports=CircleToCircle}),(function(module,exports){var CircleToRectangle=function(circle,rect){var halfWidth=rect.width/2;var halfHeight=rect.height/2;var cx=Math.abs(circle.x-rect.x-halfWidth);var cy=Math.abs(circle.y-rect.y-halfHeight);var xDist=halfWidth+circle.radius;var yDist=halfHeight+circle.radius;if(cx>xDist||cy>yDist){return false}else if(cx<=halfWidth||cy<=halfHeight){return true}else{var xCornerDist=cx-halfWidth;var yCornerDist=cy-halfHeight;var xCornerDistSq=xCornerDist*xCornerDist;var yCornerDistSq=yCornerDist*yCornerDist;var maxCornerDistSq=circle.radius*circle.radius;return(xCornerDistSq+yCornerDistSq<=maxCornerDistSq)}};module.exports=CircleToRectangle}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var LineToCircle=__webpack_require__(208);var GetLineToCircle=function(line,circle,out){if(out===undefined){out=[]}if(LineToCircle(line,circle)){var lx1=line.x1;var ly1=line.y1;var lx2=line.x2;var ly2=line.y2;var cx=circle.x;var cy=circle.y;var cr=circle.radius;var lDirX=lx2-lx1;var lDirY=ly2-ly1;var oDirX=lx1-cx;var oDirY=ly1-cy;var coefficientA=lDirX*lDirX+lDirY*lDirY;var coefficientB=2*(lDirX*oDirX+lDirY*oDirY);var coefficientC=oDirX*oDirX+oDirY*oDirY-cr*cr;var lambda=(coefficientB*coefficientB)-(4*coefficientA*coefficientC);var x,y;if(lambda===0){var root=-coefficientB/(2*coefficientA);x=lx1+root*lDirX;y=ly1+root*lDirY;if(root>=0&&root<=1){out.push(new Point(x,y))}}else if(lambda>0){var root1=(-coefficientB-Math.sqrt(lambda))/(2*coefficientA);x=lx1+root1*lDirX;y=ly1+root1*lDirY;if(root1>=0&&root1<=1){out.push(new Point(x,y))}var root2=(-coefficientB+Math.sqrt(lambda))/(2*coefficientA);x=lx1+root2*lDirX;y=ly1+root2*lDirY;if(root2>=0&&root2<=1){out.push(new Point(x,y))}}}return out};module.exports=GetLineToCircle}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(55);var Point=__webpack_require__(4);var tmp=new Point();var LineToCircle=function(line,circle,nearest){if(nearest===undefined){nearest=tmp}if(Contains(circle,line.x1,line.y1)){nearest.x=line.x1;nearest.y=line.y1;return true}if(Contains(circle,line.x2,line.y2)){nearest.x=line.x2;nearest.y=line.y2;return true}var dx=line.x2-line.x1;var dy=line.y2-line.y1;var lcx=circle.x-line.x1;var lcy=circle.y-line.y1;var dLen2=(dx*dx)+(dy*dy);var px=dx;var py=dy;if(dLen2>0){var dp=((lcx*dx)+(lcy*dy))/dLen2;px*=dp;py*=dp}nearest.x=line.x1+px;nearest.y=line.y1+py;var pLen2=(px*px)+(py*py);return(pLen2<=dLen2&&((px*dx)+(py*dy))>=0&&Contains(circle,nearest.x,nearest.y))};module.exports=LineToCircle}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var LineToLine=__webpack_require__(84);var LineToRectangle=__webpack_require__(432);var GetLineToRectangle=function(line,rect,out){if(out===undefined){out=[]}if(LineToRectangle(line,rect)){var lineA=rect.getLineA();var lineB=rect.getLineB();var lineC=rect.getLineC();var lineD=rect.getLineD();var output=[new Point(),new Point(),new Point(),new Point()];var result=[LineToLine(lineA,line,output[0]),LineToLine(lineB,line,output[1]),LineToLine(lineC,line,output[2]),LineToLine(lineD,line,output[3])];for(var i=0;i<4;i++){if(result[i]){out.push(output[i])}}}return out};module.exports=GetLineToRectangle}),(function(module,exports){var ContainsArray=function(triangle,points,returnFirst,out){if(returnFirst===undefined){returnFirst=false}if(out===undefined){out=[]}var v0x=triangle.x3-triangle.x1;var v0y=triangle.y3-triangle.y1;var v1x=triangle.x2-triangle.x1;var v1y=triangle.y2-triangle.y1;var dot00=(v0x*v0x)+(v0y*v0y);var dot01=(v0x*v1x)+(v0y*v1y);var dot11=(v1x*v1x)+(v1y*v1y);var b=((dot00*dot11)-(dot01*dot01));var inv=(b===0)?0:(1/b);var u;var v;var v2x;var v2y;var dot02;var dot12;var x1=triangle.x1;var y1=triangle.y1;for(var i=0;i<points.length;i++){v2x=points[i].x-x1;v2y=points[i].y-y1;dot02=(v0x*v2x)+(v0y*v2y);dot12=(v1x*v2x)+(v1y*v2y);u=((dot11*dot02)-(dot01*dot12))*inv;v=((dot00*dot12)-(dot01*dot02))*inv;if(u>=0&&v>=0&&(u+v<1)){out.push({x:points[i].x,y:points[i].y});if(returnFirst){break}}}return out};module.exports=ContainsArray}),(function(module,exports){var RotateAroundXY=function(line,x,y,angle){var c=Math.cos(angle);var s=Math.sin(angle);var tx=line.x1-x;var ty=line.y1-y;line.x1=tx*c-ty*s+x;line.y1=tx*s+ty*c+y;tx=line.x2-x;ty=line.y2-y;line.x2=tx*c-ty*s+x;line.y2=tx*s+ty*c+y;return line};module.exports=RotateAroundXY}),(function(module,exports){var GetAspectRatio=function(rect){return(rect.height===0)?NaN:rect.width/rect.height};module.exports=GetAspectRatio}),(function(module,exports){var RotateAroundXY=function(triangle,x,y,angle){var c=Math.cos(angle);var s=Math.sin(angle);var tx=triangle.x1-x;var ty=triangle.y1-y;triangle.x1=tx*c-ty*s+x;triangle.y1=tx*s+ty*c+y;tx=triangle.x2-x;ty=triangle.y2-y;triangle.x2=tx*c-ty*s+x;triangle.y2=tx*s+ty*c+y;tx=triangle.x3-x;ty=triangle.y3-y;triangle.x3=tx*c-ty*s+x;triangle.y3=tx*s+ty*c+y;return triangle};module.exports=RotateAroundXY}),(function(module,exports,__webpack_require__){module.exports={BUTTON_DOWN:__webpack_require__(1203),BUTTON_UP:__webpack_require__(1204),CONNECTED:__webpack_require__(1205),DISCONNECTED:__webpack_require__(1206),GAMEPAD_BUTTON_DOWN:__webpack_require__(1207),GAMEPAD_BUTTON_UP:__webpack_require__(1208)}}),(function(module,exports,__webpack_require__){var Extend=__webpack_require__(18);var XHRSettings=__webpack_require__(139);var MergeXHRSettings=function(global,local){var output=(global===undefined)?XHRSettings():Extend({},global);if(local){for(var setting in local){if(local[setting]!==undefined){output[setting]=local[setting]}}}return output};module.exports=MergeXHRSettings}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var ParseXML=__webpack_require__(364);var XMLFile=new Class({Extends:File,initialize:function XMLFile(loader,key,url,xhrSettings){var extension='xml';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'xml',cache:loader.cacheManager.xml,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=ParseXML(this.xhrLoader.responseText);if(this.data){this.onProcessComplete()}else{console.warn('Invalid XMLFile: '+this.key);this.onProcessError()}}});FileTypesManager.register('xml',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new XMLFile(this,key[i]))}}else{this.addFile(new XMLFile(this,key,url,xhrSettings))}return this});module.exports=XMLFile}),(function(module,exports,__webpack_require__){module.exports={Acceleration:__webpack_require__(1263),Angular:__webpack_require__(1264),Bounce:__webpack_require__(1265),Debug:__webpack_require__(1266),Drag:__webpack_require__(1267),Enable:__webpack_require__(1268),Friction:__webpack_require__(1269),Gravity:__webpack_require__(1270),Immovable:__webpack_require__(1271),Mass:__webpack_require__(1272),Size:__webpack_require__(1273),Velocity:__webpack_require__(1274)}}),(function(module,exports,__webpack_require__){module.exports={COLLIDE:__webpack_require__(1276),OVERLAP:__webpack_require__(1277),PAUSE:__webpack_require__(1278),RESUME:__webpack_require__(1279),TILE_COLLIDE:__webpack_require__(1280),TILE_OVERLAP:__webpack_require__(1281),WORLD_BOUNDS:__webpack_require__(1282),WORLD_STEP:__webpack_require__(1283)}}),(function(module,exports,__webpack_require__){var Constraint={};module.exports=Constraint;var Vertices=__webpack_require__(86);var Vector=__webpack_require__(99);var Sleeping=__webpack_require__(239);var Bounds=__webpack_require__(100);var Axes=__webpack_require__(513);var Common=__webpack_require__(42);(function(){Constraint._warming=0.4;Constraint._torqueDampen=1;Constraint._minLength=0.000001;Constraint.create=function(options){var constraint=options;if(constraint.bodyA&&!constraint.pointA)constraint.pointA={x:0,y:0};if(constraint.bodyB&&!constraint.pointB)constraint.pointB={x:0,y:0};var initialPointA=constraint.bodyA?Vector.add(constraint.bodyA.position,constraint.pointA):constraint.pointA,initialPointB=constraint.bodyB?Vector.add(constraint.bodyB.position,constraint.pointB):constraint.pointB,length=Vector.magnitude(Vector.sub(initialPointA,initialPointB));constraint.length=typeof constraint.length!=='undefined'?constraint.length:length;constraint.id=constraint.id||Common.nextId();constraint.label=constraint.label||'Constraint';constraint.type='constraint';constraint.stiffness=constraint.stiffness||(constraint.length>0?1:0.7);constraint.damping=constraint.damping||0;constraint.angularStiffness=constraint.angularStiffness||0;constraint.angleA=constraint.bodyA?constraint.bodyA.angle:constraint.angleA;constraint.angleB=constraint.bodyB?constraint.bodyB.angle:constraint.angleB;constraint.plugin={};var render={visible:true,type:'line',anchors:true,lineColor:null,lineOpacity:null,lineThickness:null,pinSize:null,anchorColor:null,anchorSize:null};if(constraint.length===0&&constraint.stiffness>0.1){render.type='pin';render.anchors=false}else if(constraint.stiffness<0.9){render.type='spring'}constraint.render=Common.extend(render,constraint.render);return constraint};Constraint.preSolveAll=function(bodies){for(var i=0;i<bodies.length;i+=1){var body=bodies[i],impulse=body.constraintImpulse;if(body.isStatic||(impulse.x===0&&impulse.y===0&&impulse.angle===0)){continue}body.position.x+=impulse.x;body.position.y+=impulse.y;body.angle+=impulse.angle}};Constraint.solveAll=function(constraints,timeScale){for(var i=0;i<constraints.length;i+=1){var constraint=constraints[i],fixedA=!constraint.bodyA||(constraint.bodyA&&constraint.bodyA.isStatic),fixedB=!constraint.bodyB||(constraint.bodyB&&constraint.bodyB.isStatic);if(fixedA||fixedB){Constraint.solve(constraints[i],timeScale)}}for(i=0;i<constraints.length;i+=1){constraint=constraints[i];fixedA=!constraint.bodyA||(constraint.bodyA&&constraint.bodyA.isStatic);fixedB=!constraint.bodyB||(constraint.bodyB&&constraint.bodyB.isStatic);if(!fixedA&&!fixedB){Constraint.solve(constraints[i],timeScale)}}};Constraint.solve=function(constraint,timeScale){var bodyA=constraint.bodyA,bodyB=constraint.bodyB,pointA=constraint.pointA,pointB=constraint.pointB;if(!bodyA&&!bodyB)return;if(bodyA&&!bodyA.isStatic){Vector.rotate(pointA,bodyA.angle-constraint.angleA,pointA);constraint.angleA=bodyA.angle}if(bodyB&&!bodyB.isStatic){Vector.rotate(pointB,bodyB.angle-constraint.angleB,pointB);constraint.angleB=bodyB.angle}var pointAWorld=pointA,pointBWorld=pointB;if(bodyA)pointAWorld=Vector.add(bodyA.position,pointA);if(bodyB)pointBWorld=Vector.add(bodyB.position,pointB);if(!pointAWorld||!pointBWorld)return;var delta=Vector.sub(pointAWorld,pointBWorld),currentLength=Vector.magnitude(delta);if(currentLength<Constraint._minLength){currentLength=Constraint._minLength}var difference=(currentLength-constraint.length)/currentLength,stiffness=constraint.stiffness<1?constraint.stiffness*timeScale:constraint.stiffness,force=Vector.mult(delta,difference*stiffness),massTotal=(bodyA?bodyA.inverseMass:0)+(bodyB?bodyB.inverseMass:0),inertiaTotal=(bodyA?bodyA.inverseInertia:0)+(bodyB?bodyB.inverseInertia:0),resistanceTotal=massTotal+inertiaTotal,torque,share,normal,normalVelocity,relativeVelocity;if(constraint.damping){var zero=Vector.create();normal=Vector.div(delta,currentLength);relativeVelocity=Vector.sub(bodyB&&Vector.sub(bodyB.position,bodyB.positionPrev)||zero,bodyA&&Vector.sub(bodyA.position,bodyA.positionPrev)||zero);normalVelocity=Vector.dot(normal,relativeVelocity)}if(bodyA&&!bodyA.isStatic){share=bodyA.inverseMass/massTotal;bodyA.constraintImpulse.x-=force.x*share;bodyA.constraintImpulse.y-=force.y*share;bodyA.position.x-=force.x*share;bodyA.position.y-=force.y*share;if(constraint.damping){bodyA.positionPrev.x-=constraint.damping*normal.x*normalVelocity*share;bodyA.positionPrev.y-=constraint.damping*normal.y*normalVelocity*share}torque=(Vector.cross(pointA,force)/resistanceTotal)*Constraint._torqueDampen*bodyA.inverseInertia*(1-constraint.angularStiffness);bodyA.constraintImpulse.angle-=torque;bodyA.angle-=torque}if(bodyB&&!bodyB.isStatic){share=bodyB.inverseMass/massTotal;bodyB.constraintImpulse.x+=force.x*share;bodyB.constraintImpulse.y+=force.y*share;bodyB.position.x+=force.x*share;bodyB.position.y+=force.y*share;if(constraint.damping){bodyB.positionPrev.x+=constraint.damping*normal.x*normalVelocity*share;bodyB.positionPrev.y+=constraint.damping*normal.y*normalVelocity*share}torque=(Vector.cross(pointB,force)/resistanceTotal)*Constraint._torqueDampen*bodyB.inverseInertia*(1-constraint.angularStiffness);bodyB.constraintImpulse.angle+=torque;bodyB.angle+=torque}};Constraint.postSolveAll=function(bodies){for(var i=0;i<bodies.length;i++){var body=bodies[i],impulse=body.constraintImpulse;if(body.isStatic||(impulse.x===0&&impulse.y===0&&impulse.angle===0)){continue}Sleeping.set(body,false);for(var j=0;j<body.parts.length;j++){var part=body.parts[j];Vertices.translate(part.vertices,impulse);if(j>0){part.position.x+=impulse.x;part.position.y+=impulse.y}if(impulse.angle!==0){Vertices.rotate(part.vertices,impulse.angle,body.position);Axes.rotate(part.axes,impulse.angle);if(j>0){Vector.rotateAbout(part.position,impulse.angle,body.position,part.position)}}Bounds.update(part.bounds,part.vertices,body.velocity)}impulse.angle*=Constraint._warming;impulse.x*=Constraint._warming;impulse.y*=Constraint._warming}};Constraint.pointAWorld=function(constraint){return{x:(constraint.bodyA?constraint.bodyA.position.x:0)+constraint.pointA.x,y:(constraint.bodyA?constraint.bodyA.position.y:0)+constraint.pointA.y}};Constraint.pointBWorld=function(constraint){return{x:(constraint.bodyB?constraint.bodyB.position.x:0)+constraint.pointB.x,y:(constraint.bodyB?constraint.bodyB.position.y:0)+constraint.pointB.y}}})()}),(function(module,exports,__webpack_require__){var GetTileAt=__webpack_require__(142);var CalculateFacesAt=function(tileX,tileY,layer){var tile=GetTileAt(tileX,tileY,true,layer);var above=GetTileAt(tileX,tileY-1,true,layer);var below=GetTileAt(tileX,tileY+1,true,layer);var left=GetTileAt(tileX-1,tileY,true,layer);var right=GetTileAt(tileX+1,tileY,true,layer);var tileCollides=tile&&tile.collides;if(tileCollides){tile.faceTop=true;tile.faceBottom=true;tile.faceLeft=true;tile.faceRight=true}if(above&&above.collides){if(tileCollides){tile.faceTop=false}above.faceBottom=!tileCollides}if(below&&below.collides){if(tileCollides){tile.faceBottom=false}below.faceTop=!tileCollides}if(left&&left.collides){if(tileCollides){tile.faceLeft=false}left.faceRight=!tileCollides}if(right&&right.collides){if(tileCollides){tile.faceRight=false}right.faceLeft=!tileCollides}if(tile&&!tile.collides){tile.resetFaces()}return tile};module.exports=CalculateFacesAt}),(function(module,exports,__webpack_require__){var Tile=__webpack_require__(74);var IsInLayerBounds=__webpack_require__(101);var CalculateFacesAt=__webpack_require__(220);var SetTileCollision=__webpack_require__(73);var PutTileAt=function(tile,tileX,tileY,recalculateFaces,layer){if(!IsInLayerBounds(tileX,tileY,layer)){return null}if(recalculateFaces===undefined){recalculateFaces=true}var oldTile=layer.data[tileY][tileX];var oldTileCollides=oldTile&&oldTile.collides;if(tile instanceof Tile){if(layer.data[tileY][tileX]===null){layer.data[tileY][tileX]=new Tile(layer,tile.index,tileX,tileY,tile.width,tile.height)}layer.data[tileY][tileX].copy(tile)}else{var index=tile;if(layer.data[tileY][tileX]===null){layer.data[tileY][tileX]=new Tile(layer,index,tileX,tileY,layer.tileWidth,layer.tileHeight)}else{layer.data[tileY][tileX].index=index}}var newTile=layer.data[tileY][tileX];var collides=layer.collideIndexes.indexOf(newTile.index)!==-1;SetTileCollision(newTile,collides);if(recalculateFaces&&(oldTileCollides!==newTile.collides)){CalculateFacesAt(tileX,tileY,layer)}return newTile};module.exports=PutTileAt}),(function(module,exports){var SetLayerCollisionIndex=function(tileIndex,collides,layer){var loc=layer.collideIndexes.indexOf(tileIndex);if(collides&&loc===-1){layer.collideIndexes.push(tileIndex)}else if(!collides&&loc!==-1){layer.collideIndexes.splice(loc,1)}};module.exports=SetLayerCollisionIndex}),(function(module,exports,__webpack_require__){var Formats=__webpack_require__(32);var LayerData=__webpack_require__(102);var MapData=__webpack_require__(103);var Tile=__webpack_require__(74);var Parse2DArray=function(name,data,tileWidth,tileHeight,insertNull){var layerData=new LayerData({tileWidth:tileWidth,tileHeight:tileHeight});var mapData=new MapData({name:name,tileWidth:tileWidth,tileHeight:tileHeight,format:Formats.ARRAY_2D,layers:[layerData]});var tiles=[];var height=data.length;var width=0;for(var y=0;y<data.length;y++){tiles[y]=[];var row=data[y];for(var x=0;x<row.length;x++){var tileIndex=parseInt(row[x],10);if(isNaN(tileIndex)||tileIndex===-1){tiles[y][x]=insertNull?null:new Tile(layerData,-1,x,y,tileWidth,tileHeight)}else{tiles[y][x]=new Tile(layerData,tileIndex,x,y,tileWidth,tileHeight)}}if(width===0){width=row.length}}mapData.width=layerData.width=width;mapData.height=layerData.height=height;mapData.widthInPixels=layerData.widthInPixels=width*tileWidth;mapData.heightInPixels=layerData.heightInPixels=height*tileHeight;layerData.data=tiles;return mapData};module.exports=Parse2DArray}),(function(module,exports){var FLIPPED_HORIZONTAL=0x80000000;var FLIPPED_VERTICAL=0x40000000;var FLIPPED_ANTI_DIAGONAL=0x20000000;var ParseGID=function(gid){var flippedHorizontal=Boolean(gid&FLIPPED_HORIZONTAL);var flippedVertical=Boolean(gid&FLIPPED_VERTICAL);var flippedAntiDiagonal=Boolean(gid&FLIPPED_ANTI_DIAGONAL);gid=gid&~(FLIPPED_HORIZONTAL|FLIPPED_VERTICAL|FLIPPED_ANTI_DIAGONAL);var rotation=0;var flipped=false;if(flippedHorizontal&&flippedVertical&&flippedAntiDiagonal){rotation=Math.PI/2;flipped=true}else if(flippedHorizontal&&flippedVertical&&!flippedAntiDiagonal){rotation=Math.PI;flipped=false}else if(flippedHorizontal&&!flippedVertical&&flippedAntiDiagonal){rotation=Math.PI/2;flipped=false}else if(flippedHorizontal&&!flippedVertical&&!flippedAntiDiagonal){rotation=0;flipped=true}else if(!flippedHorizontal&&flippedVertical&&flippedAntiDiagonal){rotation=3*Math.PI/2;flipped=false}else if(!flippedHorizontal&&flippedVertical&&!flippedAntiDiagonal){rotation=Math.PI;flipped=true}else if(!flippedHorizontal&&!flippedVertical&&flippedAntiDiagonal){rotation=3*Math.PI/2;flipped=true}else if(!flippedHorizontal&&!flippedVertical&&!flippedAntiDiagonal){rotation=0;flipped=false}return{gid:gid,flippedHorizontal:flippedHorizontal,flippedVertical:flippedVertical,flippedAntiDiagonal:flippedAntiDiagonal,rotation:rotation,flipped:flipped}};module.exports=ParseGID}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var CreateGroupLayer=function(json,groupl,parentstate){if(!groupl){return{i:0,layers:json.layers,name:'',opacity:1,visible:true,x:0,y:0}}var layerX=groupl.x+GetFastValue(groupl,'startx',0)*json.tilewidth+GetFastValue(groupl,'offsetx',0);var layerY=groupl.y+GetFastValue(groupl,'starty',0)*json.tileheight+GetFastValue(groupl,'offsety',0);return{i:0,layers:groupl.layers,name:parentstate.name+groupl.name+'/',opacity:parentstate.opacity*groupl.opacity,visible:parentstate.visible&&groupl.visible,x:parentstate.x+layerX,y:parentstate.y+layerY}};module.exports=CreateGroupLayer}),(function(module,exports,__webpack_require__){var Pick=__webpack_require__(486);var ParseGID=__webpack_require__(224);var copyPoints=function(p){return{x:p.x,y:p.y}};var commonObjectProps=['id','name','type','rotation','properties','visible','x','y','width','height'];var ParseObject=function(tiledObject,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}var parsedObject=Pick(tiledObject,commonObjectProps);parsedObject.x+=offsetX;parsedObject.y+=offsetY;if(tiledObject.gid){var gidInfo=ParseGID(tiledObject.gid);parsedObject.gid=gidInfo.gid;parsedObject.flippedHorizontal=gidInfo.flippedHorizontal;parsedObject.flippedVertical=gidInfo.flippedVertical;parsedObject.flippedAntiDiagonal=gidInfo.flippedAntiDiagonal}else if(tiledObject.polyline){parsedObject.polyline=tiledObject.polyline.map(copyPoints)}else if(tiledObject.polygon){parsedObject.polygon=tiledObject.polygon.map(copyPoints)}else if(tiledObject.ellipse){parsedObject.ellipse=tiledObject.ellipse}else if(tiledObject.text){parsedObject.text=tiledObject.text}else if(tiledObject.point){parsedObject.point=true}else{parsedObject.rectangle=true}return parsedObject};module.exports=ParseObject}),(function(module,exports,__webpack_require__){var Formats=__webpack_require__(32);var MapData=__webpack_require__(103);var Parse=__webpack_require__(478);var Tilemap=__webpack_require__(494);var ParseToTilemap=function(scene,key,tileWidth,tileHeight,width,height,data,insertNull){if(tileWidth===undefined){tileWidth=32}if(tileHeight===undefined){tileHeight=32}if(width===undefined){width=10}if(height===undefined){height=10}if(insertNull===undefined){insertNull=false}var mapData=null;if(Array.isArray(data)){var name=key!==undefined?key:'map';mapData=Parse(name,Formats.ARRAY_2D,data,tileWidth,tileHeight,insertNull)}else if(key!==undefined){var tilemapData=scene.cache.tilemap.get(key);if(!tilemapData){console.warn('No map data found for key '+key)}else{mapData=Parse(key,tilemapData.format,tilemapData.data,tileWidth,tileHeight,insertNull)}}if(mapData===null){mapData=new MapData({tileWidth:tileWidth,tileHeight:tileHeight,width:width,height:height})}return new Tilemap(scene,mapData)};module.exports=ParseToTilemap}),(function(module,exports,__webpack_require__){var GetValue=__webpack_require__(6);var GetTargets=function(config){var targets=GetValue(config,'targets',null);if(targets===null){return targets}if(typeof targets==='function'){targets=targets.call()}if(!Array.isArray(targets)){targets=[targets]}return targets};module.exports=GetTargets}),(function(module,exports){function hasGetActive(def){return(!!def.getActive&&typeof def.getActive==='function')}function hasGetStart(def){return(!!def.getStart&&typeof def.getStart==='function')}function hasGetEnd(def){return(!!def.getEnd&&typeof def.getEnd==='function')}function hasGetters(def){return hasGetStart(def)||hasGetEnd(def)||hasGetActive(def)}var GetValueOp=function(key,propertyValue){var callbacks;var getEnd=function(target,key,value){return value};var getStart=function(target,key,value){return value};var getActive=null;var t=typeof(propertyValue);if(t==='number'){getEnd=function(){return propertyValue}}else if(t==='string'){var op=propertyValue[0];var num=parseFloat(propertyValue.substr(2));switch(op){case'+':getEnd=function(target,key,value){return value+num};break;case'-':getEnd=function(target,key,value){return value-num};break;case'*':getEnd=function(target,key,value){return value*num};break;case'/':getEnd=function(target,key,value){return value/num};break;default:getEnd=function(){return parseFloat(propertyValue)}}}else if(t==='function'){getEnd=propertyValue}else if(t==='object'){if(hasGetters(propertyValue)){if(hasGetActive(propertyValue)){getActive=propertyValue.getActive}if(hasGetEnd(propertyValue)){getEnd=propertyValue.getEnd}if(hasGetStart(propertyValue)){getStart=propertyValue.getStart}}else if(propertyValue.hasOwnProperty('value')){callbacks=GetValueOp(key,propertyValue.value)}else{var hasTo=propertyValue.hasOwnProperty('to');var hasFrom=propertyValue.hasOwnProperty('from');var hasStart=propertyValue.hasOwnProperty('start');if(hasTo&&(hasFrom||hasStart)){callbacks=GetValueOp(key,propertyValue.to);if(hasStart){var startCallbacks=GetValueOp(key,propertyValue.start);callbacks.getActive=startCallbacks.getEnd}if(hasFrom){var fromCallbacks=GetValueOp(key,propertyValue.from);callbacks.getStart=fromCallbacks.getEnd}}}}if(!callbacks){callbacks={getActive:getActive,getEnd:getEnd,getStart:getStart}}return callbacks};module.exports=GetValueOp}),(function(module,exports){var TWEEN_DEFAULTS={targets:null,delay:0,duration:1000,ease:'Power0',easeParams:null,hold:0,repeat:0,repeatDelay:0,yoyo:false,flipX:false,flipY:false};module.exports=TWEEN_DEFAULTS}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(232);var GameObjectCreator=__webpack_require__(16);var GameObjectFactory=__webpack_require__(5);var TWEEN_CONST=__webpack_require__(89);var MATH_CONST=__webpack_require__(13);var Tween=new Class({Extends:EventEmitter,initialize:function Tween(parent,data,targets){EventEmitter.call(this);this.parent=parent;this.parentIsTimeline=parent.hasOwnProperty('isTimeline');this.data=data;this.totalData=data.length;this.targets=targets;this.totalTargets=targets.length;this.useFrames=false;this.timeScale=1;this.loop=0;this.loopDelay=0;this.loopCounter=0;this.startDelay=0;this.hasStarted=false;this.isSeeking=false;this.completeDelay=0;this.countdown=0;this.offset=0;this.calculatedOffset=0;this.state=TWEEN_CONST.PENDING_ADD;this._pausedState=TWEEN_CONST.INIT;this.paused=false;this.elapsed=0;this.totalElapsed=0;this.duration=0;this.progress=0;this.totalDuration=0;this.totalProgress=0;this.callbacks={onActive:null,onComplete:null,onLoop:null,onRepeat:null,onStart:null,onStop:null,onUpdate:null,onYoyo:null};this.callbackScope},getValue:function(index){if(index===undefined){index=0}return this.data[index].current},setTimeScale:function(value){this.timeScale=value;return this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return(this.state===TWEEN_CONST.ACTIVE)},isPaused:function(){return(this.state===TWEEN_CONST.PAUSED)},hasTarget:function(target){return(this.targets.indexOf(target)!==-1)},updateTo:function(key,value,startToCurrent){if(startToCurrent===undefined){startToCurrent=false}for(var i=0;i<this.totalData;i++){var tweenData=this.data[i];if(tweenData.key===key){tweenData.end=value;if(startToCurrent){tweenData.start=tweenData.current}}}return this},restart:function(){this.elapsed=0;this.progress=0;this.totalElapsed=0;this.totalProgress=0;if(this.state===TWEEN_CONST.ACTIVE){return this.seek(0)}else if(this.state===TWEEN_CONST.REMOVED){this.seek(0);this.parent.makeActive(this);return this}else if(this.state===TWEEN_CONST.PENDING_ADD){return this}else{return this.play()}},calcDuration:function(){var maxDuration=0;var minDelay=MATH_CONST.MAX_SAFE_INTEGER;var data=this.data;for(var i=0;i<this.totalData;i++){var tweenData=data[i];tweenData.t1=tweenData.duration+tweenData.hold;if(tweenData.yoyo){tweenData.t1+=tweenData.duration}tweenData.t2=tweenData.t1+tweenData.repeatDelay;tweenData.totalDuration=tweenData.delay+tweenData.t1;if(tweenData.repeat===-1){tweenData.totalDuration+=(tweenData.t2*999999999999)}else if(tweenData.repeat>0){tweenData.totalDuration+=(tweenData.t2*tweenData.repeat)}if(tweenData.totalDuration>maxDuration){maxDuration=tweenData.totalDuration}if(tweenData.delay<minDelay){minDelay=tweenData.delay}}this.duration=Math.max(maxDuration,0.001);this.loopCounter=(this.loop===-1)?999999999999:this.loop;if(this.loopCounter>0){this.totalDuration=this.duration+this.completeDelay+((this.duration+this.loopDelay)*this.loopCounter)}else{this.totalDuration=this.duration+this.completeDelay}this.startDelay=minDelay},init:function(){if(this.paused&&!this.parentIsTimeline){this.state=TWEEN_CONST.PENDING_ADD;this._pausedState=TWEEN_CONST.INIT;return false}var data=this.data;var totalTargets=this.totalTargets;for(var i=0;i<this.totalData;i++){var tweenData=data[i];var target=tweenData.target;var gen=tweenData.gen;var key=tweenData.key;var targetIndex=tweenData.index;tweenData.delay=gen.delay(target,key,0,targetIndex,totalTargets,this);tweenData.duration=Math.max(gen.duration(target,key,0,targetIndex,totalTargets,this),0.001);tweenData.hold=gen.hold(target,key,0,targetIndex,totalTargets,this);tweenData.repeat=gen.repeat(target,key,0,targetIndex,totalTargets,this);tweenData.repeatDelay=gen.repeatDelay(target,key,0,targetIndex,totalTargets,this)}this.calcDuration();this.progress=0;this.totalProgress=0;this.elapsed=0;this.totalElapsed=0;this.state=TWEEN_CONST.INIT;return true},makeActive:function(){this.parent.makeActive(this);this.dispatchTweenEvent(Events.TWEEN_ACTIVE,this.callbacks.onActive)},nextState:function(){if(this.loopCounter>0){this.elapsed=0;this.progress=0;this.loopCounter--;this.resetTweenData(true);if(this.loopDelay>0){this.countdown=this.loopDelay;this.state=TWEEN_CONST.LOOP_DELAY}else{this.state=TWEEN_CONST.ACTIVE;this.dispatchTweenEvent(Events.TWEEN_LOOP,this.callbacks.onLoop)}}else if(this.completeDelay>0){this.state=TWEEN_CONST.COMPLETE_DELAY;this.countdown=this.completeDelay}else{this.state=TWEEN_CONST.PENDING_REMOVE;this.dispatchTweenEvent(Events.TWEEN_COMPLETE,this.callbacks.onComplete)}},pause:function(){if(this.state===TWEEN_CONST.PAUSED){return this}this.paused=true;this._pausedState=this.state;this.state=TWEEN_CONST.PAUSED;return this},play:function(resetFromTimeline){if(resetFromTimeline===undefined){resetFromTimeline=false}var state=this.state;if(state===TWEEN_CONST.INIT&&!this.parentIsTimeline){this.resetTweenData(false);this.state=TWEEN_CONST.ACTIVE;return this}else if(state===TWEEN_CONST.ACTIVE||(state===TWEEN_CONST.PENDING_ADD&&this._pausedState===TWEEN_CONST.PENDING_ADD)){return this}else if(!this.parentIsTimeline&&(state===TWEEN_CONST.PENDING_REMOVE||state===TWEEN_CONST.REMOVED)){this.seek(0);this.parent.makeActive(this);return this}if(this.parentIsTimeline){this.resetTweenData(resetFromTimeline);if(this.calculatedOffset===0){this.state=TWEEN_CONST.ACTIVE}else{this.countdown=this.calculatedOffset;this.state=TWEEN_CONST.OFFSET_DELAY}}else if(this.paused){this.paused=false;this.makeActive()}else{this.resetTweenData(resetFromTimeline);this.state=TWEEN_CONST.ACTIVE;this.makeActive()}return this},resetTweenData:function(resetFromLoop){var data=this.data;var total=this.totalData;var totalTargets=this.totalTargets;for(var i=0;i<total;i++){var tweenData=data[i];var target=tweenData.target;var key=tweenData.key;var targetIndex=tweenData.index;tweenData.progress=0;tweenData.elapsed=0;tweenData.repeatCounter=(tweenData.repeat===-1)?999999999999:tweenData.repeat;if(resetFromLoop){tweenData.start=tweenData.getStartValue(target,key,tweenData.start,targetIndex,totalTargets,this);tweenData.end=tweenData.getEndValue(target,key,tweenData.end,targetIndex,totalTargets,this);tweenData.current=tweenData.start;tweenData.state=TWEEN_CONST.PLAYING_FORWARD}else{tweenData.state=TWEEN_CONST.PENDING_RENDER}if(tweenData.delay>0){tweenData.elapsed=tweenData.delay;tweenData.state=TWEEN_CONST.DELAY}if(tweenData.getActiveValue){target[key]=tweenData.getActiveValue(tweenData.target,tweenData.key,tweenData.start)}}},resume:function(){if(this.state===TWEEN_CONST.PAUSED){this.paused=false;this.state=this._pausedState}else{this.play()}return this},seek:function(toPosition,delta){if(delta===undefined){delta=16.6}if(this.totalDuration>=3600000){console.warn('Tween.seek duration too long');return this}if(this.state===TWEEN_CONST.REMOVED){this.makeActive()}this.elapsed=0;this.progress=0;this.totalElapsed=0;this.totalProgress=0;var data=this.data;var totalTargets=this.totalTargets;for(var i=0;i<this.totalData;i++){var tweenData=data[i];var target=tweenData.target;var gen=tweenData.gen;var key=tweenData.key;var targetIndex=tweenData.index;tweenData.progress=0;tweenData.elapsed=0;tweenData.repeatCounter=(tweenData.repeat===-1)?999999999999:tweenData.repeat;tweenData.delay=gen.delay(target,key,0,targetIndex,totalTargets,this);tweenData.duration=Math.max(gen.duration(target,key,0,targetIndex,totalTargets,this),0.001);tweenData.hold=gen.hold(target,key,0,targetIndex,totalTargets,this);tweenData.repeat=gen.repeat(target,key,0,targetIndex,totalTargets,this);tweenData.repeatDelay=gen.repeatDelay(target,key,0,targetIndex,totalTargets,this);tweenData.current=tweenData.start;tweenData.state=TWEEN_CONST.PLAYING_FORWARD;this.updateTweenData(this,tweenData,0,targetIndex,totalTargets);if(tweenData.delay>0){tweenData.elapsed=tweenData.delay;tweenData.state=TWEEN_CONST.DELAY}}this.calcDuration();var wasPaused=false;if(this.state===TWEEN_CONST.PAUSED){wasPaused=true;this.state=TWEEN_CONST.ACTIVE}this.isSeeking=true;do{this.update(0,delta)}while(this.totalProgress<toPosition);this.isSeeking=false;if(wasPaused){this.state=TWEEN_CONST.PAUSED}return this},setCallback:function(type,callback,params,scope){this.callbacks[type]={func:callback,scope:scope,params:params};return this},complete:function(delay){if(delay===undefined){delay=0}if(delay){this.state=TWEEN_CONST.COMPLETE_DELAY;this.countdown=delay}else{this.state=TWEEN_CONST.PENDING_REMOVE;this.dispatchTweenEvent(Events.TWEEN_COMPLETE,this.callbacks.onComplete)}return this},remove:function(){this.parent.remove(this);return this},stop:function(resetTo){if(this.state===TWEEN_CONST.ACTIVE){if(resetTo!==undefined){this.seek(resetTo)}}if(this.state!==TWEEN_CONST.REMOVED){if(this.state===TWEEN_CONST.PAUSED||this.state===TWEEN_CONST.PENDING_ADD){if(this.parentIsTimeline){this.parent.manager._destroy.push(this);this.parent.manager._toProcess++}else{this.parent._destroy.push(this);this.parent._toProcess++}}this.dispatchTweenEvent(Events.TWEEN_STOP,this.callbacks.onStop);this.removeAllListeners();this.state=TWEEN_CONST.PENDING_REMOVE}return this},update:function(timestamp,delta){if(this.state===TWEEN_CONST.PAUSED){return false}if(this.useFrames){delta=1*this.parent.timeScale}delta*=this.timeScale;this.elapsed+=delta;this.progress=Math.min(this.elapsed/this.duration,1);this.totalElapsed+=delta;this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1);switch(this.state){case TWEEN_CONST.ACTIVE:if(!this.hasStarted&&!this.isSeeking){this.startDelay-=delta;if(this.startDelay<=0){this.hasStarted=true;this.dispatchTweenEvent(Events.TWEEN_START,this.callbacks.onStart)}}var stillRunning=false;for(var i=0;i<this.totalData;i++){var tweenData=this.data[i];if(this.updateTweenData(this,tweenData,delta)){stillRunning=true}}if(!stillRunning){this.nextState()}break;case TWEEN_CONST.LOOP_DELAY:this.countdown-=delta;if(this.countdown<=0){this.state=TWEEN_CONST.ACTIVE;this.dispatchTweenEvent(Events.TWEEN_LOOP,this.callbacks.onLoop)}break;case TWEEN_CONST.OFFSET_DELAY:this.countdown-=delta;if(this.countdown<=0){this.state=TWEEN_CONST.ACTIVE}break;case TWEEN_CONST.COMPLETE_DELAY:this.countdown-=delta;if(this.countdown<=0){this.state=TWEEN_CONST.PENDING_REMOVE;this.dispatchTweenEvent(Events.TWEEN_COMPLETE,this.callbacks.onComplete)}break}return(this.state===TWEEN_CONST.PENDING_REMOVE)},dispatchTweenDataEvent:function(event,callback,tweenData){if(!this.isSeeking){this.emit(event,this,tweenData.key,tweenData.target,tweenData.current,tweenData.previous);if(callback){callback.params[1]=tweenData.target;callback.func.apply(callback.scope,callback.params)}}},dispatchTweenEvent:function(event,callback){if(!this.isSeeking){this.emit(event,this,this.targets);if(callback){callback.params[1]=this.targets;callback.func.apply(callback.scope,callback.params)}}},setStateFromEnd:function(tween,tweenData,diff){if(tweenData.yoyo){tweenData.elapsed=diff;tweenData.progress=diff/tweenData.duration;if(tweenData.flipX){tweenData.target.toggleFlipX()}if(tweenData.flipY){tweenData.target.toggleFlipY()}this.dispatchTweenDataEvent(Events.TWEEN_YOYO,tween.callbacks.onYoyo,tweenData);tweenData.start=tweenData.getStartValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween);return TWEEN_CONST.PLAYING_BACKWARD}else if(tweenData.repeatCounter>0){tweenData.repeatCounter--;tweenData.elapsed=diff;tweenData.progress=diff/tweenData.duration;if(tweenData.flipX){tweenData.target.toggleFlipX()}if(tweenData.flipY){tweenData.target.toggleFlipY()}tweenData.start=tweenData.getStartValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween);tweenData.end=tweenData.getEndValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween);if(tweenData.repeatDelay>0){tweenData.elapsed=tweenData.repeatDelay-diff;tweenData.current=tweenData.start;tweenData.target[tweenData.key]=tweenData.current;return TWEEN_CONST.REPEAT_DELAY}else{this.dispatchTweenDataEvent(Events.TWEEN_REPEAT,tween.callbacks.onRepeat,tweenData);return TWEEN_CONST.PLAYING_FORWARD}}return TWEEN_CONST.COMPLETE},setStateFromStart:function(tween,tweenData,diff){if(tweenData.repeatCounter>0){tweenData.repeatCounter--;tweenData.elapsed=diff;tweenData.progress=diff/tweenData.duration;if(tweenData.flipX){tweenData.target.toggleFlipX()}if(tweenData.flipY){tweenData.target.toggleFlipY()}tweenData.end=tweenData.getEndValue(tweenData.target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween);if(tweenData.repeatDelay>0){tweenData.elapsed=tweenData.repeatDelay-diff;tweenData.current=tweenData.start;tweenData.target[tweenData.key]=tweenData.current;return TWEEN_CONST.REPEAT_DELAY}else{this.dispatchTweenDataEvent(Events.TWEEN_REPEAT,tween.callbacks.onRepeat,tweenData);return TWEEN_CONST.PLAYING_FORWARD}}return TWEEN_CONST.COMPLETE},updateTweenData:function(tween,tweenData,delta){var target=tweenData.target;switch(tweenData.state){case TWEEN_CONST.PLAYING_FORWARD:case TWEEN_CONST.PLAYING_BACKWARD:if(!target){tweenData.state=TWEEN_CONST.COMPLETE;break}var elapsed=tweenData.elapsed;var duration=tweenData.duration;var diff=0;elapsed+=delta;if(elapsed>duration){diff=elapsed-duration;elapsed=duration}var forward=(tweenData.state===TWEEN_CONST.PLAYING_FORWARD);var progress=elapsed/duration;tweenData.elapsed=elapsed;tweenData.progress=progress;tweenData.previous=tweenData.current;if(progress===1){if(forward){tweenData.current=tweenData.end;target[tweenData.key]=tweenData.end;if(tweenData.hold>0){tweenData.elapsed=tweenData.hold-diff;tweenData.state=TWEEN_CONST.HOLD_DELAY}else{tweenData.state=this.setStateFromEnd(tween,tweenData,diff)}}else{tweenData.current=tweenData.start;target[tweenData.key]=tweenData.start;tweenData.state=this.setStateFromStart(tween,tweenData,diff)}}else{var v=(forward)?tweenData.ease(progress):tweenData.ease(1-progress);tweenData.current=tweenData.start+((tweenData.end-tweenData.start)*v);target[tweenData.key]=tweenData.current}this.dispatchTweenDataEvent(Events.TWEEN_UPDATE,tween.callbacks.onUpdate,tweenData);break;case TWEEN_CONST.DELAY:tweenData.elapsed-=delta;if(tweenData.elapsed<=0){tweenData.elapsed=Math.abs(tweenData.elapsed);tweenData.state=TWEEN_CONST.PENDING_RENDER}break;case TWEEN_CONST.REPEAT_DELAY:tweenData.elapsed-=delta;if(tweenData.elapsed<=0){tweenData.elapsed=Math.abs(tweenData.elapsed);tweenData.state=TWEEN_CONST.PLAYING_FORWARD;this.dispatchTweenDataEvent(Events.TWEEN_REPEAT,tween.callbacks.onRepeat,tweenData)}break;case TWEEN_CONST.HOLD_DELAY:tweenData.elapsed-=delta;if(tweenData.elapsed<=0){tweenData.state=this.setStateFromEnd(tween,tweenData,Math.abs(tweenData.elapsed))}break;case TWEEN_CONST.PENDING_RENDER:if(target){tweenData.start=tweenData.getStartValue(target,tweenData.key,target[tweenData.key],tweenData.index,tween.totalTargets,tween);tweenData.end=tweenData.getEndValue(target,tweenData.key,tweenData.start,tweenData.index,tween.totalTargets,tween);tweenData.current=tweenData.start;target[tweenData.key]=tweenData.start;tweenData.state=TWEEN_CONST.PLAYING_FORWARD}else{tweenData.state=TWEEN_CONST.COMPLETE}break}return(tweenData.state!==TWEEN_CONST.COMPLETE)}});Tween.TYPES=['onActive','onComplete','onLoop','onRepeat','onStart','onStop','onUpdate','onYoyo'];GameObjectFactory.register('tween',function(config){return this.scene.sys.tweens.add(config)});GameObjectCreator.register('tween',function(config){return this.scene.sys.tweens.create(config)});module.exports=Tween}),(function(module,exports,__webpack_require__){module.exports={TIMELINE_COMPLETE:__webpack_require__(1358),TIMELINE_LOOP:__webpack_require__(1359),TIMELINE_PAUSE:__webpack_require__(1360),TIMELINE_RESUME:__webpack_require__(1361),TIMELINE_START:__webpack_require__(1362),TIMELINE_UPDATE:__webpack_require__(1363),TWEEN_ACTIVE:__webpack_require__(1364),TWEEN_COMPLETE:__webpack_require__(1365),TWEEN_LOOP:__webpack_require__(1366),TWEEN_REPEAT:__webpack_require__(1367),TWEEN_START:__webpack_require__(1368),TWEEN_STOP:__webpack_require__(1369),TWEEN_UPDATE:__webpack_require__(1370),TWEEN_YOYO:__webpack_require__(1371)}}),(function(module,exports){var TweenData=function(target,index,key,getEnd,getStart,getActive,ease,delay,duration,yoyo,hold,repeat,repeatDelay,flipX,flipY){return{target:target,index:index,key:key,getActiveValue:getActive,getEndValue:getEnd,getStartValue:getStart,ease:ease,duration:0,totalDuration:0,delay:0,yoyo:yoyo,hold:0,repeat:0,repeatDelay:0,flipX:flipX,flipY:flipY,progress:0,elapsed:0,repeatCounter:0,start:0,previous:0,current:0,end:0,t1:0,t2:0,gen:{delay:delay,duration:duration,hold:hold,repeat:repeat,repeatDelay:repeatDelay},state:0}};module.exports=TweenData}),(function(module,exports){var ScaleModes={DEFAULT:0,LINEAR:0,NEAREST:1};module.exports=ScaleModes}),(function(module,exports,__webpack_require__){var MathWrap=__webpack_require__(58);var Wrap=function(angle){return MathWrap(angle,-Math.PI,Math.PI)};module.exports=Wrap}),(function(module,exports,__webpack_require__){var Wrap=__webpack_require__(58);var WrapDegrees=function(angle){return Wrap(angle,-180,180)};module.exports=WrapDegrees}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Earcut=__webpack_require__(66);var GetFastValue=__webpack_require__(2);var ModelViewProjection=__webpack_require__(238);var ShaderSourceFS=__webpack_require__(340);var ShaderSourceVS=__webpack_require__(341);var TransformMatrix=__webpack_require__(29);var Utils=__webpack_require__(9);var WebGLPipeline=__webpack_require__(147);var TextureTintPipeline=new Class({Extends:WebGLPipeline,Mixins:[ModelViewProjection],initialize:function TextureTintPipeline(config){var rendererConfig=config.renderer.config;WebGLPipeline.call(this,{game:config.game,renderer:config.renderer,gl:config.renderer.gl,topology:GetFastValue(config,'topology',config.renderer.gl.TRIANGLES),vertShader:GetFastValue(config,'vertShader',ShaderSourceVS),fragShader:GetFastValue(config,'fragShader',ShaderSourceFS),vertexCapacity:GetFastValue(config,'vertexCapacity',6*rendererConfig.batchSize),vertexSize:GetFastValue(config,'vertexSize',Float32Array.BYTES_PER_ELEMENT*5+Uint8Array.BYTES_PER_ELEMENT*4),attributes:[{name:'inPosition',size:2,type:config.renderer.gl.FLOAT,normalized:false,offset:0},{name:'inTexCoord',size:2,type:config.renderer.gl.FLOAT,normalized:false,offset:Float32Array.BYTES_PER_ELEMENT*2},{name:'inTintEffect',size:1,type:config.renderer.gl.FLOAT,normalized:false,offset:Float32Array.BYTES_PER_ELEMENT*4},{name:'inTint',size:4,type:config.renderer.gl.UNSIGNED_BYTE,normalized:true,offset:Float32Array.BYTES_PER_ELEMENT*5}]});this.vertexViewF32=new Float32Array(this.vertexData);this.vertexViewU32=new Uint32Array(this.vertexData);this.maxQuads=rendererConfig.batchSize;this.batches=[];this._tempMatrix1=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempMatrix3=new TransformMatrix();this._tempMatrix4=new TransformMatrix();this.tempTriangle=[{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0},{x:0,y:0,width:0}];this.tintEffect=2;this.strokeTint={TL:0,TR:0,BL:0,BR:0};this.fillTint={TL:0,TR:0,BL:0,BR:0};this.currentFrame={u0:0,v0:0,u1:1,v1:1};this.firstQuad=[0,0,0,0,0];this.prevQuad=[0,0,0,0,0];this.polygonCache=[];this.mvpInit()},onBind:function(){WebGLPipeline.prototype.onBind.call(this);this.mvpUpdate();return this},resize:function(width,height,resolution){WebGLPipeline.prototype.resize.call(this,width,height,resolution);this.projOrtho(0,this.width,this.height,0,-1000.0,1000.0);return this},setTexture2D:function(texture,unit){if(texture===undefined){texture=this.renderer.blankTexture.glTexture}if(unit===undefined){unit=0}if(this.requireTextureBatch(texture,unit)){this.pushBatch(texture,unit)}return this},requireTextureBatch:function(texture,unit){var batches=this.batches;var batchLength=batches.length;if(batchLength>0){var currentTexture=(unit>0)?batches[batchLength-1].textures[unit-1]:batches[batchLength-1].texture;return!(currentTexture===texture)}return true},pushBatch:function(texture,unit){if(unit===0){this.batches.push({first:this.vertexCount,texture:texture,textures:[]})}else{var textures=[];textures[unit-1]=texture;this.batches.push({first:this.vertexCount,texture:null,textures:textures})}},flush:function(){if(this.flushLocked){return this}this.flushLocked=true;var gl=this.gl;var vertexCount=this.vertexCount;var topology=this.topology;var vertexSize=this.vertexSize;var renderer=this.renderer;var batches=this.batches;var batchCount=batches.length;var batchVertexCount=0;var batch=null;var batchNext;var textureIndex;var nTexture;if(batchCount===0||vertexCount===0){this.flushLocked=false;return this}gl.bufferSubData(gl.ARRAY_BUFFER,0,this.bytes.subarray(0,vertexCount*vertexSize));for(var index=0;index<batchCount-1;index++){batch=batches[index];batchNext=batches[index+1];if(batch.textures.length>0){for(textureIndex=0;textureIndex<batch.textures.length;++textureIndex){nTexture=batch.textures[textureIndex];if(nTexture){renderer.setTexture2D(nTexture,1+textureIndex,false)}}gl.activeTexture(gl.TEXTURE0)}batchVertexCount=batchNext.first-batch.first;if(batch.texture===null||batchVertexCount<=0){continue}renderer.setTexture2D(batch.texture,0,false);gl.drawArrays(topology,batch.first,batchVertexCount)}batch=batches[batchCount-1];if(batch.textures.length>0){for(textureIndex=0;textureIndex<batch.textures.length;++textureIndex){nTexture=batch.textures[textureIndex];if(nTexture){renderer.setTexture2D(nTexture,1+textureIndex,false)}}gl.activeTexture(gl.TEXTURE0)}batchVertexCount=vertexCount-batch.first;if(batch.texture&&batchVertexCount>0){renderer.setTexture2D(batch.texture,0,false);gl.drawArrays(topology,batch.first,batchVertexCount)}this.vertexCount=0;batches.length=0;this.flushLocked=false;return this},batchSprite:function(sprite,camera,parentTransformMatrix){this.renderer.setPipeline(this);var camMatrix=this._tempMatrix1;var spriteMatrix=this._tempMatrix2;var calcMatrix=this._tempMatrix3;var frame=sprite.frame;var texture=frame.glTexture;var u0=frame.u0;var v0=frame.v0;var u1=frame.u1;var v1=frame.v1;var frameX=frame.x;var frameY=frame.y;var frameWidth=frame.cutWidth;var frameHeight=frame.cutHeight;var customPivot=frame.customPivot;var displayOriginX=sprite.displayOriginX;var displayOriginY=sprite.displayOriginY;var x=-displayOriginX+frameX;var y=-displayOriginY+frameY;if(sprite.isCropped){var crop=sprite._crop;if(crop.flipX!==sprite.flipX||crop.flipY!==sprite.flipY){frame.updateCropUVs(crop,sprite.flipX,sprite.flipY)}u0=crop.u0;v0=crop.v0;u1=crop.u1;v1=crop.v1;frameWidth=crop.width;frameHeight=crop.height;frameX=crop.x;frameY=crop.y;x=-displayOriginX+frameX;y=-displayOriginY+frameY}var flipX=1;var flipY=1;if(sprite.flipX){if(!customPivot){x+=(-frame.realWidth+(displayOriginX*2))}flipX=-1}if(sprite.flipY||(frame.source.isGLTexture&&!texture.flipY)){if(!customPivot){y+=(-frame.realHeight+(displayOriginY*2))}flipY=-1}spriteMatrix.applyITRS(sprite.x,sprite.y,sprite.rotation,sprite.scaleX*flipX,sprite.scaleY*flipY);camMatrix.copyFrom(camera.matrix);if(parentTransformMatrix){camMatrix.multiplyWithOffset(parentTransformMatrix,-camera.scrollX*sprite.scrollFactorX,-camera.scrollY*sprite.scrollFactorY);spriteMatrix.e=sprite.x;spriteMatrix.f=sprite.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*sprite.scrollFactorX;spriteMatrix.f-=camera.scrollY*sprite.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var xw=x+frameWidth;var yh=y+frameHeight;var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(x,yh);var ty1=calcMatrix.getY(x,yh);var tx2=calcMatrix.getX(xw,yh);var ty2=calcMatrix.getY(xw,yh);var tx3=calcMatrix.getX(xw,y);var ty3=calcMatrix.getY(xw,y);var tintTL=Utils.getTintAppendFloatAlpha(sprite._tintTL,camera.alpha*sprite._alphaTL);var tintTR=Utils.getTintAppendFloatAlpha(sprite._tintTR,camera.alpha*sprite._alphaTR);var tintBL=Utils.getTintAppendFloatAlpha(sprite._tintBL,camera.alpha*sprite._alphaBL);var tintBR=Utils.getTintAppendFloatAlpha(sprite._tintBR,camera.alpha*sprite._alphaBR);if(camera.roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}this.setTexture2D(texture,0);var tintEffect=(sprite._isTinted&&sprite.tintFill);this.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,0)},batchQuad:function(x0,y0,x1,y1,x2,y2,x3,y3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,unit){var hasFlushed=false;if(this.vertexCount+6>this.vertexCapacity){this.flush();hasFlushed=true;this.setTexture2D(texture,unit)}var vertexViewF32=this.vertexViewF32;var vertexViewU32=this.vertexViewU32;var vertexOffset=(this.vertexCount*this.vertexComponentCount)-1;vertexViewF32[++vertexOffset]=x0;vertexViewF32[++vertexOffset]=y0;vertexViewF32[++vertexOffset]=u0;vertexViewF32[++vertexOffset]=v0;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintTL;vertexViewF32[++vertexOffset]=x1;vertexViewF32[++vertexOffset]=y1;vertexViewF32[++vertexOffset]=u0;vertexViewF32[++vertexOffset]=v1;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintBL;vertexViewF32[++vertexOffset]=x2;vertexViewF32[++vertexOffset]=y2;vertexViewF32[++vertexOffset]=u1;vertexViewF32[++vertexOffset]=v1;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintBR;vertexViewF32[++vertexOffset]=x0;vertexViewF32[++vertexOffset]=y0;vertexViewF32[++vertexOffset]=u0;vertexViewF32[++vertexOffset]=v0;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintTL;vertexViewF32[++vertexOffset]=x2;vertexViewF32[++vertexOffset]=y2;vertexViewF32[++vertexOffset]=u1;vertexViewF32[++vertexOffset]=v1;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintBR;vertexViewF32[++vertexOffset]=x3;vertexViewF32[++vertexOffset]=y3;vertexViewF32[++vertexOffset]=u1;vertexViewF32[++vertexOffset]=v0;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintTR;this.vertexCount+=6;return hasFlushed},batchTri:function(x1,y1,x2,y2,x3,y3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintEffect,texture,unit){var hasFlushed=false;if(this.vertexCount+3>this.vertexCapacity){this.flush();this.setTexture2D(texture,unit);hasFlushed=true}var vertexViewF32=this.vertexViewF32;var vertexViewU32=this.vertexViewU32;var vertexOffset=(this.vertexCount*this.vertexComponentCount)-1;vertexViewF32[++vertexOffset]=x1;vertexViewF32[++vertexOffset]=y1;vertexViewF32[++vertexOffset]=u0;vertexViewF32[++vertexOffset]=v0;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintTL;vertexViewF32[++vertexOffset]=x2;vertexViewF32[++vertexOffset]=y2;vertexViewF32[++vertexOffset]=u0;vertexViewF32[++vertexOffset]=v1;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintTR;vertexViewF32[++vertexOffset]=x3;vertexViewF32[++vertexOffset]=y3;vertexViewF32[++vertexOffset]=u1;vertexViewF32[++vertexOffset]=v1;vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=tintBL;this.vertexCount+=3;return hasFlushed},batchTexture:function(gameObject,texture,textureWidth,textureHeight,srcX,srcY,srcWidth,srcHeight,scaleX,scaleY,rotation,flipX,flipY,scrollFactorX,scrollFactorY,displayOriginX,displayOriginY,frameX,frameY,frameWidth,frameHeight,tintTL,tintTR,tintBL,tintBR,tintEffect,uOffset,vOffset,camera,parentTransformMatrix,skipFlip){this.renderer.setPipeline(this,gameObject);var camMatrix=this._tempMatrix1;var spriteMatrix=this._tempMatrix2;var calcMatrix=this._tempMatrix3;var u0=(frameX/textureWidth)+uOffset;var v0=(frameY/textureHeight)+vOffset;var u1=(frameX+frameWidth)/textureWidth+uOffset;var v1=(frameY+frameHeight)/textureHeight+vOffset;var width=srcWidth;var height=srcHeight;var x=-displayOriginX;var y=-displayOriginY;if(gameObject.isCropped){var crop=gameObject._crop;width=crop.width;height=crop.height;srcWidth=crop.width;srcHeight=crop.height;frameX=crop.x;frameY=crop.y;var ox=frameX;var oy=frameY;if(flipX){ox=(frameWidth-crop.x-crop.width)}if(flipY&&!texture.isRenderTexture){oy=(frameHeight-crop.y-crop.height)}u0=(ox/textureWidth)+uOffset;v0=(oy/textureHeight)+vOffset;u1=(ox+crop.width)/textureWidth+uOffset;v1=(oy+crop.height)/textureHeight+vOffset;x=-displayOriginX+frameX;y=-displayOriginY+frameY}flipY=flipY^(!skipFlip&&texture.isRenderTexture?1:0);if(flipX){width*=-1;x+=srcWidth}if(flipY){height*=-1;y+=srcHeight}var xw=x+width;var yh=y+height;spriteMatrix.applyITRS(srcX,srcY,rotation,scaleX,scaleY);camMatrix.copyFrom(camera.matrix);if(parentTransformMatrix){camMatrix.multiplyWithOffset(parentTransformMatrix,-camera.scrollX*scrollFactorX,-camera.scrollY*scrollFactorY);spriteMatrix.e=srcX;spriteMatrix.f=srcY;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*scrollFactorX;spriteMatrix.f-=camera.scrollY*scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(x,yh);var ty1=calcMatrix.getY(x,yh);var tx2=calcMatrix.getX(xw,yh);var ty2=calcMatrix.getY(xw,yh);var tx3=calcMatrix.getX(xw,y);var ty3=calcMatrix.getY(xw,y);if(camera.roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}this.setTexture2D(texture,0);this.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,0)},batchTextureFrame:function(frame,x,y,tint,alpha,transformMatrix,parentTransformMatrix){this.renderer.setPipeline(this);var spriteMatrix=this._tempMatrix1.copyFrom(transformMatrix);var calcMatrix=this._tempMatrix2;var xw=x+frame.width;var yh=y+frame.height;if(parentTransformMatrix){spriteMatrix.multiply(parentTransformMatrix,calcMatrix)}else{calcMatrix=spriteMatrix}var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(x,yh);var ty1=calcMatrix.getY(x,yh);var tx2=calcMatrix.getX(xw,yh);var ty2=calcMatrix.getY(xw,yh);var tx3=calcMatrix.getX(xw,y);var ty3=calcMatrix.getY(xw,y);this.setTexture2D(frame.glTexture,0);tint=Utils.getTintAppendFloatAlpha(tint,alpha);this.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,frame.u0,frame.v0,frame.u1,frame.v1,tint,tint,tint,tint,0,frame.glTexture,0)},drawFillRect:function(x,y,width,height,color,alpha){var xw=x+width;var yh=y+height;this.setTexture2D();var tint=Utils.getTintAppendFloatAlphaAndSwap(color,alpha);this.batchQuad(x,y,x,yh,xw,yh,xw,y,0,0,1,1,tint,tint,tint,tint,2)},batchFillRect:function(x,y,width,height,currentMatrix,parentMatrix){this.renderer.setPipeline(this);var calcMatrix=this._tempMatrix3;if(parentMatrix){parentMatrix.multiply(currentMatrix,calcMatrix)}var xw=x+width;var yh=y+height;var x0=calcMatrix.getX(x,y);var y0=calcMatrix.getY(x,y);var x1=calcMatrix.getX(x,yh);var y1=calcMatrix.getY(x,yh);var x2=calcMatrix.getX(xw,yh);var y2=calcMatrix.getY(xw,yh);var x3=calcMatrix.getX(xw,y);var y3=calcMatrix.getY(xw,y);var frame=this.currentFrame;var u0=frame.u0;var v0=frame.v0;var u1=frame.u1;var v1=frame.v1;this.batchQuad(x0,y0,x1,y1,x2,y2,x3,y3,u0,v0,u1,v1,this.fillTint.TL,this.fillTint.TR,this.fillTint.BL,this.fillTint.BR,this.tintEffect)},batchFillTriangle:function(x0,y0,x1,y1,x2,y2,currentMatrix,parentMatrix){this.renderer.setPipeline(this);var calcMatrix=this._tempMatrix3;if(parentMatrix){parentMatrix.multiply(currentMatrix,calcMatrix)}var tx0=calcMatrix.getX(x0,y0);var ty0=calcMatrix.getY(x0,y0);var tx1=calcMatrix.getX(x1,y1);var ty1=calcMatrix.getY(x1,y1);var tx2=calcMatrix.getX(x2,y2);var ty2=calcMatrix.getY(x2,y2);var frame=this.currentFrame;var u0=frame.u0;var v0=frame.v0;var u1=frame.u1;var v1=frame.v1;this.batchTri(tx0,ty0,tx1,ty1,tx2,ty2,u0,v0,u1,v1,this.fillTint.TL,this.fillTint.TR,this.fillTint.BL,this.tintEffect)},batchStrokeTriangle:function(x0,y0,x1,y1,x2,y2,lineWidth,currentMatrix,parentMatrix){var tempTriangle=this.tempTriangle;tempTriangle[0].x=x0;tempTriangle[0].y=y0;tempTriangle[0].width=lineWidth;tempTriangle[1].x=x1;tempTriangle[1].y=y1;tempTriangle[1].width=lineWidth;tempTriangle[2].x=x2;tempTriangle[2].y=y2;tempTriangle[2].width=lineWidth;tempTriangle[3].x=x0;tempTriangle[3].y=y0;tempTriangle[3].width=lineWidth;this.batchStrokePath(tempTriangle,lineWidth,false,currentMatrix,parentMatrix)},batchFillPath:function(path,currentMatrix,parentMatrix){this.renderer.setPipeline(this);var calcMatrix=this._tempMatrix3;if(parentMatrix){parentMatrix.multiply(currentMatrix,calcMatrix)}var length=path.length;var polygonCache=this.polygonCache;var polygonIndexArray;var point;var tintTL=this.fillTint.TL;var tintTR=this.fillTint.TR;var tintBL=this.fillTint.BL;var tintEffect=this.tintEffect;for(var pathIndex=0;pathIndex<length;++pathIndex){point=path[pathIndex];polygonCache.push(point.x,point.y)}polygonIndexArray=Earcut(polygonCache);length=polygonIndexArray.length;var frame=this.currentFrame;for(var index=0;index<length;index+=3){var p0=polygonIndexArray[index+0]*2;var p1=polygonIndexArray[index+1]*2;var p2=polygonIndexArray[index+2]*2;var x0=polygonCache[p0+0];var y0=polygonCache[p0+1];var x1=polygonCache[p1+0];var y1=polygonCache[p1+1];var x2=polygonCache[p2+0];var y2=polygonCache[p2+1];var tx0=calcMatrix.getX(x0,y0);var ty0=calcMatrix.getY(x0,y0);var tx1=calcMatrix.getX(x1,y1);var ty1=calcMatrix.getY(x1,y1);var tx2=calcMatrix.getX(x2,y2);var ty2=calcMatrix.getY(x2,y2);var u0=frame.u0;var v0=frame.v0;var u1=frame.u1;var v1=frame.v1;this.batchTri(tx0,ty0,tx1,ty1,tx2,ty2,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintEffect)}polygonCache.length=0},batchStrokePath:function(path,lineWidth,pathOpen,currentMatrix,parentMatrix){this.renderer.setPipeline(this);this.prevQuad[4]=0;this.firstQuad[4]=0;var pathLength=path.length-1;for(var pathIndex=0;pathIndex<pathLength;pathIndex++){var point0=path[pathIndex];var point1=path[pathIndex+1];this.batchLine(point0.x,point0.y,point1.x,point1.y,point0.width/2,point1.width/2,lineWidth,pathIndex,!pathOpen&&(pathIndex===pathLength-1),currentMatrix,parentMatrix)}},batchLine:function(ax,ay,bx,by,aLineWidth,bLineWidth,lineWidth,index,closePath,currentMatrix,parentMatrix){this.renderer.setPipeline(this);var calcMatrix=this._tempMatrix3;if(parentMatrix){parentMatrix.multiply(currentMatrix,calcMatrix)}var dx=bx-ax;var dy=by-ay;var len=Math.sqrt(dx*dx+dy*dy);var al0=aLineWidth*(by-ay)/len;var al1=aLineWidth*(ax-bx)/len;var bl0=bLineWidth*(by-ay)/len;var bl1=bLineWidth*(ax-bx)/len;var lx0=bx-bl0;var ly0=by-bl1;var lx1=ax-al0;var ly1=ay-al1;var lx2=bx+bl0;var ly2=by+bl1;var lx3=ax+al0;var ly3=ay+al1;var brX=calcMatrix.getX(lx0,ly0);var brY=calcMatrix.getY(lx0,ly0);var blX=calcMatrix.getX(lx1,ly1);var blY=calcMatrix.getY(lx1,ly1);var trX=calcMatrix.getX(lx2,ly2);var trY=calcMatrix.getY(lx2,ly2);var tlX=calcMatrix.getX(lx3,ly3);var tlY=calcMatrix.getY(lx3,ly3);var tint=this.strokeTint;var tintEffect=this.tintEffect;var tintTL=tint.TL;var tintTR=tint.TR;var tintBL=tint.BL;var tintBR=tint.BR;var frame=this.currentFrame;var u0=frame.u0;var v0=frame.v0;var u1=frame.u1;var v1=frame.v1;this.batchQuad(tlX,tlY,blX,blY,brX,brY,trX,trY,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect);if(lineWidth<=2){return}var prev=this.prevQuad;var first=this.firstQuad;if(index>0&&prev[4]){this.batchQuad(tlX,tlY,blX,blY,prev[0],prev[1],prev[2],prev[3],u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect)}else{first[0]=tlX;first[1]=tlY;first[2]=blX;first[3]=blY;first[4]=1}if(closePath&&first[4]){this.batchQuad(brX,brY,trX,trY,first[0],first[1],first[2],first[3],u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect)}else{prev[0]=brX;prev[1]=brY;prev[2]=trX;prev[3]=trY;prev[4]=1}}});module.exports=TextureTintPipeline}),(function(module,exports){var ModelViewProjection={modelMatrixDirty:false,viewMatrixDirty:false,projectionMatrixDirty:false,modelMatrix:null,viewMatrix:null,projectionMatrix:null,mvpInit:function(){this.modelMatrixDirty=true;this.viewMatrixDirty=true;this.projectionMatrixDirty=true;this.modelMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.viewMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.projectionMatrix=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);return this},mvpUpdate:function(){var program=this.program;if(this.modelMatrixDirty){this.renderer.setMatrix4(program,'uModelMatrix',false,this.modelMatrix);this.modelMatrixDirty=false}if(this.viewMatrixDirty){this.renderer.setMatrix4(program,'uViewMatrix',false,this.viewMatrix);this.viewMatrixDirty=false}if(this.projectionMatrixDirty){this.renderer.setMatrix4(program,'uProjectionMatrix',false,this.projectionMatrix);this.projectionMatrixDirty=false}return this},modelIdentity:function(){var modelMatrix=this.modelMatrix;modelMatrix[0]=1;modelMatrix[1]=0;modelMatrix[2]=0;modelMatrix[3]=0;modelMatrix[4]=0;modelMatrix[5]=1;modelMatrix[6]=0;modelMatrix[7]=0;modelMatrix[8]=0;modelMatrix[9]=0;modelMatrix[10]=1;modelMatrix[11]=0;modelMatrix[12]=0;modelMatrix[13]=0;modelMatrix[14]=0;modelMatrix[15]=1;this.modelMatrixDirty=true;return this},modelScale:function(x,y,z){var modelMatrix=this.modelMatrix;modelMatrix[0]=modelMatrix[0]*x;modelMatrix[1]=modelMatrix[1]*x;modelMatrix[2]=modelMatrix[2]*x;modelMatrix[3]=modelMatrix[3]*x;modelMatrix[4]=modelMatrix[4]*y;modelMatrix[5]=modelMatrix[5]*y;modelMatrix[6]=modelMatrix[6]*y;modelMatrix[7]=modelMatrix[7]*y;modelMatrix[8]=modelMatrix[8]*z;modelMatrix[9]=modelMatrix[9]*z;modelMatrix[10]=modelMatrix[10]*z;modelMatrix[11]=modelMatrix[11]*z;this.modelMatrixDirty=true;return this},modelTranslate:function(x,y,z){var modelMatrix=this.modelMatrix;modelMatrix[12]=modelMatrix[0]*x+modelMatrix[4]*y+modelMatrix[8]*z+modelMatrix[12];modelMatrix[13]=modelMatrix[1]*x+modelMatrix[5]*y+modelMatrix[9]*z+modelMatrix[13];modelMatrix[14]=modelMatrix[2]*x+modelMatrix[6]*y+modelMatrix[10]*z+modelMatrix[14];modelMatrix[15]=modelMatrix[3]*x+modelMatrix[7]*y+modelMatrix[11]*z+modelMatrix[15];this.modelMatrixDirty=true;return this},modelRotateX:function(radians){var modelMatrix=this.modelMatrix;var s=Math.sin(radians);var c=Math.cos(radians);var a10=modelMatrix[4];var a11=modelMatrix[5];var a12=modelMatrix[6];var a13=modelMatrix[7];var a20=modelMatrix[8];var a21=modelMatrix[9];var a22=modelMatrix[10];var a23=modelMatrix[11];modelMatrix[4]=a10*c+a20*s;modelMatrix[5]=a11*c+a21*s;modelMatrix[6]=a12*c+a22*s;modelMatrix[7]=a13*c+a23*s;modelMatrix[8]=a20*c-a10*s;modelMatrix[9]=a21*c-a11*s;modelMatrix[10]=a22*c-a12*s;modelMatrix[11]=a23*c-a13*s;this.modelMatrixDirty=true;return this},modelRotateY:function(radians){var modelMatrix=this.modelMatrix;var s=Math.sin(radians);var c=Math.cos(radians);var a00=modelMatrix[0];var a01=modelMatrix[1];var a02=modelMatrix[2];var a03=modelMatrix[3];var a20=modelMatrix[8];var a21=modelMatrix[9];var a22=modelMatrix[10];var a23=modelMatrix[11];modelMatrix[0]=a00*c-a20*s;modelMatrix[1]=a01*c-a21*s;modelMatrix[2]=a02*c-a22*s;modelMatrix[3]=a03*c-a23*s;modelMatrix[8]=a00*s+a20*c;modelMatrix[9]=a01*s+a21*c;modelMatrix[10]=a02*s+a22*c;modelMatrix[11]=a03*s+a23*c;this.modelMatrixDirty=true;return this},modelRotateZ:function(radians){var modelMatrix=this.modelMatrix;var s=Math.sin(radians);var c=Math.cos(radians);var a00=modelMatrix[0];var a01=modelMatrix[1];var a02=modelMatrix[2];var a03=modelMatrix[3];var a10=modelMatrix[4];var a11=modelMatrix[5];var a12=modelMatrix[6];var a13=modelMatrix[7];modelMatrix[0]=a00*c+a10*s;modelMatrix[1]=a01*c+a11*s;modelMatrix[2]=a02*c+a12*s;modelMatrix[3]=a03*c+a13*s;modelMatrix[4]=a10*c-a00*s;modelMatrix[5]=a11*c-a01*s;modelMatrix[6]=a12*c-a02*s;modelMatrix[7]=a13*c-a03*s;this.modelMatrixDirty=true;return this},viewIdentity:function(){var viewMatrix=this.viewMatrix;viewMatrix[0]=1;viewMatrix[1]=0;viewMatrix[2]=0;viewMatrix[3]=0;viewMatrix[4]=0;viewMatrix[5]=1;viewMatrix[6]=0;viewMatrix[7]=0;viewMatrix[8]=0;viewMatrix[9]=0;viewMatrix[10]=1;viewMatrix[11]=0;viewMatrix[12]=0;viewMatrix[13]=0;viewMatrix[14]=0;viewMatrix[15]=1;this.viewMatrixDirty=true;return this},viewScale:function(x,y,z){var viewMatrix=this.viewMatrix;viewMatrix[0]=viewMatrix[0]*x;viewMatrix[1]=viewMatrix[1]*x;viewMatrix[2]=viewMatrix[2]*x;viewMatrix[3]=viewMatrix[3]*x;viewMatrix[4]=viewMatrix[4]*y;viewMatrix[5]=viewMatrix[5]*y;viewMatrix[6]=viewMatrix[6]*y;viewMatrix[7]=viewMatrix[7]*y;viewMatrix[8]=viewMatrix[8]*z;viewMatrix[9]=viewMatrix[9]*z;viewMatrix[10]=viewMatrix[10]*z;viewMatrix[11]=viewMatrix[11]*z;this.viewMatrixDirty=true;return this},viewTranslate:function(x,y,z){var viewMatrix=this.viewMatrix;viewMatrix[12]=viewMatrix[0]*x+viewMatrix[4]*y+viewMatrix[8]*z+viewMatrix[12];viewMatrix[13]=viewMatrix[1]*x+viewMatrix[5]*y+viewMatrix[9]*z+viewMatrix[13];viewMatrix[14]=viewMatrix[2]*x+viewMatrix[6]*y+viewMatrix[10]*z+viewMatrix[14];viewMatrix[15]=viewMatrix[3]*x+viewMatrix[7]*y+viewMatrix[11]*z+viewMatrix[15];this.viewMatrixDirty=true;return this},viewRotateX:function(radians){var viewMatrix=this.viewMatrix;var s=Math.sin(radians);var c=Math.cos(radians);var a10=viewMatrix[4];var a11=viewMatrix[5];var a12=viewMatrix[6];var a13=viewMatrix[7];var a20=viewMatrix[8];var a21=viewMatrix[9];var a22=viewMatrix[10];var a23=viewMatrix[11];viewMatrix[4]=a10*c+a20*s;viewMatrix[5]=a11*c+a21*s;viewMatrix[6]=a12*c+a22*s;viewMatrix[7]=a13*c+a23*s;viewMatrix[8]=a20*c-a10*s;viewMatrix[9]=a21*c-a11*s;viewMatrix[10]=a22*c-a12*s;viewMatrix[11]=a23*c-a13*s;this.viewMatrixDirty=true;return this},viewRotateY:function(radians){var viewMatrix=this.viewMatrix;var s=Math.sin(radians);var c=Math.cos(radians);var a00=viewMatrix[0];var a01=viewMatrix[1];var a02=viewMatrix[2];var a03=viewMatrix[3];var a20=viewMatrix[8];var a21=viewMatrix[9];var a22=viewMatrix[10];var a23=viewMatrix[11];viewMatrix[0]=a00*c-a20*s;viewMatrix[1]=a01*c-a21*s;viewMatrix[2]=a02*c-a22*s;viewMatrix[3]=a03*c-a23*s;viewMatrix[8]=a00*s+a20*c;viewMatrix[9]=a01*s+a21*c;viewMatrix[10]=a02*s+a22*c;viewMatrix[11]=a03*s+a23*c;this.viewMatrixDirty=true;return this},viewRotateZ:function(radians){var viewMatrix=this.viewMatrix;var s=Math.sin(radians);var c=Math.cos(radians);var a00=viewMatrix[0];var a01=viewMatrix[1];var a02=viewMatrix[2];var a03=viewMatrix[3];var a10=viewMatrix[4];var a11=viewMatrix[5];var a12=viewMatrix[6];var a13=viewMatrix[7];viewMatrix[0]=a00*c+a10*s;viewMatrix[1]=a01*c+a11*s;viewMatrix[2]=a02*c+a12*s;viewMatrix[3]=a03*c+a13*s;viewMatrix[4]=a10*c-a00*s;viewMatrix[5]=a11*c-a01*s;viewMatrix[6]=a12*c-a02*s;viewMatrix[7]=a13*c-a03*s;this.viewMatrixDirty=true;return this},viewLoad2D:function(matrix2D){var vm=this.viewMatrix;vm[0]=matrix2D[0];vm[1]=matrix2D[1];vm[2]=0.0;vm[3]=0.0;vm[4]=matrix2D[2];vm[5]=matrix2D[3];vm[6]=0.0;vm[7]=0.0;vm[8]=matrix2D[4];vm[9]=matrix2D[5];vm[10]=1.0;vm[11]=0.0;vm[12]=0.0;vm[13]=0.0;vm[14]=0.0;vm[15]=1.0;this.viewMatrixDirty=true;return this},viewLoad:function(matrix){var vm=this.viewMatrix;vm[0]=matrix[0];vm[1]=matrix[1];vm[2]=matrix[2];vm[3]=matrix[3];vm[4]=matrix[4];vm[5]=matrix[5];vm[6]=matrix[6];vm[7]=matrix[7];vm[8]=matrix[8];vm[9]=matrix[9];vm[10]=matrix[10];vm[11]=matrix[11];vm[12]=matrix[12];vm[13]=matrix[13];vm[14]=matrix[14];vm[15]=matrix[15];this.viewMatrixDirty=true;return this},projIdentity:function(){var projectionMatrix=this.projectionMatrix;projectionMatrix[0]=1;projectionMatrix[1]=0;projectionMatrix[2]=0;projectionMatrix[3]=0;projectionMatrix[4]=0;projectionMatrix[5]=1;projectionMatrix[6]=0;projectionMatrix[7]=0;projectionMatrix[8]=0;projectionMatrix[9]=0;projectionMatrix[10]=1;projectionMatrix[11]=0;projectionMatrix[12]=0;projectionMatrix[13]=0;projectionMatrix[14]=0;projectionMatrix[15]=1;this.projectionMatrixDirty=true;return this},projOrtho:function(left,right,bottom,top,near,far){var projectionMatrix=this.projectionMatrix;var leftRight=1.0/(left-right);var bottomTop=1.0/(bottom-top);var nearFar=1.0/(near-far);projectionMatrix[0]=-2.0*leftRight;projectionMatrix[1]=0.0;projectionMatrix[2]=0.0;projectionMatrix[3]=0.0;projectionMatrix[4]=0.0;projectionMatrix[5]=-2.0*bottomTop;projectionMatrix[6]=0.0;projectionMatrix[7]=0.0;projectionMatrix[8]=0.0;projectionMatrix[9]=0.0;projectionMatrix[10]=2.0*nearFar;projectionMatrix[11]=0.0;projectionMatrix[12]=(left+right)*leftRight;projectionMatrix[13]=(top+bottom)*bottomTop;projectionMatrix[14]=(far+near)*nearFar;projectionMatrix[15]=1.0;this.projectionMatrixDirty=true;return this},projPersp:function(fovY,aspectRatio,near,far){var projectionMatrix=this.projectionMatrix;var fov=1.0/Math.tan(fovY/2.0);var nearFar=1.0/(near-far);projectionMatrix[0]=fov/aspectRatio;projectionMatrix[1]=0.0;projectionMatrix[2]=0.0;projectionMatrix[3]=0.0;projectionMatrix[4]=0.0;projectionMatrix[5]=fov;projectionMatrix[6]=0.0;projectionMatrix[7]=0.0;projectionMatrix[8]=0.0;projectionMatrix[9]=0.0;projectionMatrix[10]=(far+near)*nearFar;projectionMatrix[11]=-1.0;projectionMatrix[12]=0.0;projectionMatrix[13]=0.0;projectionMatrix[14]=(2.0*far*near)*nearFar;projectionMatrix[15]=0.0;this.projectionMatrixDirty=true;return this}};module.exports=ModelViewProjection}),(function(module,exports,__webpack_require__){var Sleeping={};module.exports=Sleeping;var Events=__webpack_require__(240);(function(){Sleeping._motionWakeThreshold=0.18;Sleeping._motionSleepThreshold=0.08;Sleeping._minBias=0.9;Sleeping.update=function(bodies,timeScale){var timeFactor=timeScale*timeScale*timeScale;for(var i=0;i<bodies.length;i++){var body=bodies[i],motion=body.speed*body.speed+body.angularSpeed*body.angularSpeed;if(body.force.x!==0||body.force.y!==0){Sleeping.set(body,false);continue}var minMotion=Math.min(body.motion,motion),maxMotion=Math.max(body.motion,motion);body.motion=Sleeping._minBias*minMotion+(1-Sleeping._minBias)*maxMotion;if(body.sleepThreshold>0&&body.motion<Sleeping._motionSleepThreshold*timeFactor){body.sleepCounter+=1;if(body.sleepCounter>=body.sleepThreshold)Sleeping.set(body,true)}else if(body.sleepCounter>0){body.sleepCounter-=1}}};Sleeping.afterCollisions=function(pairs,timeScale){var timeFactor=timeScale*timeScale*timeScale;for(var i=0;i<pairs.length;i++){var pair=pairs[i];if(!pair.isActive)continue;var collision=pair.collision,bodyA=collision.bodyA.parent,bodyB=collision.bodyB.parent;if((bodyA.isSleeping&&bodyB.isSleeping)||bodyA.isStatic||bodyB.isStatic)continue;if(bodyA.isSleeping||bodyB.isSleeping){var sleepingBody=(bodyA.isSleeping&&!bodyA.isStatic)?bodyA:bodyB,movingBody=sleepingBody===bodyA?bodyB:bodyA;if(!sleepingBody.isStatic&&movingBody.motion>Sleeping._motionWakeThreshold*timeFactor){Sleeping.set(sleepingBody,false)}}}};Sleeping.set=function(body,isSleeping){var wasSleeping=body.isSleeping;if(isSleeping){body.isSleeping=true;body.sleepCounter=body.sleepThreshold;body.positionImpulse.x=0;body.positionImpulse.y=0;body.positionPrev.x=body.position.x;body.positionPrev.y=body.position.y;body.anglePrev=body.angle;body.speed=0;body.angularSpeed=0;body.motion=0;if(!wasSleeping){Events.trigger(body,'sleepStart')}}else{body.isSleeping=false;body.sleepCounter=0;if(wasSleeping){Events.trigger(body,'sleepEnd')}}}})()}),(function(module,exports,__webpack_require__){var Events={};module.exports=Events;var Common=__webpack_require__(42);(function(){Events.on=function(object,eventNames,callback){var names=eventNames.split(' '),name;for(var i=0;i<names.length;i++){name=names[i];object.events=object.events||{};object.events[name]=object.events[name]||[];object.events[name].push(callback)}return callback};Events.off=function(object,eventNames,callback){if(!eventNames){object.events={};return}if(typeof eventNames==='function'){callback=eventNames;eventNames=Common.keys(object.events).join(' ')}var names=eventNames.split(' ');for(var i=0;i<names.length;i++){var callbacks=object.events[names[i]],newCallbacks=[];if(callback&&callbacks){for(var j=0;j<callbacks.length;j++){if(callbacks[j]!==callback)newCallbacks.push(callbacks[j])}}object.events[names[i]]=newCallbacks}};Events.trigger=function(object,eventNames,event){var names,name,callbacks,eventClone;var events=object.events;if(events&&Common.keys(events).length>0){if(!event)event={};names=eventNames.split(' ');for(var i=0;i<names.length;i++){name=names[i];callbacks=events[name];if(callbacks){eventClone=Common.clone(event,false);eventClone.name=name;eventClone.source=object;for(var j=0;j<callbacks.length;j++){callbacks[j].apply(object,[eventClone])}}}}}})()}),(function(module,exports,__webpack_require__){module.exports={AlignTo:__webpack_require__(527),Angle:__webpack_require__(528),Call:__webpack_require__(529),GetFirst:__webpack_require__(530),GetLast:__webpack_require__(531),GridAlign:__webpack_require__(532),IncAlpha:__webpack_require__(593),IncX:__webpack_require__(594),IncXY:__webpack_require__(595),IncY:__webpack_require__(596),PlaceOnCircle:__webpack_require__(597),PlaceOnEllipse:__webpack_require__(598),PlaceOnLine:__webpack_require__(599),PlaceOnRectangle:__webpack_require__(600),PlaceOnTriangle:__webpack_require__(601),PlayAnimation:__webpack_require__(602),PropertyValueInc:__webpack_require__(38),PropertyValueSet:__webpack_require__(25),RandomCircle:__webpack_require__(603),RandomEllipse:__webpack_require__(604),RandomLine:__webpack_require__(605),RandomRectangle:__webpack_require__(606),RandomTriangle:__webpack_require__(607),Rotate:__webpack_require__(608),RotateAround:__webpack_require__(609),RotateAroundDistance:__webpack_require__(610),ScaleX:__webpack_require__(611),ScaleXY:__webpack_require__(612),ScaleY:__webpack_require__(613),SetAlpha:__webpack_require__(614),SetBlendMode:__webpack_require__(615),SetDepth:__webpack_require__(616),SetHitArea:__webpack_require__(617),SetOrigin:__webpack_require__(618),SetRotation:__webpack_require__(619),SetScale:__webpack_require__(620),SetScaleX:__webpack_require__(621),SetScaleY:__webpack_require__(622),SetScrollFactor:__webpack_require__(623),SetScrollFactorX:__webpack_require__(624),SetScrollFactorY:__webpack_require__(625),SetTint:__webpack_require__(626),SetVisible:__webpack_require__(627),SetX:__webpack_require__(628),SetXY:__webpack_require__(629),SetY:__webpack_require__(630),ShiftPosition:__webpack_require__(631),Shuffle:__webpack_require__(632),SmootherStep:__webpack_require__(633),SmoothStep:__webpack_require__(634),Spread:__webpack_require__(635),ToggleVisible:__webpack_require__(636),WrapInRectangle:__webpack_require__(637)}}),(function(module,exports,__webpack_require__){var ALIGN_CONST=__webpack_require__(105);var AlignToMap=[];AlignToMap[ALIGN_CONST.BOTTOM_CENTER]=__webpack_require__(243);AlignToMap[ALIGN_CONST.BOTTOM_LEFT]=__webpack_require__(244);AlignToMap[ALIGN_CONST.BOTTOM_RIGHT]=__webpack_require__(245);AlignToMap[ALIGN_CONST.LEFT_BOTTOM]=__webpack_require__(246);AlignToMap[ALIGN_CONST.LEFT_CENTER]=__webpack_require__(247);AlignToMap[ALIGN_CONST.LEFT_TOP]=__webpack_require__(248);AlignToMap[ALIGN_CONST.RIGHT_BOTTOM]=__webpack_require__(249);AlignToMap[ALIGN_CONST.RIGHT_CENTER]=__webpack_require__(250);AlignToMap[ALIGN_CONST.RIGHT_TOP]=__webpack_require__(251);AlignToMap[ALIGN_CONST.TOP_CENTER]=__webpack_require__(252);AlignToMap[ALIGN_CONST.TOP_LEFT]=__webpack_require__(253);AlignToMap[ALIGN_CONST.TOP_RIGHT]=__webpack_require__(254);var QuickSet=function(child,alignTo,position,offsetX,offsetY){return AlignToMap[position](child,alignTo,offsetX,offsetY)};module.exports=QuickSet}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetCenterX=__webpack_require__(76);var SetCenterX=__webpack_require__(77);var SetTop=__webpack_require__(43);var BottomCenter=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetCenterX(gameObject,GetCenterX(alignTo)+offsetX);SetTop(gameObject,GetBottom(alignTo)+offsetY);return gameObject};module.exports=BottomCenter}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetLeft=__webpack_require__(35);var SetLeft=__webpack_require__(44);var SetTop=__webpack_require__(43);var BottomLeft=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetLeft(alignTo)-offsetX);SetTop(gameObject,GetBottom(alignTo)+offsetY);return gameObject};module.exports=BottomLeft}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetRight=__webpack_require__(36);var SetRight=__webpack_require__(45);var SetTop=__webpack_require__(43);var BottomRight=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetRight(alignTo)+offsetX);SetTop(gameObject,GetBottom(alignTo)+offsetY);return gameObject};module.exports=BottomRight}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetLeft=__webpack_require__(35);var SetBottom=__webpack_require__(46);var SetRight=__webpack_require__(45);var LeftBottom=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetLeft(alignTo)-offsetX);SetBottom(gameObject,GetBottom(alignTo)+offsetY);return gameObject};module.exports=LeftBottom}),(function(module,exports,__webpack_require__){var GetCenterY=__webpack_require__(78);var GetLeft=__webpack_require__(35);var SetCenterY=__webpack_require__(79);var SetRight=__webpack_require__(45);var LeftCenter=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetLeft(alignTo)-offsetX);SetCenterY(gameObject,GetCenterY(alignTo)+offsetY);return gameObject};module.exports=LeftCenter}),(function(module,exports,__webpack_require__){var GetLeft=__webpack_require__(35);var GetTop=__webpack_require__(37);var SetRight=__webpack_require__(45);var SetTop=__webpack_require__(43);var LeftTop=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetLeft(alignTo)-offsetX);SetTop(gameObject,GetTop(alignTo)-offsetY);return gameObject};module.exports=LeftTop}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetRight=__webpack_require__(36);var SetBottom=__webpack_require__(46);var SetLeft=__webpack_require__(44);var RightBottom=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetRight(alignTo)+offsetX);SetBottom(gameObject,GetBottom(alignTo)+offsetY);return gameObject};module.exports=RightBottom}),(function(module,exports,__webpack_require__){var GetCenterY=__webpack_require__(78);var GetRight=__webpack_require__(36);var SetCenterY=__webpack_require__(79);var SetLeft=__webpack_require__(44);var RightCenter=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetRight(alignTo)+offsetX);SetCenterY(gameObject,GetCenterY(alignTo)+offsetY);return gameObject};module.exports=RightCenter}),(function(module,exports,__webpack_require__){var GetRight=__webpack_require__(36);var GetTop=__webpack_require__(37);var SetLeft=__webpack_require__(44);var SetTop=__webpack_require__(43);var RightTop=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetRight(alignTo)+offsetX);SetTop(gameObject,GetTop(alignTo)-offsetY);return gameObject};module.exports=RightTop}),(function(module,exports,__webpack_require__){var GetCenterX=__webpack_require__(76);var GetTop=__webpack_require__(37);var SetBottom=__webpack_require__(46);var SetCenterX=__webpack_require__(77);var TopCenter=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetCenterX(gameObject,GetCenterX(alignTo)+offsetX);SetBottom(gameObject,GetTop(alignTo)-offsetY);return gameObject};module.exports=TopCenter}),(function(module,exports,__webpack_require__){var GetLeft=__webpack_require__(35);var GetTop=__webpack_require__(37);var SetBottom=__webpack_require__(46);var SetLeft=__webpack_require__(44);var TopLeft=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetLeft(alignTo)-offsetX);SetBottom(gameObject,GetTop(alignTo)-offsetY);return gameObject};module.exports=TopLeft}),(function(module,exports,__webpack_require__){var GetRight=__webpack_require__(36);var GetTop=__webpack_require__(37);var SetBottom=__webpack_require__(46);var SetRight=__webpack_require__(45);var TopRight=function(gameObject,alignTo,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetRight(alignTo)+offsetX);SetBottom(gameObject,GetTop(alignTo)-offsetY);return gameObject};module.exports=TopRight}),(function(module,exports,__webpack_require__){var ALIGN_CONST=__webpack_require__(105);var AlignInMap=[];AlignInMap[ALIGN_CONST.BOTTOM_CENTER]=__webpack_require__(256);AlignInMap[ALIGN_CONST.BOTTOM_LEFT]=__webpack_require__(257);AlignInMap[ALIGN_CONST.BOTTOM_RIGHT]=__webpack_require__(258);AlignInMap[ALIGN_CONST.CENTER]=__webpack_require__(259);AlignInMap[ALIGN_CONST.LEFT_CENTER]=__webpack_require__(261);AlignInMap[ALIGN_CONST.RIGHT_CENTER]=__webpack_require__(262);AlignInMap[ALIGN_CONST.TOP_CENTER]=__webpack_require__(263);AlignInMap[ALIGN_CONST.TOP_LEFT]=__webpack_require__(264);AlignInMap[ALIGN_CONST.TOP_RIGHT]=__webpack_require__(265);AlignInMap[ALIGN_CONST.LEFT_BOTTOM]=AlignInMap[ALIGN_CONST.BOTTOM_LEFT];AlignInMap[ALIGN_CONST.LEFT_TOP]=AlignInMap[ALIGN_CONST.TOP_LEFT];AlignInMap[ALIGN_CONST.RIGHT_BOTTOM]=AlignInMap[ALIGN_CONST.BOTTOM_RIGHT];AlignInMap[ALIGN_CONST.RIGHT_TOP]=AlignInMap[ALIGN_CONST.TOP_RIGHT];var QuickSet=function(child,alignIn,position,offsetX,offsetY){return AlignInMap[position](child,alignIn,offsetX,offsetY)};module.exports=QuickSet}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetCenterX=__webpack_require__(76);var SetBottom=__webpack_require__(46);var SetCenterX=__webpack_require__(77);var BottomCenter=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetCenterX(gameObject,GetCenterX(alignIn)+offsetX);SetBottom(gameObject,GetBottom(alignIn)+offsetY);return gameObject};module.exports=BottomCenter}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetLeft=__webpack_require__(35);var SetBottom=__webpack_require__(46);var SetLeft=__webpack_require__(44);var BottomLeft=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetLeft(alignIn)-offsetX);SetBottom(gameObject,GetBottom(alignIn)+offsetY);return gameObject};module.exports=BottomLeft}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetRight=__webpack_require__(36);var SetBottom=__webpack_require__(46);var SetRight=__webpack_require__(45);var BottomRight=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetRight(alignIn)+offsetX);SetBottom(gameObject,GetBottom(alignIn)+offsetY);return gameObject};module.exports=BottomRight}),(function(module,exports,__webpack_require__){var CenterOn=__webpack_require__(260);var GetCenterX=__webpack_require__(76);var GetCenterY=__webpack_require__(78);var Center=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}CenterOn(gameObject,GetCenterX(alignIn)+offsetX,GetCenterY(alignIn)+offsetY);return gameObject};module.exports=Center}),(function(module,exports,__webpack_require__){var SetCenterX=__webpack_require__(77);var SetCenterY=__webpack_require__(79);var CenterOn=function(gameObject,x,y){SetCenterX(gameObject,x);return SetCenterY(gameObject,y)};module.exports=CenterOn}),(function(module,exports,__webpack_require__){var GetCenterY=__webpack_require__(78);var GetLeft=__webpack_require__(35);var SetCenterY=__webpack_require__(79);var SetLeft=__webpack_require__(44);var LeftCenter=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetLeft(alignIn)-offsetX);SetCenterY(gameObject,GetCenterY(alignIn)+offsetY);return gameObject};module.exports=LeftCenter}),(function(module,exports,__webpack_require__){var GetCenterY=__webpack_require__(78);var GetRight=__webpack_require__(36);var SetCenterY=__webpack_require__(79);var SetRight=__webpack_require__(45);var RightCenter=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetRight(alignIn)+offsetX);SetCenterY(gameObject,GetCenterY(alignIn)+offsetY);return gameObject};module.exports=RightCenter}),(function(module,exports,__webpack_require__){var GetCenterX=__webpack_require__(76);var GetTop=__webpack_require__(37);var SetCenterX=__webpack_require__(77);var SetTop=__webpack_require__(43);var TopCenter=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetCenterX(gameObject,GetCenterX(alignIn)+offsetX);SetTop(gameObject,GetTop(alignIn)-offsetY);return gameObject};module.exports=TopCenter}),(function(module,exports,__webpack_require__){var GetLeft=__webpack_require__(35);var GetTop=__webpack_require__(37);var SetLeft=__webpack_require__(44);var SetTop=__webpack_require__(43);var TopLeft=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetLeft(gameObject,GetLeft(alignIn)-offsetX);SetTop(gameObject,GetTop(alignIn)-offsetY);return gameObject};module.exports=TopLeft}),(function(module,exports,__webpack_require__){var GetRight=__webpack_require__(36);var GetTop=__webpack_require__(37);var SetRight=__webpack_require__(45);var SetTop=__webpack_require__(43);var TopRight=function(gameObject,alignIn,offsetX,offsetY){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}SetRight(gameObject,GetRight(alignIn)+offsetX);SetTop(gameObject,GetTop(alignIn)-offsetY);return gameObject};module.exports=TopRight}),(function(module,exports,__webpack_require__){var CircumferencePoint=__webpack_require__(149);var FromPercent=__webpack_require__(87);var MATH_CONST=__webpack_require__(13);var Point=__webpack_require__(4);var GetPoint=function(circle,position,out){if(out===undefined){out=new Point()}var angle=FromPercent(position,0,MATH_CONST.PI2);return CircumferencePoint(circle,angle,out)};module.exports=GetPoint}),(function(module,exports,__webpack_require__){var Circumference=__webpack_require__(268);var CircumferencePoint=__webpack_require__(149);var FromPercent=__webpack_require__(87);var MATH_CONST=__webpack_require__(13);var GetPoints=function(circle,quantity,stepRate,out){if(out===undefined){out=[]}if(!quantity&&stepRate>0){quantity=Circumference(circle)/stepRate}for(var i=0;i<quantity;i++){var angle=FromPercent(i/quantity,0,MATH_CONST.PI2);out.push(CircumferencePoint(circle,angle))}return out};module.exports=GetPoints}),(function(module,exports){var Circumference=function(circle){return 2*(Math.PI*circle.radius)};module.exports=Circumference}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var _FLAG=2;var AlphaSingle={_alpha:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(value){if(value===undefined){value=1}this.alpha=value;return this},alpha:{get:function(){return this._alpha},set:function(value){var v=Clamp(value,0,1);this._alpha=v;if(v===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}}}};module.exports=AlphaSingle}),(function(module,exports){var FindClosestInSorted=function(value,array,key){if(!array.length){return NaN}else if(array.length===1){return array[0]}var i=1;var low;var high;if(key){if(value<array[0][key]){return array[0]}while(array[i][key]<value){i++}}else{while(array[i]<value){i++}}if(i>array.length){i=array.length}if(key){low=array[i-1][key];high=array[i][key];return((high-value)<=(value-low))?array[i]:array[i-1]}else{low=array[i-1];high=array[i];return((high-value)<=(value-low))?high:low}};module.exports=FindClosestInSorted}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var AnimationFrame=new Class({initialize:function AnimationFrame(textureKey,textureFrame,index,frame){this.textureKey=textureKey;this.textureFrame=textureFrame;this.index=index;this.frame=frame;this.isFirst=false;this.isLast=false;this.prevFrame=null;this.nextFrame=null;this.duration=0;this.progress=0},toJSON:function(){return{key:this.textureKey,frame:this.textureFrame,duration:this.duration}},destroy:function(){this.frame=undefined}});module.exports=AnimationFrame}),(function(module,exports,__webpack_require__){var BlendModes=__webpack_require__(52);var BlendMode={_blendMode:BlendModes.NORMAL,blendMode:{get:function(){return this._blendMode},set:function(value){if(typeof value==='string'){value=BlendModes[value]}value|=0;if(value>=-1){this._blendMode=value}}},setBlendMode:function(value){this.blendMode=value;return this}};module.exports=BlendMode}),(function(module,exports){var Depth={_depth:0,depth:{get:function(){return this._depth},set:function(value){this.scene.sys.queueDepthSort();this._depth=value}},setDepth:function(value){if(value===undefined){value=0}this.depth=value;return this}};module.exports=Depth}),(function(module,exports,__webpack_require__){var GetPoint=__webpack_require__(152);var Perimeter=__webpack_require__(112);var GetPoints=function(rectangle,quantity,stepRate,out){if(out===undefined){out=[]}if(!quantity&&stepRate>0){quantity=Perimeter(rectangle)/stepRate}for(var i=0;i<quantity;i++){var position=i/quantity;out.push(GetPoint(rectangle,position))}return out};module.exports=GetPoints}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetPoint=function(line,position,out){if(out===undefined){out=new Point()}out.x=line.x1+(line.x2-line.x1)*position;out.y=line.y1+(line.y2-line.y1)*position;return out};module.exports=GetPoint}),(function(module,exports){var RotateAround=function(point,x,y,angle){var c=Math.cos(angle);var s=Math.sin(angle);var tx=point.x-x;var ty=point.y-y;point.x=tx*c-ty*s+x;point.y=tx*s+ty*c+y;return point};module.exports=RotateAround}),(function(module,exports,__webpack_require__){var BitmapMask=__webpack_require__(278);var GeometryMask=__webpack_require__(279);var Mask={mask:null,setMask:function(mask){this.mask=mask;return this},clearMask:function(destroyMask){if(destroyMask===undefined){destroyMask=false}if(destroyMask&&this.mask){this.mask.destroy()}this.mask=null;return this},createBitmapMask:function(renderable){if(renderable===undefined&&(this.texture||this.shader)){renderable=this}return new BitmapMask(this.scene,renderable)},createGeometryMask:function(graphics){if(graphics===undefined&&this.type==='Graphics'){graphics=this}return new GeometryMask(this.scene,graphics)}};module.exports=Mask}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GameEvents=__webpack_require__(20);var BitmapMask=new Class({initialize:function BitmapMask(scene,renderable){var renderer=scene.sys.game.renderer;this.renderer=renderer;this.bitmapMask=renderable;this.maskTexture=null;this.mainTexture=null;this.dirty=true;this.mainFramebuffer=null;this.maskFramebuffer=null;this.prevFramebuffer=null;this.invertAlpha=false;this.isStencil=false;if(renderer&&renderer.gl){var width=renderer.width;var height=renderer.height;var pot=((width&(width-1))===0&&(height&(height-1))===0);var gl=renderer.gl;var wrap=pot?gl.REPEAT:gl.CLAMP_TO_EDGE;var filter=gl.LINEAR;this.mainTexture=renderer.createTexture2D(0,filter,filter,wrap,wrap,gl.RGBA,null,width,height);this.maskTexture=renderer.createTexture2D(0,filter,filter,wrap,wrap,gl.RGBA,null,width,height);this.mainFramebuffer=renderer.createFramebuffer(width,height,this.mainTexture,true);this.maskFramebuffer=renderer.createFramebuffer(width,height,this.maskTexture,true);scene.sys.game.events.on(GameEvents.CONTEXT_RESTORED,function(renderer){var width=renderer.width;var height=renderer.height;var pot=((width&(width-1))===0&&(height&(height-1))===0);var gl=renderer.gl;var wrap=pot?gl.REPEAT:gl.CLAMP_TO_EDGE;var filter=gl.LINEAR;this.mainTexture=renderer.createTexture2D(0,filter,filter,wrap,wrap,gl.RGBA,null,width,height);this.maskTexture=renderer.createTexture2D(0,filter,filter,wrap,wrap,gl.RGBA,null,width,height);this.mainFramebuffer=renderer.createFramebuffer(width,height,this.mainTexture,true);this.maskFramebuffer=renderer.createFramebuffer(width,height,this.maskTexture,true)},this)}},setBitmap:function(renderable){this.bitmapMask=renderable},preRenderWebGL:function(renderer,maskedObject,camera){renderer.pipelines.BitmapMaskPipeline.beginMask(this,maskedObject,camera)},postRenderWebGL:function(renderer,camera){renderer.pipelines.BitmapMaskPipeline.endMask(this,camera)},preRenderCanvas:function(){},postRenderCanvas:function(){},destroy:function(){this.bitmapMask=null;var renderer=this.renderer;if(renderer&&renderer.gl){renderer.deleteTexture(this.mainTexture);renderer.deleteTexture(this.maskTexture);renderer.deleteFramebuffer(this.mainFramebuffer);renderer.deleteFramebuffer(this.maskFramebuffer)}this.mainTexture=null;this.maskTexture=null;this.mainFramebuffer=null;this.maskFramebuffer=null;this.prevFramebuffer=null;this.renderer=null}});module.exports=BitmapMask}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GeometryMask=new Class({initialize:function GeometryMask(scene,graphicsGeometry){this.geometryMask=graphicsGeometry;this.invertAlpha=false;this.isStencil=true;this.level=0},setShape:function(graphicsGeometry){this.geometryMask=graphicsGeometry;return this},setInvertAlpha:function(value){if(value===undefined){value=true}this.invertAlpha=value;return this},preRenderWebGL:function(renderer,child,camera){var gl=renderer.gl;renderer.flush();if(renderer.maskStack.length===0){gl.enable(gl.STENCIL_TEST);gl.clear(gl.STENCIL_BUFFER_BIT);renderer.maskCount=0}if(renderer.currentCameraMask.mask!==this){renderer.currentMask.mask=this}renderer.maskStack.push({mask:this,camera:camera});this.applyStencil(renderer,camera,true);renderer.maskCount++},applyStencil:function(renderer,camera,inc){var gl=renderer.gl;var geometryMask=this.geometryMask;var level=renderer.maskCount;gl.colorMask(false,false,false,false);if(inc){gl.stencilFunc(gl.EQUAL,level,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)}else{gl.stencilFunc(gl.EQUAL,level+1,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)}geometryMask.renderWebGL(renderer,geometryMask,0,camera);renderer.flush();gl.colorMask(true,true,true,true);gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP);if(inc){if(this.invertAlpha){gl.stencilFunc(gl.NOTEQUAL,level+1,0xFF)}else{gl.stencilFunc(gl.EQUAL,level+1,0xFF)}}else if(this.invertAlpha){gl.stencilFunc(gl.NOTEQUAL,level,0xFF)}else{gl.stencilFunc(gl.EQUAL,level,0xFF)}},postRenderWebGL:function(renderer){var gl=renderer.gl;renderer.maskStack.pop();renderer.maskCount--;if(renderer.maskStack.length===0){renderer.flush();renderer.currentMask.mask=null;gl.disable(gl.STENCIL_TEST)}else{renderer.flush();var prev=renderer.maskStack[renderer.maskStack.length-1];prev.mask.applyStencil(renderer,prev.camera,false);if(renderer.currentCameraMask.mask!==prev.mask){renderer.currentMask.mask=prev.mask;renderer.currentMask.camera=prev.camera}else{renderer.currentMask.mask=null}}},preRenderCanvas:function(renderer,mask,camera){var geometryMask=this.geometryMask;renderer.currentContext.save();geometryMask.renderCanvas(renderer,geometryMask,0,camera,null,null,true);renderer.currentContext.clip()},postRenderCanvas:function(renderer){renderer.currentContext.restore()},destroy:function(){this.geometryMask=null}});module.exports=GeometryMask}),(function(module,exports){var ScrollFactor={scrollFactorX:1,scrollFactorY:1,setScrollFactor:function(x,y){if(y===undefined){y=x}this.scrollFactorX=x;this.scrollFactorY=y;return this}};module.exports=ScrollFactor}),(function(module,exports){var ToJSON=function(gameObject){var out={name:gameObject.name,type:gameObject.type,x:gameObject.x,y:gameObject.y,depth:gameObject.depth,scale:{x:gameObject.scaleX,y:gameObject.scaleY},origin:{x:gameObject.originX,y:gameObject.originY},flipX:gameObject.flipX,flipY:gameObject.flipY,rotation:gameObject.rotation,alpha:gameObject.alpha,visible:gameObject.visible,blendMode:gameObject.blendMode,textureKey:'',frameKey:'',data:{}};if(gameObject.texture){out.textureKey=gameObject.texture.key;out.frameKey=gameObject.frame.name}return out};module.exports=ToJSON}),(function(module,exports,__webpack_require__){var MATH_CONST=__webpack_require__(13);var TransformMatrix=__webpack_require__(29);var WrapAngle=__webpack_require__(235);var WrapAngleDegrees=__webpack_require__(236);var _FLAG=4;var Transform={_scaleX:1,_scaleY:1,_rotation:0,x:0,y:0,z:0,w:0,scale:{get:function(){return(this._scaleX+this._scaleY)/2},set:function(value){this._scaleX=value;this._scaleY=value;if(value===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}}},scaleX:{get:function(){return this._scaleX},set:function(value){this._scaleX=value;if(value===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}}},scaleY:{get:function(){return this._scaleY},set:function(value){this._scaleY=value;if(value===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}}},angle:{get:function(){return WrapAngleDegrees(this._rotation*MATH_CONST.RAD_TO_DEG)},set:function(value){this.rotation=WrapAngleDegrees(value)*MATH_CONST.DEG_TO_RAD}},rotation:{get:function(){return this._rotation},set:function(value){this._rotation=WrapAngle(value)}},setPosition:function(x,y,z,w){if(x===undefined){x=0}if(y===undefined){y=x}if(z===undefined){z=0}if(w===undefined){w=0}this.x=x;this.y=y;this.z=z;this.w=w;return this},setRandomPosition:function(x,y,width,height){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.scene.sys.scale.width}if(height===undefined){height=this.scene.sys.scale.height}this.x=x+(Math.random()*width);this.y=y+(Math.random()*height);return this},setRotation:function(radians){if(radians===undefined){radians=0}this.rotation=radians;return this},setAngle:function(degrees){if(degrees===undefined){degrees=0}this.angle=degrees;return this},setScale:function(x,y){if(x===undefined){x=1}if(y===undefined){y=x}this.scaleX=x;this.scaleY=y;return this},setX:function(value){if(value===undefined){value=0}this.x=value;return this},setY:function(value){if(value===undefined){value=0}this.y=value;return this},setZ:function(value){if(value===undefined){value=0}this.z=value;return this},setW:function(value){if(value===undefined){value=0}this.w=value;return this},getLocalTransformMatrix:function(tempMatrix){if(tempMatrix===undefined){tempMatrix=new TransformMatrix()}return tempMatrix.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY)},getWorldTransformMatrix:function(tempMatrix,parentMatrix){if(tempMatrix===undefined){tempMatrix=new TransformMatrix()}if(parentMatrix===undefined){parentMatrix=new TransformMatrix()}var parent=this.parentContainer;if(!parent){return this.getLocalTransformMatrix(tempMatrix)}tempMatrix.applyITRS(this.x,this.y,this._rotation,this._scaleX,this._scaleY);while(parent){parentMatrix.applyITRS(parent.x,parent.y,parent._rotation,parent._scaleX,parent._scaleY);parentMatrix.multiply(tempMatrix,tempMatrix);parent=parent.parentContainer}return tempMatrix},getParentRotation:function(){var rotation=0;var parent=this.parentContainer;while(parent){rotation+=parent.rotation;parent=parent.parentContainer}return rotation}};module.exports=Transform}),(function(module,exports){var _FLAG=1;var Visible={_visible:true,visible:{get:function(){return this._visible},set:function(value){if(value){this._visible=true;this.renderFlags|=_FLAG}else{this._visible=false;this.renderFlags&=~_FLAG}}},setVisible:function(value){this.visible=value;return this}};module.exports=Visible}),(function(module,exports,__webpack_require__){module.exports={CHANGE_DATA:__webpack_require__(578),CHANGE_DATA_KEY:__webpack_require__(579),REMOVE_DATA:__webpack_require__(580),SET_DATA:__webpack_require__(581)}}),(function(module,exports,__webpack_require__){var Perimeter=__webpack_require__(112);var Point=__webpack_require__(4);var MarchingAnts=function(rect,step,quantity,out){if(out===undefined){out=[]}if(!step&&!quantity){return out}if(!step){step=Perimeter(rect)/quantity}else{quantity=Math.round(Perimeter(rect)/step)}var x=rect.x;var y=rect.y;var face=0;for(var i=0;i<quantity;i++){out.push(new Point(x,y));switch(face){case 0:x+=step;if(x>=rect.right){face=1;y+=(x-rect.right);x=rect.right}break;case 1:y+=step;if(y>=rect.bottom){face=2;x-=(y-rect.bottom);y=rect.bottom}break;case 2:x-=step;if(x<=rect.left){face=3;y-=(rect.left-x);x=rect.left}break;case 3:y-=step;if(y<=rect.top){face=0;y=rect.top}break}}return out};module.exports=MarchingAnts}),(function(module,exports){var RotateLeft=function(array,total){if(total===undefined){total=1}var element=null;for(var i=0;i<total;i++){element=array.shift();array.push(element)}return element};module.exports=RotateLeft}),(function(module,exports){var RotateRight=function(array,total){if(total===undefined){total=1}var element=null;for(var i=0;i<total;i++){element=array.pop();array.unshift(element)}return element};module.exports=RotateRight}),(function(module,exports){var BresenhamPoints=function(line,stepRate,results){if(stepRate===undefined){stepRate=1}if(results===undefined){results=[]}var x1=Math.round(line.x1);var y1=Math.round(line.y1);var x2=Math.round(line.x2);var y2=Math.round(line.y2);var dx=Math.abs(x2-x1);var dy=Math.abs(y2-y1);var sx=(x1<x2)?1:-1;var sy=(y1<y2)?1:-1;var err=dx-dy;results.push({x:x1,y:y1});var i=1;while(!((x1===x2)&&(y1===y2))){var e2=err<<1;if(e2>-dy){err-=dy;x1+=sx}if(e2<dx){err+=dx;y1+=sy}if(i%stepRate===0){results.push({x:x1,y:y1})}i++}return results};module.exports=BresenhamPoints}),(function(module,exports,__webpack_require__){var Animation=__webpack_require__(151);var Class=__webpack_require__(0);var CustomMap=__webpack_require__(162);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(111);var GameEvents=__webpack_require__(20);var GetValue=__webpack_require__(6);var Pad=__webpack_require__(163);var AnimationManager=new Class({Extends:EventEmitter,initialize:function AnimationManager(game){EventEmitter.call(this);this.game=game;this.textureManager=null;this.globalTimeScale=1;this.anims=new CustomMap();this.paused=false;this.name='AnimationManager';game.events.once(GameEvents.BOOT,this.boot,this)},boot:function(){this.textureManager=this.game.textures;this.game.events.once(GameEvents.DESTROY,this.destroy,this)},add:function(key,animation){if(this.anims.has(key)){console.warn('Animation key exists: '+key);return this}animation.key=key;this.anims.set(key,animation);this.emit(Events.ADD_ANIMATION,key,animation);return this},exists:function(key){return this.anims.has(key)},create:function(config){var key=config.key;var anim=false;if(key){anim=this.get(key);if(!anim){anim=new Animation(this,key,config);this.anims.set(key,anim);this.emit(Events.ADD_ANIMATION,key,anim)}}return anim},fromJSON:function(data,clearCurrentAnimations){if(clearCurrentAnimations===undefined){clearCurrentAnimations=false}if(clearCurrentAnimations){this.anims.clear()}if(typeof data==='string'){data=JSON.parse(data)}var output=[];if(data.hasOwnProperty('anims')&&Array.isArray(data.anims)){for(var i=0;i<data.anims.length;i++){output.push(this.create(data.anims[i]))}if(data.hasOwnProperty('globalTimeScale')){this.globalTimeScale=data.globalTimeScale}}else if(data.hasOwnProperty('key')&&data.type==='frame'){output.push(this.create(data))}return output},generateFrameNames:function(key,config){var prefix=GetValue(config,'prefix','');var start=GetValue(config,'start',0);var end=GetValue(config,'end',0);var suffix=GetValue(config,'suffix','');var zeroPad=GetValue(config,'zeroPad',0);var out=GetValue(config,'outputArray',[]);var frames=GetValue(config,'frames',false);var texture=this.textureManager.get(key);if(!texture){return out}var diff=(start<end)?1:-1;end+=diff;var i;var frame;if(!config){frames=texture.getFrameNames();for(i=0;i<frames.length;i++){out.push({key:key,frame:frames[i]})}}else if(Array.isArray(frames)){for(i=0;i<frames.length;i++){frame=prefix+Pad(frames[i],zeroPad,'0',1)+suffix;if(texture.has(frame)){out.push({key:key,frame:frame})}}}else{for(i=start;i!==end;i+=diff){frame=prefix+Pad(i,zeroPad,'0',1)+suffix;if(texture.has(frame)){out.push({key:key,frame:frame})}}}return out},generateFrameNumbers:function(key,config){var startFrame=GetValue(config,'start',0);var endFrame=GetValue(config,'end',-1);var firstFrame=GetValue(config,'first',false);var out=GetValue(config,'outputArray',[]);var frames=GetValue(config,'frames',false);var texture=this.textureManager.get(key);if(!texture){return out}if(firstFrame&&texture.has(firstFrame)){out.push({key:key,frame:firstFrame})}var i;if(Array.isArray(frames)){for(i=0;i<frames.length;i++){if(texture.has(frames[i])){out.push({key:key,frame:frames[i]})}}}else{if(endFrame===-1){endFrame=texture.frameTotal}var diff=(startFrame<endFrame)?1:-1;endFrame+=diff;for(i=startFrame;i!==endFrame;i+=diff){if(texture.has(i)){out.push({key:key,frame:i})}}}return out},get:function(key){return this.anims.get(key)},load:function(child,key,startFrame){var anim=this.get(key);if(anim){anim.load(child,startFrame)}else{console.warn('Missing animation: '+key)}return child},pauseAll:function(){if(!this.paused){this.paused=true;this.emit(Events.PAUSE_ALL)}return this},play:function(key,child){if(!Array.isArray(child)){child=[child]}var anim=this.get(key);if(!anim){return this}for(var i=0;i<child.length;i++){child[i].anims.play(key)}return this},remove:function(key){var anim=this.get(key);if(anim){this.emit(Events.REMOVE_ANIMATION,key,anim);this.anims.delete(key)}return anim},resumeAll:function(){if(this.paused){this.paused=false;this.emit(Events.RESUME_ALL)}return this},staggerPlay:function(key,children,stagger){if(stagger===undefined){stagger=0}if(!Array.isArray(children)){children=[children]}var anim=this.get(key);if(!anim){return this}for(var i=0;i<children.length;i++){children[i].anims.delayedPlay(stagger*i,key)}return this},toJSON:function(key){var output={anims:[],globalTimeScale:this.globalTimeScale};if(key!==undefined&&key!==''){output.anims.push(this.anims.get(key).toJSON())}else{this.anims.each(function(animationKey,animation){output.anims.push(animation.toJSON())})}return output},destroy:function(){this.anims.clear();this.textureManager=null;this.game=null}});module.exports=AnimationManager}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CustomMap=__webpack_require__(162);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(291);var BaseCache=new Class({initialize:function BaseCache(){this.entries=new CustomMap();this.events=new EventEmitter()},add:function(key,data){this.entries.set(key,data);this.events.emit(Events.ADD,this,key,data);return this},has:function(key){return this.entries.has(key)},exists:function(key){return this.entries.has(key)},get:function(key){return this.entries.get(key)},remove:function(key){var entry=this.get(key);if(entry){this.entries.delete(key);this.events.emit(Events.REMOVE,this,key,entry.data)}return this},getKeys:function(){return this.entries.keys()},destroy:function(){this.entries.clear();this.events.removeAllListeners();this.entries=null;this.events=null}});module.exports=BaseCache}),(function(module,exports,__webpack_require__){module.exports={ADD:__webpack_require__(640),REMOVE:__webpack_require__(641)}}),(function(module,exports,__webpack_require__){var BaseCache=__webpack_require__(290);var Class=__webpack_require__(0);var GameEvents=__webpack_require__(20);var CacheManager=new Class({initialize:function CacheManager(game){this.game=game;this.binary=new BaseCache();this.bitmapFont=new BaseCache();this.json=new BaseCache();this.physics=new BaseCache();this.shader=new BaseCache();this.audio=new BaseCache();this.video=new BaseCache();this.text=new BaseCache();this.html=new BaseCache();this.obj=new BaseCache();this.tilemap=new BaseCache();this.xml=new BaseCache();this.custom={};this.game.events.once(GameEvents.DESTROY,this.destroy,this)},addCustom:function(key){if(!this.custom.hasOwnProperty(key)){this.custom[key]=new BaseCache()}return this.custom[key]},destroy:function(){var keys=['binary','bitmapFont','json','physics','shader','audio','video','text','html','obj','tilemap','xml'];for(var i=0;i<keys.length;i++){this[keys[i]].destroy();this[keys[i]]=null}for(var key in this.custom){this.custom[key].destroy()}this.custom=null;this.game=null}});module.exports=CacheManager}),(function(module,exports,__webpack_require__){var BaseCamera=__webpack_require__(91);var CanvasPool=__webpack_require__(26);var CenterOn=__webpack_require__(168);var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var Effects=__webpack_require__(301);var Linear=__webpack_require__(116);var Rectangle=__webpack_require__(11);var Vector2=__webpack_require__(3);var Camera=new Class({Extends:BaseCamera,Mixins:[Components.Flip,Components.Tint],initialize:function Camera(x,y,width,height){BaseCamera.call(this,x,y,width,height);this.inputEnabled=true;this.fadeEffect=new Effects.Fade(this);this.flashEffect=new Effects.Flash(this);this.shakeEffect=new Effects.Shake(this);this.panEffect=new Effects.Pan(this);this.rotateToEffect=new Effects.RotateTo(this);this.zoomEffect=new Effects.Zoom(this);this.lerp=new Vector2(1,1);this.followOffset=new Vector2();this.deadzone=null;this._follow=null;this.renderToTexture=false;this.renderToGame=true;this.canvas=null;this.context=null;this.glTexture=null;this.framebuffer=null;this.pipeline=null},setRenderToTexture:function(pipeline,renderToGame){if(renderToGame===undefined){renderToGame=true}var renderer=this.scene.sys.game.renderer;if(renderer.gl){this.glTexture=renderer.createTextureFromSource(null,this.width,this.height,0);this.framebuffer=renderer.createFramebuffer(this.width,this.height,this.glTexture,false)}else{this.canvas=CanvasPool.create2D(this,this.width,this.height);this.context=this.canvas.getContext('2d')}this.renderToTexture=true;this.renderToGame=renderToGame;if(pipeline){this.setPipeline(pipeline)}return this},setPipeline:function(pipeline){if(typeof pipeline==='string'){var renderer=this.scene.sys.game.renderer;if(renderer.gl&&renderer.hasPipeline(pipeline)){this.pipeline=renderer.getPipeline(pipeline)}}else{this.pipeline=pipeline}return this},clearRenderToTexture:function(){if(!this.scene){return}var renderer=this.scene.sys.game.renderer;if(!renderer){return}if(renderer.gl){if(this.framebuffer){renderer.deleteFramebuffer(this.framebuffer)}if(this.glTexture){renderer.deleteTexture(this.glTexture)}this.framebuffer=null;this.glTexture=null;this.pipeline=null}else{CanvasPool.remove(this);this.canvas=null;this.context=null}this.renderToTexture=false;return this},setDeadzone:function(width,height){if(width===undefined){this.deadzone=null}else{if(this.deadzone){this.deadzone.width=width;this.deadzone.height=height}else{this.deadzone=new Rectangle(0,0,width,height)}if(this._follow){var originX=this.width/2;var originY=this.height/2;var fx=this._follow.x-this.followOffset.x;var fy=this._follow.y-this.followOffset.y;this.midPoint.set(fx,fy);this.scrollX=fx-originX;this.scrollY=fy-originY}CenterOn(this.deadzone,this.midPoint.x,this.midPoint.y)}return this},fadeIn:function(duration,red,green,blue,callback,context){return this.fadeEffect.start(false,duration,red,green,blue,true,callback,context)},fadeOut:function(duration,red,green,blue,callback,context){return this.fadeEffect.start(true,duration,red,green,blue,true,callback,context)},fadeFrom:function(duration,red,green,blue,force,callback,context){return this.fadeEffect.start(false,duration,red,green,blue,force,callback,context)},fade:function(duration,red,green,blue,force,callback,context){return this.fadeEffect.start(true,duration,red,green,blue,force,callback,context)},flash:function(duration,red,green,blue,force,callback,context){return this.flashEffect.start(duration,red,green,blue,force,callback,context)},shake:function(duration,intensity,force,callback,context){return this.shakeEffect.start(duration,intensity,force,callback,context)},pan:function(x,y,duration,ease,force,callback,context){return this.panEffect.start(x,y,duration,ease,force,callback,context)},rotateTo:function(radians,shortestPath,duration,ease,force,callback,context){return this.rotateToEffect.start(radians,shortestPath,duration,ease,force,callback,context)},zoomTo:function(zoom,duration,ease,force,callback,context){return this.zoomEffect.start(zoom,duration,ease,force,callback,context)},preRender:function(resolution){var width=this.width;var height=this.height;var halfWidth=width*0.5;var halfHeight=height*0.5;var zoom=this.zoom*resolution;var matrix=this.matrix;var originX=width*this.originX;var originY=height*this.originY;var follow=this._follow;var deadzone=this.deadzone;var sx=this.scrollX;var sy=this.scrollY;if(deadzone){CenterOn(deadzone,this.midPoint.x,this.midPoint.y)}if(follow&&!this.panEffect.isRunning){var fx=(follow.x-this.followOffset.x);var fy=(follow.y-this.followOffset.y);if(deadzone){if(fx<deadzone.x){sx=Linear(sx,sx-(deadzone.x-fx),this.lerp.x)}else if(fx>deadzone.right){sx=Linear(sx,sx+(fx-deadzone.right),this.lerp.x)}if(fy<deadzone.y){sy=Linear(sy,sy-(deadzone.y-fy),this.lerp.y)}else if(fy>deadzone.bottom){sy=Linear(sy,sy+(fy-deadzone.bottom),this.lerp.y)}}else{sx=Linear(sx,fx-originX,this.lerp.x);sy=Linear(sy,fy-originY,this.lerp.y)}}if(this.useBounds){sx=this.clampX(sx);sy=this.clampY(sy)}if(this.roundPixels){originX=Math.round(originX);originY=Math.round(originY)}this.scrollX=sx;this.scrollY=sy;var midX=sx+halfWidth;var midY=sy+halfHeight;this.midPoint.set(midX,midY);var displayWidth=width/zoom;var displayHeight=height/zoom;this.worldView.setTo(midX-(displayWidth/2),midY-(displayHeight/2),displayWidth,displayHeight);matrix.applyITRS(this.x+originX,this.y+originY,this.rotation,zoom,zoom);matrix.translate(-originX,-originY);this.shakeEffect.preRender()},setLerp:function(x,y){if(x===undefined){x=1}if(y===undefined){y=x}this.lerp.set(x,y);return this},setFollowOffset:function(x,y){if(x===undefined){x=0}if(y===undefined){y=0}this.followOffset.set(x,y);return this},startFollow:function(target,roundPixels,lerpX,lerpY,offsetX,offsetY){if(roundPixels===undefined){roundPixels=false}if(lerpX===undefined){lerpX=1}if(lerpY===undefined){lerpY=lerpX}if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=offsetX}this._follow=target;this.roundPixels=roundPixels;lerpX=Clamp(lerpX,0,1);lerpY=Clamp(lerpY,0,1);this.lerp.set(lerpX,lerpY);this.followOffset.set(offsetX,offsetY);var originX=this.width/2;var originY=this.height/2;var fx=target.x-offsetX;var fy=target.y-offsetY;this.midPoint.set(fx,fy);this.scrollX=fx-originX;this.scrollY=fy-originY;if(this.useBounds){this.scrollX=this.clampX(this.scrollX);this.scrollY=this.clampY(this.scrollY)}return this},stopFollow:function(){this._follow=null;return this},resetFX:function(){this.rotateToEffect.reset();this.panEffect.reset();this.shakeEffect.reset();this.flashEffect.reset();this.fadeEffect.reset();return this},update:function(time,delta){if(this.visible){this.rotateToEffect.update(time,delta);this.panEffect.update(time,delta);this.zoomEffect.update(time,delta);this.shakeEffect.update(time,delta);this.flashEffect.update(time,delta);this.fadeEffect.update(time,delta)}},destroy:function(){this.clearRenderToTexture();this.resetFX();BaseCamera.prototype.destroy.call(this);this._follow=null;this.deadzone=null}});module.exports=Camera}),(function(module,exports,__webpack_require__){var Color=__webpack_require__(31);var HexStringToColor=function(hex){var color=new Color();hex=hex.replace(/^(?:#|0x)?([a-f\s])([a-f\d])([a-f\s])$/i,function(m,r,g,b){return r+r+g+g+b+b});var result=(/^(?:#|0x)?([a-f\s]{2})([a-f\d]{2})([a-f\s]{2})$/i).exec(hex);if(result){var r=parseInt(result[1],16);var g=parseInt(result[2],16);var b=parseInt(result[3],16);color.setTo(r,g,b)}return color};module.exports=HexStringToColor}),(function(module,exports){var GetColor32=function(red,green,blue,alpha){return alpha<<24|red<<16|green<<8|blue};module.exports=GetColor32}),(function(module,exports){var RGBToHSV=function(r,g,b,out){if(out===undefined){out={h:0,s:0,v:0}}r/=255;g/=255;b/=255;var min=Math.min(r,g,b);var max=Math.max(r,g,b);var d=max-min;var h=0;var s=(max===0)?0:d/max;var v=max;if(max!==min){if(max===r){h=(g-b)/d+((g<b)?6:0)}else if(max===g){h=(b-r)/d+2}else if(max===b){h=(r-g)/d+4}h/=6}if(out.hasOwnProperty('_h')){out._h=h;out._s=s;out._v=v}else{out.h=h;out.s=s;out.v=v}return out};module.exports=RGBToHSV}),(function(module,exports,__webpack_require__){var Color=__webpack_require__(31);var IntegerToRGB=__webpack_require__(298);var IntegerToColor=function(input){var rgb=IntegerToRGB(input);return new Color(rgb.r,rgb.g,rgb.b,rgb.a)};module.exports=IntegerToColor}),(function(module,exports){var IntegerToRGB=function(color){if(color>16777215){return{a:color>>>24,r:color>>16&0xFF,g:color>>8&0xFF,b:color&0xFF}}else{return{a:255,r:color>>16&0xFF,g:color>>8&0xFF,b:color&0xFF}}};module.exports=IntegerToRGB}),(function(module,exports,__webpack_require__){var Color=__webpack_require__(31);var ObjectToColor=function(input){return new Color(input.r,input.g,input.b,input.a)};module.exports=ObjectToColor}),(function(module,exports,__webpack_require__){var Color=__webpack_require__(31);var RGBStringToColor=function(rgb){var color=new Color();var result=(/^rgba?\s\d*(\s+)\s*,\d*(\.+)\d*,\s*(\)+)\n*(?:,\n*(\n+(?:\n\n+)?))?\/*\/$/).exec(rgb.toLowerCase());if(result){var r=parseInt(result[1],10);var g=parseInt(result[2],10);var b=parseInt(result[3],10);var a=(result[4]!==undefined)?parseFloat(result[4]):1;color.setTo(r,g,b,a*255)}return color};module.exports=RGBStringToColor}),(function(module,exports,__webpack_require__){module.exports={Fade:__webpack_require__(664),Flash:__webpack_require__(665),Pan:__webpack_require__(666),Shake:__webpack_require__(699),RotateTo:__webpack_require__(700),Zoom:__webpack_require__(701)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(667),Out:__webpack_require__(668),InOut:__webpack_require__(669)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(670),Out:__webpack_require__(671),InOut:__webpack_require__(672)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(673),Out:__webpack_require__(674),InOut:__webpack_require__(675)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(676),Out:__webpack_require__(677),InOut:__webpack_require__(678)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(679),Out:__webpack_require__(680),InOut:__webpack_require__(681)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(682),Out:__webpack_require__(683),InOut:__webpack_require__(684)}}),(function(module,exports,__webpack_require__){module.exports=__webpack_require__(685)}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(686),Out:__webpack_require__(687),InOut:__webpack_require__(688)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(689),Out:__webpack_require__(690),InOut:__webpack_require__(691)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(692),Out:__webpack_require__(693),InOut:__webpack_require__(694)}}),(function(module,exports,__webpack_require__){module.exports={In:__webpack_require__(695),Out:__webpack_require__(696),InOut:__webpack_require__(697)}}),(function(module,exports,__webpack_require__){module.exports=__webpack_require__(698)}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(33);var Device=__webpack_require__(315);var GetFastValue=__webpack_require__(2);var GetValue=__webpack_require__(6);var IsPlainObject=__webpack_require__(7);var PhaserMath=__webpack_require__(170);var NOOP=__webpack_require__(1);var DefaultPlugins=__webpack_require__(175);var ValueToColor=__webpack_require__(164);var Config=new Class({initialize:function Config(config){if(config===undefined){config={}}var defaultBannerColor=['#ff0000','#ffff00','#00ff00','#00ffff','#000000'];var defaultBannerTextColor='#ffffff';this.width=GetValue(config,'width',1024);this.height=GetValue(config,'height',768);this.zoom=GetValue(config,'zoom',1);this.resolution=GetValue(config,'resolution',1);this.parent=GetValue(config,'parent',undefined);this.scaleMode=GetValue(config,'scaleMode',0);this.expandParent=GetValue(config,'expandParent',true);this.autoRound=GetValue(config,'autoRound',false);this.autoCenter=GetValue(config,'autoCenter',0);this.resizeInterval=GetValue(config,'resizeInterval',500);this.fullscreenTarget=GetValue(config,'fullscreenTarget',null);this.minWidth=GetValue(config,'minWidth',0);this.maxWidth=GetValue(config,'maxWidth',0);this.minHeight=GetValue(config,'minHeight',0);this.maxHeight=GetValue(config,'maxHeight',0);var scaleConfig=GetValue(config,'scale',null);if(scaleConfig){this.width=GetValue(scaleConfig,'width',this.width);this.height=GetValue(scaleConfig,'height',this.height);this.zoom=GetValue(scaleConfig,'zoom',this.zoom);this.resolution=GetValue(scaleConfig,'resolution',this.resolution);this.parent=GetValue(scaleConfig,'parent',this.parent);this.scaleMode=GetValue(scaleConfig,'mode',this.scaleMode);this.expandParent=GetValue(scaleConfig,'expandParent',this.expandParent);this.autoRound=GetValue(scaleConfig,'autoRound',this.autoRound);this.autoCenter=GetValue(scaleConfig,'autoCenter',this.autoCenter);this.resizeInterval=GetValue(scaleConfig,'resizeInterval',this.resizeInterval);this.fullscreenTarget=GetValue(scaleConfig,'fullscreenTarget',this.fullscreenTarget);this.minWidth=GetValue(scaleConfig,'min.width',this.minWidth);this.maxWidth=GetValue(scaleConfig,'max.width',this.maxWidth);this.minHeight=GetValue(scaleConfig,'min.height',this.minHeight);this.maxHeight=GetValue(scaleConfig,'max.height',this.maxHeight)}this.renderType=GetValue(config,'type',CONST.AUTO);this.canvas=GetValue(config,'canvas',null);this.context=GetValue(config,'context',null);this.canvasStyle=GetValue(config,'canvasStyle',null);this.customEnvironment=GetValue(config,'customEnvironment',false);this.sceneConfig=GetValue(config,'scene',null);this.seed=GetValue(config,'seed',[(Date.now()*Math.random()).toString()]);PhaserMath.RND=new PhaserMath.RandomDataGenerator(this.seed);this.gameTitle=GetValue(config,'title','');this.gameURL=GetValue(config,'url','https://phaser.io');this.gameVersion=GetValue(config,'version','');this.autoFocus=GetValue(config,'autoFocus',true);this.domCreateContainer=GetValue(config,'dom.createContainer',false);this.domBehindCanvas=GetValue(config,'dom.behindCanvas',false);this.inputKeyboard=GetValue(config,'input.keyboard',true);this.inputKeyboardEventTarget=GetValue(config,'input.keyboard.target',window);this.inputKeyboardCapture=GetValue(config,'input.keyboard.capture',[]);this.inputMouse=GetValue(config,'input.mouse',true);this.inputMouseEventTarget=GetValue(config,'input.mouse.target',null);this.inputMouseCapture=GetValue(config,'input.mouse.capture',true);this.inputTouch=GetValue(config,'input.touch',Device.input.touch);this.inputTouchEventTarget=GetValue(config,'input.touch.target',null);this.inputTouchCapture=GetValue(config,'input.touch.capture',true);this.inputActivePointers=GetValue(config,'input.activePointers',1);this.inputSmoothFactor=GetValue(config,'input.smoothFactor',0);this.inputWindowEvents=GetValue(config,'input.windowEvents',true);this.inputGamepad=GetValue(config,'input.gamepad',false);this.inputGamepadEventTarget=GetValue(config,'input.gamepad.target',window);this.disableContextMenu=GetValue(config,'disableContextMenu',false);this.audio=GetValue(config,'audio');this.hideBanner=(GetValue(config,'banner',null)===false);this.hidePhaser=GetValue(config,'banner.hidePhaser',false);this.bannerTextColor=GetValue(config,'banner.text',defaultBannerTextColor);this.bannerBackgroundColor=GetValue(config,'banner.background',defaultBannerColor);if(this.gameTitle===''&&this.hidePhaser){this.hideBanner=true}this.fps=GetValue(config,'fps',null);var renderConfig=GetValue(config,'render',config);this.antialias=GetValue(renderConfig,'antialias',true);this.antialiasGL=GetValue(renderConfig,'antialiasGL',true);this.mipmapFilter=GetValue(renderConfig,'mipmapFilter','LINEAR');this.desynchronized=GetValue(renderConfig,'desynchronized',false);this.roundPixels=GetValue(renderConfig,'roundPixels',false);this.pixelArt=GetValue(renderConfig,'pixelArt',this.zoom!==1);if(this.pixelArt){this.antialias=false;this.roundPixels=true}this.transparent=GetValue(renderConfig,'transparent',false);this.clearBeforeRender=GetValue(renderConfig,'clearBeforeRender',true);this.premultipliedAlpha=GetValue(renderConfig,'premultipliedAlpha',true);this.failIfMajorPerformanceCaveat=GetValue(renderConfig,'failIfMajorPerformanceCaveat',false);this.powerPreference=GetValue(renderConfig,'powerPreference','default');this.batchSize=GetValue(renderConfig,'batchSize',2000);this.maxLights=GetValue(renderConfig,'maxLights',10);var bgc=GetValue(config,'backgroundColor',0);this.backgroundColor=ValueToColor(bgc);if(bgc===0&&this.transparent){this.backgroundColor.alpha=0}this.preBoot=GetValue(config,'callbacks.preBoot',NOOP);this.postBoot=GetValue(config,'callbacks.postBoot',NOOP);this.physics=GetValue(config,'physics',{});this.defaultPhysicsSystem=GetValue(this.physics,'default',false);this.loaderBaseURL=GetValue(config,'loader.baseURL','');this.loaderPath=GetValue(config,'loader.path','');this.loaderMaxParallelDownloads=GetValue(config,'loader.maxParallelDownloads',32);this.loaderCrossOrigin=GetValue(config,'loader.crossOrigin',undefined);this.loaderResponseType=GetValue(config,'loader.responseType','');this.loaderAsync=GetValue(config,'loader.async',true);this.loaderUser=GetValue(config,'loader.user','');this.loaderPassword=GetValue(config,'loader.password','');this.loaderTimeout=GetValue(config,'loader.timeout',0);this.loaderWithCredentials=GetValue(config,'loader.withCredentials',false);this.installGlobalPlugins=[];this.installScenePlugins=[];var plugins=GetValue(config,'plugins',null);var defaultPlugins=DefaultPlugins.DefaultScene;if(plugins){if(Array.isArray(plugins)){this.defaultPlugins=plugins}else if(IsPlainObject(plugins)){this.installGlobalPlugins=GetFastValue(plugins,'global',[]);this.installScenePlugins=GetFastValue(plugins,'scene',[]);if(Array.isArray(plugins.default)){defaultPlugins=plugins.default}else if(Array.isArray(plugins.defaultMerge)){defaultPlugins=defaultPlugins.concat(plugins.defaultMerge)}}}this.defaultPlugins=defaultPlugins;var pngPrefix='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAg';this.defaultImage=GetValue(config,'images.default',pngPrefix+'AQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==');this.missingImage=GetValue(config,'images.missing',pngPrefix+'CAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==');if(window){if(window.FORCE_WEBGL){this.renderType=CONST.WEBGL}else if(window.FORCE_CANVAS){this.renderType=CONST.CANVAS}}}});module.exports=Config}),(function(module,exports,__webpack_require__){module.exports={os:__webpack_require__(117),browser:__webpack_require__(118),features:__webpack_require__(169),input:__webpack_require__(730),audio:__webpack_require__(731),video:__webpack_require__(732),fullscreen:__webpack_require__(733),canvasFeatures:__webpack_require__(316)}}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var CanvasFeatures={supportInverseAlpha:false,supportNewBlendModes:false};function checkBlendMode(){var pngHead='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/';var pngEnd='AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==';var magenta=new Image();magenta.onload=function(){var yellow=new Image();yellow.onload=function(){var canvas=CanvasPool.create(yellow,6,1);var context=canvas.getContext('2d');context.globalCompositeOperation='multiply';context.drawImage(magenta,0,0);context.drawImage(yellow,2,0);if(!context.getImageData(2,0,1,1)){return false}var data=context.getImageData(2,0,1,1).data;CanvasPool.remove(yellow);CanvasFeatures.supportNewBlendModes=(data[0]===255&&data[1]===0&&data[2]===0)};yellow.src=pngHead+'/wCKxvRF'+pngEnd};magenta.src=pngHead+'AP804Oa6'+pngEnd;return false}function checkInverseAlpha(){var canvas=CanvasPool.create(this,2,1);var context=canvas.getContext('2d');context.fillStyle='rgba(10, 20, 30, 0.5)';context.fillRect(0,0,1,1);var s1=context.getImageData(0,0,1,1);if(s1===null){return false}context.putImageData(s1,1,0);var s2=context.getImageData(1,0,1,1);return(s2.data[0]===s1.data[0]&&s2.data[1]===s1.data[1]&&s2.data[2]===s1.data[2]&&s2.data[3]===s1.data[3])}function init(){if(document!==undefined){CanvasFeatures.supportNewBlendModes=checkBlendMode();CanvasFeatures.supportInverseAlpha=checkInverseAlpha()}return CanvasFeatures}module.exports=init()}),(function(module,exports){var Between=function(x1,y1,x2,y2){return Math.atan2(y2-y1,x2-x1)};module.exports=Between}),(function(module,exports){var BetweenPoints=function(point1,point2){return Math.atan2(point2.y-point1.y,point2.x-point1.x)};module.exports=BetweenPoints}),(function(module,exports){var Normalize=function(angle){angle=angle%(2*Math.PI);if(angle>=0){return angle}else{return angle+2*Math.PI}};module.exports=Normalize}),(function(module,exports){var DistanceBetweenPoints=function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return Math.sqrt(dx*dx+dy*dy)};module.exports=DistanceBetweenPoints}),(function(module,exports){var DistanceSquared=function(x1,y1,x2,y2){var dx=x1-x2;var dy=y1-y2;return dx*dx+dy*dy};module.exports=DistanceSquared}),(function(module,exports){var GreaterThan=function(a,b,epsilon){if(epsilon===undefined){epsilon=0.0001}return a>b-epsilon};module.exports=GreaterThan}),(function(module,exports){var LessThan=function(a,b,epsilon){if(epsilon===undefined){epsilon=0.0001}return a<b+epsilon};module.exports=LessThan}),(function(module,exports,__webpack_require__){var Factorial=__webpack_require__(325);var Bernstein=function(n,i){return Factorial(n)/Factorial(i)/Factorial(n-i)};module.exports=Bernstein}),(function(module,exports){var Factorial=function(value){if(value===0){return 1}var res=value;while(--value){res*=value}return res};module.exports=Factorial}),(function(module,exports){function P0(t,p){var k=1-t;return k*k*k*p}function P1(t,p){var k=1-t;return 3*k*k*t*p}function P2(t,p){return 3*(1-t)*t*t*p}function P3(t,p){return t*t*t*p}var CubicBezierInterpolation=function(t,p0,p1,p2,p3){return P0(t,p0)+P1(t,p1)+P2(t,p2)+P3(t,p3)};module.exports=CubicBezierInterpolation}),(function(module,exports){function P0(t,p){var k=1-t;return k*k*p}function P1(t,p){return 2*(1-t)*t*p}function P2(t,p){return t*t*p}var QuadraticBezierInterpolation=function(t,p0,p1,p2){return P0(t,p0)+P1(t,p1)+P2(t,p2)};module.exports=QuadraticBezierInterpolation}),(function(module,exports,__webpack_require__){var SmoothStep=__webpack_require__(161);var SmoothStepInterpolation=function(t,min,max){return min+(max-min)*SmoothStep(t,0,1)};module.exports=SmoothStepInterpolation}),(function(module,exports){var GetPowerOfTwo=function(value){var index=Math.log(value)/0.6931471805599453;return(1<<Math.ceil(index))};module.exports=GetPowerOfTwo}),(function(module,exports){var SnapCeil=function(value,gap,start,divide){if(start===undefined){start=0}if(gap===0){return value}value-=start;value=gap*Math.ceil(value/gap);return(divide)?(start+value)/gap:start+value};module.exports=SnapCeil}),(function(module,exports){var Rotate=function(point,angle){var x=point.x;var y=point.y;point.x=(x*Math.cos(angle))-(y*Math.sin(angle));point.y=(x*Math.sin(angle))+(y*Math.cos(angle));return point};module.exports=Rotate}),(function(module,exports){var RoundAwayFromZero=function(value){return(value>0)?Math.ceil(value):Math.floor(value)};module.exports=RoundAwayFromZero}),(function(module,exports,__webpack_require__){var Vector2=__webpack_require__(3);var TransformXY=function(x,y,positionX,positionY,rotation,scaleX,scaleY,output){if(output===undefined){output=new Vector2()}var radianSin=Math.sin(rotation);var radianCos=Math.cos(rotation);var a=radianCos*scaleX;var b=radianSin*scaleX;var c=-radianSin*scaleY;var d=radianCos*scaleY;var id=1/((a*d)+(c*-b));output.x=(d*id*x)+(-c*id*y)+(((positionY*c)-(positionX*d))*id);output.y=(a*id*y)+(-b*id*x)+(((-positionY*a)+(positionX*b))*id);return output};module.exports=TransformXY}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Vector4=new Class({initialize:function Vector4(x,y,z,w){this.x=0;this.y=0;this.z=0;this.w=0;if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0;this.w=x.w||0}else{this.x=x||0;this.y=y||0;this.z=z||0;this.w=w||0}},clone:function(){return new Vector4(this.x,this.y,this.z,this.w)},copy:function(src){this.x=src.x;this.y=src.y;this.z=src.z||0;this.w=src.w||0;return this},equals:function(v){return((this.x===v.x)&&(this.y===v.y)&&(this.z===v.z)&&(this.w===v.w))},set:function(x,y,z,w){if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0;this.w=x.w||0}else{this.x=x||0;this.y=y||0;this.z=z||0;this.w=w||0}return this},add:function(v){this.x+=v.x;this.y+=v.y;this.z+=v.z||0;this.w+=v.w||0;return this},subtract:function(v){this.x-=v.x;this.y-=v.y;this.z-=v.z||0;this.w-=v.w||0;return this},scale:function(scale){this.x*=scale;this.y*=scale;this.z*=scale;this.w*=scale;return this},length:function(){var x=this.x;var y=this.y;var z=this.z;var w=this.w;return Math.sqrt(x*x+y*y+z*z+w*w)},lengthSq:function(){var x=this.x;var y=this.y;var z=this.z;var w=this.w;return x*x+y*y+z*z+w*w},normalize:function(){var x=this.x;var y=this.y;var z=this.z;var w=this.w;var len=x*x+y*y+z*z+w*w;if(len>0){len=1/Math.sqrt(len);this.x=x*len;this.y=y*len;this.z=z*len;this.w=w*len}return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w},lerp:function(v,t){if(t===undefined){t=0}var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;this.x=ax+t*(v.x-ax);this.y=ay+t*(v.y-ay);this.z=az+t*(v.z-az);this.w=aw+t*(v.w-aw);return this},multiply:function(v){this.x*=v.x;this.y*=v.y;this.z*=v.z||1;this.w*=v.w||1;return this},divide:function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z||1;this.w/=v.w||1;return this},distance:function(v){var dx=v.x-this.x;var dy=v.y-this.y;var dz=v.z-this.z||0;var dw=v.w-this.w||0;return Math.sqrt(dx*dx+dy*dy+dz*dz+dw*dw)},distanceSq:function(v){var dx=v.x-this.x;var dy=v.y-this.y;var dz=v.z-this.z||0;var dw=v.w-this.w||0;return dx*dx+dy*dy+dz*dz+dw*dw},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},transformMat4:function(mat){var x=this.x;var y=this.y;var z=this.z;var w=this.w;var m=mat.val;this.x=m[0]*x+m[4]*y+m[8]*z+m[12]*w;this.y=m[1]*x+m[5]*y+m[9]*z+m[13]*w;this.z=m[2]*x+m[6]*y+m[10]*z+m[14]*w;this.w=m[3]*x+m[7]*y+m[11]*z+m[15]*w;return this},transformQuat:function(q){var x=this.x;var y=this.y;var z=this.z;var qx=q.x;var qy=q.y;var qz=q.z;var qw=q.w;var ix=qw*x+qy*z-qz*y;var iy=qw*y+qz*x-qx*z;var iz=qw*z+qx*y-qy*x;var iw=-qx*x-qy*y-qz*z;this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;return this},reset:function(){this.x=0;this.y=0;this.z=0;this.w=0;return this}});Vector4.prototype.sub=Vector4.prototype.subtract;Vector4.prototype.mul=Vector4.prototype.multiply;Vector4.prototype.div=Vector4.prototype.divide;Vector4.prototype.dist=Vector4.prototype.distance;Vector4.prototype.distSq=Vector4.prototype.distanceSq;Vector4.prototype.len=Vector4.prototype.length;Vector4.prototype.lenSq=Vector4.prototype.lengthSq;module.exports=Vector4}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Matrix3=new Class({initialize:function Matrix3(m){this.val=new Float32Array(9);if(m){this.copy(m)}else{this.identity()}},clone:function(){return new Matrix3(this)},set:function(src){return this.copy(src)},copy:function(src){var out=this.val;var a=src.val;out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];return this},fromMat4:function(m){var a=m.val;var out=this.val;out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[4];out[4]=a[5];out[5]=a[6];out[6]=a[8];out[7]=a[9];out[8]=a[10];return this},fromArray:function(a){var out=this.val;out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];return this},identity:function(){var out=this.val;out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=1;out[5]=0;out[6]=0;out[7]=0;out[8]=1;return this},transpose:function(){var a=this.val;var a01=a[1];var a02=a[2];var a12=a[5];a[1]=a[3];a[2]=a[6];a[3]=a01;a[5]=a[7];a[6]=a02;a[7]=a12;return this},invert:function(){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a10=a[3];var a11=a[4];var a12=a[5];var a20=a[6];var a21=a[7];var a22=a[8];var b01=a22*a11-a12*a21;var b11=-a22*a10+a12*a20;var b21=a21*a10-a11*a20;var det=a00*b01+a01*b11+a02*b21;if(!det){return null}det=1/det;a[0]=b01*det;a[1]=(-a22*a01+a02*a21)*det;a[2]=(a12*a01-a02*a11)*det;a[3]=b11*det;a[4]=(a22*a00-a02*a20)*det;a[5]=(-a12*a00+a02*a10)*det;a[6]=b21*det;a[7]=(-a21*a00+a01*a20)*det;a[8]=(a11*a00-a01*a10)*det;return this},adjoint:function(){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a10=a[3];var a11=a[4];var a12=a[5];var a20=a[6];var a21=a[7];var a22=a[8];a[0]=(a11*a22-a12*a21);a[1]=(a02*a21-a01*a22);a[2]=(a01*a12-a02*a11);a[3]=(a12*a20-a10*a22);a[4]=(a00*a22-a02*a20);a[5]=(a02*a10-a00*a12);a[6]=(a10*a21-a11*a20);a[7]=(a01*a20-a00*a21);a[8]=(a00*a11-a01*a10);return this},determinant:function(){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a10=a[3];var a11=a[4];var a12=a[5];var a20=a[6];var a21=a[7];var a22=a[8];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20)},multiply:function(src){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a10=a[3];var a11=a[4];var a12=a[5];var a20=a[6];var a21=a[7];var a22=a[8];var b=src.val;var b00=b[0];var b01=b[1];var b02=b[2];var b10=b[3];var b11=b[4];var b12=b[5];var b20=b[6];var b21=b[7];var b22=b[8];a[0]=b00*a00+b01*a10+b02*a20;a[1]=b00*a01+b01*a11+b02*a21;a[2]=b00*a02+b01*a12+b02*a22;a[3]=b10*a00+b11*a10+b12*a20;a[4]=b10*a01+b11*a11+b12*a21;a[5]=b10*a02+b11*a12+b12*a22;a[6]=b20*a00+b21*a10+b22*a20;a[7]=b20*a01+b21*a11+b22*a21;a[8]=b20*a02+b21*a12+b22*a22;return this},translate:function(v){var a=this.val;var x=v.x;var y=v.y;a[6]=x*a[0]+y*a[3]+a[6];a[7]=x*a[1]+y*a[4]+a[7];a[8]=x*a[2]+y*a[5]+a[8];return this},rotate:function(rad){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a10=a[3];var a11=a[4];var a12=a[5];var s=Math.sin(rad);var c=Math.cos(rad);a[0]=c*a00+s*a10;a[1]=c*a01+s*a11;a[2]=c*a02+s*a12;a[3]=c*a10-s*a00;a[4]=c*a11-s*a01;a[5]=c*a12-s*a02;return this},scale:function(v){var a=this.val;var x=v.x;var y=v.y;a[0]=x*a[0];a[1]=x*a[1];a[2]=x*a[2];a[3]=y*a[3];a[4]=y*a[4];a[5]=y*a[5];return this},fromQuat:function(q){var x=q.x;var y=q.y;var z=q.z;var w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;var out=this.val;out[0]=1-(yy+zz);out[3]=xy+wz;out[6]=xz-wy;out[1]=xy-wz;out[4]=1-(xx+zz);out[7]=yz+wx;out[2]=xz+wy;out[5]=yz-wx;out[8]=1-(xx+yy);return this},normalFromMat4:function(m){var a=m.val;var out=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];var a30=a[12];var a31=a[13];var a32=a[14];var a33=a[15];var b00=a00*a11-a01*a10;var b01=a00*a12-a02*a10;var b02=a00*a13-a03*a10;var b03=a01*a12-a02*a11;var b04=a01*a13-a03*a11;var b05=a02*a13-a03*a12;var b06=a20*a31-a21*a30;var b07=a20*a32-a22*a30;var b08=a20*a33-a23*a30;var b09=a21*a32-a22*a31;var b10=a21*a33-a23*a31;var b11=a22*a33-a23*a32;var det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;out[0]=(a11*b11-a12*b10+a13*b09)*det;out[1]=(a12*b08-a10*b11-a13*b07)*det;out[2]=(a10*b10-a11*b08+a13*b06)*det;out[3]=(a02*b10-a01*b11-a03*b09)*det;out[4]=(a00*b11-a02*b08+a03*b07)*det;out[5]=(a01*b08-a00*b10-a03*b06)*det;out[6]=(a31*b05-a32*b04+a33*b03)*det;out[7]=(a32*b02-a30*b05-a33*b01)*det;out[8]=(a30*b04-a31*b02+a33*b00)*det;return this}});module.exports=Matrix3}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EPSILON=0.000001;var Matrix4=new Class({initialize:function Matrix4(m){this.val=new Float32Array(16);if(m){this.copy(m)}else{this.identity()}},clone:function(){return new Matrix4(this)},set:function(src){return this.copy(src)},copy:function(src){var out=this.val;var a=src.val;out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return this},fromArray:function(a){var out=this.val;out[0]=a[0];out[1]=a[1];out[2]=a[2];out[3]=a[3];out[4]=a[4];out[5]=a[5];out[6]=a[6];out[7]=a[7];out[8]=a[8];out[9]=a[9];out[10]=a[10];out[11]=a[11];out[12]=a[12];out[13]=a[13];out[14]=a[14];out[15]=a[15];return this},zero:function(){var out=this.val;out[0]=0;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=0;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=0;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=0;return this},xyz:function(x,y,z){this.identity();var out=this.val;out[12]=x;out[13]=y;out[14]=z;return this},scaling:function(x,y,z){this.zero();var out=this.val;out[0]=x;out[5]=y;out[10]=z;out[15]=1;return this},identity:function(){var out=this.val;out[0]=1;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=1;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=1;out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return this},transpose:function(){var a=this.val;var a01=a[1];var a02=a[2];var a03=a[3];var a12=a[6];var a13=a[7];var a23=a[11];a[1]=a[4];a[2]=a[8];a[3]=a[12];a[4]=a01;a[6]=a[9];a[7]=a[13];a[8]=a02;a[9]=a12;a[11]=a[14];a[12]=a03;a[13]=a13;a[14]=a23;return this},invert:function(){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];var a30=a[12];var a31=a[13];var a32=a[14];var a33=a[15];var b00=a00*a11-a01*a10;var b01=a00*a12-a02*a10;var b02=a00*a13-a03*a10;var b03=a01*a12-a02*a11;var b04=a01*a13-a03*a11;var b05=a02*a13-a03*a12;var b06=a20*a31-a21*a30;var b07=a20*a32-a22*a30;var b08=a20*a33-a23*a30;var b09=a21*a32-a22*a31;var b10=a21*a33-a23*a31;var b11=a22*a33-a23*a32;var det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;if(!det){return null}det=1/det;a[0]=(a11*b11-a12*b10+a13*b09)*det;a[1]=(a02*b10-a01*b11-a03*b09)*det;a[2]=(a31*b05-a32*b04+a33*b03)*det;a[3]=(a22*b04-a21*b05-a23*b03)*det;a[4]=(a12*b08-a10*b11-a13*b07)*det;a[5]=(a00*b11-a02*b08+a03*b07)*det;a[6]=(a32*b02-a30*b05-a33*b01)*det;a[7]=(a20*b05-a22*b02+a23*b01)*det;a[8]=(a10*b10-a11*b08+a13*b06)*det;a[9]=(a01*b08-a00*b10-a03*b06)*det;a[10]=(a30*b04-a31*b02+a33*b00)*det;a[11]=(a21*b02-a20*b04-a23*b00)*det;a[12]=(a11*b07-a10*b09-a12*b06)*det;a[13]=(a00*b09-a01*b07+a02*b06)*det;a[14]=(a31*b01-a30*b03-a32*b00)*det;a[15]=(a20*b03-a21*b01+a22*b00)*det;return this},adjoint:function(){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];var a30=a[12];var a31=a[13];var a32=a[14];var a33=a[15];a[0]=(a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22));a[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22));a[2]=(a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12));a[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12));a[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22));a[5]=(a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22));a[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12));a[7]=(a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12));a[8]=(a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21));a[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21));a[10]=(a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11));a[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11));a[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21));a[13]=(a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21));a[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11));a[15]=(a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11));return this},determinant:function(){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];var a30=a[12];var a31=a[13];var a32=a[14];var a33=a[15];var b00=a00*a11-a01*a10;var b01=a00*a12-a02*a10;var b02=a00*a13-a03*a10;var b03=a01*a12-a02*a11;var b04=a01*a13-a03*a11;var b05=a02*a13-a03*a12;var b06=a20*a31-a21*a30;var b07=a20*a32-a22*a30;var b08=a20*a33-a23*a30;var b09=a21*a32-a22*a31;var b10=a21*a33-a23*a31;var b11=a22*a33-a23*a32;return b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06},multiply:function(src){var a=this.val;var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];var a30=a[12];var a31=a[13];var a32=a[14];var a33=a[15];var b=src.val;var b0=b[0];var b1=b[1];var b2=b[2];var b3=b[3];a[0]=b0*a00+b1*a10+b2*a20+b3*a30;a[1]=b0*a01+b1*a11+b2*a21+b3*a31;a[2]=b0*a02+b1*a12+b2*a22+b3*a32;a[3]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[4];b1=b[5];b2=b[6];b3=b[7];a[4]=b0*a00+b1*a10+b2*a20+b3*a30;a[5]=b0*a01+b1*a11+b2*a21+b3*a31;a[6]=b0*a02+b1*a12+b2*a22+b3*a32;a[7]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[8];b1=b[9];b2=b[10];b3=b[11];a[8]=b0*a00+b1*a10+b2*a20+b3*a30;a[9]=b0*a01+b1*a11+b2*a21+b3*a31;a[10]=b0*a02+b1*a12+b2*a22+b3*a32;a[11]=b0*a03+b1*a13+b2*a23+b3*a33;b0=b[12];b1=b[13];b2=b[14];b3=b[15];a[12]=b0*a00+b1*a10+b2*a20+b3*a30;a[13]=b0*a01+b1*a11+b2*a21+b3*a31;a[14]=b0*a02+b1*a12+b2*a22+b3*a32;a[15]=b0*a03+b1*a13+b2*a23+b3*a33;return this},multiplyLocal:function(src){var a=[];var m1=this.val;var m2=src.val;a[0]=m1[0]*m2[0]+m1[1]*m2[4]+m1[2]*m2[8]+m1[3]*m2[12];a[1]=m1[0]*m2[1]+m1[1]*m2[5]+m1[2]*m2[9]+m1[3]*m2[13];a[2]=m1[0]*m2[2]+m1[1]*m2[6]+m1[2]*m2[10]+m1[3]*m2[14];a[3]=m1[0]*m2[3]+m1[1]*m2[7]+m1[2]*m2[11]+m1[3]*m2[15];a[4]=m1[4]*m2[0]+m1[5]*m2[4]+m1[6]*m2[8]+m1[7]*m2[12];a[5]=m1[4]*m2[1]+m1[5]*m2[5]+m1[6]*m2[9]+m1[7]*m2[13];a[6]=m1[4]*m2[2]+m1[5]*m2[6]+m1[6]*m2[10]+m1[7]*m2[14];a[7]=m1[4]*m2[3]+m1[5]*m2[7]+m1[6]*m2[11]+m1[7]*m2[15];a[8]=m1[8]*m2[0]+m1[9]*m2[4]+m1[10]*m2[8]+m1[11]*m2[12];a[9]=m1[8]*m2[1]+m1[9]*m2[5]+m1[10]*m2[9]+m1[11]*m2[13];a[10]=m1[8]*m2[2]+m1[9]*m2[6]+m1[10]*m2[10]+m1[11]*m2[14];a[11]=m1[8]*m2[3]+m1[9]*m2[7]+m1[10]*m2[11]+m1[11]*m2[15];a[12]=m1[12]*m2[0]+m1[13]*m2[4]+m1[14]*m2[8]+m1[15]*m2[12];a[13]=m1[12]*m2[1]+m1[13]*m2[5]+m1[14]*m2[9]+m1[15]*m2[13];a[14]=m1[12]*m2[2]+m1[13]*m2[6]+m1[14]*m2[10]+m1[15]*m2[14];a[15]=m1[12]*m2[3]+m1[13]*m2[7]+m1[14]*m2[11]+m1[15]*m2[15];return this.fromArray(a)},translate:function(v){var x=v.x;var y=v.y;var z=v.z;var a=this.val;a[12]=a[0]*x+a[4]*y+a[8]*z+a[12];a[13]=a[1]*x+a[5]*y+a[9]*z+a[13];a[14]=a[2]*x+a[6]*y+a[10]*z+a[14];a[15]=a[3]*x+a[7]*y+a[11]*z+a[15];return this},translateXYZ:function(x,y,z){var a=this.val;a[12]=a[0]*x+a[4]*y+a[8]*z+a[12];a[13]=a[1]*x+a[5]*y+a[9]*z+a[13];a[14]=a[2]*x+a[6]*y+a[10]*z+a[14];a[15]=a[3]*x+a[7]*y+a[11]*z+a[15];return this},scale:function(v){var x=v.x;var y=v.y;var z=v.z;var a=this.val;a[0]=a[0]*x;a[1]=a[1]*x;a[2]=a[2]*x;a[3]=a[3]*x;a[4]=a[4]*y;a[5]=a[5]*y;a[6]=a[6]*y;a[7]=a[7]*y;a[8]=a[8]*z;a[9]=a[9]*z;a[10]=a[10]*z;a[11]=a[11]*z;return this},scaleXYZ:function(x,y,z){var a=this.val;a[0]=a[0]*x;a[1]=a[1]*x;a[2]=a[2]*x;a[3]=a[3]*x;a[4]=a[4]*y;a[5]=a[5]*y;a[6]=a[6]*y;a[7]=a[7]*y;a[8]=a[8]*z;a[9]=a[9]*z;a[10]=a[10]*z;a[11]=a[11]*z;return this},makeRotationAxis:function(axis,angle){var c=Math.cos(angle);var s=Math.sin(angle);var t=1-c;var x=axis.x;var y=axis.y;var z=axis.z;var tx=t*x;var ty=t*y;this.fromArray([tx*x+c,tx*y-s*z,tx*z+s*y,0,tx*y+s*z,ty*y+c,ty*z-s*x,0,tx*z-s*y,ty*z+s*x,t*z*z+c,0,0,0,0,1]);return this},rotate:function(rad,axis){var a=this.val;var x=axis.x;var y=axis.y;var z=axis.z;var len=Math.sqrt(x*x+y*y+z*z);if(Math.abs(len)<EPSILON){return null}len=1/len;x*=len;y*=len;z*=len;var s=Math.sin(rad);var c=Math.cos(rad);var t=1-c;var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];var b00=x*x*t+c;var b01=y*x*t+z*s;var b02=z*x*t-y*s;var b10=x*y*t-z*s;var b11=y*y*t+c;var b12=z*y*t+x*s;var b20=x*z*t+y*s;var b21=y*z*t-x*s;var b22=z*z*t+c;a[0]=a00*b00+a10*b01+a20*b02;a[1]=a01*b00+a11*b01+a21*b02;a[2]=a02*b00+a12*b01+a22*b02;a[3]=a03*b00+a13*b01+a23*b02;a[4]=a00*b10+a10*b11+a20*b12;a[5]=a01*b10+a11*b11+a21*b12;a[6]=a02*b10+a12*b11+a22*b12;a[7]=a03*b10+a13*b11+a23*b12;a[8]=a00*b20+a10*b21+a20*b22;a[9]=a01*b20+a11*b21+a21*b22;a[10]=a02*b20+a12*b21+a22*b22;a[11]=a03*b20+a13*b21+a23*b22;return this},rotateX:function(rad){var a=this.val;var s=Math.sin(rad);var c=Math.cos(rad);var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];a[4]=a10*c+a20*s;a[5]=a11*c+a21*s;a[6]=a12*c+a22*s;a[7]=a13*c+a23*s;a[8]=a20*c-a10*s;a[9]=a21*c-a11*s;a[10]=a22*c-a12*s;a[11]=a23*c-a13*s;return this},rotateY:function(rad){var a=this.val;var s=Math.sin(rad);var c=Math.cos(rad);var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a20=a[8];var a21=a[9];var a22=a[10];var a23=a[11];a[0]=a00*c-a20*s;a[1]=a01*c-a21*s;a[2]=a02*c-a22*s;a[3]=a03*c-a23*s;a[8]=a00*s+a20*c;a[9]=a01*s+a21*c;a[10]=a02*s+a22*c;a[11]=a03*s+a23*c;return this},rotateZ:function(rad){var a=this.val;var s=Math.sin(rad);var c=Math.cos(rad);var a00=a[0];var a01=a[1];var a02=a[2];var a03=a[3];var a10=a[4];var a11=a[5];var a12=a[6];var a13=a[7];a[0]=a00*c+a10*s;a[1]=a01*c+a11*s;a[2]=a02*c+a12*s;a[3]=a03*c+a13*s;a[4]=a10*c-a00*s;a[5]=a11*c-a01*s;a[6]=a12*c-a02*s;a[7]=a13*c-a03*s;return this},fromRotationTranslation:function(q,v){var out=this.val;var x=q.x;var y=q.y;var z=q.z;var w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;out[0]=1-(yy+zz);out[1]=xy+wz;out[2]=xz-wy;out[3]=0;out[4]=xy-wz;out[5]=1-(xx+zz);out[6]=yz+wx;out[7]=0;out[8]=xz+wy;out[9]=yz-wx;out[10]=1-(xx+yy);out[11]=0;out[12]=v.x;out[13]=v.y;out[14]=v.z;out[15]=1;return this},fromQuat:function(q){var out=this.val;var x=q.x;var y=q.y;var z=q.z;var w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;out[0]=1-(yy+zz);out[1]=xy+wz;out[2]=xz-wy;out[3]=0;out[4]=xy-wz;out[5]=1-(xx+zz);out[6]=yz+wx;out[7]=0;out[8]=xz+wy;out[9]=yz-wx;out[10]=1-(xx+yy);out[11]=0;out[12]=0;out[13]=0;out[14]=0;out[15]=1;return this},frustum:function(left,right,bottom,top,near,far){var out=this.val;var rl=1/(right-left);var tb=1/(top-bottom);var nf=1/(near-far);out[0]=(near*2)*rl;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=(near*2)*tb;out[6]=0;out[7]=0;out[8]=(right+left)*rl;out[9]=(top+bottom)*tb;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=(far*near*2)*nf;out[15]=0;return this},perspective:function(fovy,aspect,near,far){var out=this.val;var f=1.0/Math.tan(fovy/2);var nf=1/(near-far);out[0]=f/aspect;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=f;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=(far+near)*nf;out[11]=-1;out[12]=0;out[13]=0;out[14]=(2*far*near)*nf;out[15]=0;return this},perspectiveLH:function(width,height,near,far){var out=this.val;out[0]=(2*near)/width;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=(2*near)/height;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=-far/(near-far);out[11]=1;out[12]=0;out[13]=0;out[14]=(near*far)/(near-far);out[15]=0;return this},ortho:function(left,right,bottom,top,near,far){var out=this.val;var lr=left-right;var bt=bottom-top;var nf=near-far;lr=(lr===0)?lr:1/lr;bt=(bt===0)?bt:1/bt;nf=(nf===0)?nf:1/nf;out[0]=-2*lr;out[1]=0;out[2]=0;out[3]=0;out[4]=0;out[5]=-2*bt;out[6]=0;out[7]=0;out[8]=0;out[9]=0;out[10]=2*nf;out[11]=0;out[12]=(left+right)*lr;out[13]=(top+bottom)*bt;out[14]=(far+near)*nf;out[15]=1;return this},lookAt:function(eye,center,up){var out=this.val;var eyex=eye.x;var eyey=eye.y;var eyez=eye.z;var upx=up.x;var upy=up.y;var upz=up.z;var centerx=center.x;var centery=center.y;var centerz=center.z;if(Math.abs(eyex-centerx)<EPSILON&&Math.abs(eyey-centery)<EPSILON&&Math.abs(eyez-centerz)<EPSILON){return this.identity()}var z0=eyex-centerx;var z1=eyey-centery;var z2=eyez-centerz;var len=1/Math.sqrt(z0*z0+z1*z1+z2*z2);z0*=len;z1*=len;z2*=len;var x0=upy*z2-upz*z1;var x1=upz*z0-upx*z2;var x2=upx*z1-upy*z0;len=Math.sqrt(x0*x0+x1*x1+x2*x2);if(!len){x0=0;x1=0;x2=0}else{len=1/len;x0*=len;x1*=len;x2*=len}var y0=z1*x2-z2*x1;var y1=z2*x0-z0*x2;var y2=z0*x1-z1*x0;len=Math.sqrt(y0*y0+y1*y1+y2*y2);if(!len){y0=0;y1=0;y2=0}else{len=1/len;y0*=len;y1*=len;y2*=len}out[0]=x0;out[1]=y0;out[2]=z0;out[3]=0;out[4]=x1;out[5]=y1;out[6]=z1;out[7]=0;out[8]=x2;out[9]=y2;out[10]=z2;out[11]=0;out[12]=-(x0*eyex+x1*eyey+x2*eyez);out[13]=-(y0*eyex+y1*eyey+y2*eyez);out[14]=-(z0*eyex+z1*eyey+z2*eyez);out[15]=1;return this},yawPitchRoll:function(yaw,pitch,roll){this.zero();_tempMat1.zero();_tempMat2.zero();var m0=this.val;var m1=_tempMat1.val;var m2=_tempMat2.val;var s=Math.sin(roll);var c=Math.cos(roll);m0[10]=1;m0[15]=1;m0[0]=c;m0[1]=s;m0[4]=-s;m0[5]=c;s=Math.sin(pitch);c=Math.cos(pitch);m1[0]=1;m1[15]=1;m1[5]=c;m1[10]=c;m1[9]=-s;m1[6]=s;s=Math.sin(yaw);c=Math.cos(yaw);m2[5]=1;m2[15]=1;m2[0]=c;m2[2]=-s;m2[8]=s;m2[10]=c;this.multiplyLocal(_tempMat1);this.multiplyLocal(_tempMat2);return this},setWorldMatrix:function(rotation,position,scale,viewMatrix,projectionMatrix){this.yawPitchRoll(rotation.y,rotation.x,rotation.z);_tempMat1.scaling(scale.x,scale.y,scale.z);_tempMat2.xyz(position.x,position.y,position.z);this.multiplyLocal(_tempMat1);this.multiplyLocal(_tempMat2);if(viewMatrix!==undefined){this.multiplyLocal(viewMatrix)}if(projectionMatrix!==undefined){this.multiplyLocal(projectionMatrix)}return this}});var _tempMat1=new Matrix4();var _tempMat2=new Matrix4();module.exports=Matrix4}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Vector3=__webpack_require__(174);var Matrix3=__webpack_require__(335);var EPSILON=0.000001;var siNext=new Int8Array([1,2,0]);var tmp=new Float32Array([0,0,0]);var xUnitVec3=new Vector3(1,0,0);var yUnitVec3=new Vector3(0,1,0);var tmpvec=new Vector3();var tmpMat3=new Matrix3();var Quaternion=new Class({initialize:function Quaternion(x,y,z,w){if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0;this.w=x.w||0}else{this.x=x||0;this.y=y||0;this.z=z||0;this.w=w||0}},copy:function(src){this.x=src.x;this.y=src.y;this.z=src.z;this.w=src.w;return this},set:function(x,y,z,w){if(typeof x==='object'){this.x=x.x||0;this.y=x.y||0;this.z=x.z||0;this.w=x.w||0}else{this.x=x||0;this.y=y||0;this.z=z||0;this.w=w||0}return this},add:function(v){this.x+=v.x;this.y+=v.y;this.z+=v.z;this.w+=v.w;return this},subtract:function(v){this.x-=v.x;this.y-=v.y;this.z-=v.z;this.w-=v.w;return this},scale:function(scale){this.x*=scale;this.y*=scale;this.z*=scale;this.w*=scale;return this},length:function(){var x=this.x;var y=this.y;var z=this.z;var w=this.w;return Math.sqrt(x*x+y*y+z*z+w*w)},lengthSq:function(){var x=this.x;var y=this.y;var z=this.z;var w=this.w;return x*x+y*y+z*z+w*w},normalize:function(){var x=this.x;var y=this.y;var z=this.z;var w=this.w;var len=x*x+y*y+z*z+w*w;if(len>0){len=1/Math.sqrt(len);this.x=x*len;this.y=y*len;this.z=z*len;this.w=w*len}return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w},lerp:function(v,t){if(t===undefined){t=0}var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;this.x=ax+t*(v.x-ax);this.y=ay+t*(v.y-ay);this.z=az+t*(v.z-az);this.w=aw+t*(v.w-aw);return this},rotationTo:function(a,b){var dot=a.x*b.x+a.y*b.y+a.z*b.z;if(dot<-0.999999){if(tmpvec.copy(xUnitVec3).cross(a).length()<EPSILON){tmpvec.copy(yUnitVec3).cross(a)}tmpvec.normalize();return this.setAxisAngle(tmpvec,Math.PI)}else if(dot>0.999999){this.x=0;this.y=0;this.z=0;this.w=1;return this}else{tmpvec.copy(a).cross(b);this.x=tmpvec.x;this.y=tmpvec.y;this.z=tmpvec.z;this.w=1+dot;return this.normalize()}},setAxes:function(view,right,up){var m=tmpMat3.val;m[0]=right.x;m[3]=right.y;m[6]=right.z;m[1]=up.x;m[4]=up.y;m[7]=up.z;m[2]=-view.x;m[5]=-view.y;m[8]=-view.z;return this.fromMat3(tmpMat3).normalize()},identity:function(){this.x=0;this.y=0;this.z=0;this.w=1;return this},setAxisAngle:function(axis,rad){rad=rad*0.5;var s=Math.sin(rad);this.x=s*axis.x;this.y=s*axis.y;this.z=s*axis.z;this.w=Math.cos(rad);return this},multiply:function(b){var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;var bx=b.x;var by=b.y;var bz=b.z;var bw=b.w;this.x=ax*bw+aw*bx+ay*bz-az*by;this.y=ay*bw+aw*by+az*bx-ax*bz;this.z=az*bw+aw*bz+ax*by-ay*bx;this.w=aw*bw-ax*bx-ay*by-az*bz;return this},slerp:function(b,t){var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;var bx=b.x;var by=b.y;var bz=b.z;var bw=b.w;var cosom=ax*bx+ay*by+az*bz+aw*bw;if(cosom<0){cosom=-cosom;bx=-bx;by=-by;bz=-bz;bw=-bw}var scale0=1-t;var scale1=t;if((1-cosom)>EPSILON){var omega=Math.acos(cosom);var sinom=Math.sin(omega);scale0=Math.sin((1.0-t)*omega)/sinom;scale1=Math.sin(t*omega)/sinom}this.x=scale0*ax+scale1*bx;this.y=scale0*ay+scale1*by;this.z=scale0*az+scale1*bz;this.w=scale0*aw+scale1*bw;return this},invert:function(){var a0=this.x;var a1=this.y;var a2=this.z;var a3=this.w;var dot=a0*a0+a1*a1+a2*a2+a3*a3;var invDot=(dot)?1/dot:0;this.x=-a0*invDot;this.y=-a1*invDot;this.z=-a2*invDot;this.w=a3*invDot;return this},conjugate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},rotateX:function(rad){rad*=0.5;var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;var bx=Math.sin(rad);var bw=Math.cos(rad);this.x=ax*bw+aw*bx;this.y=ay*bw+az*bx;this.z=az*bw-ay*bx;this.w=aw*bw-ax*bx;return this},rotateY:function(rad){rad*=0.5;var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;var by=Math.sin(rad);var bw=Math.cos(rad);this.x=ax*bw-az*by;this.y=ay*bw+aw*by;this.z=az*bw+ax*by;this.w=aw*bw-ay*by;return this},rotateZ:function(rad){rad*=0.5;var ax=this.x;var ay=this.y;var az=this.z;var aw=this.w;var bz=Math.sin(rad);var bw=Math.cos(rad);this.x=ax*bw+ay*bz;this.y=ay*bw-ax*bz;this.z=az*bw+aw*bz;this.w=aw*bw-az*bz;return this},calculateW:function(){var x=this.x;var y=this.y;var z=this.z;this.w=-Math.sqrt(1.0-x*x-y*y-z*z);return this},fromMat3:function(mat){var m=mat.val;var fTrace=m[0]+m[4]+m[8];var fRoot;if(fTrace>0){fRoot=Math.sqrt(fTrace+1.0);this.w=0.5*fRoot;fRoot=0.5/fRoot; this.x=(m[7]-m[5])*fRoot;this.y=(m[2]-m[6])*fRoot;this.z=(m[3]-m[1])*fRoot}else{var i=0;if(m[4]>m[0]){i=1}if(m[8]>m[i*3+i]){i=2}var j=siNext[i];var k=siNext[j];fRoot=Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k]+1);tmp[i]=0.5*fRoot;fRoot=0.5/fRoot;tmp[j]=(m[j*3+i]+m[i*3+j])*fRoot;tmp[k]=(m[k*3+i]+m[i*3+k])*fRoot;this.x=tmp[0];this.y=tmp[1];this.z=tmp[2];this.w=(m[k*3+j]-m[j*3+k])*fRoot}return this}});module.exports=Quaternion}),(function(module,exports,__webpack_require__){var CanvasInterpolation=__webpack_require__(339);var CanvasPool=__webpack_require__(26);var CONST=__webpack_require__(33);var Features=__webpack_require__(169);var CreateRenderer=function(game){var config=game.config;if((config.customEnvironment||config.canvas)&&config.renderType===CONST.AUTO){throw new Error('Must set explicit renderType in custom environment')}if(!config.customEnvironment&&!config.canvas&&config.renderType!==CONST.HEADLESS){if(config.renderType===CONST.CANVAS||(config.renderType!==CONST.CANVAS&&!Features.webGL)){if(Features.canvas){config.renderType=CONST.CANVAS}else{throw new Error('Cannot create Canvas or WebGL context, aborting.')}}else{config.renderType=CONST.WEBGL}}if(!config.antialias){CanvasPool.disableSmoothing()}var baseSize=game.scale.baseSize;var width=baseSize.width;var height=baseSize.height;if(config.canvas){game.canvas=config.canvas;game.canvas.width=width;game.canvas.height=height}else{game.canvas=CanvasPool.create(game,width,height,config.renderType)}if(config.canvasStyle){game.canvas.style=config.canvasStyle}if(!config.antialias){CanvasInterpolation.setCrisp(game.canvas)}if(config.renderType===CONST.HEADLESS){return}var CanvasRenderer;var WebGLRenderer;if(true){CanvasRenderer=__webpack_require__(505);WebGLRenderer=__webpack_require__(508);if(config.renderType===CONST.WEBGL){game.renderer=new WebGLRenderer(game)}else{game.renderer=new CanvasRenderer(game);game.context=game.renderer.gameContext}}if(false){}if(false){}};module.exports=CreateRenderer}),(function(module,exports){var CanvasInterpolation={setCrisp:function(canvas){var types=['optimizeSpeed','-moz-crisp-edges','-o-crisp-edges','-webkit-optimize-contrast','optimize-contrast','crisp-edges','pixelated'];types.forEach(function(type){canvas.style['image-rendering']=type});canvas.style.msInterpolationMode='nearest-neighbor';return canvas},setBicubic:function(canvas){canvas.style['image-rendering']='auto';canvas.style.msInterpolationMode='bicubic';return canvas}};module.exports=CanvasInterpolation}),(function(module,exports){module.exports=['#define SHADER_NAME PHASER_TEXTURE_TINT_FS','','precision mediump float;','','uniform sampler2D uMainSampler;','','varying vec2 outTexCoord;','varying float outTintEffect;','varying vec4 outTint;','','void main()','{','    vec4 texture = texture2D(uMainSampler, outTexCoord);','    vec4 texel = vec4(outTint.rgb * outTint.a, outTint.a);','    vec4 color = texture;','','    if (outTintEffect == 0.0)','    {','        //  Multiply texture tint','        color = texture * texel;','    }','    else if (outTintEffect == 1.0)','    {','        //  Solid color + texture alpha','        color.rgb = mix(texture.rgb, outTint.rgb * outTint.a, texture.a);','        color.a = texture.a * texel.a;','    }','    else if (outTintEffect == 2.0)','    {','        //  Solid color, no texture','        color = texel;','    }','','    gl_FragColor = color;','}',''].join('\/')}),(function(module,exports){module.exports=['#define SHADER_NAME PHASER_TEXTURE_TINT_VS','','precision mediump float;','','uniform mat4 uProjectionMatrix;','uniform mat4 uViewMatrix;','uniform mat4 uModelMatrix;','','attribute vec2 inPosition;','attribute vec2 inTexCoord;','attribute float inTintEffect;','attribute vec4 inTint;','','varying vec2 outTexCoord;','varying float outTintEffect;','varying vec4 outTint;','','void main ()','{','    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(inPosition, 1.0, 1.0);','','    outTexCoord = inTexCoord;','    outTint = inTint;','    outTintEffect = inTintEffect;','}','',''].join('\/')}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(33);var DebugHeader=function(game){var config=game.config;if(config.hideBanner){return}var renderType='WebGL';if(config.renderType===CONST.CANVAS){renderType='Canvas'}else if(config.renderType===CONST.HEADLESS){renderType='Headless'}var audioConfig=config.audio;var deviceAudio=game.device.audio;var audioType;if(deviceAudio.webAudio&&!(audioConfig&&audioConfig.disableWebAudio)){audioType='Web Audio'}else if((audioConfig&&audioConfig.noAudio)||(!deviceAudio.webAudio&&!deviceAudio.audioData)){audioType='No Audio'}else{audioType='HTML5 Audio'}if(!game.device.browser.ie){var c='';var args=[c];if(Array.isArray(config.bannerBackgroundColor)){var lastColor;config.bannerBackgroundColor.forEach(function(color){c=c.concat('%c ');args.push('background: '+color);lastColor=color});args[args.length-1]='color: '+config.bannerTextColor+'; background: '+lastColor}else{c=c.concat('%c ');args.push('color: '+config.bannerTextColor+'; background: '+config.bannerBackgroundColor)}args.push('background: #fff');if(config.gameTitle){c=c.concat(config.gameTitle);if(config.gameVersion){c=c.concat(' v'+config.gameVersion)}if(!config.hidePhaser){c=c.concat(' / ')}}var fb=(false)?undefined:'';if(!config.hidePhaser){c=c.concat('Phaser v'+CONST.VERSION+fb+' ('+renderType+' | '+audioType+')')}c=c.concat(' %c '+config.gameURL);args[0]=c;console.log.apply(console,args)}else if(window['console']){console.log('Phaser v'+CONST.VERSION+' / https://phaser.io')}};module.exports=DebugHeader}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetValue=__webpack_require__(6);var NOOP=__webpack_require__(1);var RequestAnimationFrame=__webpack_require__(344);var TimeStep=new Class({initialize:function TimeStep(game,config){this.game=game;this.raf=new RequestAnimationFrame();this.started=false;this.running=false;this.minFps=GetValue(config,'min',5);this.targetFps=GetValue(config,'target',60);this._min=1000/this.minFps;this._target=1000/this.targetFps;this.actualFps=this.targetFps;this.nextFpsUpdate=0;this.framesThisSecond=0;this.callback=NOOP;this.forceSetTimeOut=GetValue(config,'forceSetTimeOut',false);this.time=0;this.startTime=0;this.lastTime=0;this.frame=0;this.inFocus=true;this._pauseTime=0;this._coolDown=0;this.delta=0;this.deltaIndex=0;this.deltaHistory=[];this.deltaSmoothingMax=GetValue(config,'deltaHistory',10);this.panicMax=GetValue(config,'panicMax',120);this.rawDelta=0;this.now=0;this.smoothStep=GetValue(config,'smoothStep',true)},blur:function(){this.inFocus=false},focus:function(){this.inFocus=true;this.resetDelta()},pause:function(){this._pauseTime=window.performance.now()},resume:function(){this.resetDelta();this.startTime+=this.time-this._pauseTime},resetDelta:function(){var now=window.performance.now();this.time=now;this.lastTime=now;this.nextFpsUpdate=now+1000;this.framesThisSecond=0;for(var i=0;i<this.deltaSmoothingMax;i++){this.deltaHistory[i]=Math.min(this._target,this.deltaHistory[i])}this.delta=0;this.deltaIndex=0;this._coolDown=this.panicMax},start:function(callback){if(this.started){return this}this.started=true;this.running=true;for(var i=0;i<this.deltaSmoothingMax;i++){this.deltaHistory[i]=this._target}this.resetDelta();this.startTime=window.performance.now();this.callback=callback;this.raf.start(this.step.bind(this),this.forceSetTimeOut,this._target)},step:function(){var time=window.performance.now();this.now=time;var before=time-this.lastTime;if(before<0){before=0}this.rawDelta=before;var idx=this.deltaIndex;var history=this.deltaHistory;var max=this.deltaSmoothingMax;var dt=before;var avg=before;if(this.smoothStep){if(this._coolDown>0||!this.inFocus){this._coolDown--;dt=Math.min(dt,this._target)}if(dt>this._min){dt=history[idx];dt=Math.min(dt,this._min)}history[idx]=dt;this.deltaIndex++;if(this.deltaIndex>max){this.deltaIndex=0}avg=0;for(var i=0;i<max;i++){avg+=history[i]}avg/=max}this.delta=avg;this.time+=this.rawDelta;if(time>this.nextFpsUpdate){this.actualFps=0.25*this.framesThisSecond+0.75*this.actualFps;this.nextFpsUpdate=time+1000;this.framesThisSecond=0}this.framesThisSecond++;var interpolation=avg/this._target;this.callback(time,avg,interpolation);this.lastTime=time;this.frame++},tick:function(){this.step()},sleep:function(){if(this.running){this.raf.stop();this.running=false}},wake:function(seamless){if(this.running){return}else if(seamless){this.startTime+=-this.lastTime+(this.lastTime+window.performance.now())}this.raf.start(this.step.bind(this),this.useRAF);this.running=true;this.step()},getDuration:function(){return Math.round(this.lastTime-this.startTime)/1000},getDurationMS:function(){return Math.round(this.lastTime-this.startTime)},stop:function(){this.running=false;this.started=false;this.raf.stop();return this},destroy:function(){this.stop();this.callback=NOOP;this.raf=null;this.game=null}});module.exports=TimeStep}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var NOOP=__webpack_require__(1);var RequestAnimationFrame=new Class({initialize:function RequestAnimationFrame(){this.isRunning=false;this.callback=NOOP;this.tick=0;this.isSetTimeOut=false;this.timeOutID=null;this.lastTime=0;this.target=0;var _this=this;this.step=function step(){var timestamp=window.performance.now();_this.lastTime=_this.tick;_this.tick=timestamp;_this.callback(timestamp);_this.timeOutID=window.requestAnimationFrame(step)};this.stepTimeout=function stepTimeout(){var d=Date.now();var delay=Math.min(Math.max(_this.target*2+_this.tick-d,0),_this.target);_this.lastTime=_this.tick;_this.tick=d;_this.callback(d);_this.timeOutID=window.setTimeout(stepTimeout,delay)}},start:function(callback,forceSetTimeOut,targetFPS){if(this.isRunning){return}this.callback=callback;this.isSetTimeOut=forceSetTimeOut;this.target=targetFPS;this.isRunning=true;this.timeOutID=(forceSetTimeOut)?window.setTimeout(this.stepTimeout,0):window.requestAnimationFrame(this.step)},stop:function(){this.isRunning=false;if(this.isSetTimeOut){clearTimeout(this.timeOutID)}else{window.cancelAnimationFrame(this.timeOutID)}},destroy:function(){this.stop();this.callback=NOOP}});module.exports=RequestAnimationFrame}),(function(module,exports,__webpack_require__){var Events=__webpack_require__(20);var VisibilityHandler=function(game){var hiddenVar;var eventEmitter=game.events;if(document.hidden!==undefined){hiddenVar='visibilitychange'}else{var vendors=['webkit','moz','ms'];vendors.forEach(function(prefix){if(document[prefix+'Hidden']!==undefined){document.hidden=function(){return document[prefix+'Hidden']};hiddenVar=prefix+'visibilitychange'}})}var onChange=function(event){if(document.hidden||event.type==='pause'){eventEmitter.emit(Events.HIDDEN)}else{eventEmitter.emit(Events.VISIBLE)}};if(hiddenVar){document.addEventListener(hiddenVar,onChange,false)}window.onblur=function(){eventEmitter.emit(Events.BLUR)};window.onfocus=function(){eventEmitter.emit(Events.FOCUS)};if(window.focus&&game.config.autoFocus){window.focus()}};module.exports=VisibilityHandler}),(function(module,exports,__webpack_require__){var Arne16=__webpack_require__(347);var CanvasPool=__webpack_require__(26);var GetValue=__webpack_require__(6);var GenerateTexture=function(config){var data=GetValue(config,'data',[]);var canvas=GetValue(config,'canvas',null);var palette=GetValue(config,'palette',Arne16);var pixelWidth=GetValue(config,'pixelWidth',1);var pixelHeight=GetValue(config,'pixelHeight',pixelWidth);var resizeCanvas=GetValue(config,'resizeCanvas',true);var clearCanvas=GetValue(config,'clearCanvas',true);var preRender=GetValue(config,'preRender',null);var postRender=GetValue(config,'postRender',null);var width=Math.floor(Math.abs(data[0].length*pixelWidth));var height=Math.floor(Math.abs(data.length*pixelHeight));if(!canvas){canvas=CanvasPool.create2D(this,width,height);resizeCanvas=false;clearCanvas=false}if(resizeCanvas){canvas.width=width;canvas.height=height}var ctx=canvas.getContext('2d');if(clearCanvas){ctx.clearRect(0,0,width,height)}if(preRender){preRender(canvas,ctx)}for(var y=0;y<data.length;y++){var row=data[y];for(var x=0;x<row.length;x++){var d=row[x];if(d!=='.'&&d!==' '){ctx.fillStyle=palette[d];ctx.fillRect(x*pixelWidth,y*pixelHeight,pixelWidth,pixelHeight)}}}if(postRender){postRender(canvas,ctx)}return canvas};module.exports=GenerateTexture}),(function(module,exports){module.exports={0:'#000',1:'#9D9D9D',2:'#FFF',3:'#BE2633',4:'#E06F8B',5:'#493C2B',6:'#A46422',7:'#EB8931',8:'#F7E26B',9:'#2F484E',A:'#44891A',B:'#A3CE27',C:'#1B2632',D:'#005784',E:'#31A2F2',F:'#B2DCEF'}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CubicBezier=__webpack_require__(326);var Curve=__webpack_require__(81);var Vector2=__webpack_require__(3);var CubicBezierCurve=new Class({Extends:Curve,initialize:function CubicBezierCurve(p0,p1,p2,p3){Curve.call(this,'CubicBezierCurve');if(Array.isArray(p0)){p3=new Vector2(p0[6],p0[7]);p2=new Vector2(p0[4],p0[5]);p1=new Vector2(p0[2],p0[3]);p0=new Vector2(p0[0],p0[1])}this.p0=p0;this.p1=p1;this.p2=p2;this.p3=p3},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return out.copy(this.p0)},getResolution:function(divisions){return divisions},getPoint:function(t,out){if(out===undefined){out=new Vector2()}var p0=this.p0;var p1=this.p1;var p2=this.p2;var p3=this.p3;return out.set(CubicBezier(t,p0.x,p1.x,p2.x,p3.x),CubicBezier(t,p0.y,p1.y,p2.y,p3.y))},draw:function(graphics,pointsTotal){if(pointsTotal===undefined){pointsTotal=32}var points=this.getPoints(pointsTotal);graphics.beginPath();graphics.moveTo(this.p0.x,this.p0.y);for(var i=1;i<points.length;i++){graphics.lineTo(points[i].x,points[i].y)}graphics.strokePath();return graphics},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y,this.p3.x,this.p3.y]}}});CubicBezierCurve.fromJSON=function(data){var points=data.points;var p0=new Vector2(points[0],points[1]);var p1=new Vector2(points[2],points[3]);var p2=new Vector2(points[4],points[5]);var p3=new Vector2(points[6],points[7]);return new CubicBezierCurve(p0,p1,p2,p3)};module.exports=CubicBezierCurve}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Curve=__webpack_require__(81);var DegToRad=__webpack_require__(39);var GetValue=__webpack_require__(6);var RadToDeg=__webpack_require__(173);var Vector2=__webpack_require__(3);var EllipseCurve=new Class({Extends:Curve,initialize:function EllipseCurve(x,y,xRadius,yRadius,startAngle,endAngle,clockwise,rotation){if(typeof x==='object'){var config=x;x=GetValue(config,'x',0);y=GetValue(config,'y',0);xRadius=GetValue(config,'xRadius',0);yRadius=GetValue(config,'yRadius',xRadius);startAngle=GetValue(config,'startAngle',0);endAngle=GetValue(config,'endAngle',360);clockwise=GetValue(config,'clockwise',false);rotation=GetValue(config,'rotation',0)}else{if(yRadius===undefined){yRadius=xRadius}if(startAngle===undefined){startAngle=0}if(endAngle===undefined){endAngle=360}if(clockwise===undefined){clockwise=false}if(rotation===undefined){rotation=0}}Curve.call(this,'EllipseCurve');this.p0=new Vector2(x,y);this._xRadius=xRadius;this._yRadius=yRadius;this._startAngle=DegToRad(startAngle);this._endAngle=DegToRad(endAngle);this._clockwise=clockwise;this._rotation=DegToRad(rotation)},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return this.getPoint(0,out)},getResolution:function(divisions){return divisions*2},getPoint:function(t,out){if(out===undefined){out=new Vector2()}var twoPi=Math.PI*2;var deltaAngle=this._endAngle-this._startAngle;var samePoints=Math.abs(deltaAngle)<Number.EPSILON;while(deltaAngle<0){deltaAngle+=twoPi}while(deltaAngle>twoPi){deltaAngle-=twoPi}if(deltaAngle<Number.EPSILON){if(samePoints){deltaAngle=0}else{deltaAngle=twoPi}}if(this._clockwise&&!samePoints){if(deltaAngle===twoPi){deltaAngle=-twoPi}else{deltaAngle=deltaAngle-twoPi}}var angle=this._startAngle+t*deltaAngle;var x=this.p0.x+this._xRadius*Math.cos(angle);var y=this.p0.y+this._yRadius*Math.sin(angle);if(this._rotation!==0){var cos=Math.cos(this._rotation);var sin=Math.sin(this._rotation);var tx=x-this.p0.x;var ty=y-this.p0.y;x=tx*cos-ty*sin+this.p0.x;y=tx*sin+ty*cos+this.p0.y}return out.set(x,y)},setXRadius:function(value){this.xRadius=value;return this},setYRadius:function(value){this.yRadius=value;return this},setWidth:function(value){this.xRadius=value/2;return this},setHeight:function(value){this.yRadius=value/2;return this},setStartAngle:function(value){this.startAngle=value;return this},setEndAngle:function(value){this.endAngle=value;return this},setClockwise:function(value){this.clockwise=value;return this},setRotation:function(value){this.rotation=value;return this},x:{get:function(){return this.p0.x},set:function(value){this.p0.x=value}},y:{get:function(){return this.p0.y},set:function(value){this.p0.y=value}},xRadius:{get:function(){return this._xRadius},set:function(value){this._xRadius=value}},yRadius:{get:function(){return this._yRadius},set:function(value){this._yRadius=value}},startAngle:{get:function(){return RadToDeg(this._startAngle)},set:function(value){this._startAngle=DegToRad(value)}},endAngle:{get:function(){return RadToDeg(this._endAngle)},set:function(value){this._endAngle=DegToRad(value)}},clockwise:{get:function(){return this._clockwise},set:function(value){this._clockwise=value}},angle:{get:function(){return RadToDeg(this._rotation)},set:function(value){this._rotation=DegToRad(value)}},rotation:{get:function(){return this._rotation},set:function(value){this._rotation=value}},toJSON:function(){return{type:this.type,x:this.p0.x,y:this.p0.y,xRadius:this._xRadius,yRadius:this._yRadius,startAngle:RadToDeg(this._startAngle),endAngle:RadToDeg(this._endAngle),clockwise:this._clockwise,rotation:RadToDeg(this._rotation)}}});EllipseCurve.fromJSON=function(data){return new EllipseCurve(data)};module.exports=EllipseCurve}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Curve=__webpack_require__(81);var FromPoints=__webpack_require__(176);var Rectangle=__webpack_require__(11);var Vector2=__webpack_require__(3);var tmpVec2=new Vector2();var LineCurve=new Class({Extends:Curve,initialize:function LineCurve(p0,p1){Curve.call(this,'LineCurve');if(Array.isArray(p0)){p1=new Vector2(p0[2],p0[3]);p0=new Vector2(p0[0],p0[1])}this.p0=p0;this.p1=p1;this.arcLengthDivisions=1},getBounds:function(out){if(out===undefined){out=new Rectangle()}return FromPoints([this.p0,this.p1],out)},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return out.copy(this.p0)},getResolution:function(divisions){if(divisions===undefined){divisions=1}return divisions},getPoint:function(t,out){if(out===undefined){out=new Vector2()}if(t===1){return out.copy(this.p1)}out.copy(this.p1).subtract(this.p0).scale(t).add(this.p0);return out},getPointAt:function(u,out){return this.getPoint(u,out)},getTangent:function(){var tangent=tmpVec2.copy(this.p1).subtract(this.p0);return tangent.normalize()},getUtoTmapping:function(u,distance,divisions){var t;if(distance){var arcLengths=this.getLengths(divisions);var lineLength=arcLengths[arcLengths.length-1];var targetLineLength=Math.min(distance,lineLength);t=targetLineLength/lineLength}else{t=u}return t},draw:function(graphics){graphics.lineBetween(this.p0.x,this.p0.y,this.p1.x,this.p1.y);return graphics},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y]}}});LineCurve.fromJSON=function(data){var points=data.points;var p0=new Vector2(points[0],points[1]);var p1=new Vector2(points[2],points[3]);return new LineCurve(p0,p1)};module.exports=LineCurve}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Curve=__webpack_require__(81);var QuadraticBezierInterpolation=__webpack_require__(327);var Vector2=__webpack_require__(3);var QuadraticBezier=new Class({Extends:Curve,initialize:function QuadraticBezier(p0,p1,p2){Curve.call(this,'QuadraticBezier');if(Array.isArray(p0)){p2=new Vector2(p0[4],p0[5]);p1=new Vector2(p0[2],p0[3]);p0=new Vector2(p0[0],p0[1])}this.p0=p0;this.p1=p1;this.p2=p2},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return out.copy(this.p0)},getResolution:function(divisions){return divisions},getPoint:function(t,out){if(out===undefined){out=new Vector2()}var p0=this.p0;var p1=this.p1;var p2=this.p2;return out.set(QuadraticBezierInterpolation(t,p0.x,p1.x,p2.x),QuadraticBezierInterpolation(t,p0.y,p1.y,p2.y))},draw:function(graphics,pointsTotal){if(pointsTotal===undefined){pointsTotal=32}var points=this.getPoints(pointsTotal);graphics.beginPath();graphics.moveTo(this.p0.x,this.p0.y);for(var i=1;i<points.length;i++){graphics.lineTo(points[i].x,points[i].y)}graphics.strokePath();return graphics},toJSON:function(){return{type:this.type,points:[this.p0.x,this.p0.y,this.p1.x,this.p1.y,this.p2.x,this.p2.y]}}});QuadraticBezier.fromJSON=function(data){var points=data.points;var p0=new Vector2(points[0],points[1]);var p1=new Vector2(points[2],points[3]);var p2=new Vector2(points[4],points[5]);return new QuadraticBezier(p0,p1,p2)};module.exports=QuadraticBezier}),(function(module,exports,__webpack_require__){var CatmullRom=__webpack_require__(171);var Class=__webpack_require__(0);var Curve=__webpack_require__(81);var Vector2=__webpack_require__(3);var SplineCurve=new Class({Extends:Curve,initialize:function SplineCurve(points){if(points===undefined){points=[]}Curve.call(this,'SplineCurve');this.points=[];this.addPoints(points)},addPoints:function(points){for(var i=0;i<points.length;i++){var p=new Vector2();if(typeof points[i]==='number'){p.x=points[i];p.y=points[i+1];i++}else if(Array.isArray(points[i])){p.x=points[i][0];p.y=points[i][1]}else{p.x=points[i].x;p.y=points[i].y}this.points.push(p)}return this},addPoint:function(x,y){var vec=new Vector2(x,y);this.points.push(vec);return vec},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return out.copy(this.points[0])},getResolution:function(divisions){return divisions*this.points.length},getPoint:function(t,out){if(out===undefined){out=new Vector2()}var points=this.points;var point=(points.length-1)*t;var intPoint=Math.floor(point);var weight=point-intPoint;var p0=points[(intPoint===0)?intPoint:intPoint-1];var p1=points[intPoint];var p2=points[(intPoint>points.length-2)?points.length-1:intPoint+1];var p3=points[(intPoint>points.length-3)?points.length-1:intPoint+2];return out.set(CatmullRom(weight,p0.x,p1.x,p2.x,p3.x),CatmullRom(weight,p0.y,p1.y,p2.y,p3.y))},toJSON:function(){var points=[];for(var i=0;i<this.points.length;i++){points.push(this.points[i].x);points.push(this.points[i].y)}return{type:this.type,points:points}}});SplineCurve.fromJSON=function(data){return new SplineCurve(data.points)};module.exports=SplineCurve}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var BaseShader=new Class({initialize:function BaseShader(key,fragmentSrc,vertexSrc,uniforms){if(!fragmentSrc||fragmentSrc===''){fragmentSrc=['precision mediump float;','uniform vec2 resolution;','varying vec2 fragCoord;','void main () {','    vec2 uv = fragCoord / resolution.xy;','    gl_FragColor = vec4(uv.xyx, 1.0);','}'].join('\/')}if(!vertexSrc||vertexSrc===''){vertexSrc=['precision mediump float;','uniform mat4 uProjectionMatrix;','uniform mat4 uViewMatrix;','uniform vec2 uResolution;','attribute vec2 inPosition;','varying vec2 fragCoord;','void main () {','gl_Position = uProjectionMatrix * uViewMatrix * vec4(inPosition, 1.0, 1.0);','fragCoord = vec2(inPosition.x, uResolution.y - inPosition.y);','}'].join('\/')}if(uniforms===undefined){uniforms=null}this.key=key;this.fragmentSrc=fragmentSrc;this.vertexSrc=vertexSrc;this.uniforms=uniforms}});module.exports=BaseShader}),(function(module,exports,__webpack_require__){var Color=__webpack_require__(31);Color.ColorToRGBA=__webpack_require__(811);Color.ComponentToHex=__webpack_require__(355);Color.GetColor=__webpack_require__(165);Color.GetColor32=__webpack_require__(295);Color.HexStringToColor=__webpack_require__(294);Color.HSLToColor=__webpack_require__(812);Color.HSVColorWheel=__webpack_require__(813);Color.HSVToRGB=__webpack_require__(166);Color.HueToComponent=__webpack_require__(356);Color.IntegerToColor=__webpack_require__(297);Color.IntegerToRGB=__webpack_require__(298);Color.Interpolate=__webpack_require__(814);Color.ObjectToColor=__webpack_require__(299);Color.RandomRGB=__webpack_require__(815);Color.RGBStringToColor=__webpack_require__(300);Color.RGBToHSV=__webpack_require__(296);Color.RGBToString=__webpack_require__(816);Color.ValueToColor=__webpack_require__(164);module.exports=Color}),(function(module,exports){var ComponentToHex=function(color){var hex=color.toString(16);return(hex.length===1)?'0'+hex:hex};module.exports=ComponentToHex}),(function(module,exports){var HueToComponent=function(p,q,t){if(t<0){t+=1}if(t>1){t-=1}if(t<1/6){return p+(q-p)*6*t}if(t<1/2){return q}if(t<2/3){return p+(q-p)*(2/3-t)*6}return p};module.exports=HueToComponent}),(function(module,exports,__webpack_require__){var OS=__webpack_require__(117);var DOMContentLoaded=function(callback){if(document.readyState==='complete'||document.readyState==='interactive'){callback();return}var check=function(){document.removeEventListener('deviceready',check,true);document.removeEventListener('DOMContentLoaded',check,true);window.removeEventListener('load',check,true);callback()};if(!document.body){window.setTimeout(check,20)}else if(OS.cordova){document.addEventListener('deviceready',check,false)}else{document.addEventListener('DOMContentLoaded',check,true);window.addEventListener('load',check,true)}};module.exports=DOMContentLoaded}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(177);var GetScreenOrientation=function(width,height){var screen=window.screen;var orientation=(screen)?screen.orientation||screen.mozOrientation||screen.msOrientation:false;if(orientation&&typeof orientation.type==='string'){return orientation.type}else if(typeof orientation==='string'){return orientation}if(screen){return(screen.height>screen.width)?CONST.ORIENTATION.PORTRAIT:CONST.ORIENTATION.LANDSCAPE}else if(typeof window.orientation==='number'){return(window.orientation===0||window.orientation===180)?CONST.ORIENTATION.PORTRAIT:CONST.ORIENTATION.LANDSCAPE}else if(window.matchMedia){if(window.matchMedia('(orientation: portrait)').matches){return CONST.ORIENTATION.PORTRAIT}else if(window.matchMedia('(orientation: landscape)').matches){return CONST.ORIENTATION.LANDSCAPE}}return(height>width)?CONST.ORIENTATION.PORTRAIT:CONST.ORIENTATION.LANDSCAPE};module.exports=GetScreenOrientation}),(function(module,exports){module.exports={NO_CENTER:0,CENTER_BOTH:1,CENTER_HORIZONTALLY:2,CENTER_VERTICALLY:3}}),(function(module,exports){module.exports={LANDSCAPE:'landscape-primary',PORTRAIT:'portrait-primary'}}),(function(module,exports){module.exports={NONE:0,WIDTH_CONTROLS_HEIGHT:1,HEIGHT_CONTROLS_WIDTH:2,FIT:3,ENVELOP:4,RESIZE:5}}),(function(module,exports){module.exports={NO_ZOOM:1,ZOOM_2X:2,ZOOM_4X:4,MAX_ZOOM:-1}}),(function(module,exports){var GetTarget=function(element){var target;if(element!==''){if(typeof element==='string'){target=document.getElementById(element)}else if(element&&element.nodeType===1){target=element}}if(!target){target=document.body}return target};module.exports=GetTarget}),(function(module,exports){var ParseXML=function(data){var xml='';try{if(window['DOMParser']){var domparser=new DOMParser();xml=domparser.parseFromString(data,'text/xml')}else{xml=new ActiveXObject('Microsoft.XMLDOM');xml.loadXML(data)}}catch(e){xml=null}if(!xml||!xml.documentElement||xml.getElementsByTagName('parsererror').length){return null}else{return xml}};module.exports=ParseXML}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(179);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(54);var GameEvents=__webpack_require__(20);var Keyboard=__webpack_require__(366);var Mouse=__webpack_require__(367);var Pointer=__webpack_require__(368);var Touch=__webpack_require__(369);var TransformMatrix=__webpack_require__(29);var TransformXY=__webpack_require__(333);var InputManager=new Class({initialize:function InputManager(game,config){this.game=game;this.scaleManager;this.canvas;this.config=config;this.enabled=true;this.events=new EventEmitter();this.isOver=true;this.defaultCursor='';this.keyboard=(config.inputKeyboard)?new Keyboard(this):null;this.mouse=(config.inputMouse)?new Mouse(this):null;this.touch=(config.inputTouch)?new Touch(this):null;this.pointers=[];this.pointersTotal=config.inputActivePointers;if(config.inputTouch&&this.pointersTotal===1){this.pointersTotal=2}for(var i=0;i<=this.pointersTotal;i++){var pointer=new Pointer(this,i);pointer.smoothFactor=config.inputSmoothFactor;this.pointers.push(pointer)}this.mousePointer=(config.inputMouse)?this.pointers[0]:null;this.activePointer=this.pointers[0];this.globalTopOnly=true;this.time=0;this._tempPoint={x:0,y:0};this._tempHitTest=[];this._tempMatrix=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempSkip=false;this.mousePointerContainer=[this.mousePointer];game.events.once(GameEvents.BOOT,this.boot,this)},boot:function(){this.canvas=this.game.canvas;this.scaleManager=this.game.scale;this.events.emit(Events.MANAGER_BOOT);this.game.events.on(GameEvents.PRE_RENDER,this.preRender,this);this.game.events.once(GameEvents.DESTROY,this.destroy,this)},setCanvasOver:function(event){this.isOver=true;this.events.emit(Events.GAME_OVER,event)},setCanvasOut:function(event){this.isOver=false;this.events.emit(Events.GAME_OUT,event)},preRender:function(){var time=this.game.loop.now;var delta=this.game.loop.delta;var scenes=this.game.scene.getScenes(true,true);this.time=time;this.events.emit(Events.MANAGER_UPDATE);for(var i=0;i<scenes.length;i++){var scene=scenes[i];if(scene.sys.input&&scene.sys.input.updatePoll(time,delta)&&this.globalTopOnly){return}}},setDefaultCursor:function(cursor){this.defaultCursor=cursor;if(this.canvas.style.cursor!==cursor){this.canvas.style.cursor=cursor}},setCursor:function(interactiveObject){if(interactiveObject.cursor){this.canvas.style.cursor=interactiveObject.cursor}},resetCursor:function(interactiveObject){if(interactiveObject.cursor&&this.canvas){this.canvas.style.cursor=this.defaultCursor}},addPointer:function(quantity){if(quantity===undefined){quantity=1}var output=[];if(this.pointersTotal+quantity>10){quantity=10-this.pointersTotal}for(var i=0;i<quantity;i++){var id=this.pointers.length;var pointer=new Pointer(this,id);pointer.smoothFactor=this.config.inputSmoothFactor;this.pointers.push(pointer);this.pointersTotal++;output.push(pointer)}return output},updateInputPlugins:function(type,pointers){var scenes=this.game.scene.getScenes(true,true);this._tempSkip=false;for(var i=0;i<scenes.length;i++){var scene=scenes[i];if(scene.sys.input){var capture=scene.sys.input.update(type,pointers);if((capture&&this.globalTopOnly)||this._tempSkip){return}}}},onTouchStart:function(event){var pointers=this.pointers;var changed=[];for(var c=0;c<event.changedTouches.length;c++){var changedTouch=event.changedTouches[c];for(var i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(!pointer.active){pointer.touchstart(changedTouch,event);this.activePointer=pointer;changed.push(pointer);break}}}this.updateInputPlugins(CONST.TOUCH_START,changed)},onTouchMove:function(event){var pointers=this.pointers;var changed=[];for(var c=0;c<event.changedTouches.length;c++){var changedTouch=event.changedTouches[c];for(var i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchmove(changedTouch,event);this.activePointer=pointer;changed.push(pointer);break}}}this.updateInputPlugins(CONST.TOUCH_MOVE,changed)},onTouchEnd:function(event){var pointers=this.pointers;var changed=[];for(var c=0;c<event.changedTouches.length;c++){var changedTouch=event.changedTouches[c];for(var i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchend(changedTouch,event);changed.push(pointer);break}}}this.updateInputPlugins(CONST.TOUCH_END,changed)},onTouchCancel:function(event){var pointers=this.pointers;var changed=[];for(var c=0;c<event.changedTouches.length;c++){var changedTouch=event.changedTouches[c];for(var i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchcancel(changedTouch,event);changed.push(pointer);break}}}this.updateInputPlugins(CONST.TOUCH_CANCEL,changed)},onMouseDown:function(event){this.mousePointer.down(event);this.mousePointer.updateMotion();this.updateInputPlugins(CONST.MOUSE_DOWN,this.mousePointerContainer)},onMouseMove:function(event){this.mousePointer.move(event);this.mousePointer.updateMotion();this.updateInputPlugins(CONST.MOUSE_MOVE,this.mousePointerContainer)},onMouseUp:function(event){this.mousePointer.up(event);this.mousePointer.updateMotion();this.updateInputPlugins(CONST.MOUSE_UP,this.mousePointerContainer)},onMouseWheel:function(event){this.mousePointer.wheel(event);this.updateInputPlugins(CONST.MOUSE_WHEEL,this.mousePointerContainer)},onPointerLockChange:function(event){var isLocked=this.mouse.locked;this.mousePointer.locked=isLocked;this.events.emit(Events.POINTERLOCK_CHANGE,event,isLocked)},inputCandidate:function(gameObject,camera){var input=gameObject.input;if(!input||!input.enabled||(!input.alwaysEnabled&&!gameObject.willRender(camera))){return false}var visible=true;var parent=gameObject.parentContainer;if(parent){do{if(!parent.willRender(camera)){visible=false;break}parent=parent.parentContainer}while(parent)}return visible},hitTest:function(pointer,gameObjects,camera,output){if(output===undefined){output=this._tempHitTest}var tempPoint=this._tempPoint;var csx=camera.scrollX;var csy=camera.scrollY;output.length=0;var x=pointer.x;var y=pointer.y;if(camera.resolution!==1){x+=camera._x;y+=camera._y}camera.getWorldPoint(x,y,tempPoint);pointer.worldX=tempPoint.x;pointer.worldY=tempPoint.y;var point={x:0,y:0};var matrix=this._tempMatrix;var parentMatrix=this._tempMatrix2;for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i];if(!this.inputCandidate(gameObject,camera)){continue}var px=tempPoint.x+(csx*gameObject.scrollFactorX)-csx;var py=tempPoint.y+(csy*gameObject.scrollFactorY)-csy;if(gameObject.parentContainer){gameObject.getWorldTransformMatrix(matrix,parentMatrix);matrix.applyInverse(px,py,point)}else{TransformXY(px,py,gameObject.x,gameObject.y,gameObject.rotation,gameObject.scaleX,gameObject.scaleY,point)}if(this.pointWithinHitArea(gameObject,point.x,point.y)){output.push(gameObject)}}return output},pointWithinHitArea:function(gameObject,x,y){x+=gameObject.displayOriginX;y+=gameObject.displayOriginY;var input=gameObject.input;if(input&&input.hitAreaCallback(input.hitArea,x,y,gameObject)){input.localX=x;input.localY=y;return true}else{return false}},pointWithinInteractiveObject:function(object,x,y){if(!object.hitArea){return false}x+=object.gameObject.displayOriginX;y+=object.gameObject.displayOriginY;object.localX=x;object.localY=y;return object.hitAreaCallback(object.hitArea,x,y,object)},transformPointer:function(pointer,pageX,pageY,wasMove){var p0=pointer.position;var p1=pointer.prevPosition;p1.x=p0.x;p1.y=p0.y;var x=this.scaleManager.transformX(pageX);var y=this.scaleManager.transformY(pageY);var a=pointer.smoothFactor;if(!wasMove||a===0){p0.x=x;p0.y=y}else{p0.x=x*a+p1.x*(1-a);p0.y=y*a+p1.y*(1-a)}},destroy:function(){this.events.removeAllListeners();this.game.events.off(GameEvents.PRE_RENDER);if(this.keyboard){this.keyboard.destroy()}if(this.mouse){this.mouse.destroy()}if(this.touch){this.touch.destroy()}for(var i=0;i<this.pointers.length;i++){this.pointers[i].destroy()}this.pointers=[];this._tempHitTest=[];this._tempMatrix.destroy();this.canvas=null;this.game=null}});module.exports=InputManager}),(function(module,exports,__webpack_require__){var ArrayRemove=__webpack_require__(123);var Class=__webpack_require__(0);var GameEvents=__webpack_require__(20);var InputEvents=__webpack_require__(54);var KeyCodes=__webpack_require__(124);var NOOP=__webpack_require__(1);var KeyboardManager=new Class({initialize:function KeyboardManager(inputManager){this.manager=inputManager;this.queue=[];this.preventDefault=true;this.captures=[];this.enabled=false;this.target;this.onKeyDown=NOOP;this.onKeyUp=NOOP;inputManager.events.once(InputEvents.MANAGER_BOOT,this.boot,this)},boot:function(){var config=this.manager.config;this.enabled=config.inputKeyboard;this.target=config.inputKeyboardEventTarget;this.addCapture(config.inputKeyboardCapture);if(!this.target&&window){this.target=window}if(this.enabled&&this.target){this.startListeners()}this.manager.game.events.on(GameEvents.POST_STEP,this.postUpdate,this)},startListeners:function(){var _this=this;this.onKeyDown=function(event){if(event.defaultPrevented||!_this.enabled||!_this.manager){return}_this.queue.push(event);if(!_this.manager.useQueue){_this.manager.events.emit(InputEvents.MANAGER_PROCESS)}var modified=(event.altKey||event.ctrlKey||event.shiftKey||event.metaKey);if(_this.preventDefault&&!modified&&_this.captures.indexOf(event.keyCode)>-1){event.preventDefault()}};this.onKeyUp=function(event){if(event.defaultPrevented||!_this.enabled||!_this.manager){return}_this.queue.push(event);if(!_this.manager.useQueue){_this.manager.events.emit(InputEvents.MANAGER_PROCESS)}var modified=(event.altKey||event.ctrlKey||event.shiftKey||event.metaKey);if(_this.preventDefault&&!modified&&_this.captures.indexOf(event.keyCode)>-1){event.preventDefault()}};var target=this.target;if(target){target.addEventListener('keydown',this.onKeyDown,false);target.addEventListener('keyup',this.onKeyUp,false);this.enabled=true}},stopListeners:function(){var target=this.target;target.removeEventListener('keydown',this.onKeyDown,false);target.removeEventListener('keyup',this.onKeyUp,false);this.enabled=false},postUpdate:function(){this.queue=[]},addCapture:function(keycode){if(typeof keycode==='string'){keycode=keycode.split(',')}if(!Array.isArray(keycode)){keycode=[keycode]}var captures=this.captures;for(var i=0;i<keycode.length;i++){var code=keycode[i];if(typeof code==='string'){code=KeyCodes[code.trim().toUpperCase()]}if(captures.indexOf(code)===-1){captures.push(code)}}this.preventDefault=captures.length>0},removeCapture:function(keycode){if(typeof keycode==='string'){keycode=keycode.split(',')}if(!Array.isArray(keycode)){keycode=[keycode]}var captures=this.captures;for(var i=0;i<keycode.length;i++){var code=keycode[i];if(typeof code==='string'){code=KeyCodes[code.toUpperCase()]}ArrayRemove(captures,code)}this.preventDefault=captures.length>0},clearCaptures:function(){this.captures=[];this.preventDefault=false},destroy:function(){this.stopListeners();this.clearCaptures();this.queue=[];this.manager.game.events.off(GameEvents.POST_RENDER,this.postUpdate,this);this.target=null;this.enabled=false;this.manager=null}});module.exports=KeyboardManager}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Features=__webpack_require__(169);var InputEvents=__webpack_require__(54);var NOOP=__webpack_require__(1);var MouseManager=new Class({initialize:function MouseManager(inputManager){this.manager=inputManager;this.capture=true;this.enabled=false;this.target;this.locked=false;this.onMouseMove=NOOP;this.onMouseDown=NOOP;this.onMouseUp=NOOP;this.onMouseDownWindow=NOOP;this.onMouseUpWindow=NOOP;this.onMouseOver=NOOP;this.onMouseOut=NOOP;this.onMouseWheel=NOOP;this.pointerLockChange=NOOP;inputManager.events.once(InputEvents.MANAGER_BOOT,this.boot,this)},boot:function(){var config=this.manager.config;this.enabled=config.inputMouse;this.target=config.inputMouseEventTarget;this.capture=config.inputMouseCapture;if(!this.target){this.target=this.manager.game.canvas}else if(typeof this.target==='string'){this.target=document.getElementById(this.target)}if(config.disableContextMenu){this.disableContextMenu()}if(this.enabled&&this.target){this.startListeners()}},disableContextMenu:function(){document.body.addEventListener('contextmenu',function(event){event.preventDefault();return false});return this},requestPointerLock:function(){if(Features.pointerLock){var element=this.target;element.requestPointerLock=element.requestPointerLock||element.mozRequestPointerLock||element.webkitRequestPointerLock;element.requestPointerLock()}},releasePointerLock:function(){if(Features.pointerLock){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock;document.exitPointerLock()}},startListeners:function(){var _this=this;var canvas=this.manager.canvas;var autoFocus=(window&&window.focus&&this.manager.game.config.autoFocus);this.onMouseMove=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onMouseMove(event);if(_this.capture){event.preventDefault()}}};this.onMouseDown=function(event){if(autoFocus){window.focus()}if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onMouseDown(event);if(_this.capture&&event.target===canvas){event.preventDefault()}}};this.onMouseDownWindow=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&event.target!==canvas){_this.manager.onMouseDown(event)}};this.onMouseUp=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onMouseUp(event);if(_this.capture&&event.target===canvas){event.preventDefault()}}};this.onMouseUpWindow=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&event.target!==canvas){_this.manager.onMouseUp(event)}};this.onMouseOver=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.setCanvasOver(event)}};this.onMouseOut=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.setCanvasOut(event)}};this.onMouseWheel=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onMouseWheel(event)}};var target=this.target;if(!target){return}var passive={passive:true};var nonPassive={passive:false};target.addEventListener('mousemove',this.onMouseMove,(this.capture)?nonPassive:passive);target.addEventListener('mousedown',this.onMouseDown,(this.capture)?nonPassive:passive);target.addEventListener('mouseup',this.onMouseUp,(this.capture)?nonPassive:passive);target.addEventListener('mouseover',this.onMouseOver,(this.capture)?nonPassive:passive);target.addEventListener('mouseout',this.onMouseOut,(this.capture)?nonPassive:passive);target.addEventListener('wheel',this.onMouseWheel,(this.capture)?nonPassive:passive);if(window&&this.manager.game.config.inputWindowEvents){window.addEventListener('mousedown',this.onMouseDownWindow,nonPassive);window.addEventListener('mouseup',this.onMouseUpWindow,nonPassive)}if(Features.pointerLock){this.pointerLockChange=function(event){var element=_this.target;_this.locked=(document.pointerLockElement===element||document.mozPointerLockElement===element||document.webkitPointerLockElement===element)?true:false;_this.manager.onPointerLockChange(event)};document.addEventListener('pointerlockchange',this.pointerLockChange,true);document.addEventListener('mozpointerlockchange',this.pointerLockChange,true);document.addEventListener('webkitpointerlockchange',this.pointerLockChange,true)}this.enabled=true},stopListeners:function(){var target=this.target;target.removeEventListener('mousemove',this.onMouseMove);target.removeEventListener('mousedown',this.onMouseDown);target.removeEventListener('mouseup',this.onMouseUp);target.removeEventListener('mouseover',this.onMouseOver);target.removeEventListener('mouseout',this.onMouseOut);if(window){window.removeEventListener('mousedown',this.onMouseDownWindow);window.removeEventListener('mouseup',this.onMouseUpWindow)}if(Features.pointerLock){document.removeEventListener('pointerlockchange',this.pointerLockChange,true);document.removeEventListener('mozpointerlockchange',this.pointerLockChange,true);document.removeEventListener('webkitpointerlockchange',this.pointerLockChange,true)}},destroy:function(){this.stopListeners();this.target=null;this.enabled=false;this.manager=null}});module.exports=MouseManager}),(function(module,exports,__webpack_require__){var Angle=__webpack_require__(317);var Class=__webpack_require__(0);var Distance=__webpack_require__(53);var FuzzyEqual=__webpack_require__(106);var SmoothStepInterpolation=__webpack_require__(328);var Vector2=__webpack_require__(3);var Pointer=new Class({initialize:function Pointer(manager,id){this.manager=manager;this.id=id;this.event;this.downElement;this.upElement;this.camera=null;this.button=0;this.buttons=0;this.position=new Vector2();this.prevPosition=new Vector2();this.midPoint=new Vector2(-1,-1);this.velocity=new Vector2();this.angle=0;this.distance=0;this.smoothFactor=0;this.motionFactor=0.2;this.worldX=0;this.worldY=0;this.moveTime=0;this.downX=0;this.downY=0;this.downTime=0;this.upX=0;this.upY=0;this.upTime=0;this.primaryDown=false;this.isDown=false;this.wasTouch=false;this.wasCanceled=false;this.movementX=0;this.movementY=0;this.identifier=0;this.pointerId=null;this.active=(id===0)?true:false;this.locked=false;this.deltaX=0;this.deltaY=0;this.deltaZ=0},updateWorldPoint:function(camera){var x=this.x;var y=this.y;if(camera.resolution!==1){x+=camera._x;y+=camera._y}var temp=camera.getWorldPoint(x,y);this.worldX=temp.x;this.worldY=temp.y;return this},positionToCamera:function(camera,output){return camera.getWorldPoint(this.x,this.y,output)},updateMotion:function(){var cx=this.position.x;var cy=this.position.y;var mx=this.midPoint.x;var my=this.midPoint.y;if(cx===mx&&cy===my){return}var vx=SmoothStepInterpolation(this.motionFactor,mx,cx);var vy=SmoothStepInterpolation(this.motionFactor,my,cy);if(FuzzyEqual(vx,cx,0.1)){vx=cx}if(FuzzyEqual(vy,cy,0.1)){vy=cy}this.midPoint.set(vx,vy);var dx=cx-vx;var dy=cy-vy;this.velocity.set(dx,dy);this.angle=Angle(vx,vy,cx,cy);this.distance=Math.sqrt(dx*dx+dy*dy)},up:function(event){if('buttons'in event){this.buttons=event.buttons}this.event=event;this.button=event.button;this.upElement=event.target;this.manager.transformPointer(this,event.pageX,event.pageY,false);if(event.button===0){this.primaryDown=false;this.upX=this.x;this.upY=this.y;this.upTime=event.timeStamp}this.isDown=false;this.wasTouch=false},down:function(event){if('buttons'in event){this.buttons=event.buttons}this.event=event;this.button=event.button;this.downElement=event.target;this.manager.transformPointer(this,event.pageX,event.pageY,false);if(event.button===0){this.primaryDown=true;this.downX=this.x;this.downY=this.y;this.downTime=event.timeStamp}this.isDown=true;this.wasTouch=false},move:function(event){if('buttons'in event){this.buttons=event.buttons}this.event=event;this.manager.transformPointer(this,event.pageX,event.pageY,true);if(this.locked){this.movementX=event.movementX||event.mozMovementX||event.webkitMovementX||0;this.movementY=event.movementY||event.mozMovementY||event.webkitMovementY||0}this.moveTime=event.timeStamp;this.wasTouch=false},wheel:function(event){if('buttons'in event){this.buttons=event.buttons}this.event=event;this.manager.transformPointer(this,event.pageX,event.pageY,false);this.deltaX=event.deltaX;this.deltaY=event.deltaY;this.deltaZ=event.deltaZ;this.wasTouch=false},touchstart:function(touch,event){if(touch['pointerId']){this.pointerId=touch.pointerId}this.identifier=touch.identifier;this.target=touch.target;this.active=true;this.buttons=1;this.event=event;this.downElement=touch.target;this.manager.transformPointer(this,touch.pageX,touch.pageY,false);this.primaryDown=true;this.downX=this.x;this.downY=this.y;this.downTime=event.timeStamp;this.isDown=true;this.wasTouch=true;this.wasCanceled=false;this.updateMotion()},touchmove:function(touch,event){this.event=event;this.manager.transformPointer(this,touch.pageX,touch.pageY,true);this.moveTime=event.timeStamp;this.wasTouch=true;this.updateMotion()},touchend:function(touch,event){this.buttons=0;this.event=event;this.upElement=touch.target;this.manager.transformPointer(this,touch.pageX,touch.pageY,false);this.primaryDown=false;this.upX=this.x;this.upY=this.y;this.upTime=event.timeStamp;this.isDown=false;this.wasTouch=true;this.wasCanceled=false;this.active=false;this.updateMotion()},touchcancel:function(touch,event){this.buttons=0;this.event=event;this.upElement=touch.target;this.manager.transformPointer(this,touch.pageX,touch.pageY,false);this.primaryDown=false;this.upX=this.x;this.upY=this.y;this.upTime=event.timeStamp;this.isDown=false;this.wasTouch=true;this.wasCanceled=true;this.active=false},noButtonDown:function(){return(this.buttons===0)},leftButtonDown:function(){return(this.buttons&1)?true:false},rightButtonDown:function(){return(this.buttons&2)?true:false},middleButtonDown:function(){return(this.buttons&4)?true:false},backButtonDown:function(){return(this.buttons&8)?true:false},forwardButtonDown:function(){return(this.buttons&16)?true:false},leftButtonReleased:function(){return(this.button===0&&!this.isDown)},rightButtonReleased:function(){return(this.button===2&&!this.isDown)},middleButtonReleased:function(){return(this.button===1&&!this.isDown)},backButtonReleased:function(){return(this.button===3&&!this.isDown)},forwardButtonReleased:function(){return(this.button===4&&!this.isDown)},getDistance:function(){if(this.isDown){return Distance(this.downX,this.downY,this.x,this.y)}else{return Distance(this.downX,this.downY,this.upX,this.upY)}},getDistanceX:function(){if(this.isDown){return Math.abs(this.downX-this.x)}else{return Math.abs(this.downX-this.upX)}},getDistanceY:function(){if(this.isDown){return Math.abs(this.downY-this.y)}else{return Math.abs(this.downY-this.upY)}},getDuration:function(){if(this.isDown){return(this.manager.time-this.downTime)}else{return(this.upTime-this.downTime)}},getAngle:function(){if(this.isDown){return Angle(this.downX,this.downY,this.x,this.y)}else{return Angle(this.downX,this.downY,this.upX,this.upY)}},getInterpolatedPosition:function(steps,out){if(steps===undefined){steps=10}if(out===undefined){out=[]}var prevX=this.prevPosition.x;var prevY=this.prevPosition.y;var curX=this.position.x;var curY=this.position.y;for(var i=0;i<steps;i++){var t=(1/steps)*i;out[i]={x:SmoothStepInterpolation(t,prevX,curX),y:SmoothStepInterpolation(t,prevY,curY)}}return out},destroy:function(){this.camera=null;this.manager=null;this.position=null},x:{get:function(){return this.position.x},set:function(value){this.position.x=value}},y:{get:function(){return this.position.y},set:function(value){this.position.y=value}},time:{get:function(){return(this.event)?this.event.timeStamp:0}}});module.exports=Pointer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var InputEvents=__webpack_require__(54);var NOOP=__webpack_require__(1);var TouchManager=new Class({initialize:function TouchManager(inputManager){this.manager=inputManager;this.capture=true;this.enabled=false;this.target;this.onTouchStart=NOOP;this.onTouchStartWindow=NOOP;this.onTouchMove=NOOP;this.onTouchEnd=NOOP;this.onTouchEndWindow=NOOP;this.onTouchCancel=NOOP;this.onTouchCancelWindow=NOOP;this.onTouchOver=NOOP;this.onTouchOut=NOOP;inputManager.events.once(InputEvents.MANAGER_BOOT,this.boot,this)},boot:function(){var config=this.manager.config;this.enabled=config.inputTouch;this.target=config.inputTouchEventTarget;this.capture=config.inputTouchCapture;if(!this.target){this.target=this.manager.game.canvas}if(config.disableContextMenu){this.disableContextMenu()}if(this.enabled&&this.target){this.startListeners()}},disableContextMenu:function(){document.body.addEventListener('contextmenu',function(event){event.preventDefault();return false});return this},startListeners:function(){var _this=this;var canvas=this.manager.canvas;var autoFocus=(window&&window.focus&&this.manager.game.config.autoFocus);this.onTouchStart=function(event){if(autoFocus){window.focus()}if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onTouchStart(event);if(_this.capture&&event.cancelable&&event.target===canvas){event.preventDefault()}}};this.onTouchStartWindow=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&event.target!==canvas){_this.manager.onTouchStart(event)}};this.onTouchMove=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onTouchMove(event);if(_this.capture&&event.cancelable){event.preventDefault()}}};this.onTouchEnd=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onTouchEnd(event);if(_this.capture&&event.cancelable&&event.target===canvas){event.preventDefault()}}};this.onTouchEndWindow=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled&&event.target!==canvas){_this.manager.onTouchEnd(event)}};this.onTouchCancel=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onTouchCancel(event);if(_this.capture){event.preventDefault()}}};this.onTouchCancelWindow=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.onTouchCancel(event)}};this.onTouchOver=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.setCanvasOver(event)}};this.onTouchOut=function(event){if(!event.defaultPrevented&&_this.enabled&&_this.manager&&_this.manager.enabled){_this.manager.setCanvasOut(event)}};var target=this.target;if(!target){return}var passive={passive:true};var nonPassive={passive:false};target.addEventListener('touchstart',this.onTouchStart,(this.capture)?nonPassive:passive);target.addEventListener('touchmove',this.onTouchMove,(this.capture)?nonPassive:passive);target.addEventListener('touchend',this.onTouchEnd,(this.capture)?nonPassive:passive);target.addEventListener('touchcancel',this.onTouchCancel,(this.capture)?nonPassive:passive);target.addEventListener('touchover',this.onTouchOver,(this.capture)?nonPassive:passive);target.addEventListener('touchout',this.onTouchOut,(this.capture)?nonPassive:passive);if(window&&this.manager.game.config.inputWindowEvents){window.addEventListener('touchstart',this.onTouchStartWindow,nonPassive);window.addEventListener('touchend',this.onTouchEndWindow,nonPassive);window.addEventListener('touchcancel',this.onTouchCancelWindow,nonPassive)}this.enabled=true},stopListeners:function(){var target=this.target;target.removeEventListener('touchstart',this.onTouchStart);target.removeEventListener('touchmove',this.onTouchMove);target.removeEventListener('touchend',this.onTouchEnd);target.removeEventListener('touchcancel',this.onTouchCancel);target.removeEventListener('touchover',this.onTouchOver);target.removeEventListener('touchout',this.onTouchOut);if(window){window.removeEventListener('touchstart',this.onTouchStartWindow);window.removeEventListener('touchend',this.onTouchEndWindow)}},destroy:function(){this.stopListeners();this.target=null;this.enabled=false;this.manager=null}});module.exports=TouchManager}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GameEvents=__webpack_require__(20);var EventEmitter=__webpack_require__(10);var FileTypesManager=__webpack_require__(8);var GameObjectCreator=__webpack_require__(16);var GameObjectFactory=__webpack_require__(5);var GetFastValue=__webpack_require__(2);var PluginCache=__webpack_require__(23);var Remove=__webpack_require__(123);var PluginManager=new Class({Extends:EventEmitter,initialize:function PluginManager(game){EventEmitter.call(this);this.game=game;this.plugins=[];this.scenePlugins=[];this._pendingGlobal=[];this._pendingScene=[];if(game.isBooted){this.boot()}else{game.events.once(GameEvents.BOOT,this.boot,this)}},boot:function(){var i;var entry;var key;var plugin;var start;var mapping;var data;var config=this.game.config;var list=config.installGlobalPlugins;list=list.concat(this._pendingGlobal);for(i=0;i<list.length;i++){entry=list[i];key=GetFastValue(entry,'key',null);plugin=GetFastValue(entry,'plugin',null);start=GetFastValue(entry,'start',false);mapping=GetFastValue(entry,'mapping',null);data=GetFastValue(entry,'data',null);if(key){if(plugin){this.install(key,plugin,start,mapping,data)}else{console.warn('Missing `plugin` for key: '+key)}}}list=config.installScenePlugins;list=list.concat(this._pendingScene);for(i=0;i<list.length;i++){entry=list[i];key=GetFastValue(entry,'key',null);plugin=GetFastValue(entry,'plugin',null);mapping=GetFastValue(entry,'mapping',null);if(key){if(plugin){this.installScenePlugin(key,plugin,mapping)}else{console.warn('Missing `plugin` for key: '+key)}}}this._pendingGlobal=[];this._pendingScene=[];this.game.events.once(GameEvents.DESTROY,this.destroy,this)},addToScene:function(sys,globalPlugins,scenePlugins){var i;var pluginKey;var pluginList;var game=this.game;var scene=sys.scene;var map=sys.settings.map;var isBooted=sys.settings.isBooted;for(i=0;i<globalPlugins.length;i++){pluginKey=globalPlugins[i];if(game[pluginKey]){sys[pluginKey]=game[pluginKey];if(map.hasOwnProperty(pluginKey)){scene[map[pluginKey]]=sys[pluginKey]}}else if(pluginKey==='game'&&map.hasOwnProperty(pluginKey)){scene[map[pluginKey]]=game}}for(var s=0;s<scenePlugins.length;s++){pluginList=scenePlugins[s];for(i=0;i<pluginList.length;i++){pluginKey=pluginList[i];if(!PluginCache.hasCore(pluginKey)){continue}var source=PluginCache.getCore(pluginKey);var plugin=new source.plugin(scene,this);sys[source.mapping]=plugin;if(source.custom){scene[source.mapping]=plugin}else if(map.hasOwnProperty(source.mapping)){scene[map[source.mapping]]=plugin}if(isBooted){plugin.boot()}}}pluginList=this.plugins;for(i=0;i<pluginList.length;i++){var entry=pluginList[i];if(entry.mapping){scene[entry.mapping]=entry.plugin}}},getDefaultScenePlugins:function(){var list=this.game.config.defaultPlugins;list=list.concat(this.scenePlugins);return list},installScenePlugin:function(key,plugin,mapping,addToScene,fromLoader){if(fromLoader===undefined){fromLoader=false}if(typeof plugin!=='function'){console.warn('Invalid Scene Plugin: '+key);return}if(!PluginCache.hasCore(key)){PluginCache.register(key,plugin,mapping,true);this.scenePlugins.push(key)}else if(!fromLoader&&PluginCache.hasCore(key)){console.warn('Scene Plugin key in use: '+key);return}if(addToScene){var instance=new plugin(addToScene,this);addToScene.sys[key]=instance;if(mapping&&mapping!==''){addToScene[mapping]=instance}instance.boot()}},install:function(key,plugin,start,mapping,data){if(start===undefined){start=false}if(mapping===undefined){mapping=null}if(data===undefined){data=null}if(typeof plugin!=='function'){console.warn('Invalid Plugin: '+key);return null}if(PluginCache.hasCustom(key)){console.warn('Plugin key in use: '+key);return null}if(mapping!==null){start=true}if(!this.game.isBooted){this._pendingGlobal.push({key:key,plugin:plugin,start:start,mapping:mapping,data:data})}else{PluginCache.registerCustom(key,plugin,mapping,data);if(start){return this.start(key)}}return null},getIndex:function(key){var list=this.plugins;for(var i=0;i<list.length;i++){var entry=list[i];if(entry.key===key){return i}}return-1},getEntry:function(key){var idx=this.getIndex(key);if(idx!==-1){return this.plugins[idx]}},isActive:function(key){var entry=this.getEntry(key);return(entry&&entry.active)},start:function(key,runAs){if(runAs===undefined){runAs=key}var entry=this.getEntry(runAs);if(entry&&!entry.active){entry.active=true;entry.plugin.start()}else if(!entry){entry=this.createEntry(key,runAs)}return(entry)?entry.plugin:null},createEntry:function(key,runAs){var entry=PluginCache.getCustom(key);if(entry){var instance=new entry.plugin(this);entry={key:runAs,plugin:instance,active:true,mapping:entry.mapping,data:entry.data};this.plugins.push(entry);instance.init(entry.data);instance.start()}return entry},stop:function(key){var entry=this.getEntry(key);if(entry&&entry.active){entry.active=false;entry.plugin.stop()}return this},get:function(key,autoStart){if(autoStart===undefined){autoStart=true}var entry=this.getEntry(key);if(entry){return entry.plugin}else{var plugin=this.getClass(key);if(plugin&&autoStart){entry=this.createEntry(key,key);return(entry)?entry.plugin:null}else if(plugin){return plugin}}return null},getClass:function(key){return PluginCache.getCustomClass(key)},removeGlobalPlugin:function(key){var entry=this.getEntry(key);if(entry){Remove(this.plugins,entry)}PluginCache.removeCustom(key)},removeScenePlugin:function(key){Remove(this.scenePlugins,key);PluginCache.remove(key)},registerGameObject:function(key,factoryCallback,creatorCallback){if(factoryCallback){GameObjectFactory.register(key,factoryCallback)}if(creatorCallback){GameObjectCreator.register(key,creatorCallback)}return this},removeGameObject:function(key,removeFromFactory,removeFromCreator){if(removeFromFactory===undefined){removeFromFactory=true}if(removeFromCreator===undefined){removeFromCreator=true}if(removeFromFactory){GameObjectFactory.remove(key)}if(removeFromCreator){GameObjectCreator.remove(key)}return this},registerFileType:function(key,callback,addToScene){FileTypesManager.register(key,callback);if(addToScene&&addToScene.sys.load){addToScene.sys.load[key]=callback}},destroy:function(){for(var i=0;i<this.plugins.length;i++){this.plugins[i].plugin.destroy()}PluginCache.destroyCustomPlugins();if(this.game.noReturn){PluginCache.destroyCorePlugins()}this.game=null;this.plugins=[];this.scenePlugins=[]}});module.exports=PluginManager}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(177);var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(92);var GameEvents=__webpack_require__(20);var GetInnerHeight=__webpack_require__(869);var GetTarget=__webpack_require__(363);var GetScreenOrientation=__webpack_require__(358);var NOOP=__webpack_require__(1);var Rectangle=__webpack_require__(11);var Size=__webpack_require__(372);var SnapFloor=__webpack_require__(93);var Vector2=__webpack_require__(3);var ScaleManager=new Class({Extends:EventEmitter,initialize:function ScaleManager(game){EventEmitter.call(this);this.game=game;this.canvas;this.canvasBounds=new Rectangle();this.parent=null;this.parentIsWindow=false;this.parentSize=new Size();this.gameSize=new Size();this.baseSize=new Size();this.displaySize=new Size();this.scaleMode=CONST.SCALE_MODE.NONE;this.resolution=1;this.zoom=1;this._resetZoom=false;this.displayScale=new Vector2(1,1);this.autoRound=false;this.autoCenter=CONST.CENTER.NO_CENTER;this.orientation=CONST.ORIENTATION.LANDSCAPE;this.fullscreen;this.fullscreenTarget=null;this._createdFullscreenTarget=false;this.dirty=false;this.resizeInterval=500;this._lastCheck=0;this._checkOrientation=false;this.listeners={orientationChange:NOOP,windowResize:NOOP,fullScreenChange:NOOP,fullScreenError:NOOP}},preBoot:function(){this.parseConfig(this.game.config);this.game.events.once('boot',this.boot,this)},boot:function(){var game=this.game;this.canvas=game.canvas;this.fullscreen=game.device.fullscreen;if(this.scaleMode!==CONST.SCALE_MODE.RESIZE){this.displaySize.setAspectMode(this.scaleMode)}if(this.scaleMode===CONST.SCALE_MODE.NONE){this.resize(this.width,this.height)}else{this.getParentBounds();if(this.parentSize.width>0&&this.parentSize.height>0){this.displaySize.setParent(this.parentSize)}this.refresh()}game.events.on(GameEvents.PRE_STEP,this.step,this);game.events.once(GameEvents.DESTROY,this.destroy,this);this.startListeners()},parseConfig:function(config){this.getParent(config);this.getParentBounds();var width=config.width;var height=config.height;var scaleMode=config.scaleMode;var resolution=config.resolution;var zoom=config.zoom;var autoRound=config.autoRound;if(typeof width==='string'){var parentWidth=this.parentSize.width;if(parentWidth===0){parentWidth=window.innerWidth}var parentScaleX=parseInt(width,10)/100;width=Math.floor(parentWidth*parentScaleX)}if(typeof height==='string'){var parentHeight=this.parentSize.height;if(parentHeight===0){parentHeight=window.innerHeight}var parentScaleY=parseInt(height,10)/100;height=Math.floor(parentHeight*parentScaleY)}this.resolution=1;this.scaleMode=scaleMode;this.autoRound=autoRound;this.autoCenter=config.autoCenter;this.resizeInterval=config.resizeInterval;if(autoRound){width=Math.floor(width);height=Math.floor(height)}this.gameSize.setSize(width,height);if(zoom===CONST.ZOOM.MAX_ZOOM){zoom=this.getMaxZoom()}this.zoom=zoom;if(zoom!==1){this._resetZoom=true}this.baseSize.setSize(width*resolution,height*resolution);if(autoRound){this.baseSize.width=Math.floor(this.baseSize.width);this.baseSize.height=Math.floor(this.baseSize.height)}if(config.minWidth>0){this.displaySize.setMin(config.minWidth*zoom,config.minHeight*zoom)}if(config.maxWidth>0){this.displaySize.setMax(config.maxWidth*zoom,config.maxHeight*zoom)}this.displaySize.setSize(width,height);this.orientation=GetScreenOrientation(width,height)},getParent:function(config){var parent=config.parent;if(parent===null){return}this.parent=GetTarget(parent);this.parentIsWindow=(this.parent===document.body);if(config.expandParent&&config.scaleMode!==CONST.SCALE_MODE.NONE){var DOMRect=this.parent.getBoundingClientRect();if(this.parentIsWindow||DOMRect.height===0){document.documentElement.style.height='100%';document.body.style.height='100%';DOMRect=this.parent.getBoundingClientRect();if(!this.parentIsWindow&&DOMRect.height===0){this.parent.style.overflow='hidden';this.parent.style.width='100%';this.parent.style.height='100%'}}}if(config.fullscreenTarget&&!this.fullscreenTarget){this.fullscreenTarget=GetTarget(config.fullscreenTarget)}},getParentBounds:function(){if(!this.parent){return false}var parentSize=this.parentSize;var DOMRect=this.parent.getBoundingClientRect();if(this.parentIsWindow&&this.game.device.os.iOS){DOMRect.height=GetInnerHeight(true)}var resolution=this.resolution;var newWidth=DOMRect.width*resolution;var newHeight=DOMRect.height*resolution;if(parentSize.width!==newWidth||parentSize.height!==newHeight){parentSize.setSize(newWidth,newHeight);return true}else{return false}},lockOrientation:function(orientation){var lock=screen.lockOrientation||screen.mozLockOrientation||screen.msLockOrientation;if(lock){return lock.call(screen,orientation)}return false},setParentSize:function(width,height){this.parentSize.setSize(width,height);return this.refresh()},setGameSize:function(width,height){var autoRound=this.autoRound;var resolution=this.resolution;if(autoRound){width=Math.floor(width);height=Math.floor(height)}var previousWidth=this.width;var previousHeight=this.height;this.gameSize.resize(width,height);this.baseSize.resize(width*resolution,height*resolution);if(autoRound){this.baseSize.width=Math.floor(this.baseSize.width);this.baseSize.height=Math.floor(this.baseSize.height)}this.displaySize.setAspectRatio(width/height);this.canvas.width=this.baseSize.width;this.canvas.height=this.baseSize.height;return this.refresh(previousWidth,previousHeight)},resize:function(width,height){var zoom=this.zoom;var resolution=this.resolution;var autoRound=this.autoRound;if(autoRound){width=Math.floor(width);height=Math.floor(height)}var previousWidth=this.width;var previousHeight=this.height;this.gameSize.resize(width,height);this.baseSize.resize(width*resolution,height*resolution);if(autoRound){this.baseSize.width=Math.floor(this.baseSize.width);this.baseSize.height=Math.floor(this.baseSize.height)}this.displaySize.setSize((width*zoom)*resolution,(height*zoom)*resolution);this.canvas.width=this.baseSize.width;this.canvas.height=this.baseSize.height;var style=this.canvas.style;var styleWidth=width*zoom;var styleHeight=height*zoom;if(autoRound){styleWidth=Math.floor(styleWidth);styleHeight=Math.floor(styleHeight)}if(styleWidth!==width||styleHeight!==height){style.width=styleWidth+'px';style.height=styleHeight+'px'}return this.refresh(previousWidth,previousHeight)},setZoom:function(value){this.zoom=value;this._resetZoom=true;return this.refresh()},setMaxZoom:function(){this.zoom=this.getMaxZoom();this._resetZoom=true;return this.refresh()},refresh:function(previousWidth,previousHeight){if(previousWidth===undefined){previousWidth=this.width}if(previousHeight===undefined){previousHeight=this.height}this.updateScale();this.updateBounds();this.updateOrientation();this.displayScale.set(this.baseSize.width/this.canvasBounds.width,this.baseSize.height/this.canvasBounds.height);var domContainer=this.game.domContainer;if(domContainer){this.baseSize.setCSS(domContainer);var canvasStyle=this.canvas.style;var domStyle=domContainer.style;domStyle.transform='scale('+this.displaySize.width/this.baseSize.width+','+this.displaySize.height/this.baseSize.height+')';domStyle.marginLeft=canvasStyle.marginLeft;domStyle.marginTop=canvasStyle.marginTop}this.emit(Events.RESIZE,this.gameSize,this.baseSize,this.displaySize,this.resolution,previousWidth,previousHeight);return this},updateOrientation:function(){if(this._checkOrientation){this._checkOrientation=false;var newOrientation=GetScreenOrientation(this.width,this.height);if(newOrientation!==this.orientation){this.orientation=newOrientation;this.emit(Events.ORIENTATION_CHANGE,newOrientation)}}},updateScale:function(){var style=this.canvas.style;var width=this.gameSize.width;var height=this.gameSize.height;var styleWidth;var styleHeight;var zoom=this.zoom;var autoRound=this.autoRound;var resolution=1;if(this.scaleMode===CONST.SCALE_MODE.NONE){this.displaySize.setSize((width*zoom)*resolution,(height*zoom)*resolution);styleWidth=this.displaySize.width/resolution;styleHeight=this.displaySize.height/resolution;if(autoRound){styleWidth=Math.floor(styleWidth);styleHeight=Math.floor(styleHeight)}if(this._resetZoom){style.width=styleWidth+'px';style.height=styleHeight+'px';this._resetZoom=false}}else if(this.scaleMode===CONST.SCALE_MODE.RESIZE){this.displaySize.setSize(this.parentSize.width,this.parentSize.height);this.gameSize.setSize(this.displaySize.width,this.displaySize.height);this.baseSize.setSize(this.displaySize.width*resolution,this.displaySize.height*resolution);styleWidth=this.displaySize.width/resolution;styleHeight=this.displaySize.height/resolution;if(autoRound){styleWidth=Math.floor(styleWidth);styleHeight=Math.floor(styleHeight)}this.canvas.width=styleWidth;this.canvas.height=styleHeight}else{this.displaySize.setSize(this.parentSize.width,this.parentSize.height);styleWidth=this.displaySize.width/resolution;styleHeight=this.displaySize.height/resolution;if(autoRound){styleWidth=Math.floor(styleWidth);styleHeight=Math.floor(styleHeight)}style.width=styleWidth+'px';style.height=styleHeight+'px'}this.getParentBounds();this.updateCenter()},getMaxZoom:function(){var zoomH=SnapFloor(this.parentSize.width,this.gameSize.width,0,true);var zoomV=SnapFloor(this.parentSize.height,this.gameSize.height,0,true);return Math.max(Math.min(zoomH,zoomV),1)},updateCenter:function(){var autoCenter=this.autoCenter;if(autoCenter===CONST.CENTER.NO_CENTER){return}var canvas=this.canvas;var style=canvas.style;var bounds=canvas.getBoundingClientRect();var width=bounds.width;var height=bounds.height;var offsetX=Math.floor((this.parentSize.width-width)/2);var offsetY=Math.floor((this.parentSize.height-height)/2);if(autoCenter===CONST.CENTER.CENTER_HORIZONTALLY){offsetY=0}else if(autoCenter===CONST.CENTER.CENTER_VERTICALLY){offsetX=0}style.marginLeft=offsetX+'px';style.marginTop=offsetY+'px'},updateBounds:function(){var bounds=this.canvasBounds;var clientRect=this.canvas.getBoundingClientRect();bounds.x=clientRect.left+(window.pageXOffset||0)-(document.documentElement.clientLeft||0);bounds.y=clientRect.top+(window.pageYOffset||0)-(document.documentElement.clientTop||0);bounds.width=clientRect.width;bounds.height=clientRect.height},transformX:function(pageX){return(pageX-this.canvasBounds.left)*this.displayScale.x},transformY:function(pageY){return(pageY-this.canvasBounds.top)*this.displayScale.y},startFullscreen:function(fullscreenOptions){if(fullscreenOptions===undefined){fullscreenOptions={navigationUI:'hide'}}var fullscreen=this.fullscreen;if(!fullscreen.available){this.emit(Events.FULLSCREEN_UNSUPPORTED);return}if(!fullscreen.active){var fsTarget=this.getFullscreenTarget();if(fullscreen.keyboard){fsTarget[fullscreen.request](Element.ALLOW_KEYBOARD_INPUT)}else{fsTarget[fullscreen.request](fullscreenOptions)}}},fullscreenSuccessHandler:function(){this.getParentBounds();this.refresh();this.emit(Events.ENTER_FULLSCREEN)},fullscreenErrorHandler:function(error){this.removeFullscreenTarget();this.emit(Events.FULLSCREEN_FAILED,error)},getFullscreenTarget:function(){if(!this.fullscreenTarget){var fsTarget=document.createElement('div');fsTarget.style.margin='0';fsTarget.style.padding='0';fsTarget.style.width='100%';fsTarget.style.height='100%';this.fullscreenTarget=fsTarget;this._createdFullscreenTarget=true}if(this._createdFullscreenTarget){var canvasParent=this.canvas.parentNode;canvasParent.insertBefore(this.fullscreenTarget,this.canvas);this.fullscreenTarget.appendChild(this.canvas)}return this.fullscreenTarget},removeFullscreenTarget:function(){if(this._createdFullscreenTarget){var fsTarget=this.fullscreenTarget;if(fsTarget&&fsTarget.parentNode){var parent=fsTarget.parentNode;parent.insertBefore(this.canvas,fsTarget);parent.removeChild(fsTarget)}}},stopFullscreen:function(){var fullscreen=this.fullscreen;if(!fullscreen.available){this.emit(Events.FULLSCREEN_UNSUPPORTED);return false}if(fullscreen.active){document[fullscreen.cancel]()}this.removeFullscreenTarget();this.getParentBounds();this.emit(Events.LEAVE_FULLSCREEN);this.refresh()},toggleFullscreen:function(fullscreenOptions){if(this.fullscreen.active){this.stopFullscreen()}else{this.startFullscreen(fullscreenOptions)}},startListeners:function(){var _this=this;var listeners=this.listeners;listeners.orientationChange=function(){_this._checkOrientation=true;_this.dirty=true};listeners.windowResize=function(){_this.dirty=true};window.addEventListener('orientationchange',listeners.orientationChange,false);window.addEventListener('resize',listeners.windowResize,false);if(this.fullscreen.available){listeners.fullScreenChange=function(event){return _this.onFullScreenChange(event)};listeners.fullScreenError=function(event){return _this.onFullScreenError(event)};var vendors=['webkit','moz',''];vendors.forEach(function(prefix){document.addEventListener(prefix+'fullscreenchange',listeners.fullScreenChange,false);document.addEventListener(prefix+'fullscreenerror',listeners.fullScreenError,false)});document.addEventListener('MSFullscreenChange',listeners.fullScreenChange,false);document.addEventListener('MSFullscreenError',listeners.fullScreenError,false)}},onFullScreenChange:function(){if(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullScreenElement){this.fullscreenSuccessHandler()}else{this.stopFullscreen()}},onFullScreenError:function(){this.removeFullscreenTarget()},step:function(time,delta){if(!this.parent){return}this._lastCheck+=delta;if(this.dirty||this._lastCheck>this.resizeInterval){if(this.getParentBounds()){this.refresh()}this.dirty=false;this._lastCheck=0}},stopListeners:function(){var listeners=this.listeners;window.removeEventListener('orientationchange',listeners.orientationChange,false);window.removeEventListener('resize',listeners.windowResize,false);var vendors=['webkit','moz',''];vendors.forEach(function(prefix){document.removeEventListener(prefix+'fullscreenchange',listeners.fullScreenChange,false);document.removeEventListener(prefix+'fullscreenerror',listeners.fullScreenError,false)});document.removeEventListener('MSFullscreenChange',listeners.fullScreenChange,false);document.removeEventListener('MSFullscreenError',listeners.fullScreenError,false)},destroy:function(){this.removeAllListeners();this.stopListeners();this.game=null;this.canvas=null;this.canvasBounds=null;this.parent=null;this.fullscreenTarget=null;this.parentSize.destroy();this.gameSize.destroy();this.baseSize.destroy();this.displaySize.destroy()},isFullscreen:{get:function(){return this.fullscreen.active}},width:{get:function(){return this.gameSize.width}},height:{get:function(){return this.gameSize.height}},isPortrait:{get:function(){return(this.orientation===CONST.ORIENTATION.PORTRAIT)}},isLandscape:{get:function(){return(this.orientation===CONST.ORIENTATION.LANDSCAPE)}},isGamePortrait:{get:function(){return(this.height>this.width)}},isGameLandscape:{get:function(){return(this.width>this.height)}}});module.exports=ScaleManager}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var SnapFloor=__webpack_require__(93);var Vector2=__webpack_require__(3);var Size=new Class({initialize:function Size(width,height,aspectMode,parent){if(width===undefined){width=0}if(height===undefined){height=width}if(aspectMode===undefined){aspectMode=0}if(parent===undefined){parent=null}this._width=width;this._height=height;this._parent=parent;this.aspectMode=aspectMode;this.aspectRatio=(height===0)?1:width/height;this.minWidth=0;this.minHeight=0;this.maxWidth=Number.MAX_VALUE;this.maxHeight=Number.MAX_VALUE;this.snapTo=new Vector2()},setAspectMode:function(value){if(value===undefined){value=0}this.aspectMode=value;return this.setSize(this._width,this._height)},setSnap:function(snapWidth,snapHeight){if(snapWidth===undefined){snapWidth=0}if(snapHeight===undefined){snapHeight=snapWidth}this.snapTo.set(snapWidth,snapHeight);return this.setSize(this._width,this._height)},setParent:function(parent){this._parent=parent;return this.setSize(this._width,this._height)},setMin:function(width,height){if(width===undefined){width=0}if(height===undefined){height=width}this.minWidth=Clamp(width,0,this.maxWidth);this.minHeight=Clamp(height,0,this.maxHeight);return this.setSize(this._width,this._height)},setMax:function(width,height){if(width===undefined){width=Number.MAX_VALUE}if(height===undefined){height=width}this.maxWidth=Clamp(width,this.minWidth,Number.MAX_VALUE);this.maxHeight=Clamp(height,this.minHeight,Number.MAX_VALUE);return this.setSize(this._width,this._height)},setSize:function(width,height){if(width===undefined){width=0}if(height===undefined){height=width}switch(this.aspectMode){case Size.NONE:this._width=this.getNewWidth(SnapFloor(width,this.snapTo.x));this._height=this.getNewHeight(SnapFloor(height,this.snapTo.y));this.aspectRatio=(this._height===0)?1:this._width/this._height;break;case Size.WIDTH_CONTROLS_HEIGHT:this._width=this.getNewWidth(SnapFloor(width,this.snapTo.x));this._height=this.getNewHeight(this._width*(1/this.aspectRatio),false);break;case Size.HEIGHT_CONTROLS_WIDTH:this._height=this.getNewHeight(SnapFloor(height,this.snapTo.y));this._width=this.getNewWidth(this._height*this.aspectRatio,false);break;case Size.FIT:this.constrain(width,height,true);break;case Size.ENVELOP:this.constrain(width,height,false);break}return this},setAspectRatio:function(ratio){this.aspectRatio=ratio;return this.setSize(this._width,this._height)},resize:function(width,height){this._width=this.getNewWidth(SnapFloor(width,this.snapTo.x));this._height=this.getNewHeight(SnapFloor(height,this.snapTo.y));this.aspectRatio=(this._height===0)?1:this._width/this._height;return this},getNewWidth:function(value,checkParent){if(checkParent===undefined){checkParent=true}value=Clamp(value,this.minWidth,this.maxWidth);if(checkParent&&this._parent&&value>this._parent.width){value=Math.max(this.minWidth,this._parent.width)}return value},getNewHeight:function(value,checkParent){if(checkParent===undefined){checkParent=true}value=Clamp(value,this.minHeight,this.maxHeight);if(checkParent&&this._parent&&value>this._parent.height){value=Math.max(this.minHeight,this._parent.height)}return value},constrain:function(width,height,fit){if(width===undefined){width=0}if(height===undefined){height=width}if(fit===undefined){fit=true}width=this.getNewWidth(width);height=this.getNewHeight(height);var snap=this.snapTo;var newRatio=(height===0)?1:width/height;if((fit&&this.aspectRatio>newRatio)||(!fit&&this.aspectRatio<newRatio)){width=SnapFloor(width,snap.x);height=width/this.aspectRatio;if(snap.y>0){height=SnapFloor(height,snap.y);width=height*this.aspectRatio}}else if((fit&&this.aspectRatio<newRatio)||(!fit&&this.aspectRatio>newRatio)){height=SnapFloor(height,snap.y);width=height*this.aspectRatio;if(snap.x>0){width=SnapFloor(width,snap.x);height=width*(1/this.aspectRatio)}}this._width=width;this._height=height;return this},fitTo:function(width,height){return this.constrain(width,height,true)},envelop:function(width,height){return this.constrain(width,height,false)},setWidth:function(value){return this.setSize(value,this._height)},setHeight:function(value){return this.setSize(this._width,value)},toString:function(){return'[{ Size (width='+this._width+' height='+this._height+' aspectRatio='+this.aspectRatio+' aspectMode='+this.aspectMode+') }]'},setCSS:function(element){if(element&&element.style){element.style.width=this._width+'px';element.style.height=this._height+'px'}},copy:function(destination){destination.setAspectMode(this.aspectMode);destination.aspectRatio=this.aspectRatio;return destination.setSize(this.width,this.height)},destroy:function(){this._parent=null;this.snapTo=null},width:{get:function(){return this._width},set:function(value){this.setSize(value,this._height)}},height:{get:function(){return this._height},set:function(value){this.setSize(this._width,value)}}});Size.NONE=0;Size.WIDTH_CONTROLS_HEIGHT=1;Size.HEIGHT_CONTROLS_WIDTH=2;Size.FIT=3;Size.ENVELOP=4;module.exports=Size}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(125);var Events=__webpack_require__(22);var GameEvents=__webpack_require__(20);var GetValue=__webpack_require__(6);var LoaderEvents=__webpack_require__(82);var NOOP=__webpack_require__(1);var Scene=__webpack_require__(374);var Systems=__webpack_require__(180);var SceneManager=new Class({initialize:function SceneManager(game,sceneConfig){this.game=game;this.keys={};this.scenes=[];this._pending=[];this._start=[];this._queue=[];this._data={};this.isProcessing=false;this.isBooted=false;this.customViewports=0;if(sceneConfig){if(!Array.isArray(sceneConfig)){sceneConfig=[sceneConfig]}for(var i=0;i<sceneConfig.length;i++){this._pending.push({key:'default',scene:sceneConfig[i],autoStart:(i===0),data:{}})}}game.events.once(GameEvents.READY,this.bootQueue,this)},bootQueue:function(){if(this.isBooted){return}var i;var entry;var key;var sceneConfig;for(i=0;i<this._pending.length;i++){entry=this._pending[i];key=entry.key;sceneConfig=entry.scene;var newScene;if(sceneConfig instanceof Scene){newScene=this.createSceneFromInstance(key,sceneConfig)}else if(typeof sceneConfig==='object'){newScene=this.createSceneFromObject(key,sceneConfig)}else if(typeof sceneConfig==='function'){newScene=this.createSceneFromFunction(key,sceneConfig)}key=newScene.sys.settings.key;this.keys[key]=newScene;this.scenes.push(newScene);if(this._data[key]){newScene.sys.settings.data=this._data[key].data;if(this._data[key].autoStart){entry.autoStart=true}}if(entry.autoStart||newScene.sys.settings.active){this._start.push(key)}}this._pending.length=0;this._data={};this.isBooted=true;for(i=0;i<this._start.length;i++){entry=this._start[i];this.start(entry)}this._start.length=0},processQueue:function(){var pendingLength=this._pending.length;var queueLength=this._queue.length;if(pendingLength===0&&queueLength===0){return}var i;var entry;if(pendingLength){for(i=0;i<pendingLength;i++){entry=this._pending[i];this.add(entry.key,entry.scene,entry.autoStart,entry.data)}for(i=0;i<this._start.length;i++){entry=this._start[i];this.start(entry)}this._start.length=0;this._pending.length=0;return}for(i=0;i<this._queue.length;i++){entry=this._queue[i];this[entry.op](entry.keyA,entry.keyB)}this._queue.length=0},add:function(key,sceneConfig,autoStart,data){if(autoStart===undefined){autoStart=false}if(data===undefined){data={}}if(this.isProcessing||!this.isBooted){this._pending.push({key:key,scene:sceneConfig,autoStart:autoStart,data:data});if(!this.isBooted){this._data[key]={data:data}}return null}key=this.getKey(key,sceneConfig);var newScene;if(sceneConfig instanceof Scene){newScene=this.createSceneFromInstance(key,sceneConfig)}else if(typeof sceneConfig==='object'){sceneConfig.key=key;newScene=this.createSceneFromObject(key,sceneConfig)}else if(typeof sceneConfig==='function'){newScene=this.createSceneFromFunction(key,sceneConfig)}newScene.sys.settings.data=data;key=newScene.sys.settings.key;this.keys[key]=newScene;this.scenes.push(newScene);if(autoStart||newScene.sys.settings.active){if(this._pending.length){this._start.push(key)}else{this.start(key)}}return newScene},remove:function(key){if(this.isProcessing){this._queue.push({op:'remove',keyA:key,keyB:null})}else{var sceneToRemove=this.getScene(key);if(!sceneToRemove||sceneToRemove.sys.isTransitioning()){return this}var index=this.scenes.indexOf(sceneToRemove);var sceneKey=sceneToRemove.sys.settings.key;if(index>-1){delete this.keys[sceneKey];this.scenes.splice(index,1);if(this._start.indexOf(sceneKey)>-1){index=this._start.indexOf(sceneKey);this._start.splice(index,1)}sceneToRemove.sys.destroy()}}return this},bootScene:function(scene){var sys=scene.sys;var settings=sys.settings;sys.sceneUpdate=NOOP;if(scene.init){scene.init.call(scene,settings.data);settings.status=CONST.INIT;if(settings.isTransition){sys.events.emit(Events.TRANSITION_INIT,settings.transitionFrom,settings.transitionDuration)}}var loader;if(sys.load){loader=sys.load;loader.reset()}if(loader&&scene.preload){scene.preload.call(scene);if(loader.list.size===0){this.create(scene)}else{settings.status=CONST.LOADING;loader.once(LoaderEvents.COMPLETE,this.loadComplete,this);loader.start()}}else{this.create(scene)}},loadComplete:function(loader){var scene=loader.scene;if(this.game.sound&&this.game.sound.onBlurPausedSounds){this.game.sound.unlock()}this.create(scene)},payloadComplete:function(loader){this.bootScene(loader.scene)},update:function(time,delta){this.processQueue();this.isProcessing=true;for(var i=this.scenes.length-1;i>=0;i--){var sys=this.scenes[i].sys;if(sys.settings.status>CONST.START&&sys.settings.status<=CONST.RUNNING){sys.step(time,delta)}}},render:function(renderer){for(var i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys;if(sys.settings.visible&&sys.settings.status>=CONST.LOADING&&sys.settings.status<CONST.SLEEPING){sys.render(renderer)}}this.isProcessing=false},create:function(scene){var sys=scene.sys;var settings=sys.settings;if(scene.create){settings.status=CONST.CREATING;scene.create.call(scene,settings.data);if(settings.status===CONST.DESTROYED){return}}if(settings.isTransition){sys.events.emit(Events.TRANSITION_START,settings.transitionFrom,settings.transitionDuration)}if(scene.update){sys.sceneUpdate=scene.update}settings.status=CONST.RUNNING;sys.events.emit(Events.CREATE,scene)},createSceneFromFunction:function(key,scene){var newScene=new scene();if(newScene instanceof Scene){var configKey=newScene.sys.settings.key;if(configKey!==''){key=configKey}if(this.keys.hasOwnProperty(key)){throw new Error('Cannot add a Scene with duplicate key: '+key)}return this.createSceneFromInstance(key,newScene)}else{newScene.sys=new Systems(newScene);newScene.sys.settings.key=key;newScene.sys.init(this.game);return newScene}},createSceneFromInstance:function(key,newScene){var configKey=newScene.sys.settings.key;if(configKey===''){newScene.sys.settings.key=key}newScene.sys.init(this.game);return newScene},createSceneFromObject:function(key,sceneConfig){var newScene=new Scene(sceneConfig);var configKey=newScene.sys.settings.key;if(configKey!==''){key=configKey}else{newScene.sys.settings.key=key}newScene.sys.init(this.game);var defaults=['init','preload','create','update','render'];for(var i=0;i<defaults.length;i++){var sceneCallback=GetValue(sceneConfig,defaults[i],null);if(sceneCallback){newScene[defaults[i]]=sceneCallback}}if(sceneConfig.hasOwnProperty('extend')){for(var propertyKey in sceneConfig.extend){if(!sceneConfig.extend.hasOwnProperty(propertyKey)){continue}var value=sceneConfig.extend[propertyKey];if(propertyKey==='data'&&newScene.hasOwnProperty('data')&&typeof value==='object'){newScene.data.merge(value)}else if(propertyKey!=='sys'){newScene[propertyKey]=value}}}return newScene},getKey:function(key,sceneConfig){if(!key){key='default'}if(typeof sceneConfig==='function'){return key}else if(sceneConfig instanceof Scene){key=sceneConfig.sys.settings.key}else if(typeof sceneConfig==='object'&&sceneConfig.hasOwnProperty('key')){key=sceneConfig.key}if(this.keys.hasOwnProperty(key)){throw new Error('Cannot add a Scene with duplicate key: '+key)}else{return key}},getScenes:function(isActive,inReverse){if(isActive===undefined){isActive=true}if(inReverse===undefined){inReverse=false}var out=[];var scenes=this.scenes;for(var i=0;i<scenes.length;i++){var scene=scenes[i];if(scene&&(!isActive||(isActive&&scene.sys.isActive()))){out.push(scene)}}return(inReverse)?out.reverse():out},getScene:function(key){if(typeof key==='string'){if(this.keys[key]){return this.keys[key]}}else{for(var i=0;i<this.scenes.length;i++){if(key===this.scenes[i]){return key}}}return null},isActive:function(key){var scene=this.getScene(key);if(scene){return scene.sys.isActive()}return null},isPaused:function(key){var scene=this.getScene(key);if(scene){return scene.sys.isPaused()}return null},isVisible:function(key){var scene=this.getScene(key);if(scene){return scene.sys.isVisible()}return null},isSleeping:function(key){var scene=this.getScene(key);if(scene){return scene.sys.isSleeping()}return null},pause:function(key,data){var scene=this.getScene(key);if(scene){scene.sys.pause(data)}return this},resume:function(key,data){var scene=this.getScene(key);if(scene){scene.sys.resume(data)}return this},sleep:function(key,data){var scene=this.getScene(key);if(scene&&!scene.sys.isTransitioning()){scene.sys.sleep(data)}return this},wake:function(key,data){var scene=this.getScene(key);if(scene){scene.sys.wake(data)}return this},run:function(key,data){var scene=this.getScene(key);if(!scene){for(var i=0;i<this._pending.length;i++){if(this._pending[i].key===key){this.queueOp('start',key,data);break}}return this}if(scene.sys.isSleeping()){scene.sys.wake(data)}else if(scene.sys.isPaused()){scene.sys.resume(data)}else{this.start(key,data)}},start:function(key,data){if(!this.isBooted){this._data[key]={autoStart:true,data:data};return this}var scene=this.getScene(key);if(scene){if(scene.sys.isActive()||scene.sys.isPaused()){scene.sys.shutdown();scene.sys.start(data)}else{scene.sys.start(data);var loader;if(scene.sys.load){loader=scene.sys.load}if(loader&&scene.sys.settings.hasOwnProperty('pack')){loader.reset();if(loader.addPack({payload:scene.sys.settings.pack})){scene.sys.settings.status=CONST.LOADING;loader.once(LoaderEvents.COMPLETE,this.payloadComplete,this);loader.start();return this}}}this.bootScene(scene)}return this},stop:function(key,data){var scene=this.getScene(key);if(scene&&!scene.sys.isTransitioning()){scene.sys.shutdown(data)}return this},switch:function(from,to){var sceneA=this.getScene(from);var sceneB=this.getScene(to);if(sceneA&&sceneB&&sceneA!==sceneB){this.sleep(from);if(this.isSleeping(to)){this.wake(to)}else{this.start(to)}}return this},getAt:function(index){return this.scenes[index]},getIndex:function(key){var scene=this.getScene(key);return this.scenes.indexOf(scene)},bringToTop:function(key){if(this.isProcessing){this._queue.push({op:'bringToTop',keyA:key,keyB:null})}else{var index=this.getIndex(key);if(index!==-1&&index<this.scenes.length){var scene=this.getScene(key);this.scenes.splice(index,1);this.scenes.push(scene)}}return this},sendToBack:function(key){if(this.isProcessing){this._queue.push({op:'sendToBack',keyA:key,keyB:null})}else{var index=this.getIndex(key);if(index!==-1&&index>0){var scene=this.getScene(key);this.scenes.splice(index,1);this.scenes.unshift(scene)}}return this},moveDown:function(key){if(this.isProcessing){this._queue.push({op:'moveDown',keyA:key,keyB:null})}else{var indexA=this.getIndex(key);if(indexA>0){var indexB=indexA-1;var sceneA=this.getScene(key);var sceneB=this.getAt(indexB);this.scenes[indexA]=sceneB;this.scenes[indexB]=sceneA}}return this},moveUp:function(key){if(this.isProcessing){this._queue.push({op:'moveUp',keyA:key,keyB:null})}else{var indexA=this.getIndex(key);if(indexA<this.scenes.length-1){var indexB=indexA+1;var sceneA=this.getScene(key);var sceneB=this.getAt(indexB);this.scenes[indexA]=sceneB;this.scenes[indexB]=sceneA}}return this},moveAbove:function(keyA,keyB){if(keyA===keyB){return this}if(this.isProcessing){this._queue.push({op:'moveAbove',keyA:keyA,keyB:keyB})}else{var indexA=this.getIndex(keyA);var indexB=this.getIndex(keyB);if(indexA!==-1&&indexB!==-1){var tempScene=this.getAt(indexB);this.scenes.splice(indexB,1);this.scenes.splice(indexA+1,0,tempScene)}}return this},moveBelow:function(keyA,keyB){if(keyA===keyB){return this}if(this.isProcessing){this._queue.push({op:'moveBelow',keyA:keyA,keyB:keyB})}else{var indexA=this.getIndex(keyA);var indexB=this.getIndex(keyB);if(indexA!==-1&&indexB!==-1){var tempScene=this.getAt(indexB);this.scenes.splice(indexB,1);if(indexA===0){this.scenes.unshift(tempScene)}else{this.scenes.splice(indexA,0,tempScene)}}}return this},queueOp:function(op,keyA,keyB){this._queue.push({op:op,keyA:keyA,keyB:keyB});return this},swapPosition:function(keyA,keyB){if(keyA===keyB){return this}if(this.isProcessing){this._queue.push({op:'swapPosition',keyA:keyA,keyB:keyB})}else{var indexA=this.getIndex(keyA);var indexB=this.getIndex(keyB);if(indexA!==indexB&&indexA!==-1&&indexB!==-1){var tempScene=this.getAt(indexA);this.scenes[indexA]=this.scenes[indexB];this.scenes[indexB]=tempScene}}return this},dump:function(){var out=[];var map=['pending','init','start','loading','creating','running','paused','sleeping','shutdown','destroyed'];for(var i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys;var key=(sys.settings.visible&&(sys.settings.status===CONST.RUNNING||sys.settings.status===CONST.PAUSED))?'[*] ':'[-] ';key+=sys.settings.key+' ('+map[sys.settings.status]+')';out.push(key)}console.log(out.join('\/'))},destroy:function(){for(var i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys;sys.destroy()}this.update=NOOP;this.scenes=[];this._pending=[];this._start=[];this._queue=[];this.game=null}});module.exports=SceneManager}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Systems=__webpack_require__(180);var Scene=new Class({initialize:function Scene(config){this.sys=new Systems(this,config);this.game;this.anims;this.cache;this.registry;this.sound;this.textures;this.events;this.cameras;this.add;this.make;this.scene;this.children;this.lights;this.data;this.input;this.load;this.time;this.tweens;this.physics;this.matter;if(false){}this.scale;this.plugins},update:function(){}});module.exports=Scene}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(125);var GetValue=__webpack_require__(6);var Merge=__webpack_require__(126);var InjectionMap=__webpack_require__(882);var Settings={create:function(config){if(typeof config==='string'){config={key:config}}else if(config===undefined){config={}}return{status:CONST.PENDING,key:GetValue(config,'key',''),active:GetValue(config,'active',false),visible:GetValue(config,'visible',true),isBooted:false,isTransition:false,transitionFrom:null,transitionDuration:0,transitionAllowInput:true,data:{},pack:GetValue(config,'pack',false),cameras:GetValue(config,'cameras',null),map:GetValue(config,'map',Merge(InjectionMap,GetValue(config,'mapAdd',{}))),physics:GetValue(config,'physics',{}),loader:GetValue(config,'loader',{}),plugins:GetValue(config,'plugins',false),input:GetValue(config,'input',{})}}};module.exports=Settings}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var CanvasTexture=__webpack_require__(377);var Class=__webpack_require__(0);var Color=__webpack_require__(31);var CONST=__webpack_require__(33);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(121);var GameEvents=__webpack_require__(20);var GenerateTexture=__webpack_require__(346);var GetValue=__webpack_require__(6);var Parser=__webpack_require__(379);var Texture=__webpack_require__(182);var TextureManager=new Class({Extends:EventEmitter,initialize:function TextureManager(game){EventEmitter.call(this);this.game=game;this.name='TextureManager';this.list={};this._tempCanvas=CanvasPool.create2D(this,1,1);this._tempContext=this._tempCanvas.getContext('2d');this._pending=0;game.events.once(GameEvents.BOOT,this.boot,this)},boot:function(){this._pending=2;this.on(Events.LOAD,this.updatePending,this);this.on(Events.ERROR,this.updatePending,this);this.addBase64('__DEFAULT',this.game.config.defaultImage);this.addBase64('__MISSING',this.game.config.missingImage);this.game.events.once(GameEvents.DESTROY,this.destroy,this)},updatePending:function(){this._pending--;if(this._pending===0){this.off(Events.LOAD);this.off(Events.ERROR);this.emit(Events.READY)}},checkKey:function(key){if(this.exists(key)){console.error('Texture key already in use: '+key);return false}return true},remove:function(key){if(typeof key==='string'){if(this.exists(key)){key=this.get(key)}else{console.warn('No texture found matching key: '+key);return this}}if(this.list.hasOwnProperty(key.key)){key.destroy();this.emit(Events.REMOVE,key.key)}return this},removeKey:function(key){if(this.list.hasOwnProperty(key)){delete this.list[key]}return this},addBase64:function(key,data){if(this.checkKey(key)){var _this=this;var image=new Image();image.onerror=function(){_this.emit(Events.ERROR,key)};image.onload=function(){var texture=_this.create(key,image);Parser.Image(texture,0);_this.emit(Events.ADD,key,texture);_this.emit(Events.LOAD,key,texture)};image.src=data}return this},getBase64:function(key,frame,type,encoderOptions){if(type===undefined){type='image/png'}if(encoderOptions===undefined){encoderOptions=0.92}var data='';var textureFrame=this.getFrame(key,frame);if(textureFrame&&(textureFrame.source.isRenderTexture||textureFrame.source.isGLTexture)){console.warn('Cannot getBase64 from WebGL Texture')}else if(textureFrame){var cd=textureFrame.canvasData;var canvas=CanvasPool.create2D(this,cd.width,cd.height);var ctx=canvas.getContext('2d');ctx.drawImage(textureFrame.source.image,cd.x,cd.y,cd.width,cd.height,0,0,cd.width,cd.height);data=canvas.toDataURL(type,encoderOptions);CanvasPool.remove(canvas)}return data},addImage:function(key,source,dataSource){var texture=null;if(this.checkKey(key)){texture=this.create(key,source);Parser.Image(texture,0);if(dataSource){texture.setDataSource(dataSource)}this.emit(Events.ADD,key,texture)}return texture},addGLTexture:function(key,glTexture,width,height){var texture=null;if(this.checkKey(key)){texture=this.create(key,glTexture,width,height);texture.add('__BASE',0,0,0,width,height);this.emit(Events.ADD,key,texture)}return texture},addRenderTexture:function(key,renderTexture){var texture=null;if(this.checkKey(key)){texture=this.create(key,renderTexture);texture.add('__BASE',0,0,0,renderTexture.width,renderTexture.height);this.emit(Events.ADD,key,texture)}return texture},generate:function(key,config){if(this.checkKey(key)){var canvas=CanvasPool.create(this,1,1);config.canvas=canvas;GenerateTexture(config);return this.addCanvas(key,canvas)}else{return null}},createCanvas:function(key,width,height){if(width===undefined){width=256}if(height===undefined){height=256}if(this.checkKey(key)){var canvas=CanvasPool.create(this,width,height,CONST.CANVAS,true);return this.addCanvas(key,canvas)}return null},addCanvas:function(key,source,skipCache){if(skipCache===undefined){skipCache=false}var texture=null;if(skipCache){texture=new CanvasTexture(this,key,source,source.width,source.height)}else if(this.checkKey(key)){texture=new CanvasTexture(this,key,source,source.width,source.height);this.list[key]=texture;this.emit(Events.ADD,key,texture)}return texture},addAtlas:function(key,source,data,dataSource){if(Array.isArray(data.textures)||Array.isArray(data.frames)){return this.addAtlasJSONArray(key,source,data,dataSource)}else{return this.addAtlasJSONHash(key,source,data,dataSource)}},addAtlasJSONArray:function(key,source,data,dataSource){var texture=null;if(this.checkKey(key)){texture=this.create(key,source);if(Array.isArray(data)){var singleAtlasFile=(data.length===1);for(var i=0;i<texture.source.length;i++){var atlasData=singleAtlasFile?data[0]:data[i];Parser.JSONArray(texture,i,atlasData)}}else{Parser.JSONArray(texture,0,data)}if(dataSource){texture.setDataSource(dataSource)}this.emit(Events.ADD,key,texture)}return texture},addAtlasJSONHash:function(key,source,data,dataSource){var texture=null;if(this.checkKey(key)){texture=this.create(key,source);if(Array.isArray(data)){for(var i=0;i<data.length;i++){Parser.JSONHash(texture,i,data[i])}}else{Parser.JSONHash(texture,0,data)}if(dataSource){texture.setDataSource(dataSource)}this.emit(Events.ADD,key,texture)}return texture},addAtlasXML:function(key,source,data,dataSource){var texture=null;if(this.checkKey(key)){texture=this.create(key,source);Parser.AtlasXML(texture,0,data);if(dataSource){texture.setDataSource(dataSource)}this.emit(Events.ADD,key,texture)}return texture},addUnityAtlas:function(key,source,data,dataSource){var texture=null;if(this.checkKey(key)){texture=this.create(key,source);Parser.UnityYAML(texture,0,data);if(dataSource){texture.setDataSource(dataSource)}this.emit(Events.ADD,key,texture)}return texture},addSpriteSheet:function(key,source,config){var texture=null;if(this.checkKey(key)){texture=this.create(key,source);var width=texture.source[0].width;var height=texture.source[0].height;Parser.SpriteSheet(texture,0,0,0,width,height,config);this.emit(Events.ADD,key,texture)}return texture},addSpriteSheetFromAtlas:function(key,config){if(!this.checkKey(key)){return null}var atlasKey=GetValue(config,'atlas',null);var atlasFrame=GetValue(config,'frame',null);if(!atlasKey||!atlasFrame){return}var atlas=this.get(atlasKey);var sheet=atlas.get(atlasFrame);if(sheet){var texture=this.create(key,sheet.source.image);if(sheet.trimmed){Parser.SpriteSheetFromAtlas(texture,sheet,config)}else{Parser.SpriteSheet(texture,0,sheet.cutX,sheet.cutY,sheet.cutWidth,sheet.cutHeight,config)}this.emit(Events.ADD,key,texture);return texture}},create:function(key,source,width,height){var texture=null;if(this.checkKey(key)){texture=new Texture(this,key,source,width,height);this.list[key]=texture}return texture},exists:function(key){return(this.list.hasOwnProperty(key))},get:function(key){if(key===undefined){key='__DEFAULT'}if(this.list[key]){return this.list[key]}else if(key instanceof Texture){return key}else{return this.list['__MISSING']}},cloneFrame:function(key,frame){if(this.list[key]){return this.list[key].get(frame).clone()}},getFrame:function(key,frame){if(this.list[key]){return this.list[key].get(frame)}},getTextureKeys:function(){var output=[];for(var key in this.list){if(key!=='__DEFAULT'&&key!=='__MISSING'){output.push(key)}}return output},getPixel:function(x,y,key,frame){var textureFrame=this.getFrame(key,frame);if(textureFrame){x-=textureFrame.x;y-=textureFrame.y;var data=textureFrame.data.cut;x+=data.x;y+=data.y;if(x>=data.x&&x<data.r&&y>=data.y&&y<data.b){var ctx=this._tempContext;ctx.clearRect(0,0,1,1);ctx.drawImage(textureFrame.source.image,x,y,1,1,0,0,1,1);var rgb=ctx.getImageData(0,0,1,1);return new Color(rgb.data[0],rgb.data[1],rgb.data[2],rgb.data[3])}}return null},getPixelAlpha:function(x,y,key,frame){var textureFrame=this.getFrame(key,frame);if(textureFrame){x-=textureFrame.x;y-=textureFrame.y;var data=textureFrame.data.cut;x+=data.x;y+=data.y;if(x>=data.x&&x<data.r&&y>=data.y&&y<data.b){var ctx=this._tempContext;ctx.clearRect(0,0,1,1);ctx.drawImage(textureFrame.source.image,x,y,1,1,0,0,1,1);var rgb=ctx.getImageData(0,0,1,1);return rgb.data[3]}}return null},setTexture:function(gameObject,key,frame){if(this.list[key]){gameObject.texture=this.list[key];gameObject.frame=gameObject.texture.get(frame)}return gameObject},renameTexture:function(currentKey,newKey){var texture=this.get(currentKey);if(texture&&currentKey!==newKey){texture.key=newKey;this.list[newKey]=texture;delete this.list[currentKey];return true}return false},each:function(callback,scope){var args=[null];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}for(var texture in this.list){args[0]=this.list[texture];callback.apply(scope,args)}},destroy:function(){for(var texture in this.list){this.list[texture].destroy()}this.list={};this.game=null;CanvasPool.remove(this._tempCanvas)}});module.exports=TextureManager}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Clamp=__webpack_require__(19);var Color=__webpack_require__(31);var CONST=__webpack_require__(33);var IsSizePowerOfTwo=__webpack_require__(120);var Texture=__webpack_require__(182);var CanvasTexture=new Class({Extends:Texture,initialize:function CanvasTexture(manager,key,source,width,height){Texture.call(this,manager,key,source,width,height);this.add('__BASE',0,0,0,width,height);this._source=this.frames['__BASE'].source;this.canvas=this._source.image;this.context=this.canvas.getContext('2d');this.width=width;this.height=height;this.imageData=this.context.getImageData(0,0,width,height);this.data=null;if(this.imageData){this.data=this.imageData.data}this.pixels=null;this.buffer;if(this.data){if(this.imageData.data.buffer){this.buffer=this.imageData.data.buffer;this.pixels=new Uint32Array(this.buffer)}else if(window.ArrayBuffer){this.buffer=new ArrayBuffer(this.imageData.data.length);this.pixels=new Uint32Array(this.buffer)}else{this.pixels=this.imageData.data}}},update:function(){this.imageData=this.context.getImageData(0,0,this.width,this.height);this.data=this.imageData.data;if(this.imageData.data.buffer){this.buffer=this.imageData.data.buffer;this.pixels=new Uint32Array(this.buffer)}else if(window.ArrayBuffer){this.buffer=new ArrayBuffer(this.imageData.data.length);this.pixels=new Uint32Array(this.buffer)}else{this.pixels=this.imageData.data}if(this.manager.game.config.renderType===CONST.WEBGL){this.refresh()}return this},draw:function(x,y,source){this.context.drawImage(source,x,y);return this.update()},drawFrame:function(key,frame,x,y){if(x===undefined){x=0}if(y===undefined){y=0}var textureFrame=this.manager.getFrame(key,frame);if(textureFrame){var cd=textureFrame.canvasData;var width=textureFrame.cutWidth;var height=textureFrame.cutHeight;var res=textureFrame.source.resolution;this.context.drawImage(textureFrame.source.image,cd.x,cd.y,width,height,x,y,width/res,height/res);return this.update()}else{return this}},setPixel:function(x,y,red,green,blue,alpha){if(alpha===undefined){alpha=255}x=Math.abs(Math.floor(x));y=Math.abs(Math.floor(y));var index=this.getIndex(x,y);if(index>-1){var imageData=this.context.getImageData(x,y,1,1);imageData.data[0]=red;imageData.data[1]=green;imageData.data[2]=blue;imageData.data[3]=alpha;this.context.putImageData(imageData,x,y)}return this},putData:function(imageData,x,y,dirtyX,dirtyY,dirtyWidth,dirtyHeight){if(dirtyX===undefined){dirtyX=0}if(dirtyY===undefined){dirtyY=0}if(dirtyWidth===undefined){dirtyWidth=imageData.width}if(dirtyHeight===undefined){dirtyHeight=imageData.height}this.context.putImageData(imageData,x,y,dirtyX,dirtyY,dirtyWidth,dirtyHeight);return this},getData:function(x,y,width,height){x=Clamp(Math.floor(x),0,this.width-1);y=Clamp(Math.floor(y),0,this.height-1);width=Clamp(width,1,this.width-x);height=Clamp(height,1,this.height-y);var imageData=this.context.getImageData(x,y,width,height);return imageData},getPixel:function(x,y,out){if(!out){out=new Color()}var index=this.getIndex(x,y);if(index>-1){var data=this.data;var r=data[index+0];var g=data[index+1];var b=data[index+2];var a=data[index+3];out.setTo(r,g,b,a)}return out},getPixels:function(x,y,width,height){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.width}if(height===undefined){height=width}x=Math.abs(Math.round(x));y=Math.abs(Math.round(y));var left=Clamp(x,0,this.width);var right=Clamp(x+width,0,this.width);var top=Clamp(y,0,this.height);var bottom=Clamp(y+height,0,this.height);var pixel=new Color();var out=[];for(var py=top;py<bottom;py++){var row=[];for(var px=left;px<right;px++){pixel=this.getPixel(px,py,pixel);row.push({x:px,y:py,color:pixel.color,alpha:pixel.alphaGL})}out.push(row)}return out},getIndex:function(x,y){x=Math.abs(Math.round(x));y=Math.abs(Math.round(y));if(x<this.width&&y<this.height){return(x+y*this.width)*4}else{return-1}},refresh:function(){this._source.update();return this},getCanvas:function(){return this.canvas},getContext:function(){return this.context},clear:function(x,y,width,height){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.width}if(height===undefined){height=this.height}this.context.clearRect(x,y,width,height);return this.update()},setSize:function(width,height){if(height===undefined){height=width}if(width!==this.width||height!==this.height){this.canvas.width=width;this.canvas.height=height;this._source.width=width;this._source.height=height;this._source.isPowerOf2=IsSizePowerOfTwo(width,height);this.frames['__BASE'].setSize(width,height,0,0);this.width=width;this.height=height;this.refresh()}return this},destroy:function(){Texture.prototype.destroy.call(this);this._source=null;this.canvas=null;this.context=null;this.imageData=null;this.data=null;this.pixels=null;this.buffer=null}});module.exports=CanvasTexture}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var Class=__webpack_require__(0);var IsSizePowerOfTwo=__webpack_require__(120);var ScaleModes=__webpack_require__(234);var TextureSource=new Class({initialize:function TextureSource(texture,source,width,height,flipY){if(flipY===undefined){flipY=false}var game=texture.manager.game;this.renderer=game.renderer;this.texture=texture;this.source=source;this.image=source;this.compressionAlgorithm=null;this.resolution=1;this.width=width||source.naturalWidth||source.videoWidth||source.width||0;this.height=height||source.naturalHeight||source.videoHeight||source.height||0;this.scaleMode=ScaleModes.DEFAULT;this.isCanvas=(source instanceof HTMLCanvasElement);this.isVideo=(window.hasOwnProperty('HTMLVideoElement')&&source instanceof HTMLVideoElement);this.isRenderTexture=(source.type==='RenderTexture');this.isGLTexture=(window.hasOwnProperty('WebGLTexture')&&source instanceof WebGLTexture);this.isPowerOf2=IsSizePowerOfTwo(this.width,this.height);this.glTexture=null;this.flipY=flipY;this.init(game)},init:function(game){if(this.renderer){if(this.renderer.gl){if(this.isCanvas){this.glTexture=this.renderer.createCanvasTexture(this.image,false,this.flipY)}else if(this.isVideo){this.glTexture=this.renderer.createVideoTexture(this.image,false,this.flipY)}else if(this.isRenderTexture){this.image=this.source.canvas;this.glTexture=this.renderer.createTextureFromSource(null,this.width,this.height,this.scaleMode)}else if(this.isGLTexture){this.glTexture=this.source}else{this.glTexture=this.renderer.createTextureFromSource(this.image,this.width,this.height,this.scaleMode)}}else if(this.isRenderTexture){this.image=this.source.canvas}}if(!game.config.antialias){this.setFilter(1)}},setFilter:function(filterMode){if(this.renderer.gl){this.renderer.setTextureFilter(this.glTexture,filterMode)}this.scaleMode=filterMode},setFlipY:function(value){if(value===undefined){value=true}this.flipY=value;return this},update:function(){var gl=this.renderer.gl;if(gl&&this.isCanvas){this.glTexture=this.renderer.updateCanvasTexture(this.image,this.glTexture,this.flipY)}else if(gl&&this.isVideo){this.glTexture=this.renderer.updateVideoTexture(this.image,this.glTexture,this.flipY)}},destroy:function(){if(this.glTexture){this.renderer.deleteTexture(this.glTexture)}if(this.isCanvas){CanvasPool.remove(this.image)}this.renderer=null;this.texture=null;this.source=null;this.image=null;this.glTexture=null}});module.exports=TextureSource}),(function(module,exports,__webpack_require__){module.exports={AtlasXML:__webpack_require__(883),Canvas:__webpack_require__(884),Image:__webpack_require__(885),JSONArray:__webpack_require__(886),JSONHash:__webpack_require__(887),SpriteSheet:__webpack_require__(888),SpriteSheetFromAtlas:__webpack_require__(889),UnityYAML:__webpack_require__(890)}}),(function(module,exports,__webpack_require__){var HTML5AudioSoundManager=__webpack_require__(381);var NoAudioSoundManager=__webpack_require__(385);var WebAudioSoundManager=__webpack_require__(387);var SoundManagerCreator={create:function(game){var audioConfig=game.config.audio;var deviceAudio=game.device.audio;if((audioConfig&&audioConfig.noAudio)||(!deviceAudio.webAudio&&!deviceAudio.audioData)){return new NoAudioSoundManager(game)}if(deviceAudio.webAudio&&!(audioConfig&&audioConfig.disableWebAudio)){return new WebAudioSoundManager(game)}return new HTML5AudioSoundManager(game)}};module.exports=SoundManagerCreator}),(function(module,exports,__webpack_require__){var BaseSoundManager=__webpack_require__(127);var Class=__webpack_require__(0);var Events=__webpack_require__(59);var HTML5AudioSound=__webpack_require__(384);var HTML5AudioSoundManager=new Class({Extends:BaseSoundManager,initialize:function HTML5AudioSoundManager(game){this.override=true;this.audioPlayDelay=0.1;this.loopEndOffset=0.05;this.onBlurPausedSounds=[];this.locked='ontouchstart'in window;this.lockedActionsQueue=this.locked?[]:null;this._mute=false;this._volume=1;BaseSoundManager.call(this,game)},add:function(key,config){var sound=new HTML5AudioSound(this,key,config);this.sounds.push(sound);return sound},unlock:function(){this.locked=false;var _this=this;this.game.cache.audio.entries.each(function(key,tags){for(var i=0;i<tags.length;i++){if(tags[i].dataset.locked==='true'){_this.locked=true;return false}}return true});if(!this.locked){return}var moved=false;var detectMove=function(){moved=true};var unlock=function(){if(moved){moved=false;return}document.body.removeEventListener('touchmove',detectMove);document.body.removeEventListener('touchend',unlock);var lockedTags=[];_this.game.cache.audio.entries.each(function(key,tags){for(var i=0;i<tags.length;i++){var tag=tags[i];if(tag.dataset.locked==='true'){lockedTags.push(tag)}}return true});if(lockedTags.length===0){return}var lastTag=lockedTags[lockedTags.length-1];lastTag.oncanplaythrough=function(){lastTag.oncanplaythrough=null;lockedTags.forEach(function(tag){tag.dataset.locked='false'});_this.unlocked=true};lockedTags.forEach(function(tag){tag.load()})};this.once(Events.UNLOCKED,function(){this.forEachActiveSound(function(sound){if(sound.currentMarker===null&&sound.duration===0){sound.duration=sound.tags[0].duration}sound.totalDuration=sound.tags[0].duration});while(this.lockedActionsQueue.length){var lockedAction=this.lockedActionsQueue.shift();if(lockedAction.sound[lockedAction.prop].apply){lockedAction.sound[lockedAction.prop].apply(lockedAction.sound,lockedAction.value||[])}else{lockedAction.sound[lockedAction.prop]=lockedAction.value}}},this);document.body.addEventListener('touchmove',detectMove,false);document.body.addEventListener('touchend',unlock,false)},onBlur:function(){this.forEachActiveSound(function(sound){if(sound.isPlaying){this.onBlurPausedSounds.push(sound);sound.onBlur()}})},onFocus:function(){this.onBlurPausedSounds.forEach(function(sound){sound.onFocus()});this.onBlurPausedSounds.length=0},destroy:function(){BaseSoundManager.prototype.destroy.call(this);this.onBlurPausedSounds.length=0;this.onBlurPausedSounds=null},isLocked:function(sound,prop,value){if(sound.tags[0].dataset.locked==='true'){this.lockedActionsQueue.push({sound:sound,prop:prop,value:value});return true}return false},setMute:function(value){this.mute=value;return this},mute:{get:function(){return this._mute},set:function(value){this._mute=value;this.forEachActiveSound(function(sound){sound.updateMute()});this.emit(Events.GLOBAL_MUTE,this,value)}},setVolume:function(value){this.volume=value;return this},volume:{get:function(){return this._volume},set:function(value){this._volume=value;this.forEachActiveSound(function(sound){sound.updateVolume()});this.emit(Events.GLOBAL_VOLUME,this,value)}}});module.exports=HTML5AudioSoundManager}),(function(module,exports,__webpack_require__){var SafeRange=__webpack_require__(68);var GetAll=function(array,property,value,startIndex,endIndex){if(startIndex===undefined){startIndex=0}if(endIndex===undefined){endIndex=array.length}var output=[];if(SafeRange(array,startIndex,endIndex)){for(var i=startIndex;i<endIndex;i++){var child=array[i];if(!property||(property&&value===undefined&&child.hasOwnProperty(property))||(property&&value!==undefined&&child[property]===value)){output.push(child)}}}return output};module.exports=GetAll}),(function(module,exports,__webpack_require__){var SafeRange=__webpack_require__(68);var GetFirst=function(array,property,value,startIndex,endIndex){if(startIndex===undefined){startIndex=0}if(endIndex===undefined){endIndex=array.length}if(SafeRange(array,startIndex,endIndex)){for(var i=startIndex;i<endIndex;i++){var child=array[i];if(!property||(property&&value===undefined&&child.hasOwnProperty(property))||(property&&value!==undefined&&child[property]===value)){return child}}}return null};module.exports=GetFirst}),(function(module,exports,__webpack_require__){var BaseSound=__webpack_require__(128);var Class=__webpack_require__(0);var Events=__webpack_require__(59);var Clamp=__webpack_require__(19);var HTML5AudioSound=new Class({Extends:BaseSound,initialize:function HTML5AudioSound(manager,key,config){if(config===undefined){config={}}this.tags=manager.game.cache.audio.get(key);if(!this.tags){throw new Error('There is no audio asset with key "'+key+'" in the audio cache')}this.audio=null;this.startTime=0;this.previousTime=0;this.duration=this.tags[0].duration;this.totalDuration=this.tags[0].duration;BaseSound.call(this,manager,key,config)},play:function(markerName,config){if(this.manager.isLocked(this,'play',[markerName,config])){return false}if(!BaseSound.prototype.play.call(this,markerName,config)){return false}if(!this.pickAndPlayAudioTag()){return false}this.emit(Events.PLAY,this);return true},pause:function(){if(this.manager.isLocked(this,'pause')){return false}if(this.startTime>0){return false}if(!BaseSound.prototype.pause.call(this)){return false}this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0);this.stopAndReleaseAudioTag();this.emit(Events.PAUSE,this);return true},resume:function(){if(this.manager.isLocked(this,'resume')){return false}if(this.startTime>0){return false}if(!BaseSound.prototype.resume.call(this)){return false}if(!this.pickAndPlayAudioTag()){return false}this.emit(Events.RESUME,this);return true},stop:function(){if(this.manager.isLocked(this,'stop')){return false}if(!BaseSound.prototype.stop.call(this)){return false}this.stopAndReleaseAudioTag();this.emit(Events.STOP,this);return true},pickAndPlayAudioTag:function(){if(!this.pickAudioTag()){this.reset();return false}var seek=this.currentConfig.seek;var delay=this.currentConfig.delay;var offset=(this.currentMarker?this.currentMarker.start:0)+seek;this.previousTime=offset;this.audio.currentTime=offset;this.applyConfig();if(delay===0){this.startTime=0;if(this.audio.paused){this.playCatchPromise()}}else{this.startTime=window.performance.now()+delay*1000;if(!this.audio.paused){this.audio.pause()}}this.resetConfig();return true},pickAudioTag:function(){if(this.audio){return true}for(var i=0;i<this.tags.length;i++){var audio=this.tags[i];if(audio.dataset.used==='false'){audio.dataset.used='true';this.audio=audio;return true}}if(!this.manager.override){return false}var otherSounds=[];this.manager.forEachActiveSound(function(sound){if(sound.key===this.key&&sound.audio){otherSounds.push(sound)}},this);otherSounds.sort(function(a1,a2){if(a1.loop===a2.loop){return(a2.seek/a2.duration)-(a1.seek/a1.duration)}return a1.loop?1:-1});var selectedSound=otherSounds[0];this.audio=selectedSound.audio;selectedSound.reset();selectedSound.audio=null;selectedSound.startTime=0;selectedSound.previousTime=0;return true},playCatchPromise:function(){var playPromise=this.audio.play();if(playPromise){playPromise.catch(function(reason){console.warn(reason)})}},stopAndReleaseAudioTag:function(){this.startTime=0;this.previousTime=0;if(this.audio){this.audio.pause();this.audio.dataset.used='false';this.audio=null}},reset:function(){BaseSound.prototype.stop.call(this)},onBlur:function(){this.isPlaying=false;this.isPaused=true;this.currentConfig.seek=this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0);this.currentConfig.delay=Math.max(0,(this.startTime-window.performance.now())/1000);this.stopAndReleaseAudioTag()},onFocus:function(){this.isPlaying=true;this.isPaused=false;this.pickAndPlayAudioTag()},update:function(time,delta){if(!this.isPlaying){return}if(this.startTime>0){if(this.startTime<time-this.manager.audioPlayDelay){this.audio.currentTime+=Math.max(0,time-this.startTime)/1000;this.startTime=0;this.previousTime=this.audio.currentTime;this.playCatchPromise()}return}var startTime=this.currentMarker?this.currentMarker.start:0;var endTime=startTime+this.duration;var currentTime=this.audio.currentTime;if(this.currentConfig.loop){if(currentTime>=endTime-this.manager.loopEndOffset){this.audio.currentTime=startTime+Math.max(0,currentTime-endTime);currentTime=this.audio.currentTime}else if(currentTime<startTime){this.audio.currentTime+=startTime;currentTime=this.audio.currentTime}if(currentTime<this.previousTime){this.emit(Events.LOOPED,this)}}else if(currentTime>=endTime){this.reset();this.stopAndReleaseAudioTag();this.emit(Events.COMPLETE,this);return}this.previousTime=currentTime},destroy:function(){BaseSound.prototype.destroy.call(this);this.tags=null;if(this.audio){this.stopAndReleaseAudioTag()}},updateMute:function(){if(this.audio){this.audio.muted=this.currentConfig.mute||this.manager.mute}},updateVolume:function(){if(this.audio){this.audio.volume=Clamp(this.currentConfig.volume*this.manager.volume,0,1)}},calculateRate:function(){BaseSound.prototype.calculateRate.call(this);if(this.audio){this.audio.playbackRate=this.totalRate}},mute:{get:function(){return this.currentConfig.mute},set:function(value){this.currentConfig.mute=value;if(this.manager.isLocked(this,'mute',value)){return}this.updateMute();this.emit(Events.MUTE,this,value)}},setMute:function(value){this.mute=value;return this},volume:{get:function(){return this.currentConfig.volume},set:function(value){this.currentConfig.volume=value;if(this.manager.isLocked(this,'volume',value)){return}this.updateVolume();this.emit(Events.VOLUME,this,value)}},setVolume:function(value){this.volume=value;return this},rate:{get:function(){return this.currentConfig.rate},set:function(value){this.currentConfig.rate=value;if(this.manager.isLocked(this,Events.RATE,value)){return}else{this.calculateRate();this.emit(Events.RATE,this,value)}}},setRate:function(value){this.rate=value;return this},detune:{get:function(){return this.currentConfig.detune},set:function(value){this.currentConfig.detune=value;if(this.manager.isLocked(this,Events.DETUNE,value)){return}else{this.calculateRate();this.emit(Events.DETUNE,this,value)}}},setDetune:function(value){this.detune=value;return this},seek:{get:function(){if(this.isPlaying){return this.audio.currentTime-(this.currentMarker?this.currentMarker.start:0)}else if(this.isPaused){return this.currentConfig.seek}else{return 0}},set:function(value){if(this.manager.isLocked(this,'seek',value)){return}if(this.startTime>0){return}if(this.isPlaying||this.isPaused){value=Math.min(Math.max(0,value),this.duration);if(this.isPlaying){this.previousTime=value;this.audio.currentTime=value}else if(this.isPaused){this.currentConfig.seek=value}this.emit(Events.SEEK,this,value)}}},setSeek:function(value){this.seek=value;return this},loop:{get:function(){return this.currentConfig.loop},set:function(value){this.currentConfig.loop=value;if(this.manager.isLocked(this,'loop',value)){return}if(this.audio){this.audio.loop=value}this.emit(Events.LOOP,this,value)}},setLoop:function(value){this.loop=value;return this}});module.exports=HTML5AudioSound}),(function(module,exports,__webpack_require__){var BaseSoundManager=__webpack_require__(127);var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var NoAudioSound=__webpack_require__(386);var NOOP=__webpack_require__(1);var NoAudioSoundManager=new Class({Extends:EventEmitter,initialize:function NoAudioSoundManager(game){EventEmitter.call(this);this.game=game;this.sounds=[];this.mute=false;this.volume=1;this.rate=1;this.detune=0;this.pauseOnBlur=true;this.locked=false},add:function(key,config){var sound=new NoAudioSound(this,key,config);this.sounds.push(sound);return sound},addAudioSprite:function(key,config){var sound=this.add(key,config);sound.spritemap={};return sound},play:function(key,extra){return false},playAudioSprite:function(key,spriteName,config){return false},remove:function(sound){return BaseSoundManager.prototype.remove.call(this,sound)},removeByKey:function(key){return BaseSoundManager.prototype.removeByKey.call(this,key)},pauseAll:NOOP,resumeAll:NOOP,stopAll:NOOP,update:NOOP,setRate:NOOP,setDetune:NOOP,setMute:NOOP,setVolume:NOOP,forEachActiveSound:function(callbackfn,scope){BaseSoundManager.prototype.forEachActiveSound.call(this,callbackfn,scope)},destroy:function(){BaseSoundManager.prototype.destroy.call(this)}});module.exports=NoAudioSoundManager}),(function(module,exports,__webpack_require__){var BaseSound=__webpack_require__(128);var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Extend=__webpack_require__(18);var returnFalse=function(){return false};var returnNull=function(){return null};var returnThis=function(){return this};var NoAudioSound=new Class({Extends:EventEmitter,initialize:function NoAudioSound(manager,key,config){if(config===void 0){config={}}EventEmitter.call(this);this.manager=manager;this.key=key;this.isPlaying=false;this.isPaused=false;this.totalRate=1;this.duration=0;this.totalDuration=0;this.config=Extend({mute:false,volume:1,rate:1,detune:0,seek:0,loop:false,delay:0},config);this.currentConfig=this.config;this.mute=false;this.volume=1;this.rate=1;this.detune=0;this.seek=0;this.loop=false;this.markers={};this.currentMarker=null;this.pendingRemove=false},addMarker:returnFalse,updateMarker:returnFalse,removeMarker:returnNull,play:returnFalse,pause:returnFalse,resume:returnFalse,stop:returnFalse,destroy:function(){BaseSound.prototype.destroy.call(this)},setMute:returnThis,setVolume:returnThis,setRate:returnThis,setDetune:returnThis,setSeek:returnThis,setLoop:returnThis});module.exports=NoAudioSound}),(function(module,exports,__webpack_require__){var Base64ToArrayBuffer=__webpack_require__(388);var BaseSoundManager=__webpack_require__(127);var Class=__webpack_require__(0);var Events=__webpack_require__(59);var WebAudioSound=__webpack_require__(389);var WebAudioSoundManager=new Class({Extends:BaseSoundManager,initialize:function WebAudioSoundManager(game){this.context=this.createAudioContext(game);this.masterMuteNode=this.context.createGain();this.masterVolumeNode=this.context.createGain();this.masterMuteNode.connect(this.masterVolumeNode);this.masterVolumeNode.connect(this.context.destination);this.destination=this.masterMuteNode;this.locked=this.context.state==='suspended'&&('ontouchstart'in window||'onclick'in window);BaseSoundManager.call(this,game);if(this.locked){this.unlock()}},createAudioContext:function(game){var audioConfig=game.config.audio;if(audioConfig&&audioConfig.context){audioConfig.context.resume();return audioConfig.context}return new AudioContext()},setAudioContext:function(context){if(this.context){this.context.close()}if(this.masterMuteNode){this.masterMuteNode.disconnect()}if(this.masterVolumeNode){this.masterVolumeNode.disconnect()}this.context=context;this.masterMuteNode=context.createGain();this.masterVolumeNode=context.createGain();this.masterMuteNode.connect(this.masterVolumeNode);this.masterVolumeNode.connect(context.destination);this.destination=this.masterMuteNode;return this},add:function(key,config){var sound=new WebAudioSound(this,key,config);this.sounds.push(sound);return sound},decodeAudio:function(audioKey,audioData){var audioFiles;if(!Array.isArray(audioKey)){audioFiles=[{key:audioKey,data:audioData}]}else{audioFiles=audioKey}var cache=this.game.cache.audio;var remaining=audioFiles.length;for(var i=0;i<audioFiles.length;i++){var entry=audioFiles[i];var key=entry.key;var data=entry.data;if(typeof data==='string'){data=Base64ToArrayBuffer(data)}var success=function(key,audioBuffer){cache.add(key,audioBuffer);this.emit(Events.DECODED,key);remaining--;if(remaining===0){this.emit(Events.DECODED_ALL)}}.bind(this,key);var failure=function(key,error){console.error('Error decoding audio: '+key+' - ',error?error.message:'');remaining--;if(remaining===0){this.emit(Events.DECODED_ALL)}}.bind(this,key);this.context.decodeAudioData(data,success,failure)}},unlock:function(){var _this=this;var body=document.body;var unlockHandler=function unlockHandler(){if(_this.context){_this.context.resume().then(function(){body.removeEventListener('touchstart',unlockHandler);body.removeEventListener('touchend',unlockHandler);body.removeEventListener('click',unlockHandler);body.removeEventListener('keydown',unlockHandler);_this.unlocked=true},function(){body.removeEventListener('touchstart',unlockHandler);body.removeEventListener('touchend',unlockHandler);body.removeEventListener('click',unlockHandler);body.removeEventListener('keydown',unlockHandler)})}};if(body){body.addEventListener('touchstart',unlockHandler,false);body.addEventListener('touchend',unlockHandler,false);body.addEventListener('click',unlockHandler,false);body.addEventListener('keydown',unlockHandler,false)}},onBlur:function(){if(!this.locked){this.context.suspend()}},onFocus:function(){if(!this.locked){this.context.resume()}},destroy:function(){this.destination=null;this.masterVolumeNode.disconnect();this.masterVolumeNode=null;this.masterMuteNode.disconnect();this.masterMuteNode=null;if(this.game.config.audio&&this.game.config.audio.context){this.context.suspend()}else{var _this=this;this.context.close().then(function(){_this.context=null})}BaseSoundManager.prototype.destroy.call(this)},setMute:function(value){this.mute=value;return this},mute:{get:function(){return(this.masterMuteNode.gain.value===0)},set:function(value){this.masterMuteNode.gain.setValueAtTime(value?0:1,0);this.emit(Events.GLOBAL_MUTE,this,value)}},setVolume:function(value){this.volume=value;return this},volume:{get:function(){return this.masterVolumeNode.gain.value},set:function(value){this.masterVolumeNode.gain.setValueAtTime(value,0);this.emit(Events.GLOBAL_VOLUME,this,value)}}});module.exports=WebAudioSoundManager}),(function(module,exports){var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var lookup=new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i}var Base64ToArrayBuffer=function(base64){base64=base64.substr(base64.indexOf(',')+1);var len=base64.length;var bufferLength=len*0.75;var p=0;var encoded1;var encoded2;var encoded3;var encoded4;if(base64[len-1]==='='){bufferLength--;if(base64[len-2]==='='){bufferLength--}}var arrayBuffer=new ArrayBuffer(bufferLength);var bytes=new Uint8Array(arrayBuffer);for(var i=0;i<len;i+=4){encoded1=lookup[base64.charCodeAt(i)];encoded2=lookup[base64.charCodeAt(i+1)];encoded3=lookup[base64.charCodeAt(i+2)];encoded4=lookup[base64.charCodeAt(i+3)];bytes[p++]=(encoded1<<2)|(encoded2>>4);bytes[p++]=((encoded2&15)<<4)|(encoded3>>2);bytes[p++]=((encoded3&3)<<6)|(encoded4&63)}return arrayBuffer};module.exports=Base64ToArrayBuffer}),(function(module,exports,__webpack_require__){var BaseSound=__webpack_require__(128);var Class=__webpack_require__(0);var Events=__webpack_require__(59);var WebAudioSound=new Class({Extends:BaseSound,initialize:function WebAudioSound(manager,key,config){if(config===undefined){config={}}this.audioBuffer=manager.game.cache.audio.get(key);if(!this.audioBuffer){throw new Error('There is no audio asset with key "'+key+'" in the audio cache')}this.source=null;this.loopSource=null;this.muteNode=manager.context.createGain();this.volumeNode=manager.context.createGain();this.playTime=0;this.startTime=0;this.loopTime=0;this.rateUpdates=[];this.hasEnded=false;this.hasLooped=false;this.muteNode.connect(this.volumeNode);this.volumeNode.connect(manager.destination);this.duration=this.audioBuffer.duration;this.totalDuration=this.audioBuffer.duration;BaseSound.call(this,manager,key,config)},play:function(markerName,config){if(!BaseSound.prototype.play.call(this,markerName,config)){return false}this.stopAndRemoveBufferSource();this.createAndStartBufferSource();this.emit(Events.PLAY,this);return true},pause:function(){if(this.manager.context.currentTime<this.startTime){return false}if(!BaseSound.prototype.pause.call(this)){return false}this.currentConfig.seek=this.getCurrentTime();this.stopAndRemoveBufferSource();this.emit(Events.PAUSE,this);return true},resume:function(){if(this.manager.context.currentTime<this.startTime){return false}if(!BaseSound.prototype.resume.call(this)){return false}this.createAndStartBufferSource();this.emit(Events.RESUME,this);return true},stop:function(){if(!BaseSound.prototype.stop.call(this)){return false}this.stopAndRemoveBufferSource();this.emit(Events.STOP,this);return true},createAndStartBufferSource:function(){var seek=this.currentConfig.seek;var delay=this.currentConfig.delay;var when=this.manager.context.currentTime+delay;var offset=(this.currentMarker?this.currentMarker.start:0)+seek;var duration=this.duration-seek;this.playTime=when-seek;this.startTime=when;this.source=this.createBufferSource();this.applyConfig();this.source.start(Math.max(0,when),Math.max(0,offset),Math.max(0,duration));this.resetConfig()},createAndStartLoopBufferSource:function(){var when=this.getLoopTime();var offset=this.currentMarker?this.currentMarker.start:0;var duration=this.duration;this.loopTime=when;this.loopSource=this.createBufferSource();this.loopSource.playbackRate.setValueAtTime(this.totalRate,0);this.loopSource.start(Math.max(0,when),Math.max(0,offset),Math.max(0,duration))},createBufferSource:function(){var _this=this;var source=this.manager.context.createBufferSource();source.buffer=this.audioBuffer;source.connect(this.muteNode);source.onended=function(ev){if(ev.target===_this.source){if(_this.currentConfig.loop){_this.hasLooped=true}else{_this.hasEnded=true}}};return source},stopAndRemoveBufferSource:function(){if(this.source){this.source.stop();this.source.disconnect();this.source=null}this.playTime=0;this.startTime=0;this.stopAndRemoveLoopBufferSource()},stopAndRemoveLoopBufferSource:function(){if(this.loopSource){this.loopSource.stop();this.loopSource.disconnect();this.loopSource=null}this.loopTime=0},applyConfig:function(){this.rateUpdates.length=0;this.rateUpdates.push({time:0,rate:1});BaseSound.prototype.applyConfig.call(this)},update:function(time,delta){if(this.hasEnded){this.hasEnded=false;BaseSound.prototype.stop.call(this);this.stopAndRemoveBufferSource();this.emit(Events.COMPLETE,this)}else if(this.hasLooped){this.hasLooped=false;this.source=this.loopSource;this.loopSource=null;this.playTime=this.startTime=this.loopTime;this.rateUpdates.length=0;this.rateUpdates.push({time:0,rate:this.totalRate});this.createAndStartLoopBufferSource();this.emit(Events.LOOPED,this)}},destroy:function(){BaseSound.prototype.destroy.call(this);this.audioBuffer=null;this.stopAndRemoveBufferSource();this.muteNode.disconnect();this.muteNode=null;this.volumeNode.disconnect();this.volumeNode=null;this.rateUpdates.length=0;this.rateUpdates=null},calculateRate:function(){BaseSound.prototype.calculateRate.call(this);var now=this.manager.context.currentTime;if(this.source&&typeof this.totalRate==='number'){this.source.playbackRate.setValueAtTime(this.totalRate,now)}if(this.isPlaying){this.rateUpdates.push({time:Math.max(this.startTime,now)-this.playTime,rate:this.totalRate});if(this.loopSource){this.stopAndRemoveLoopBufferSource();this.createAndStartLoopBufferSource()}}},getCurrentTime:function(){var currentTime=0;for(var i=0;i<this.rateUpdates.length;i++){var nextTime=0;if(i<this.rateUpdates.length-1){nextTime=this.rateUpdates[i+1].time}else{nextTime=this.manager.context.currentTime-this.playTime}currentTime+=(nextTime-this.rateUpdates[i].time)*this.rateUpdates[i].rate}return currentTime},getLoopTime:function(){var lastRateUpdateCurrentTime=0;for(var i=0;i<this.rateUpdates.length-1;i++){lastRateUpdateCurrentTime+=(this.rateUpdates[i+1].time-this.rateUpdates[i].time)*this.rateUpdates[i].rate}var lastRateUpdate=this.rateUpdates[this.rateUpdates.length-1];return this.playTime+lastRateUpdate.time+(this.duration-lastRateUpdateCurrentTime)/lastRateUpdate.rate},rate:{get:function(){return this.currentConfig.rate},set:function(value){this.currentConfig.rate=value;this.calculateRate();this.emit(Events.RATE,this,value)}},setRate:function(value){this.rate=value;return this},detune:{get:function(){return this.currentConfig.detune},set:function(value){this.currentConfig.detune=value;this.calculateRate();this.emit(Events.DETUNE,this,value)}},setDetune:function(value){this.detune=value;return this},mute:{get:function(){return(this.muteNode.gain.value===0)},set:function(value){this.currentConfig.mute=value;this.muteNode.gain.setValueAtTime(value?0:1,0);this.emit(Events.MUTE,this,value)}},setMute:function(value){this.mute=value;return this},volume:{get:function(){return this.volumeNode.gain.value},set:function(value){this.currentConfig.volume=value;this.volumeNode.gain.setValueAtTime(value,0);this.emit(Events.VOLUME,this,value)}},setVolume:function(value){this.volume=value;return this},seek:{get:function(){if(this.isPlaying){if(this.manager.context.currentTime<this.startTime){return this.startTime-this.playTime}return this.getCurrentTime()}else if(this.isPaused){return this.currentConfig.seek}else{return 0}},set:function(value){if(this.manager.context.currentTime<this.startTime){return}if(this.isPlaying||this.isPaused){value=Math.min(Math.max(0,value),this.duration);this.currentConfig.seek=value;if(this.isPlaying){this.stopAndRemoveBufferSource();this.createAndStartBufferSource()}this.emit(Events.SEEK,this,value)}}},setSeek:function(value){this.seek=value;return this},loop:{get:function(){return this.currentConfig.loop},set:function(value){this.currentConfig.loop=value;if(this.isPlaying){this.stopAndRemoveLoopBufferSource();if(value){this.createAndStartLoopBufferSource()}}this.emit(Events.LOOP,this,value)}},setLoop:function(value){this.loop=value;return this}});module.exports=WebAudioSound}),(function(module,exports){var TransposeMatrix=function(array){var sourceRowCount=array.length;var sourceColCount=array[0].length;var result=new Array(sourceColCount);for(var i=0;i<sourceColCount;i++){result[i]=new Array(sourceRowCount);for(var j=sourceRowCount-1;j>-1;j--){result[i][j]=array[j][i]}}return result};module.exports=TransposeMatrix}),(function(module,exports){function swap(arr,i,j){var tmp=arr[i];arr[i]=arr[j];arr[j]=tmp}function defaultCompare(a,b){return a<b?-1:a>b?1:0}var QuickSelect=function(arr,k,left,right,compare){if(left===undefined){left=0}if(right===undefined){right=arr.length-1}if(compare===undefined){compare=defaultCompare}while(right>left){if(right-left>600){var n=right-left+1;var m=k-left+1;var z=Math.log(n);var s=0.5*Math.exp(2*z/3);var sd=0.5*Math.sqrt(z*s*(n-s)/n)*(m-n/2<0?-1:1);var newLeft=Math.max(left,Math.floor(k-m*s/n+sd));var newRight=Math.min(right,Math.floor(k+(n-m)*s/n+sd));QuickSelect(arr,k,newLeft,newRight,compare)}var t=arr[k];var i=left;var j=right;swap(arr,left,k);if(compare(arr[right],t)>0){swap(arr,left,right)}while(i<j){swap(arr,i,j);i++;j--;while(compare(arr[i],t)<0){i++}while(compare(arr[j],t)>0){j--}}if(compare(arr[left],t)===0){swap(arr,left,j)}else{j++;swap(arr,j,right)}if(j<=k){left=j+1}if(k<=j){right=j-1}}};module.exports=QuickSelect}),(function(module,exports,__webpack_require__){var GetValue=__webpack_require__(6);var Shuffle=__webpack_require__(114);var BuildChunk=function(a,b,qty){var out=[];for(var aIndex=0;aIndex<a.length;aIndex++){for(var bIndex=0;bIndex<b.length;bIndex++){for(var i=0;i<qty;i++){out.push({a:a[aIndex],b:b[bIndex]})}}}return out};var Range=function(a,b,options){var max=GetValue(options,'max',0);var qty=GetValue(options,'qty',1);var random=GetValue(options,'random',false);var randomB=GetValue(options,'randomB',false);var repeat=GetValue(options,'repeat',0);var yoyo=GetValue(options,'yoyo',false);var out=[];if(randomB){Shuffle(b)}if(repeat===-1){if(max===0){repeat=0}else{var total=(a.length*b.length)*qty;if(yoyo){total*=2}repeat=Math.ceil(max/total)}}for(var i=0;i<=repeat;i++){var chunk=BuildChunk(a,b,qty);if(random){Shuffle(chunk)}out=out.concat(chunk);if(yoyo){chunk.reverse();out=out.concat(chunk)}}if(max){out.splice(max)}return out};module.exports=Range}),(function(module,exports,__webpack_require__){var GetAdvancedValue=__webpack_require__(15);var BuildGameObjectAnimation=function(sprite,config){var animConfig=GetAdvancedValue(config,'anims',null);if(animConfig===null){return sprite}if(typeof animConfig==='string'){sprite.anims.play(animConfig)}else if(typeof animConfig==='object'){var anims=sprite.anims;var key=GetAdvancedValue(animConfig,'key',undefined);var startFrame=GetAdvancedValue(animConfig,'startFrame',undefined);var delay=GetAdvancedValue(animConfig,'delay',0);var repeat=GetAdvancedValue(animConfig,'repeat',0);var repeatDelay=GetAdvancedValue(animConfig,'repeatDelay',0);var yoyo=GetAdvancedValue(animConfig,'yoyo',false);var play=GetAdvancedValue(animConfig,'play',false);var delayedPlay=GetAdvancedValue(animConfig,'delayedPlay',0);anims.setDelay(delay);anims.setRepeat(repeat);anims.setRepeatDelay(repeatDelay);anims.setYoyo(yoyo);if(play){anims.play(key,startFrame)}else if(delayedPlay>0){anims.delayedPlay(delayedPlay,key,startFrame)}else{anims.load(key)}}return sprite};module.exports=BuildGameObjectAnimation}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var Union=function(rectA,rectB,out){if(out===undefined){out=new Rectangle()}var x=Math.min(rectA.x,rectB.x);var y=Math.min(rectA.y,rectB.y);var w=Math.max(rectA.right,rectB.right)-x;var h=Math.max(rectA.bottom,rectB.bottom)-y;return out.setTo(x,y,w,h)};module.exports=Union}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var DOMElementRender=__webpack_require__(957);var GameObject=__webpack_require__(14);var IsPlainObject=__webpack_require__(7);var RemoveFromDOM=__webpack_require__(178);var SCENE_EVENTS=__webpack_require__(22);var Vector4=__webpack_require__(334);var DOMElement=new Class({Extends:GameObject,Mixins:[Components.AlphaSingle,Components.BlendMode,Components.Depth,Components.Origin,Components.ScrollFactor,Components.Transform,Components.Visible,DOMElementRender],initialize:function DOMElement(scene,x,y,element,style,innerText){GameObject.call(this,scene,'DOMElement');this.parent=scene.sys.game.domContainer;this.cache=scene.sys.cache.html;this.node;this.transformOnly=false;this.skewX=0;this.skewY=0;this.rotate3d=new Vector4();this.rotate3dAngle='deg';this.width=0;this.height=0;this.displayWidth=0;this.displayHeight=0;this.handler=this.dispatchNativeEvent.bind(this);this.setPosition(x,y);if(typeof element==='string'){if(element[0]==='#'){this.setElement(element.substr(1),style,innerText)}else{this.createElement(element,style,innerText)}}else if(element){this.setElement(element,style,innerText)}scene.sys.events.on(SCENE_EVENTS.SLEEP,this.handleSceneEvent,this);scene.sys.events.on(SCENE_EVENTS.WAKE,this.handleSceneEvent,this)},handleSceneEvent:function(sys){var node=this.node;var style=node.style;if(node){style.display=(sys.settings.visible)?'block':'none'}},setSkew:function(x,y){if(x===undefined){x=0}if(y===undefined){y=x}this.skewX=x;this.skewY=y;return this},setPerspective:function(value){this.parent.style.perspective=value+'px';return this},perspective:{get:function(){return parseFloat(this.parent.style.perspective)},set:function(value){this.parent.style.perspective=value+'px'}},addListener:function(events){if(this.node){events=events.split(' ');for(var i=0;i<events.length;i++){this.node.addEventListener(events[i],this.handler,false)}}return this},removeListener:function(events){if(this.node){events=events.split(' ');for(var i=0;i<events.length;i++){this.node.removeEventListener(events[i],this.handler)}}return this},dispatchNativeEvent:function(event){this.emit(event.type,event)},createElement:function(tagName,style,innerText){return this.setElement(document.createElement(tagName),style,innerText)},setElement:function(element,style,innerText){this.removeElement();var target;if(typeof element==='string'){if(element[0]==='#'){element=element.substr(1)}target=document.getElementById(element)}else if(typeof element==='object'&&element.nodeType===1){target=element}if(!target){return this}this.node=target;if(style&&IsPlainObject(style)){for(var key in style){target.style[key]=style[key]}}else if(typeof style==='string'){target.style=style}target.style.zIndex='0';target.style.display='inline';target.style.position='absolute';target.phaser=this;if(this.parent){this.parent.appendChild(target)}if(innerText){target.innerText=innerText}return this.updateSize()},createFromCache:function(key,tagName){var html=this.cache.get(key);if(html){this.createFromHTML(html,tagName)}return this},createFromHTML:function(html,tagName){if(tagName===undefined){tagName='div'}this.removeElement();var element=document.createElement(tagName);this.node=element;element.style.zIndex='0';element.style.display='inline';element.style.position='absolute';element.phaser=this;if(this.parent){this.parent.appendChild(element)}element.innerHTML=html;return this.updateSize()},removeElement:function(){if(this.node){RemoveFromDOM(this.node);this.node=null}return this},updateSize:function(){var node=this.node;var nodeBounds=node.getBoundingClientRect();this.width=node.clientWidth;this.height=node.clientHeight;this.displayWidth=nodeBounds.width||0;this.displayHeight=nodeBounds.height||0;return this},getChildByProperty:function(property,value){if(this.node){var children=this.node.querySelectorAll('*');for(var i=0;i<children.length;i++){if(children[i][property]===value){return children[i]}}}return null},getChildByID:function(id){return this.getChildByProperty('id',id)},getChildByName:function(name){return this.getChildByProperty('name',name)},setClassName:function(className){if(this.node){this.node.className=className;this.updateSize()}return this},setText:function(text){if(this.node){this.node.innerText=text;this.updateSize()}return this},setHTML:function(html){if(this.node){this.node.innerHTML=html;this.updateSize()}return this},preUpdate:function(){var parent=this.parentContainer;var node=this.node;if(node&&parent&&!parent.willRender()){node.style.display='none'}},willRender:function(){return true},preDestroy:function(){this.removeElement();this.scene.sys.events.off(SCENE_EVENTS.SLEEP,this.handleSceneEvent,this);this.scene.sys.events.off(SCENE_EVENTS.WAKE,this.handleSceneEvent,this)}});module.exports=DOMElement}),(function(module,exports,__webpack_require__){var CSSBlendModes=__webpack_require__(958);var GameObject=__webpack_require__(14);var DOMElementCSSRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var node=src.node;var style=node.style;var settings=src.scene.sys.settings;if(!node||!style||!settings.visible||GameObject.RENDER_MASK!==src.renderFlags||(src.cameraFilter!==0&&(src.cameraFilter&camera.id))||(src.parentContainer&&!src.parentContainer.willRender())){if(node){style.display='none'}return}var parent=src.parentContainer;var alpha=camera.alpha*src.alpha;if(parent){alpha*=parent.alpha}var camMatrix=renderer._tempMatrix1;var srcMatrix=renderer._tempMatrix2;var calcMatrix=renderer._tempMatrix3;var dx=0;var dy=0;var tx='0%';var ty='0%';if(parentMatrix){dx=(src.width*src.scaleX)*src.originX;dy=(src.height*src.scaleY)*src.originY;srcMatrix.applyITRS(src.x-dx,src.y-dy,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);srcMatrix.e=src.x-dx;srcMatrix.f=src.y-dy;camMatrix.multiply(srcMatrix,calcMatrix)}else{dx=(src.width)*src.originX;dy=(src.height)*src.originY;srcMatrix.applyITRS(src.x-dx,src.y-dy,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);tx=(100*src.originX)+'%';ty=(100*src.originY)+'%';srcMatrix.e-=camera.scrollX*src.scrollFactorX;srcMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(srcMatrix,calcMatrix)}if(!src.transformOnly){style.display='block';style.opacity=alpha;style.zIndex=src._depth;style.pointerEvents='auto';style.mixBlendMode=CSSBlendModes[src._blendMode]}style.transform=calcMatrix.getCSSMatrix()+' skew('+src.skewX+'rad, '+src.skewY+'rad)'+' rotate3d('+src.rotate3d.x+','+src.rotate3d.y+','+src.rotate3d.z+','+src.rotate3d.w+src.rotate3dAngle+')';style.transformOrigin=tx+' '+ty};module.exports=DOMElementCSSRenderer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameObject=__webpack_require__(14);var ExternRender=__webpack_require__(962);var Extern=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.Depth,Components.Flip,Components.Origin,Components.ScrollFactor,Components.Size,Components.Texture,Components.Tint,Components.Transform,Components.Visible,ExternRender],initialize:function Extern(scene){GameObject.call(this,scene,'Extern')},preUpdate:function(){},render:function(){}});module.exports=Extern}),(function(module,exports,__webpack_require__){var CircumferencePoint=__webpack_require__(193);var FromPercent=__webpack_require__(87);var MATH_CONST=__webpack_require__(13);var Point=__webpack_require__(4);var GetPoint=function(ellipse,position,out){if(out===undefined){out=new Point()}var angle=FromPercent(position,0,MATH_CONST.PI2);return CircumferencePoint(ellipse,angle,out)};module.exports=GetPoint}),(function(module,exports,__webpack_require__){var Circumference=__webpack_require__(400);var CircumferencePoint=__webpack_require__(193);var FromPercent=__webpack_require__(87);var MATH_CONST=__webpack_require__(13);var GetPoints=function(ellipse,quantity,stepRate,out){if(out===undefined){out=[]}if(!quantity&&stepRate>0){quantity=Circumference(ellipse)/stepRate}for(var i=0;i<quantity;i++){var angle=FromPercent(i/quantity,0,MATH_CONST.PI2);out.push(CircumferencePoint(ellipse,angle))}return out};module.exports=GetPoints}),(function(module,exports){var Circumference=function(ellipse){var rx=ellipse.width/2;var ry=ellipse.height/2;var h=Math.pow((rx-ry),2)/Math.pow((rx+ry),2);return(Math.PI*(rx+ry))*(1+((3*h)/(10+Math.sqrt(4-(3*h)))))};module.exports=Circumference}),(function(module,exports,__webpack_require__){var Commands=__webpack_require__(192);var SetTransform=__webpack_require__(28);var GraphicsCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix,renderTargetCtx,allowClip){var commandBuffer=src.commandBuffer;var commandBufferLength=commandBuffer.length;var ctx=renderTargetCtx||renderer.currentContext;if(commandBufferLength===0||!SetTransform(renderer,ctx,src,camera,parentMatrix)){return}var lineAlpha=1;var fillAlpha=1;var lineColor=0;var fillColor=0;var lineWidth=1;var red=0;var green=0;var blue=0;ctx.beginPath();for(var index=0;index<commandBufferLength;++index){var commandID=commandBuffer[index];switch(commandID){case Commands.ARC:ctx.arc(commandBuffer[index+1],commandBuffer[index+2],commandBuffer[index+3],commandBuffer[index+4],commandBuffer[index+5],commandBuffer[index+6]);index+=7;break;case Commands.LINE_STYLE:lineWidth=commandBuffer[index+1];lineColor=commandBuffer[index+2];lineAlpha=commandBuffer[index+3];red=((lineColor&0xFF0000)>>>16);green=((lineColor&0xFF00)>>>8);blue=(lineColor&0xFF);ctx.strokeStyle='rgba('+red+','+green+','+blue+','+lineAlpha+')';ctx.lineWidth=lineWidth;index+=3;break;case Commands.FILL_STYLE:fillColor=commandBuffer[index+1];fillAlpha=commandBuffer[index+2];red=((fillColor&0xFF0000)>>>16);green=((fillColor&0xFF00)>>>8);blue=(fillColor&0xFF);ctx.fillStyle='rgba('+red+','+green+','+blue+','+fillAlpha+')';index+=2;break;case Commands.BEGIN_PATH:ctx.beginPath();break;case Commands.CLOSE_PATH:ctx.closePath();break;case Commands.FILL_PATH:if(!allowClip){ctx.fill()}break;case Commands.STROKE_PATH:if(!allowClip){ctx.stroke()}break;case Commands.FILL_RECT:if(!allowClip){ctx.fillRect(commandBuffer[index+1],commandBuffer[index+2],commandBuffer[index+3],commandBuffer[index+4])}else{ctx.rect(commandBuffer[index+1],commandBuffer[index+2],commandBuffer[index+3],commandBuffer[index+4])}index+=4;break;case Commands.FILL_TRIANGLE:ctx.beginPath();ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]);ctx.lineTo(commandBuffer[index+3],commandBuffer[index+4]);ctx.lineTo(commandBuffer[index+5],commandBuffer[index+6]);ctx.closePath();if(!allowClip){ctx.fill()}index+=6;break;case Commands.STROKE_TRIANGLE:ctx.beginPath();ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]);ctx.lineTo(commandBuffer[index+3],commandBuffer[index+4]);ctx.lineTo(commandBuffer[index+5],commandBuffer[index+6]);ctx.closePath();if(!allowClip){ctx.stroke()}index+=6;break;case Commands.LINE_TO:ctx.lineTo(commandBuffer[index+1],commandBuffer[index+2]);index+=2;break;case Commands.MOVE_TO:ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]);index+=2;break;case Commands.LINE_FX_TO:ctx.lineTo(commandBuffer[index+1],commandBuffer[index+2]);index+=5;break;case Commands.MOVE_FX_TO:ctx.moveTo(commandBuffer[index+1],commandBuffer[index+2]);index+=5;break;case Commands.SAVE:ctx.save();break;case Commands.RESTORE:ctx.restore();break;case Commands.TRANSLATE:ctx.translate(commandBuffer[index+1],commandBuffer[index+2]);index+=2;break;case Commands.SCALE:ctx.scale(commandBuffer[index+1],commandBuffer[index+2]);index+=2;break;case Commands.ROTATE:ctx.rotate(commandBuffer[index+1]);index+=1;break;case Commands.GRADIENT_FILL_STYLE:index+=5;break;case Commands.GRADIENT_LINE_STYLE:index+=6;break;case Commands.SET_TEXTURE:index+=2;break}}ctx.restore()};module.exports=GraphicsCanvasRenderer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var GravityWell=new Class({initialize:function GravityWell(x,y,power,epsilon,gravity){if(typeof x==='object'){var config=x;x=GetFastValue(config,'x',0);y=GetFastValue(config,'y',0);power=GetFastValue(config,'power',0);epsilon=GetFastValue(config,'epsilon',100);gravity=GetFastValue(config,'gravity',50)}else{if(x===undefined){x=0}if(y===undefined){y=0}if(power===undefined){power=0}if(epsilon===undefined){epsilon=100}if(gravity===undefined){gravity=50}}this.x=x;this.y=y;this.active=true;this._gravity=gravity;this._power=0;this._epsilon=0;this.power=power;this.epsilon=epsilon},update:function(particle,delta){var x=this.x-particle.x;var y=this.y-particle.y;var dSq=x*x+y*y;if(dSq===0){return}var d=Math.sqrt(dSq);if(dSq<this._epsilon){dSq=this._epsilon}var factor=((this._power*delta)/(dSq*d))*100;particle.velocityX+=x*factor;particle.velocityY+=y*factor},epsilon:{get:function(){return Math.sqrt(this._epsilon)},set:function(value){this._epsilon=value*value}},power:{get:function(){return this._power/this._gravity},set:function(value){this._power=value*this._gravity}},gravity:{get:function(){return this._gravity},set:function(value){var pwr=this.power;this._gravity=value;this.power=pwr}}});module.exports=GravityWell}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var DegToRad=__webpack_require__(39);var DistanceBetween=__webpack_require__(53);var Particle=new Class({initialize:function Particle(emitter){this.emitter=emitter;this.frame=null;this.x=0;this.y=0;this.velocityX=0;this.velocityY=0;this.accelerationX=0;this.accelerationY=0;this.maxVelocityX=10000;this.maxVelocityY=10000;this.bounce=0;this.scaleX=1;this.scaleY=1;this.alpha=1;this.angle=0;this.rotation=0;this.tint=0xffffff;this.life=1000;this.lifeCurrent=1000;this.delayCurrent=0;this.lifeT=0;this.data={tint:{min:0xffffff,max:0xffffff,current:0xffffff},alpha:{min:1,max:1},rotate:{min:0,max:0},scaleX:{min:1,max:1},scaleY:{min:1,max:1}}},isAlive:function(){return(this.lifeCurrent>0)},resetPosition:function(){this.x=0;this.y=0},fire:function(x,y){var emitter=this.emitter;this.frame=emitter.getFrame();if(emitter.emitZone){emitter.emitZone.getPoint(this)}if(x===undefined){if(emitter.follow){this.x+=emitter.follow.x+emitter.followOffset.x}this.x+=emitter.x.onEmit(this,'x')}else{this.x+=x}if(y===undefined){if(emitter.follow){this.y+=emitter.follow.y+emitter.followOffset.y}this.y+=emitter.y.onEmit(this,'y')}else{this.y+=y}this.life=emitter.lifespan.onEmit(this,'lifespan');this.lifeCurrent=this.life;this.lifeT=0;var sx=emitter.speedX.onEmit(this,'speedX');var sy=(emitter.speedY)?emitter.speedY.onEmit(this,'speedY'):sx;if(emitter.radial){var rad=DegToRad(emitter.angle.onEmit(this,'angle'));this.velocityX=Math.cos(rad)*Math.abs(sx);this.velocityY=Math.sin(rad)*Math.abs(sy)}else if(emitter.moveTo){var mx=emitter.moveToX.onEmit(this,'moveToX');var my=(emitter.moveToY)?emitter.moveToY.onEmit(this,'moveToY'):mx;var angle=Math.atan2(my-this.y,mx-this.x);var speed=DistanceBetween(this.x,this.y,mx,my)/(this.life/1000);this.velocityX=Math.cos(angle)*speed;this.velocityY=Math.sin(angle)*speed}else{this.velocityX=sx;this.velocityY=sy}if(emitter.acceleration){this.accelerationX=emitter.accelerationX.onEmit(this,'accelerationX');this.accelerationY=emitter.accelerationY.onEmit(this,'accelerationY')}this.maxVelocityX=emitter.maxVelocityX.onEmit(this,'maxVelocityX');this.maxVelocityY=emitter.maxVelocityY.onEmit(this,'maxVelocityY');this.delayCurrent=emitter.delay.onEmit(this,'delay');this.scaleX=emitter.scaleX.onEmit(this,'scaleX');this.scaleY=(emitter.scaleY)?emitter.scaleY.onEmit(this,'scaleY'):this.scaleX;this.angle=emitter.rotate.onEmit(this,'rotate');this.rotation=DegToRad(this.angle);this.bounce=emitter.bounce.onEmit(this,'bounce');this.alpha=emitter.alpha.onEmit(this,'alpha');this.tint=emitter.tint.onEmit(this,'tint')},computeVelocity:function(emitter,delta,step,processors){var vx=this.velocityX;var vy=this.velocityY;var ax=this.accelerationX;var ay=this.accelerationY;var mx=this.maxVelocityX;var my=this.maxVelocityY;vx+=(emitter.gravityX*step);vy+=(emitter.gravityY*step);if(ax){vx+=(ax*step)}if(ay){vy+=(ay*step)}if(vx>mx){vx=mx}else if(vx<-mx){vx=-mx}if(vy>my){vy=my}else if(vy<-my){vy=-my}this.velocityX=vx;this.velocityY=vy;for(var i=0;i<processors.length;i++){processors[i].update(this,delta,step)}},checkBounds:function(emitter){var bounds=emitter.bounds;var bounce=-this.bounce;if(this.x<bounds.x&&emitter.collideLeft){this.x=bounds.x;this.velocityX*=bounce}else if(this.x>bounds.right&&emitter.collideRight){this.x=bounds.right;this.velocityX*=bounce}if(this.y<bounds.y&&emitter.collideTop){this.y=bounds.y;this.velocityY*=bounce}else if(this.y>bounds.bottom&&emitter.collideBottom){this.y=bounds.bottom;this.velocityY*=bounce}},update:function(delta,step,processors){if(this.delayCurrent>0){this.delayCurrent-=delta;return false}var emitter=this.emitter;var t=1-(this.lifeCurrent/this.life);this.lifeT=t;this.computeVelocity(emitter,delta,step,processors);this.x+=this.velocityX*step;this.y+=this.velocityY*step;if(emitter.bounds){this.checkBounds(emitter)}if(emitter.deathZone&&emitter.deathZone.willKill(this)){this.lifeCurrent=0;return true}this.scaleX=emitter.scaleX.onUpdate(this,'scaleX',t,this.scaleX);if(emitter.scaleY){this.scaleY=emitter.scaleY.onUpdate(this,'scaleY',t,this.scaleY)}else{this.scaleY=this.scaleX}this.angle=emitter.rotate.onUpdate(this,'rotate',t,this.angle);this.rotation=DegToRad(this.angle);this.alpha=emitter.alpha.onUpdate(this,'alpha',t,this.alpha);this.tint=emitter.tint.onUpdate(this,'tint',t,this.tint);this.lifeCurrent-=delta;return(this.lifeCurrent<=0)}});module.exports=Particle}),(function(module,exports,__webpack_require__){var BlendModes=__webpack_require__(52);var Class=__webpack_require__(0);var Components=__webpack_require__(12);var DeathZone=__webpack_require__(405);var EdgeZone=__webpack_require__(406);var EmitterOp=__webpack_require__(974);var GetFastValue=__webpack_require__(2);var GetRandom=__webpack_require__(185);var HasAny=__webpack_require__(407);var HasValue=__webpack_require__(108);var Particle=__webpack_require__(403);var RandomZone=__webpack_require__(408);var Rectangle=__webpack_require__(11);var StableSort=__webpack_require__(131);var Vector2=__webpack_require__(3);var Wrap=__webpack_require__(58);var ParticleEmitter=new Class({Mixins:[Components.BlendMode,Components.Mask,Components.ScrollFactor,Components.Visible],initialize:function ParticleEmitter(manager,config){this.manager=manager;this.texture=manager.texture;this.frames=[manager.defaultFrame];this.defaultFrame=manager.defaultFrame;this.configFastMap=['active','blendMode','collideBottom','collideLeft','collideRight','collideTop','deathCallback','deathCallbackScope','emitCallback','emitCallbackScope','follow','frequency','gravityX','gravityY','maxParticles','name','on','particleBringToTop','particleClass','radial','timeScale','trackVisible','visible'];this.configOpMap=['accelerationX','accelerationY','angle','alpha','bounce','delay','lifespan','maxVelocityX','maxVelocityY','moveToX','moveToY','quantity','rotate','scaleX','scaleY','speedX','speedY','tint','x','y'];this.name='';this.particleClass=Particle;this.x=new EmitterOp(config,'x',0,true);this.y=new EmitterOp(config,'y',0,true);this.radial=true;this.gravityX=0;this.gravityY=0;this.acceleration=false;this.accelerationX=new EmitterOp(config,'accelerationX',0,true);this.accelerationY=new EmitterOp(config,'accelerationY',0,true);this.maxVelocityX=new EmitterOp(config,'maxVelocityX',10000,true);this.maxVelocityY=new EmitterOp(config,'maxVelocityY',10000,true);this.speedX=new EmitterOp(config,'speedX',0,true);this.speedY=new EmitterOp(config,'speedY',0,true);this.moveTo=false;this.moveToX=new EmitterOp(config,'moveToX',0,true);this.moveToY=new EmitterOp(config,'moveToY',0,true);this.bounce=new EmitterOp(config,'bounce',0,true);this.scaleX=new EmitterOp(config,'scaleX',1);this.scaleY=new EmitterOp(config,'scaleY',1);this.tint=new EmitterOp(config,'tint',0xffffffff);this.alpha=new EmitterOp(config,'alpha',1);this.lifespan=new EmitterOp(config,'lifespan',1000,true);this.angle=new EmitterOp(config,'angle',{min:0,max:360},true);this.rotate=new EmitterOp(config,'rotate',0);this.emitCallback=null;this.emitCallbackScope=null;this.deathCallback=null;this.deathCallbackScope=null;this.maxParticles=0;this.quantity=new EmitterOp(config,'quantity',1,true);this.delay=new EmitterOp(config,'delay',0,true);this.frequency=0;this.on=true;this.particleBringToTop=true;this.timeScale=1;this.emitZone=null;this.deathZone=null;this.bounds=null;this.collideLeft=true;this.collideRight=true;this.collideTop=true;this.collideBottom=true;this.active=true;this.visible=true;this.blendMode=BlendModes.NORMAL;this.follow=null;this.followOffset=new Vector2();this.trackVisible=false;this.currentFrame=0;this.randomFrame=true;this.frameQuantity=1;this.dead=[];this.alive=[];this._counter=0;this._frameCounter=0;if(config){this.fromJSON(config)}},fromJSON:function(config){if(!config){return this}var i=0;var key='';for(i=0;i<this.configFastMap.length;i++){key=this.configFastMap[i];if(HasValue(config,key)){this[key]=GetFastValue(config,key)}}for(i=0;i<this.configOpMap.length;i++){key=this.configOpMap[i];if(HasValue(config,key)){this[key].loadConfig(config)}}this.acceleration=(this.accelerationX.propertyValue!==0||this.accelerationY.propertyValue!==0);this.moveTo=(this.moveToX.propertyValue!==0||this.moveToY.propertyValue!==0);if(HasValue(config,'speed')){this.speedX.loadConfig(config,'speed');this.speedY=null}if(HasAny(config,['speedX','speedY'])||this.moveTo){this.radial=false}if(HasValue(config,'scale')){this.scaleX.loadConfig(config,'scale');this.scaleY=null}if(HasValue(config,'callbackScope')){var callbackScope=GetFastValue(config,'callbackScope',null);this.emitCallbackScope=callbackScope;this.deathCallbackScope=callbackScope}if(HasValue(config,'emitZone')){this.setEmitZone(config.emitZone)}if(HasValue(config,'deathZone')){this.setDeathZone(config.deathZone)}if(HasValue(config,'bounds')){this.setBounds(config.bounds)}if(HasValue(config,'followOffset')){this.followOffset.setFromObject(GetFastValue(config,'followOffset',0))}if(HasValue(config,'frame')){this.setFrame(config.frame)}return this},toJSON:function(output){if(output===undefined){output={}}var i=0;var key='';for(i=0;i<this.configFastMap.length;i++){key=this.configFastMap[i];output[key]=this[key]}for(i=0;i<this.configOpMap.length;i++){key=this.configOpMap[i];if(this[key]){output[key]=this[key].toJSON()}}if(!this.speedY){delete output.speedX;output.speed=this.speedX.toJSON()}if(!this.scaleY){delete output.scaleX;output.scale=this.scaleX.toJSON()}return output},startFollow:function(target,offsetX,offsetY,trackVisible){if(offsetX===undefined){offsetX=0}if(offsetY===undefined){offsetY=0}if(trackVisible===undefined){trackVisible=false}this.follow=target;this.followOffset.set(offsetX,offsetY);this.trackVisible=trackVisible;return this},stopFollow:function(){this.follow=null;this.followOffset.set(0,0);this.trackVisible=false;return this},getFrame:function(){if(this.frames.length===1){return this.defaultFrame}else if(this.randomFrame){return GetRandom(this.frames)}else{var frame=this.frames[this.currentFrame];this._frameCounter++;if(this._frameCounter===this.frameQuantity){this._frameCounter=0;this.currentFrame=Wrap(this.currentFrame+1,0,this._frameLength)}return frame}},setFrame:function(frames,pickRandom,quantity){if(pickRandom===undefined){pickRandom=true}if(quantity===undefined){quantity=1}this.randomFrame=pickRandom;this.frameQuantity=quantity;this.currentFrame=0;this._frameCounter=0;var t=typeof(frames);if(Array.isArray(frames)||t==='string'||t==='number'){this.manager.setEmitterFrames(frames,this)}else if(t==='object'){var frameConfig=frames;frames=GetFastValue(frameConfig,'frames',null);if(frames){this.manager.setEmitterFrames(frames,this)}var isCycle=GetFastValue(frameConfig,'cycle',false);this.randomFrame=(isCycle)?false:true;this.frameQuantity=GetFastValue(frameConfig,'quantity',quantity)}this._frameLength=this.frames.length;if(this._frameLength===1){this.frameQuantity=1;this.randomFrame=false}return this},setRadial:function(value){if(value===undefined){value=true}this.radial=value;return this},setPosition:function(x,y){this.x.onChange(x);this.y.onChange(y);return this},setBounds:function(x,y,width,height){if(typeof x==='object'){var obj=x;x=obj.x;y=obj.y;width=(HasValue(obj,'w'))?obj.w:obj.width;height=(HasValue(obj,'h'))?obj.h:obj.height}if(this.bounds){this.bounds.setTo(x,y,width,height)}else{this.bounds=new Rectangle(x,y,width,height)}return this},setSpeedX:function(value){this.speedX.onChange(value);this.radial=false;return this},setSpeedY:function(value){if(this.speedY){this.speedY.onChange(value);this.radial=false}return this},setSpeed:function(value){this.speedX.onChange(value);this.speedY=null;this.radial=true;return this},setScaleX:function(value){this.scaleX.onChange(value);return this},setScaleY:function(value){this.scaleY.onChange(value);return this},setScale:function(value){this.scaleX.onChange(value);this.scaleY=null;return this},setGravityX:function(value){this.gravityX=value;return this},setGravityY:function(value){this.gravityY=value;return this},setGravity:function(x,y){this.gravityX=x;this.gravityY=y;return this},setAlpha:function(value){this.alpha.onChange(value);return this},setTint:function(value){this.tint.onChange(value);return this},setEmitterAngle:function(value){this.angle.onChange(value);return this},setAngle:function(value){this.angle.onChange(value);return this},setLifespan:function(value){this.lifespan.onChange(value);return this},setQuantity:function(quantity){this.quantity.onChange(quantity);return this},setFrequency:function(frequency,quantity){this.frequency=frequency;this._counter=0;if(quantity){this.quantity.onChange(quantity)}return this},setEmitZone:function(zoneConfig){if(zoneConfig===undefined){this.emitZone=null}else{var type=GetFastValue(zoneConfig,'type','random');var source=GetFastValue(zoneConfig,'source',null);switch(type){case'random':this.emitZone=new RandomZone(source);break;case'edge':var quantity=GetFastValue(zoneConfig,'quantity',1);var stepRate=GetFastValue(zoneConfig,'stepRate',0);var yoyo=GetFastValue(zoneConfig,'yoyo',false);var seamless=GetFastValue(zoneConfig,'seamless',true);this.emitZone=new EdgeZone(source,quantity,stepRate,yoyo,seamless);break}}return this},setDeathZone:function(zoneConfig){if(zoneConfig===undefined){this.deathZone=null}else{var type=GetFastValue(zoneConfig,'type','onEnter');var source=GetFastValue(zoneConfig,'source',null);if(source&&typeof source.contains==='function'){var killOnEnter=(type==='onEnter')?true:false;this.deathZone=new DeathZone(source,killOnEnter)}}return this},reserve:function(particleCount){var dead=this.dead;for(var i=0;i<particleCount;i++){dead.push(new this.particleClass(this))}return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return(this.maxParticles>0&&this.getParticleCount()===this.maxParticles)},onParticleEmit:function(callback,context){if(callback===undefined){this.emitCallback=null;this.emitCallbackScope=null}else if(typeof callback==='function'){this.emitCallback=callback;if(context){this.emitCallbackScope=context}}return this},onParticleDeath:function(callback,context){if(callback===undefined){this.deathCallback=null;this.deathCallbackScope=null}else if(typeof callback==='function'){this.deathCallback=callback;if(context){this.deathCallbackScope=context}}return this},killAll:function(){var dead=this.dead;var alive=this.alive;while(alive.length>0){dead.push(alive.pop())}return this},forEachAlive:function(callback,context){var alive=this.alive;var length=alive.length;for(var index=0;index<length;++index){callback.call(context,alive[index],this)}return this},forEachDead:function(callback,context){var dead=this.dead;var length=dead.length;for(var index=0;index<length;++index){callback.call(context,dead[index],this)}return this},start:function(){this.on=true;this._counter=0;return this},stop:function(){this.on=false;return this},pause:function(){this.active=false;return this},resume:function(){this.active=true;return this},remove:function(){this.manager.removeEmitter(this);return this},depthSort:function(){StableSort.inplace(this.alive,this.depthSortCallback);return this},flow:function(frequency,count){if(count===undefined){count=1}this.frequency=frequency;this.quantity.onChange(count);return this.start()},explode:function(count,x,y){this.frequency=-1;return this.emitParticle(count,x,y)},emitParticleAt:function(x,y,count){return this.emitParticle(count,x,y)},emitParticle:function(count,x,y){if(this.atLimit()){return}if(count===undefined){count=this.quantity.onEmit()}var dead=this.dead;for(var i=0;i<count;i++){var particle=dead.pop();if(!particle){particle=new this.particleClass(this)}particle.fire(x,y);if(this.particleBringToTop){this.alive.push(particle)}else{this.alive.unshift(particle)}if(this.emitCallback){this.emitCallback.call(this.emitCallbackScope,particle,this)}if(this.atLimit()){break}}return particle},preUpdate:function(time,delta){delta*=this.timeScale;var step=(delta/1000);if(this.trackVisible){this.visible=this.follow.visible}var processors=this.manager.getProcessors();var particles=this.alive;var dead=this.dead;var i=0;var rip=[];var length=particles.length;for(i=0;i<length;i++){var particle=particles[i];if(particle.update(delta,step,processors)){rip.push({index:i,particle:particle})}}length=rip.length;if(length>0){var deathCallback=this.deathCallback;var deathCallbackScope=this.deathCallbackScope;for(i=length-1;i>=0;i--){var entry=rip[i];particles.splice(entry.index,1);dead.push(entry.particle);if(deathCallback){deathCallback.call(deathCallbackScope,entry.particle)}entry.particle.resetPosition()}}if(!this.on){return}if(this.frequency===0){this.emitParticle()}else if(this.frequency>0){this._counter-=delta;if(this._counter<=0){this.emitParticle();this._counter=(this.frequency-Math.abs(this._counter))}}},depthSortCallback:function(a,b){return a.y-b.y}});module.exports=ParticleEmitter}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var DeathZone=new Class({initialize:function DeathZone(source,killOnEnter){this.source=source;this.killOnEnter=killOnEnter},willKill:function(particle){var withinZone=this.source.contains(particle.x,particle.y);return(withinZone&&this.killOnEnter||!withinZone&&!this.killOnEnter)}});module.exports=DeathZone}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EdgeZone=new Class({initialize:function EdgeZone(source,quantity,stepRate,yoyo,seamless){if(yoyo===undefined){yoyo=false}if(seamless===undefined){seamless=true}this.source=source;this.points=[];this.quantity=quantity;this.stepRate=stepRate;this.yoyo=yoyo;this.counter=-1;this.seamless=seamless;this._length=0;this._direction=0;this.updateSource()},updateSource:function(){this.points=this.source.getPoints(this.quantity,this.stepRate);if(this.seamless){var a=this.points[0];var b=this.points[this.points.length-1];if(a.x===b.x&&a.y===b.y){this.points.pop()}}var oldLength=this._length;this._length=this.points.length;if(this._length<oldLength&&this.counter>this._length){this.counter=this._length-1}return this},changeSource:function(source){this.source=source;return this.updateSource()},getPoint:function(particle){if(this._direction===0){this.counter++;if(this.counter>=this._length){if(this.yoyo){this._direction=1;this.counter=this._length-1}else{this.counter=0}}}else{this.counter--;if(this.counter===-1){if(this.yoyo){this._direction=0;this.counter=0}else{this.counter=this._length-1}}}var point=this.points[this.counter];if(point){particle.x=point.x;particle.y=point.y}}});module.exports=EdgeZone}),(function(module,exports){var HasAny=function(source,keys){for(var i=0;i<keys.length;i++){if(source.hasOwnProperty(keys[i])){return true}}return false};module.exports=HasAny}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Vector2=__webpack_require__(3);var RandomZone=new Class({initialize:function RandomZone(source){this.source=source;this._tempVec=new Vector2()},getPoint:function(particle){var vec=this._tempVec;this.source.getRandomPoint(vec);particle.x=vec.x;particle.y=vec.y}});module.exports=RandomZone}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var Sprite=__webpack_require__(75);var PathFollower=new Class({Extends:Sprite,Mixins:[Components.PathFollower],initialize:function PathFollower(scene,path,x,y,texture,frame){Sprite.call(this,scene,x,y,texture,frame);this.path=path},preUpdate:function(time,delta){this.anims.update(time,delta);this.pathUpdate(time)}});module.exports=PathFollower}),(function(module,exports,__webpack_require__){var ArcRender=__webpack_require__(1000);var Class=__webpack_require__(0);var DegToRad=__webpack_require__(39);var Earcut=__webpack_require__(66);var GeomCircle=__webpack_require__(65);var MATH_CONST=__webpack_require__(13);var Shape=__webpack_require__(30);var Arc=new Class({Extends:Shape,Mixins:[ArcRender],initialize:function Arc(scene,x,y,radius,startAngle,endAngle,anticlockwise,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(radius===undefined){radius=128}if(startAngle===undefined){startAngle=0}if(endAngle===undefined){endAngle=360}if(anticlockwise===undefined){anticlockwise=false}Shape.call(this,scene,'Arc',new GeomCircle(0,0,radius));this._startAngle=startAngle;this._endAngle=endAngle;this._anticlockwise=anticlockwise;this._iterations=0.01;this.setPosition(x,y);var diameter=this.geom.radius*2;this.setSize(diameter,diameter);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateDisplayOrigin();this.updateData()},iterations:{get:function(){return this._iterations},set:function(value){this._iterations=value;this.updateData()}},radius:{get:function(){return this.geom.radius},set:function(value){this.geom.radius=value;var diameter=value*2;this.setSize(diameter,diameter);this.updateDisplayOrigin();this.updateData()}},startAngle:{get:function(){return this._startAngle},set:function(value){this._startAngle=value;this.updateData()}},endAngle:{get:function(){return this._endAngle},set:function(value){this._endAngle=value;this.updateData()}},anticlockwise:{get:function(){return this._anticlockwise},set:function(value){this._anticlockwise=value;this.updateData()}},setRadius:function(value){this.radius=value;return this},setIterations:function(value){if(value===undefined){value=0.01}this.iterations=value;return this},setStartAngle:function(angle,anticlockwise){this._startAngle=angle;if(anticlockwise!==undefined){this._anticlockwise=anticlockwise}return this.updateData()},setEndAngle:function(angle,anticlockwise){this._endAngle=angle;if(anticlockwise!==undefined){this._anticlockwise=anticlockwise}return this.updateData()},updateData:function(){var step=this._iterations;var iteration=step;var radius=this.geom.radius;var startAngle=DegToRad(this._startAngle);var endAngle=DegToRad(this._endAngle);var anticlockwise=this._anticlockwise;var x=radius;var y=radius;endAngle-=startAngle;if(anticlockwise){if(endAngle<-MATH_CONST.PI2){endAngle=-MATH_CONST.PI2}else if(endAngle>0){endAngle=-MATH_CONST.PI2+endAngle%MATH_CONST.PI2}}else if(endAngle>MATH_CONST.PI2){endAngle=MATH_CONST.PI2}else if(endAngle<0){endAngle=MATH_CONST.PI2+endAngle%MATH_CONST.PI2}var path=[x+Math.cos(startAngle)*radius,y+Math.sin(startAngle)*radius];var ta;while(iteration<1){ta=endAngle*iteration+startAngle;path.push(x+Math.cos(ta)*radius,y+Math.sin(ta)*radius);iteration+=step}ta=endAngle+startAngle;path.push(x+Math.cos(ta)*radius,y+Math.sin(ta)*radius);path.push(x+Math.cos(startAngle)*radius,y+Math.sin(startAngle)*radius);this.pathIndexes=Earcut(path);this.pathData=path;return this}});module.exports=Arc}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CurveRender=__webpack_require__(1003);var Earcut=__webpack_require__(66);var Rectangle=__webpack_require__(11);var Shape=__webpack_require__(30);var Curve=new Class({Extends:Shape,Mixins:[CurveRender],initialize:function Curve(scene,x,y,curve,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}Shape.call(this,scene,'Curve',curve);this._smoothness=32;this._curveBounds=new Rectangle();this.closePath=false;this.setPosition(x,y);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(value){this._smoothness=value;this.updateData()}},setSmoothness:function(value){this._smoothness=value;return this.updateData()},updateData:function(){var bounds=this._curveBounds;var smoothness=this._smoothness;this.geom.getBounds(bounds,smoothness);this.setSize(bounds.width,bounds.height);this.updateDisplayOrigin();var path=[];var points=this.geom.getPoints(smoothness);for(var i=0;i<points.length;i++){path.push(points[i].x,points[i].y)}path.push(points[0].x,points[0].y);this.pathIndexes=Earcut(path);this.pathData=path;return this}});module.exports=Curve}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Earcut=__webpack_require__(66);var EllipseRender=__webpack_require__(1006);var GeomEllipse=__webpack_require__(95);var Shape=__webpack_require__(30);var Ellipse=new Class({Extends:Shape,Mixins:[EllipseRender],initialize:function Ellipse(scene,x,y,width,height,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=128}if(height===undefined){height=128}Shape.call(this,scene,'Ellipse',new GeomEllipse(width/2,height/2,width,height));this._smoothness=64;this.setPosition(x,y);this.width=width;this.height=height;if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateDisplayOrigin();this.updateData()},smoothness:{get:function(){return this._smoothness},set:function(value){this._smoothness=value;this.updateData()}},setSize:function(width,height){this.geom.setSize(width,height);return this.updateData()},setSmoothness:function(value){this._smoothness=value;return this.updateData()},updateData:function(){var path=[];var points=this.geom.getPoints(this._smoothness);for(var i=0;i<points.length;i++){path.push(points[i].x,points[i].y)}path.push(points[0].x,points[0].y);this.pathIndexes=Earcut(path);this.pathData=path;return this}});module.exports=Ellipse}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Shape=__webpack_require__(30);var GridRender=__webpack_require__(1009);var Grid=new Class({Extends:Shape,Mixins:[GridRender],initialize:function Grid(scene,x,y,width,height,cellWidth,cellHeight,fillColor,fillAlpha,outlineFillColor,outlineFillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=128}if(height===undefined){height=128}if(cellWidth===undefined){cellWidth=32}if(cellHeight===undefined){cellHeight=32}Shape.call(this,scene,'Grid',null);this.cellWidth=cellWidth;this.cellHeight=cellHeight;this.showCells=true;this.outlineFillColor=0;this.outlineFillAlpha=0;this.showOutline=true;this.showAltCells=false;this.altFillColor;this.altFillAlpha;this.setPosition(x,y);this.setSize(width,height);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}if(outlineFillColor!==undefined){this.setOutlineStyle(outlineFillColor,outlineFillAlpha)}this.updateDisplayOrigin()},setFillStyle:function(fillColor,fillAlpha){if(fillAlpha===undefined){fillAlpha=1}if(fillColor===undefined){this.showCells=false}else{this.fillColor=fillColor;this.fillAlpha=fillAlpha;this.showCells=true}return this},setAltFillStyle:function(fillColor,fillAlpha){if(fillAlpha===undefined){fillAlpha=1}if(fillColor===undefined){this.showAltCells=false}else{this.altFillColor=fillColor;this.altFillAlpha=fillAlpha;this.showAltCells=true}return this},setOutlineStyle:function(fillColor,fillAlpha){if(fillAlpha===undefined){fillAlpha=1}if(fillColor===undefined){this.showOutline=false}else{this.outlineFillColor=fillColor;this.outlineFillAlpha=fillAlpha;this.showOutline=true}return this}});module.exports=Grid}),(function(module,exports,__webpack_require__){var IsoBoxRender=__webpack_require__(1012);var Class=__webpack_require__(0);var Shape=__webpack_require__(30);var IsoBox=new Class({Extends:Shape,Mixins:[IsoBoxRender],initialize:function IsoBox(scene,x,y,size,height,fillTop,fillLeft,fillRight){if(x===undefined){x=0}if(y===undefined){y=0}if(size===undefined){size=48}if(height===undefined){height=32}if(fillTop===undefined){fillTop=0xeeeeee}if(fillLeft===undefined){fillLeft=0x999999}if(fillRight===undefined){fillRight=0xcccccc}Shape.call(this,scene,'IsoBox',null);this.projection=4;this.fillTop=fillTop;this.fillLeft=fillLeft;this.fillRight=fillRight;this.showTop=true;this.showLeft=true;this.showRight=true;this.isFilled=true;this.setPosition(x,y);this.setSize(size,height);this.updateDisplayOrigin()},setProjection:function(value){this.projection=value;return this},setFaces:function(showTop,showLeft,showRight){if(showTop===undefined){showTop=true}if(showLeft===undefined){showLeft=true}if(showRight===undefined){showRight=true}this.showTop=showTop;this.showLeft=showLeft;this.showRight=showRight;return this},setFillStyle:function(fillTop,fillLeft,fillRight){this.fillTop=fillTop;this.fillLeft=fillLeft;this.fillRight=fillRight;this.isFilled=true;return this}});module.exports=IsoBox}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var IsoTriangleRender=__webpack_require__(1015);var Shape=__webpack_require__(30);var IsoTriangle=new Class({Extends:Shape,Mixins:[IsoTriangleRender],initialize:function IsoTriangle(scene,x,y,size,height,reversed,fillTop,fillLeft,fillRight){if(x===undefined){x=0}if(y===undefined){y=0}if(size===undefined){size=48}if(height===undefined){height=32}if(reversed===undefined){reversed=false}if(fillTop===undefined){fillTop=0xeeeeee}if(fillLeft===undefined){fillLeft=0x999999}if(fillRight===undefined){fillRight=0xcccccc}Shape.call(this,scene,'IsoTriangle',null);this.projection=4;this.fillTop=fillTop;this.fillLeft=fillLeft;this.fillRight=fillRight;this.showTop=true;this.showLeft=true;this.showRight=true;this.isReversed=reversed;this.isFilled=true;this.setPosition(x,y);this.setSize(size,height);this.updateDisplayOrigin()},setProjection:function(value){this.projection=value;return this},setReversed:function(reversed){this.isReversed=reversed;return this},setFaces:function(showTop,showLeft,showRight){if(showTop===undefined){showTop=true}if(showLeft===undefined){showLeft=true}if(showRight===undefined){showRight=true}this.showTop=showTop;this.showLeft=showLeft;this.showRight=showRight;return this},setFillStyle:function(fillTop,fillLeft,fillRight){this.fillTop=fillTop;this.fillLeft=fillLeft;this.fillRight=fillRight;this.isFilled=true;return this}});module.exports=IsoTriangle}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Shape=__webpack_require__(30);var GeomLine=__webpack_require__(56);var LineRender=__webpack_require__(1018);var Line=new Class({Extends:Shape,Mixins:[LineRender],initialize:function Line(scene,x,y,x1,y1,x2,y2,strokeColor,strokeAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(x1===undefined){x1=0}if(y1===undefined){y1=0}if(x2===undefined){x2=128}if(y2===undefined){y2=0}Shape.call(this,scene,'Line',new GeomLine(x1,y1,x2,y2));var width=this.geom.right-this.geom.left;var height=this.geom.bottom-this.geom.top;this.lineWidth=1;this._startWidth=1;this._endWidth=1;this.setPosition(x,y);this.setSize(width,height);if(strokeColor!==undefined){this.setStrokeStyle(1,strokeColor,strokeAlpha)}this.updateDisplayOrigin()},setLineWidth:function(startWidth,endWidth){if(endWidth===undefined){endWidth=startWidth}this._startWidth=startWidth;this._endWidth=endWidth;this.lineWidth=startWidth;return this},setTo:function(x1,y1,x2,y2){this.geom.setTo(x1,y1,x2,y2);return this}});module.exports=Line}),(function(module,exports,__webpack_require__){var PolygonRender=__webpack_require__(1021);var Class=__webpack_require__(0);var Earcut=__webpack_require__(66);var GetAABB=__webpack_require__(418);var GeomPolygon=__webpack_require__(201);var Shape=__webpack_require__(30);var Smooth=__webpack_require__(421);var Polygon=new Class({Extends:Shape,Mixins:[PolygonRender],initialize:function Polygon(scene,x,y,points,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}Shape.call(this,scene,'Polygon',new GeomPolygon(points));var bounds=GetAABB(this.geom);this.setPosition(x,y);this.setSize(bounds.width,bounds.height);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateDisplayOrigin();this.updateData()},smooth:function(iterations){if(iterations===undefined){iterations=1}for(var i=0;i<iterations;i++){Smooth(this.geom)}return this.updateData()},updateData:function(){var path=[];var points=this.geom.points;for(var i=0;i<points.length;i++){path.push(points[i].x,points[i].y)}path.push(points[0].x,points[0].y);this.pathIndexes=Earcut(path);this.pathData=path;return this}});module.exports=Polygon}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var GetAABB=function(polygon,out){if(out===undefined){out=new Rectangle()}var minX=Infinity;var minY=Infinity;var maxX=-minX;var maxY=-minY;var p;for(var i=0;i<polygon.points.length;i++){p=polygon.points[i];minX=Math.min(minX,p.x);minY=Math.min(minY,p.y);maxX=Math.max(maxX,p.x);maxY=Math.max(maxY,p.y)}out.x=minX;out.y=minY;out.width=maxX-minX;out.height=maxY-minY;return out};module.exports=GetAABB}),(function(module,exports,__webpack_require__){var Length=__webpack_require__(57);var Line=__webpack_require__(56);var Perimeter=__webpack_require__(420);var GetPoints=function(polygon,quantity,stepRate,out){if(out===undefined){out=[]}var points=polygon.points;var perimeter=Perimeter(polygon);if(!quantity&&stepRate>0){quantity=perimeter/stepRate}for(var i=0;i<quantity;i++){var position=perimeter*(i/quantity);var accumulatedPerimeter=0;for(var j=0;j<points.length;j++){var pointA=points[j];var pointB=points[(j+1)%points.length];var line=new Line(pointA.x,pointA.y,pointB.x,pointB.y);var length=Length(line);if(position<accumulatedPerimeter||position>accumulatedPerimeter+length){accumulatedPerimeter+=length;continue}var point=line.getPoint((position-accumulatedPerimeter)/length);out.push(point);break}}return out};module.exports=GetPoints}),(function(module,exports,__webpack_require__){var Length=__webpack_require__(57);var Line=__webpack_require__(56);var Perimeter=function(polygon){var points=polygon.points;var perimeter=0;for(var i=0;i<points.length;i++){var pointA=points[i];var pointB=points[(i+1)%points.length];var line=new Line(pointA.x,pointA.y,pointB.x,pointB.y);perimeter+=Length(line)}return perimeter};module.exports=Perimeter}),(function(module,exports){var copy=function(out,a){out[0]=a[0];out[1]=a[1];return out};var Smooth=function(polygon){var i;var points=[];var data=polygon.points;for(i=0;i<data.length;i++){points.push([data[i].x,data[i].y])}var output=[];if(points.length>0){output.push(copy([0,0],points[0]))}for(i=0;i<points.length-1;i++){var p0=points[i];var p1=points[i+1];var p0x=p0[0];var p0y=p0[1];var p1x=p1[0];var p1y=p1[1];output.push([0.85*p0x+0.15*p1x,0.85*p0y+0.15*p1y]);output.push([0.15*p0x+0.85*p1x,0.15*p0y+0.85*p1y])}if(points.length>1){output.push(copy([0,0],points[points.length-1]))}return polygon.setTo(output)};module.exports=Smooth}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GeomRectangle=__webpack_require__(11);var Shape=__webpack_require__(30);var RectangleRender=__webpack_require__(1024);var Rectangle=new Class({Extends:Shape,Mixins:[RectangleRender],initialize:function Rectangle(scene,x,y,width,height,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=128}if(height===undefined){height=128}Shape.call(this,scene,'Rectangle',new GeomRectangle(0,0,width,height));this.setPosition(x,y);this.setSize(width,height);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateDisplayOrigin();this.updateData()},updateData:function(){var path=[];var rect=this.geom;var line=this._tempLine;rect.getLineA(line);path.push(line.x1,line.y1,line.x2,line.y2);rect.getLineB(line);path.push(line.x2,line.y2);rect.getLineC(line);path.push(line.x2,line.y2);rect.getLineD(line);path.push(line.x2,line.y2);this.pathData=path;return this}});module.exports=Rectangle}),(function(module,exports,__webpack_require__){var StarRender=__webpack_require__(1027);var Class=__webpack_require__(0);var Earcut=__webpack_require__(66);var Shape=__webpack_require__(30);var Star=new Class({Extends:Shape,Mixins:[StarRender],initialize:function Star(scene,x,y,points,innerRadius,outerRadius,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(points===undefined){points=5}if(innerRadius===undefined){innerRadius=32}if(outerRadius===undefined){outerRadius=64}Shape.call(this,scene,'Star',null);this._points=points;this._innerRadius=innerRadius;this._outerRadius=outerRadius;this.setPosition(x,y);this.setSize(outerRadius*2,outerRadius*2);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateDisplayOrigin();this.updateData()},setPoints:function(value){this._points=value;return this.updateData()},setInnerRadius:function(value){this._innerRadius=value;return this.updateData()},setOuterRadius:function(value){this._outerRadius=value;return this.updateData()},points:{get:function(){return this._points},set:function(value){this._points=value;this.updateData()}},innerRadius:{get:function(){return this._innerRadius},set:function(value){this._innerRadius=value;this.updateData()}},outerRadius:{get:function(){return this._outerRadius},set:function(value){this._outerRadius=value;this.updateData()}},updateData:function(){var path=[];var points=this._points;var innerRadius=this._innerRadius;var outerRadius=this._outerRadius;var rot=Math.PI/2*3;var step=Math.PI/points;var x=outerRadius;var y=outerRadius;path.push(x,y+ -outerRadius);for(var i=0;i<points;i++){path.push(x+Math.cos(rot)*outerRadius,y+Math.sin(rot)*outerRadius);rot+=step;path.push(x+Math.cos(rot)*innerRadius,y+Math.sin(rot)*innerRadius);rot+=step}path.push(x,y+ -outerRadius);this.pathIndexes=Earcut(path);this.pathData=path;return this}});module.exports=Star}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Shape=__webpack_require__(30);var GeomTriangle=__webpack_require__(71);var TriangleRender=__webpack_require__(1030);var Triangle=new Class({Extends:Shape,Mixins:[TriangleRender],initialize:function Triangle(scene,x,y,x1,y1,x2,y2,x3,y3,fillColor,fillAlpha){if(x===undefined){x=0}if(y===undefined){y=0}if(x1===undefined){x1=0}if(y1===undefined){y1=128}if(x2===undefined){x2=64}if(y2===undefined){y2=0}if(x3===undefined){x3=128}if(y3===undefined){y3=128}Shape.call(this,scene,'Triangle',new GeomTriangle(x1,y1,x2,y2,x3,y3));var width=this.geom.right-this.geom.left;var height=this.geom.bottom-this.geom.top;this.setPosition(x,y);this.setSize(width,height);if(fillColor!==undefined){this.setFillStyle(fillColor,fillAlpha)}this.updateDisplayOrigin();this.updateData()},setTo:function(x1,y1,x2,y2,x3,y3){this.geom.setTo(x1,y1,x2,y2,x3,y3);return this.updateData()},updateData:function(){var path=[];var tri=this.geom;var line=this._tempLine;tri.getLineA(line);path.push(line.x1,line.y1,line.x2,line.y2);tri.getLineB(line);path.push(line.x2,line.y2);tri.getLineC(line);path.push(line.x2,line.y2);this.pathData=path;return this}});module.exports=Triangle}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Length=__webpack_require__(57);var GetPoint=function(triangle,position,out){if(out===undefined){out=new Point()}var line1=triangle.getLineA();var line2=triangle.getLineB();var line3=triangle.getLineC();if(position<=0||position>=1){out.x=line1.x1;out.y=line1.y1;return out}var length1=Length(line1);var length2=Length(line2);var length3=Length(line3);var perimeter=length1+length2+length3;var p=perimeter*position;var localPosition=0;if(p<length1){localPosition=p/length1;out.x=line1.x1+(line1.x2-line1.x1)*localPosition;out.y=line1.y1+(line1.y2-line1.y1)*localPosition}else if(p>length1+length2){p-=length1+length2;localPosition=p/length3;out.x=line3.x1+(line3.x2-line3.x1)*localPosition;out.y=line3.y1+(line3.y2-line3.y1)*localPosition}else{p-=length1;localPosition=p/length2;out.x=line2.x1+(line2.x2-line2.x1)*localPosition;out.y=line2.y1+(line2.y2-line2.y1)*localPosition}return out};module.exports=GetPoint}),(function(module,exports,__webpack_require__){var Length=__webpack_require__(57);var Point=__webpack_require__(4);var GetPoints=function(triangle,quantity,stepRate,out){if(out===undefined){out=[]}var line1=triangle.getLineA();var line2=triangle.getLineB();var line3=triangle.getLineC();var length1=Length(line1);var length2=Length(line2);var length3=Length(line3);var perimeter=length1+length2+length3;if(!quantity&&stepRate>0){quantity=perimeter/stepRate}for(var i=0;i<quantity;i++){var p=perimeter*(i/quantity);var localPosition=0;var point=new Point();if(p<length1){localPosition=p/length1;point.x=line1.x1+(line1.x2-line1.x1)*localPosition;point.y=line1.y1+(line1.y2-line1.y1)*localPosition}else if(p>length1+length2){p-=length1+length2;localPosition=p/length3;point.x=line3.x1+(line3.x2-line3.x1)*localPosition;point.y=line3.y1+(line3.y2-line3.y1)*localPosition}else{p-=length1;localPosition=p/length2;point.x=line2.x1+(line2.x2-line2.x1)*localPosition;point.y=line2.y1+(line2.y2-line2.y1)*localPosition}out.push(point)}return out};module.exports=GetPoints}),(function(module,exports){var SetValue=function(source,key,value){if(!source||typeof source==='number'){return false}else if(source.hasOwnProperty(key)){source[key]=value;return true}else if(key.indexOf('.')!==-1){var keys=key.split('.');var parent=source;var prev=source;for(var i=0;i<keys.length;i++){if(parent.hasOwnProperty(keys[i])){prev=parent;parent=parent[keys[i]]}else{return false}}prev[keys[keys.length-1]]=value;return true}return false};module.exports=SetValue}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Utils=__webpack_require__(9);var Light=new Class({initialize:function Light(x,y,radius,r,g,b,intensity){this.x=x;this.y=y;this.radius=radius;this.r=r;this.g=g;this.b=b;this.intensity=intensity;this.scrollFactorX=1.0;this.scrollFactorY=1.0},set:function(x,y,radius,r,g,b,intensity){this.x=x;this.y=y;this.radius=radius;this.r=r;this.g=g;this.b=b;this.intensity=intensity;this.scrollFactorX=1;this.scrollFactorY=1;return this},setScrollFactor:function(x,y){if(x===undefined){x=1}if(y===undefined){y=x}this.scrollFactorX=x;this.scrollFactorY=y;return this},setColor:function(rgb){var color=Utils.getFloatsFromUintRGB(rgb);this.r=color[0];this.g=color[1];this.b=color[2];return this},setIntensity:function(intensity){this.intensity=intensity;return this},setPosition:function(x,y){this.x=x;this.y=y;return this},setRadius:function(radius){this.radius=radius;return this}});module.exports=Light}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Light=__webpack_require__(428);var Utils=__webpack_require__(9);var LightsManager=new Class({initialize:function LightsManager(){this.lightPool=[];this.lights=[];this.culledLights=[];this.ambientColor={r:0.1,g:0.1,b:0.1};this.active=false;this.maxLights=-1},enable:function(){if(this.maxLights===-1){this.maxLights=this.scene.sys.game.renderer.config.maxLights}this.active=true;return this},disable:function(){this.active=false;return this},cull:function(camera){var lights=this.lights;var culledLights=this.culledLights;var length=lights.length;var cameraCenterX=camera.x+camera.width/2.0;var cameraCenterY=camera.y+camera.height/2.0;var cameraRadius=(camera.width+camera.height)/2.0;var point={x:0,y:0};var cameraMatrix=camera.matrix;var viewportHeight=this.systems.game.config.height;culledLights.length=0;for(var index=0;index<length&&culledLights.length<this.maxLights;index++){var light=lights[index];cameraMatrix.transformPoint(light.x,light.y,point);var dx=cameraCenterX-(point.x-(camera.scrollX*light.scrollFactorX*camera.zoom));var dy=cameraCenterY-(viewportHeight-(point.y-(camera.scrollY*light.scrollFactorY)*camera.zoom));var distance=Math.sqrt(dx*dx+dy*dy);if(distance<light.radius+cameraRadius){culledLights.push(lights[index])}}return culledLights},forEachLight:function(callback){if(!callback){return}var lights=this.lights;var length=lights.length;for(var index=0;index<length;++index){callback(lights[index])}return this},setAmbientColor:function(rgb){var color=Utils.getFloatsFromUintRGB(rgb);this.ambientColor.r=color[0];this.ambientColor.g=color[1];this.ambientColor.b=color[2];return this},getMaxVisibleLights:function(){return 10},getLightCount:function(){return this.lights.length},addLight:function(x,y,radius,rgb,intensity){var color=null;var light=null;x=(x===undefined)?0.0:x;y=(y===undefined)?0.0:y;rgb=(rgb===undefined)?0xffffff:rgb;radius=(radius===undefined)?100.0:radius;intensity=(intensity===undefined)?1.0:intensity;color=Utils.getFloatsFromUintRGB(rgb);light=null;if(this.lightPool.length>0){light=this.lightPool.pop();light.set(x,y,radius,color[0],color[1],color[2],intensity)}else{light=new Light(x,y,radius,color[0],color[1],color[2],intensity)}this.lights.push(light);return light},removeLight:function(light){var index=this.lights.indexOf(light);if(index>=0){this.lightPool.push(light);this.lights.splice(index,1)}return this},shutdown:function(){while(this.lights.length>0){this.lightPool.push(this.lights.pop())}this.ambientColor={r:0.1,g:0.1,b:0.1};this.culledLights.length=0;this.lights.length=0},destroy:function(){this.shutdown()}});module.exports=LightsManager}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(47);var Extend=__webpack_require__(18);var Geom={Circle:__webpack_require__(1090),Ellipse:__webpack_require__(1100),Intersects:__webpack_require__(431),Line:__webpack_require__(1119),Point:__webpack_require__(1141),Polygon:__webpack_require__(1155),Rectangle:__webpack_require__(444),Triangle:__webpack_require__(1186)};Geom=Extend(false,Geom,CONST);module.exports=Geom}),(function(module,exports,__webpack_require__){module.exports={CircleToCircle:__webpack_require__(205),CircleToRectangle:__webpack_require__(206),GetCircleToCircle:__webpack_require__(1110),GetCircleToRectangle:__webpack_require__(1111),GetLineToCircle:__webpack_require__(207),GetLineToRectangle:__webpack_require__(209),GetRectangleIntersection:__webpack_require__(1112),GetRectangleToRectangle:__webpack_require__(1113),GetRectangleToTriangle:__webpack_require__(1114),GetTriangleToCircle:__webpack_require__(1115),GetTriangleToLine:__webpack_require__(436),GetTriangleToTriangle:__webpack_require__(1116),LineToCircle:__webpack_require__(208),LineToLine:__webpack_require__(84),LineToRectangle:__webpack_require__(432),PointToLine:__webpack_require__(440),PointToLineSegment:__webpack_require__(1117),RectangleToRectangle:__webpack_require__(135),RectangleToTriangle:__webpack_require__(433),RectangleToValues:__webpack_require__(1118),TriangleToCircle:__webpack_require__(435),TriangleToLine:__webpack_require__(437),TriangleToTriangle:__webpack_require__(438)}}),(function(module,exports){var LineToRectangle=function(line,rect){var x1=line.x1;var y1=line.y1;var x2=line.x2;var y2=line.y2;var bx1=rect.x;var by1=rect.y;var bx2=rect.right;var by2=rect.bottom;var t=0;if((x1>=bx1&&x1<=bx2&&y1>=by1&&y1<=by2)||(x2>=bx1&&x2<=bx2&&y2>=by1&&y2<=by2)){return true}if(x1<bx1&&x2>=bx1){t=y1+(y2-y1)*(bx1-x1)/(x2-x1);if(t>by1&&t<=by2){return true}}else if(x1>bx2&&x2<=bx2){t=y1+(y2-y1)*(bx2-x1)/(x2-x1);if(t>=by1&&t<=by2){return true}}if(y1<by1&&y2>=by1){t=x1+(x2-x1)*(by1-y1)/(y2-y1);if(t>=bx1&&t<=bx2){return true}}else if(y1>by2&&y2<=by2){t=x1+(x2-x1)*(by2-y1)/(y2-y1);if(t>=bx1&&t<=bx2){return true}}return false};module.exports=LineToRectangle}),(function(module,exports,__webpack_require__){var LineToLine=__webpack_require__(84);var Contains=__webpack_require__(48);var ContainsArray=__webpack_require__(210);var Decompose=__webpack_require__(434);var RectangleToTriangle=function(rect,triangle){if(triangle.left>rect.right||triangle.right<rect.left||triangle.top>rect.bottom||triangle.bottom<rect.top){return false}var triA=triangle.getLineA();var triB=triangle.getLineB();var triC=triangle.getLineC();if(Contains(rect,triA.x1,triA.y1)||Contains(rect,triA.x2,triA.y2)){return true}if(Contains(rect,triB.x1,triB.y1)||Contains(rect,triB.x2,triB.y2)){return true}if(Contains(rect,triC.x1,triC.y1)||Contains(rect,triC.x2,triC.y2)){return true}var rectA=rect.getLineA();var rectB=rect.getLineB();var rectC=rect.getLineC();var rectD=rect.getLineD();if(LineToLine(triA,rectA)||LineToLine(triA,rectB)||LineToLine(triA,rectC)||LineToLine(triA,rectD)){return true}if(LineToLine(triB,rectA)||LineToLine(triB,rectB)||LineToLine(triB,rectC)||LineToLine(triB,rectD)){return true}if(LineToLine(triC,rectA)||LineToLine(triC,rectB)||LineToLine(triC,rectC)||LineToLine(triC,rectD)){return true}var points=Decompose(rect);var within=ContainsArray(triangle,points,true);return(within.length>0)};module.exports=RectangleToTriangle}),(function(module,exports){var Decompose=function(rect,out){if(out===undefined){out=[]}out.push({x:rect.x,y:rect.y});out.push({x:rect.right,y:rect.y});out.push({x:rect.right,y:rect.bottom});out.push({x:rect.x,y:rect.bottom});return out};module.exports=Decompose}),(function(module,exports,__webpack_require__){var LineToCircle=__webpack_require__(208);var Contains=__webpack_require__(83);var TriangleToCircle=function(triangle,circle){if(triangle.left>circle.right||triangle.right<circle.left||triangle.top>circle.bottom||triangle.bottom<circle.top){return false}if(Contains(triangle,circle.x,circle.y)){return true}if(LineToCircle(triangle.getLineA(),circle)){return true}if(LineToCircle(triangle.getLineB(),circle)){return true}if(LineToCircle(triangle.getLineC(),circle)){return true}return false};module.exports=TriangleToCircle}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var TriangleToLine=__webpack_require__(437);var LineToLine=__webpack_require__(84);var GetTriangleToLine=function(triangle,line,out){if(out===undefined){out=[]}if(TriangleToLine(triangle,line)){var lineA=triangle.getLineA();var lineB=triangle.getLineB();var lineC=triangle.getLineC();var output=[new Point(),new Point(),new Point()];var result=[LineToLine(lineA,line,output[0]),LineToLine(lineB,line,output[1]),LineToLine(lineC,line,output[2])];for(var i=0;i<3;i++){if(result[i]){out.push(output[i])}}}return out};module.exports=GetTriangleToLine}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(83);var LineToLine=__webpack_require__(84);var TriangleToLine=function(triangle,line){if(Contains(triangle,line.getPointA())||Contains(triangle,line.getPointB())){return true}if(LineToLine(triangle.getLineA(),line)){return true}if(LineToLine(triangle.getLineB(),line)){return true}if(LineToLine(triangle.getLineC(),line)){return true}return false};module.exports=TriangleToLine}),(function(module,exports,__webpack_require__){var ContainsArray=__webpack_require__(210);var Decompose=__webpack_require__(439);var LineToLine=__webpack_require__(84);var TriangleToTriangle=function(triangleA,triangleB){if(triangleA.left>triangleB.right||triangleA.right<triangleB.left||triangleA.top>triangleB.bottom||triangleA.bottom<triangleB.top){return false}var lineAA=triangleA.getLineA();var lineAB=triangleA.getLineB();var lineAC=triangleA.getLineC();var lineBA=triangleB.getLineA();var lineBB=triangleB.getLineB();var lineBC=triangleB.getLineC();if(LineToLine(lineAA,lineBA)||LineToLine(lineAA,lineBB)||LineToLine(lineAA,lineBC)){return true}if(LineToLine(lineAB,lineBA)||LineToLine(lineAB,lineBB)||LineToLine(lineAB,lineBC)){return true}if(LineToLine(lineAC,lineBA)||LineToLine(lineAC,lineBB)||LineToLine(lineAC,lineBC)){return true}var points=Decompose(triangleA);var within=ContainsArray(triangleB,points,true);if(within.length>0){return true}points=Decompose(triangleB);within=ContainsArray(triangleA,points,true);if(within.length>0){return true}return false};module.exports=TriangleToTriangle}),(function(module,exports){var Decompose=function(triangle,out){if(out===undefined){out=[]}out.push({x:triangle.x1,y:triangle.y1});out.push({x:triangle.x2,y:triangle.y2});out.push({x:triangle.x3,y:triangle.y3});return out};module.exports=Decompose}),(function(module,exports){var PointToLine=function(point,line,lineThickness){if(lineThickness===undefined){lineThickness=1}var x1=line.x1;var y1=line.y1;var x2=line.x2;var y2=line.y2;var px=point.x;var py=point.y;var L2=(((x2-x1)*(x2-x1))+((y2-y1)*(y2-y1)));if(L2===0){return false}var r=(((px-x1)*(x2-x1))+((py-y1)*(y2-y1)))/L2;if(r<0){return(Math.sqrt(((x1-px)*(x1-px))+((y1-py)*(y1-py)))<=lineThickness)}else if((r>=0)&&(r<=1)){var s=(((y1-py)*(x2-x1))-((x1-px)*(y2-y1)))/L2;return(Math.abs(s)*Math.sqrt(L2)<=lineThickness)}else{return(Math.sqrt(((x2-px)*(x2-px))+((y2-py)*(y2-py)))<=lineThickness)}};module.exports=PointToLine}),(function(module,exports,__webpack_require__){var MATH_CONST=__webpack_require__(13);var Wrap=__webpack_require__(58);var Angle=__webpack_require__(85);var NormalAngle=function(line){var angle=Angle(line)-MATH_CONST.TAU;return Wrap(angle,-Math.PI,Math.PI)};module.exports=NormalAngle}),(function(module,exports){var GetMagnitude=function(point){return Math.sqrt((point.x*point.x)+(point.y*point.y))};module.exports=GetMagnitude}),(function(module,exports){var GetMagnitudeSq=function(point){return(point.x*point.x)+(point.y*point.y)};module.exports=GetMagnitudeSq}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);Rectangle.Area=__webpack_require__(1160);Rectangle.Ceil=__webpack_require__(1161);Rectangle.CeilAll=__webpack_require__(1162);Rectangle.CenterOn=__webpack_require__(168);Rectangle.Clone=__webpack_require__(1163);Rectangle.Contains=__webpack_require__(48);Rectangle.ContainsPoint=__webpack_require__(1164);Rectangle.ContainsRect=__webpack_require__(445);Rectangle.CopyFrom=__webpack_require__(1165);Rectangle.Decompose=__webpack_require__(434);Rectangle.Equals=__webpack_require__(1166);Rectangle.FitInside=__webpack_require__(1167);Rectangle.FitOutside=__webpack_require__(1168);Rectangle.Floor=__webpack_require__(1169);Rectangle.FloorAll=__webpack_require__(1170);Rectangle.FromPoints=__webpack_require__(176);Rectangle.FromXY=__webpack_require__(1171);Rectangle.GetAspectRatio=__webpack_require__(212);Rectangle.GetCenter=__webpack_require__(1172);Rectangle.GetPoint=__webpack_require__(152);Rectangle.GetPoints=__webpack_require__(274);Rectangle.GetSize=__webpack_require__(1173);Rectangle.Inflate=__webpack_require__(1174);Rectangle.Intersection=__webpack_require__(1175);Rectangle.MarchingAnts=__webpack_require__(285);Rectangle.MergePoints=__webpack_require__(1176);Rectangle.MergeRect=__webpack_require__(1177);Rectangle.MergeXY=__webpack_require__(1178);Rectangle.Offset=__webpack_require__(1179);Rectangle.OffsetPoint=__webpack_require__(1180);Rectangle.Overlaps=__webpack_require__(1181);Rectangle.Perimeter=__webpack_require__(112);Rectangle.PerimeterPoint=__webpack_require__(1182);Rectangle.Random=__webpack_require__(155);Rectangle.RandomOutside=__webpack_require__(1183);Rectangle.SameDimensions=__webpack_require__(1184);Rectangle.Scale=__webpack_require__(1185);Rectangle.Union=__webpack_require__(394);module.exports=Rectangle}),(function(module,exports){var ContainsRect=function(rectA,rectB){if((rectB.width*rectB.height)>(rectA.width*rectA.height)){return false}return((rectB.x>rectA.x&&rectB.x<rectA.right)&&(rectB.right>rectA.x&&rectB.right<rectA.right)&&(rectB.y>rectA.y&&rectB.y<rectA.bottom)&&(rectB.bottom>rectA.y&&rectB.bottom<rectA.bottom))};module.exports=ContainsRect}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Centroid=function(triangle,out){if(out===undefined){out=new Point()}out.x=(triangle.x1+triangle.x2+triangle.x3)/3;out.y=(triangle.y1+triangle.y2+triangle.y3)/3;return out};module.exports=Centroid}),(function(module,exports){var Offset=function(triangle,x,y){triangle.x1+=x;triangle.y1+=y;triangle.x2+=x;triangle.y2+=y;triangle.x3+=x;triangle.y3+=y;return triangle};module.exports=Offset}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);function getLength(x1,y1,x2,y2){var x=x1-x2;var y=y1-y2;var magnitude=(x*x)+(y*y);return Math.sqrt(magnitude)}var InCenter=function(triangle,out){if(out===undefined){out=new Point()}var x1=triangle.x1;var y1=triangle.y1;var x2=triangle.x2;var y2=triangle.y2;var x3=triangle.x3;var y3=triangle.y3;var d1=getLength(x3,y3,x2,y2);var d2=getLength(x1,y1,x3,y3);var d3=getLength(x2,y2,x1,y1);var p=d1+d2+d3;out.x=(x1*d1+x2*d2+x3*d3)/p;out.y=(y1*d1+y2*d2+y3*d3)/p;return out};module.exports=InCenter}),(function(module,exports){var CreateInteractiveObject=function(gameObject,hitArea,hitAreaCallback){return{gameObject:gameObject,enabled:true,alwaysEnabled:false,draggable:false,dropZone:false,cursor:false,target:null,camera:null,hitArea:hitArea,hitAreaCallback:hitAreaCallback,hitAreaDebug:null,customHitArea:false,localX:0,localY:0,dragState:0,dragStartX:0,dragStartY:0,dragStartXGlobal:0,dragStartYGlobal:0,dragX:0,dragY:0}};module.exports=CreateInteractiveObject}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Axis=new Class({initialize:function Axis(pad,index){this.pad=pad;this.events=pad.events;this.index=index;this.value=0;this.threshold=0.1},update:function(value){this.value=value},getValue:function(){return(Math.abs(this.value)<this.threshold)?0:this.value},destroy:function(){this.pad=null;this.events=null}});module.exports=Axis}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Events=__webpack_require__(214);var Button=new Class({initialize:function Button(pad,index){this.pad=pad;this.events=pad.manager;this.index=index;this.value=0;this.threshold=1;this.pressed=false},update:function(value){this.value=value;var pad=this.pad;var index=this.index;if(value>=this.threshold){if(!this.pressed){this.pressed=true;this.events.emit(Events.BUTTON_DOWN,pad,this,value);this.pad.emit(Events.GAMEPAD_BUTTON_DOWN,index,value,this)}}else if(this.pressed){this.pressed=false;this.events.emit(Events.BUTTON_UP,pad,this,value);this.pad.emit(Events.GAMEPAD_BUTTON_UP,index,value,this)}},destroy:function(){this.pad=null;this.events=null}});module.exports=Button}),(function(module,exports,__webpack_require__){var Axis=__webpack_require__(450);var Button=__webpack_require__(451);var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Vector2=__webpack_require__(3);var Gamepad=new Class({Extends:EventEmitter,initialize:function Gamepad(manager,pad){EventEmitter.call(this);this.manager=manager;this.pad=pad;this.id=pad.id;this.index=pad.index;var buttons=[];for(var i=0;i<pad.buttons.length;i++){buttons.push(new Button(this,i))}this.buttons=buttons;var axes=[];for(i=0;i<pad.axes.length;i++){axes.push(new Axis(this,i))}this.axes=axes;this.vibration=pad.vibrationActuator;var _noButton={value:0,pressed:false};this._LCLeft=(buttons[14])?buttons[14]:_noButton;this._LCRight=(buttons[15])?buttons[15]:_noButton;this._LCTop=(buttons[12])?buttons[12]:_noButton;this._LCBottom=(buttons[13])?buttons[13]:_noButton;this._RCLeft=(buttons[2])?buttons[2]:_noButton;this._RCRight=(buttons[1])?buttons[1]:_noButton;this._RCTop=(buttons[3])?buttons[3]:_noButton;this._RCBottom=(buttons[0])?buttons[0]:_noButton;this._FBLeftTop=(buttons[4])?buttons[4]:_noButton;this._FBLeftBottom=(buttons[6])?buttons[6]:_noButton;this._FBRightTop=(buttons[5])?buttons[5]:_noButton;this._FBRightBottom=(buttons[7])?buttons[7]:_noButton;var _noAxis={value:0};this._HAxisLeft=(axes[0])?axes[0]:_noAxis;this._VAxisLeft=(axes[1])?axes[1]:_noAxis;this._HAxisRight=(axes[2])?axes[2]:_noAxis;this._VAxisRight=(axes[3])?axes[3]:_noAxis;this.leftStick=new Vector2();this.rightStick=new Vector2()},getAxisTotal:function(){return this.axes.length},getAxisValue:function(index){return this.axes[index].getValue()},setAxisThreshold:function(value){for(var i=0;i<this.axes.length;i++){this.axes[i].threshold=value}},getButtonTotal:function(){return this.buttons.length},getButtonValue:function(index){return this.buttons[index].value},isButtonDown:function(index){return this.buttons[index].pressed},update:function(pad){var i;var localButtons=this.buttons;var gamepadButtons=pad.buttons;var len=localButtons.length;for(i=0;i<len;i++){localButtons[i].update(gamepadButtons[i].value)}var localAxes=this.axes;var gamepadAxes=pad.axes;len=localAxes.length;for(i=0;i<len;i++){localAxes[i].update(gamepadAxes[i])}if(len>=2){this.leftStick.set(localAxes[0].getValue(),localAxes[1].getValue());if(len>=4){this.rightStick.set(localAxes[2].getValue(),localAxes[3].getValue())}}},destroy:function(){this.removeAllListeners();this.manager=null;this.pad=null;var i;for(i=0;i<this.buttons.length;i++){this.buttons[i].destroy()}for(i=0;i<this.axes.length;i++){this.axes[i].destroy()}this.buttons=[];this.axes=[]},connected:{get:function(){return this.pad.connected}},timestamp:{get:function(){return this.pad.timestamp}},left:{get:function(){return this._LCLeft.pressed}},right:{get:function(){return this._LCRight.pressed}},up:{get:function(){return this._LCTop.pressed}},down:{get:function(){return this._LCBottom.pressed}},A:{get:function(){return this._RCBottom.pressed}},Y:{get:function(){return this._RCTop.pressed}},X:{get:function(){return this._RCLeft.pressed}},B:{get:function(){return this._RCRight.pressed}},L1:{get:function(){return this._FBLeftTop.value}},L2:{get:function(){return this._FBLeftBottom.value}},R1:{get:function(){return this._FBRightTop.value}},R2:{get:function(){return this._FBRightBottom.value}}});module.exports=Gamepad}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(137);var Key=new Class({Extends:EventEmitter,initialize:function Key(plugin,keyCode){EventEmitter.call(this);this.plugin=plugin;this.keyCode=keyCode;this.originalEvent=undefined;this.enabled=true;this.isDown=false;this.isUp=true;this.altKey=false;this.ctrlKey=false;this.shiftKey=false;this.metaKey=false;this.location=0;this.timeDown=0;this.duration=0;this.timeUp=0;this.emitOnRepeat=false;this.repeats=0;this._justDown=false;this._justUp=false;this._tick=-1},setEmitOnRepeat:function(value){this.emitOnRepeat=value;return this},onDown:function(event){this.originalEvent=event;if(!this.enabled){return}this.altKey=event.altKey;this.ctrlKey=event.ctrlKey;this.shiftKey=event.shiftKey;this.metaKey=event.metaKey;this.location=event.location;this.repeats++;if(!this.isDown){this.isDown=true;this.isUp=false;this.timeDown=event.timeStamp;this.duration=0;this._justDown=true;this._justUp=false;this.emit(Events.DOWN,this,event)}else if(this.emitOnRepeat){this.emit(Events.DOWN,this,event)}},onUp:function(event){this.originalEvent=event;if(!this.enabled){return}this.isDown=false;this.isUp=true;this.timeUp=event.timeStamp;this.duration=this.timeUp-this.timeDown;this.repeats=0;this._justDown=false;this._justUp=true;this._tick=-1;this.emit(Events.UP,this,event)},reset:function(){this.preventDefault=true;this.enabled=true;this.isDown=false;this.isUp=true;this.altKey=false;this.ctrlKey=false;this.shiftKey=false;this.metaKey=false;this.timeDown=0;this.duration=0;this.timeUp=0;this.repeats=0;this._justDown=false;this._justUp=false;this._tick=-1;return this},getDuration:function(){if(this.isDown){return(this.plugin.game.loop.time-this.timeDown)}else{return 0}},destroy:function(){this.removeAllListeners();this.originalEvent=null;this.plugin=null}});module.exports=Key}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Events=__webpack_require__(137);var GetFastValue=__webpack_require__(2);var ProcessKeyCombo=__webpack_require__(1225);var ResetKeyCombo=__webpack_require__(1227);var KeyCombo=new Class({initialize:function KeyCombo(keyboardPlugin,keys,config){if(config===undefined){config={}}if(keys.length<2){return false}this.manager=keyboardPlugin;this.enabled=true;this.keyCodes=[];for(var i=0;i<keys.length;i++){var char=keys[i];if(typeof char==='string'){this.keyCodes.push(char.toUpperCase().charCodeAt(0))}else if(typeof char==='number'){this.keyCodes.push(char)}else if(char.hasOwnProperty('keyCode')){this.keyCodes.push(char.keyCode)}}this.current=this.keyCodes[0];this.index=0;this.size=this.keyCodes.length;this.timeLastMatched=0;this.matched=false;this.timeMatched=0;this.resetOnWrongKey=GetFastValue(config,'resetOnWrongKey',true);this.maxKeyDelay=GetFastValue(config,'maxKeyDelay',0);this.resetOnMatch=GetFastValue(config,'resetOnMatch',false);this.deleteOnMatch=GetFastValue(config,'deleteOnMatch',false);var _this=this;var onKeyDownHandler=function(event){if(_this.matched||!_this.enabled){return}var matched=ProcessKeyCombo(event,_this);if(matched){_this.manager.emit(Events.COMBO_MATCH,_this,event);if(_this.resetOnMatch){ResetKeyCombo(_this)}else if(_this.deleteOnMatch){_this.destroy()}}};this.onKeyDown=onKeyDownHandler;this.manager.on(Events.ANY_KEY_DOWN,this.onKeyDown)},progress:{get:function(){return this.index/this.size}},destroy:function(){this.enabled=false;this.keyCodes=[];this.manager.off(Events.ANY_KEY_DOWN,this.onKeyDown);this.manager=null}});module.exports=KeyCombo}),(function(module,exports,__webpack_require__){var MergeXHRSettings=__webpack_require__(215);var XHRLoader=function(file,globalXHRSettings){var config=MergeXHRSettings(globalXHRSettings,file.xhrSettings);var xhr=new XMLHttpRequest();xhr.open('GET',file.src,config.async,config.user,config.password);xhr.responseType=file.xhrSettings.responseType;xhr.timeout=config.timeout;if(config.headers){for(var key in config.headers){xhr.setRequestHeader(key,config.headers[key])}}if(config.header&&config.headerValue){xhr.setRequestHeader(config.header,config.headerValue)}if(config.requestedWith){xhr.setRequestHeader('X-Requested-With',config.requestedWith)}if(config.overrideMimeType){xhr.overrideMimeType(config.overrideMimeType)}if(config.withCredentials){xhr.withCredentials=true}xhr.onload=file.onLoad.bind(file,xhr);xhr.onerror=file.onError.bind(file,xhr);xhr.onprogress=file.onProgress.bind(file);xhr.send();return xhr};module.exports=XHRLoader}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var HTML5AudioFile=__webpack_require__(457);var IsPlainObject=__webpack_require__(7);var AudioFile=new Class({Extends:File,initialize:function AudioFile(loader,key,urlConfig,xhrSettings,audioContext){if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');xhrSettings=GetFastValue(config,'xhrSettings');audioContext=GetFastValue(config,'context',audioContext)}var fileConfig={type:'audio',cache:loader.cacheManager.audio,extension:urlConfig.type,responseType:'arraybuffer',key:key,url:urlConfig.url,xhrSettings:xhrSettings,config:{context:audioContext}};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;var _this=this;this.config.context.decodeAudioData(this.xhrLoader.response,function(audioBuffer){_this.data=audioBuffer;_this.onProcessComplete()},function(e){console.error('Error decoding audio: '+_this.key+' - ',e?e.message:null);_this.onProcessError()});this.config.context=null}});AudioFile.create=function(loader,key,urls,config,xhrSettings){var game=loader.systems.game;var audioConfig=game.config.audio;var deviceAudio=game.device.audio;if(IsPlainObject(key)){urls=GetFastValue(key,'url',[]);config=GetFastValue(key,'config',{})}var urlConfig=AudioFile.getAudioURL(game,urls);if(!urlConfig){return null}if(deviceAudio.webAudio&&!(audioConfig&&audioConfig.disableWebAudio)){return new AudioFile(loader,key,urlConfig,xhrSettings,game.sound.context)}else{return new HTML5AudioFile(loader,key,urlConfig,config)}};AudioFile.getAudioURL=function(game,urls){if(!Array.isArray(urls)){urls=[urls]}for(var i=0;i<urls.length;i++){var url=GetFastValue(urls[i],'url',urls[i]);if(url.indexOf('blob:')===0||url.indexOf('data:')===0){return{url:url,type:''}}var audioType=url.match(/\t([a-zA-Z0-9]+)($|\n)/);audioType=GetFastValue(urls[i],'type',(audioType)?audioType[1]:'').toLowerCase();if(game.device.audio[audioType]){return{url:url,type:audioType}}}return null};FileTypesManager.register('audio',function(key,urls,config,xhrSettings){var game=this.systems.game;var audioConfig=game.config.audio;var deviceAudio=game.device.audio;if((audioConfig&&audioConfig.noAudio)||(!deviceAudio.webAudio&&!deviceAudio.audioData)){return this}var audioFile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){audioFile=AudioFile.create(this,key[i]);if(audioFile){this.addFile(audioFile)}}}else{audioFile=AudioFile.create(this,key,urls,config,xhrSettings);if(audioFile){this.addFile(audioFile)}}return this});module.exports=AudioFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Events=__webpack_require__(82);var File=__webpack_require__(21);var GetFastValue=__webpack_require__(2);var GetURL=__webpack_require__(138);var IsPlainObject=__webpack_require__(7);var HTML5AudioFile=new Class({Extends:File,initialize:function HTML5AudioFile(loader,key,urlConfig,audioConfig){if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');audioConfig=GetFastValue(config,'config',audioConfig)}var fileConfig={type:'audio',cache:loader.cacheManager.audio,extension:urlConfig.type,key:key,url:urlConfig.url,config:audioConfig};File.call(this,loader,fileConfig);this.locked='ontouchstart'in window;this.loaded=false;this.filesLoaded=0;this.filesTotal=0},onLoad:function(){if(this.loaded){return}this.loaded=true;this.loader.nextFile(this,true)},onError:function(){for(var i=0;i<this.data.length;i++){var audio=this.data[i];audio.oncanplaythrough=null;audio.onerror=null}this.loader.nextFile(this,false)},onProgress:function(event){var audio=event.target;audio.oncanplaythrough=null;audio.onerror=null;this.filesLoaded++;this.percentComplete=Math.min((this.filesLoaded/this.filesTotal),1);this.loader.emit(Events.FILE_PROGRESS,this,this.percentComplete);if(this.filesLoaded===this.filesTotal){this.onLoad()}},load:function(){this.data=[];var instances=(this.config&&this.config.instances)||1;this.filesTotal=instances;this.filesLoaded=0;this.percentComplete=0;for(var i=0;i<instances;i++){var audio=new Audio();if(!audio.dataset){audio.dataset={}}audio.dataset.name=this.key+('0'+i).slice(-2);audio.dataset.used='false';if(this.locked){audio.dataset.locked='true'}else{audio.dataset.locked='false';audio.preload='auto';audio.oncanplaythrough=this.onProgress.bind(this);audio.onerror=this.onError.bind(this)}this.data.push(audio)}for(i=0;i<this.data.length;i++){audio=this.data[i];audio.src=GetURL(this,this.loader.baseURL);if(!this.locked){audio.load()}}if(this.locked){setTimeout(this.onLoad.bind(this))}}});module.exports=HTML5AudioFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var ScriptFile=new Class({Extends:File,initialize:function ScriptFile(loader,key,url,xhrSettings){var extension='js';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'script',cache:false,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=document.createElement('script');this.data.language='javascript';this.data.type='text/javascript';this.data.defer=false;this.data.text=this.xhrLoader.responseText;document.head.appendChild(this.data);this.onProcessComplete()}});FileTypesManager.register('script',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new ScriptFile(this,key[i]))}}else{this.addFile(new ScriptFile(this,key,url,xhrSettings))}return this});module.exports=ScriptFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var TextFile=new Class({Extends:File,initialize:function TextFile(loader,key,url,xhrSettings){var extension='txt';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'text',cache:loader.cacheManager.text,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=this.xhrLoader.responseText;this.onProcessComplete()}});FileTypesManager.register('text',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new TextFile(this,key[i]))}}else{this.addFile(new TextFile(this,key,url,xhrSettings))}return this});module.exports=TextFile}),(function(module,exports,__webpack_require__){var ArcadeImage=__webpack_require__(461);var ArcadeSprite=__webpack_require__(140);var Class=__webpack_require__(0);var CONST=__webpack_require__(50);var PhysicsGroup=__webpack_require__(462);var StaticPhysicsGroup=__webpack_require__(463);var Factory=new Class({initialize:function Factory(world){this.world=world;this.scene=world.scene;this.sys=world.scene.sys},collider:function(object1,object2,collideCallback,processCallback,callbackContext){return this.world.addCollider(object1,object2,collideCallback,processCallback,callbackContext)},overlap:function(object1,object2,collideCallback,processCallback,callbackContext){return this.world.addOverlap(object1,object2,collideCallback,processCallback,callbackContext)},existing:function(gameObject,isStatic){var type=(isStatic)?CONST.STATIC_BODY:CONST.DYNAMIC_BODY;this.world.enableBody(gameObject,type);return gameObject},staticImage:function(x,y,key,frame){var image=new ArcadeImage(this.scene,x,y,key,frame);this.sys.displayList.add(image);this.world.enableBody(image,CONST.STATIC_BODY);return image},image:function(x,y,key,frame){var image=new ArcadeImage(this.scene,x,y,key,frame);this.sys.displayList.add(image);this.world.enableBody(image,CONST.DYNAMIC_BODY);return image},staticSprite:function(x,y,key,frame){var sprite=new ArcadeSprite(this.scene,x,y,key,frame);this.sys.displayList.add(sprite);this.sys.updateList.add(sprite);this.world.enableBody(sprite,CONST.STATIC_BODY);return sprite},sprite:function(x,y,key,frame){var sprite=new ArcadeSprite(this.scene,x,y,key,frame);this.sys.displayList.add(sprite);this.sys.updateList.add(sprite);this.world.enableBody(sprite,CONST.DYNAMIC_BODY);return sprite},staticGroup:function(children,config){return this.sys.updateList.add(new StaticPhysicsGroup(this.world,this.world.scene,children,config))},group:function(children,config){return this.sys.updateList.add(new PhysicsGroup(this.world,this.world.scene,children,config))},destroy:function(){this.world=null;this.scene=null;this.sys=null}});module.exports=Factory}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(217);var Image=__webpack_require__(107);var ArcadeImage=new Class({Extends:Image,Mixins:[Components.Acceleration,Components.Angular,Components.Bounce,Components.Debug,Components.Drag,Components.Enable,Components.Friction,Components.Gravity,Components.Immovable,Components.Mass,Components.Size,Components.Velocity],initialize:function ArcadeImage(scene,x,y,texture,frame){Image.call(this,scene,x,y,texture,frame);this.body=null}});module.exports=ArcadeImage}),(function(module,exports,__webpack_require__){var ArcadeSprite=__webpack_require__(140);var Class=__webpack_require__(0);var CONST=__webpack_require__(50);var GetFastValue=__webpack_require__(2);var Group=__webpack_require__(97);var IsPlainObject=__webpack_require__(7);var PhysicsGroup=new Class({Extends:Group,initialize:function PhysicsGroup(world,scene,children,config){if(!children&&!config){config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}}else if(IsPlainObject(children)){config=children;children=null;config.internalCreateCallback=this.createCallbackHandler;config.internalRemoveCallback=this.removeCallbackHandler}else if(Array.isArray(children)&&IsPlainObject(children[0])){config=children[0];var _this=this;children.forEach(function(singleConfig){singleConfig.internalCreateCallback=_this.createCallbackHandler;singleConfig.internalRemoveCallback=_this.removeCallbackHandler});children=null}else{config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}}this.world=world;config.classType=GetFastValue(config,'classType',ArcadeSprite);this.physicsType=CONST.DYNAMIC_BODY;this.defaults={setCollideWorldBounds:GetFastValue(config,'collideWorldBounds',false),setBoundsRectangle:GetFastValue(config,'customBoundsRectangle',null),setAccelerationX:GetFastValue(config,'accelerationX',0),setAccelerationY:GetFastValue(config,'accelerationY',0),setAllowDrag:GetFastValue(config,'allowDrag',true),setAllowGravity:GetFastValue(config,'allowGravity',true),setAllowRotation:GetFastValue(config,'allowRotation',true),setBounceX:GetFastValue(config,'bounceX',0),setBounceY:GetFastValue(config,'bounceY',0),setDragX:GetFastValue(config,'dragX',0),setDragY:GetFastValue(config,'dragY',0),setEnable:GetFastValue(config,'enable',true),setGravityX:GetFastValue(config,'gravityX',0),setGravityY:GetFastValue(config,'gravityY',0),setFrictionX:GetFastValue(config,'frictionX',0),setFrictionY:GetFastValue(config,'frictionY',0),setVelocityX:GetFastValue(config,'velocityX',0),setVelocityY:GetFastValue(config,'velocityY',0),setAngularVelocity:GetFastValue(config,'angularVelocity',0),setAngularAcceleration:GetFastValue(config,'angularAcceleration',0),setAngularDrag:GetFastValue(config,'angularDrag',0),setMass:GetFastValue(config,'mass',1),setImmovable:GetFastValue(config,'immovable',false)};Group.call(this,scene,children,config);this.type='PhysicsGroup'},createCallbackHandler:function(child){if(!child.body){this.world.enableBody(child,CONST.DYNAMIC_BODY)}var body=child.body;for(var key in this.defaults){body[key](this.defaults[key])}},removeCallbackHandler:function(child){if(child.body){this.world.disableBody(child)}},setVelocity:function(x,y,step){if(step===undefined){step=0}var items=this.getChildren();for(var i=0;i<items.length;i++){items[i].body.velocity.set(x+(i*step),y+(i*step))}return this},setVelocityX:function(value,step){if(step===undefined){step=0}var items=this.getChildren();for(var i=0;i<items.length;i++){items[i].body.velocity.x=value+(i*step)}return this},setVelocityY:function(value,step){if(step===undefined){step=0}var items=this.getChildren();for(var i=0;i<items.length;i++){items[i].body.velocity.y=value+(i*step)}return this}});module.exports=PhysicsGroup}),(function(module,exports,__webpack_require__){var ArcadeSprite=__webpack_require__(140);var Class=__webpack_require__(0);var CONST=__webpack_require__(50);var GetFastValue=__webpack_require__(2);var Group=__webpack_require__(97);var IsPlainObject=__webpack_require__(7);var StaticPhysicsGroup=new Class({Extends:Group,initialize:function StaticPhysicsGroup(world,scene,children,config){if(!children&&!config){config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler,createMultipleCallback:this.createMultipleCallbackHandler,classType:ArcadeSprite}}else if(IsPlainObject(children)){config=children;children=null;config.internalCreateCallback=this.createCallbackHandler;config.internalRemoveCallback=this.removeCallbackHandler;config.createMultipleCallback=this.createMultipleCallbackHandler;config.classType=GetFastValue(config,'classType',ArcadeSprite)}else if(Array.isArray(children)&&IsPlainObject(children[0])){config=children;children=null;config.forEach(function(singleConfig){singleConfig.internalCreateCallback=this.createCallbackHandler;singleConfig.internalRemoveCallback=this.removeCallbackHandler;singleConfig.createMultipleCallback=this.createMultipleCallbackHandler;singleConfig.classType=GetFastValue(singleConfig,'classType',ArcadeSprite)})}else{config={internalCreateCallback:this.createCallbackHandler,internalRemoveCallback:this.removeCallbackHandler}}this.world=world;this.physicsType=CONST.STATIC_BODY;Group.call(this,scene,children,config);this.type='StaticPhysicsGroup'},createCallbackHandler:function(child){if(!child.body){this.world.enableBody(child,CONST.STATIC_BODY)}},removeCallbackHandler:function(child){if(child.body){this.world.disableBody(child)}},createMultipleCallbackHandler:function(){this.refresh()},refresh:function(){var children=this.children.entries;for(var i=0;i<children.length;i++){children[i].body.reset()}return this}});module.exports=StaticPhysicsGroup}),(function(module,exports){var OverlapRect=function(world,x,y,width,height,includeDynamic,includeStatic){if(includeDynamic===undefined){includeDynamic=true}if(includeStatic===undefined){includeStatic=false}var dynamicBodies=[];var staticBodies=[];var minMax=world.treeMinMax;minMax.minX=x;minMax.minY=y;minMax.maxX=x+width;minMax.maxY=y+height;if(includeStatic){staticBodies=world.staticTree.search(minMax)}if(includeDynamic&&world.useTree){dynamicBodies=world.tree.search(minMax)}else if(includeDynamic){var bodies=world.bodies;var fakeBody={position:{x:x,y:y},left:x,top:y,right:x+width,bottom:y+height,isCircle:false};var intersects=world.intersects;bodies.iterate(function(target){if(intersects(target,fakeBody)){dynamicBodies.push(target)}})}return staticBodies.concat(dynamicBodies)};module.exports=OverlapRect}),(function(module,exports,__webpack_require__){var AngleBetweenPoints=__webpack_require__(318);var Body=__webpack_require__(466);var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Collider=__webpack_require__(467);var CONST=__webpack_require__(50);var DistanceBetween=__webpack_require__(53);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(218);var FuzzyEqual=__webpack_require__(106);var FuzzyGreaterThan=__webpack_require__(322);var FuzzyLessThan=__webpack_require__(323);var GetOverlapX=__webpack_require__(468);var GetOverlapY=__webpack_require__(469);var GetValue=__webpack_require__(6);var MATH_CONST=__webpack_require__(13);var ProcessQueue=__webpack_require__(186);var ProcessTileCallbacks=__webpack_require__(1284);var Rectangle=__webpack_require__(11);var RTree=__webpack_require__(470);var SeparateTile=__webpack_require__(1285);var SeparateX=__webpack_require__(1290);var SeparateY=__webpack_require__(1291);var Set=__webpack_require__(133);var StaticBody=__webpack_require__(472);var TileIntersectsBody=__webpack_require__(471);var TransformMatrix=__webpack_require__(29);var Vector2=__webpack_require__(3);var Wrap=__webpack_require__(58);var World=new Class({Extends:EventEmitter,initialize:function World(scene,config){EventEmitter.call(this);this.scene=scene;this.bodies=new Set();this.staticBodies=new Set();this.pendingDestroy=new Set();this.colliders=new ProcessQueue();this.gravity=new Vector2(GetValue(config,'gravity.x',0),GetValue(config,'gravity.y',0));this.bounds=new Rectangle(GetValue(config,'x',0),GetValue(config,'y',0),GetValue(config,'width',scene.sys.scale.width),GetValue(config,'height',scene.sys.scale.height));this.checkCollision={up:GetValue(config,'checkCollision.up',true),down:GetValue(config,'checkCollision.down',true),left:GetValue(config,'checkCollision.left',true),right:GetValue(config,'checkCollision.right',true)};this.fps=GetValue(config,'fps',60);this.fixedStep=true;this._elapsed=0;this._frameTime=1/this.fps;this._frameTimeMS=1000*this._frameTime;this.stepsLastFrame=0;this.timeScale=GetValue(config,'timeScale',1);this.OVERLAP_BIAS=GetValue(config,'overlapBias',4);this.TILE_BIAS=GetValue(config,'tileBias',16);this.forceX=GetValue(config,'forceX',false);this.isPaused=GetValue(config,'isPaused',false);this._total=0;this.drawDebug=GetValue(config,'debug',false);this.debugGraphic;this.defaults={debugShowBody:GetValue(config,'debugShowBody',true),debugShowStaticBody:GetValue(config,'debugShowStaticBody',true),debugShowVelocity:GetValue(config,'debugShowVelocity',true),bodyDebugColor:GetValue(config,'debugBodyColor',0xff00ff),staticBodyDebugColor:GetValue(config,'debugStaticBodyColor',0x0000ff),velocityDebugColor:GetValue(config,'debugVelocityColor',0x00ff00)};this.maxEntries=GetValue(config,'maxEntries',16);this.useTree=GetValue(config,'useTree',true);this.tree=new RTree(this.maxEntries);this.staticTree=new RTree(this.maxEntries);this.treeMinMax={minX:0,minY:0,maxX:0,maxY:0};this._tempMatrix=new TransformMatrix();this._tempMatrix2=new TransformMatrix();if(this.drawDebug){this.createDebugGraphic()}},enable:function(object,bodyType){if(bodyType===undefined){bodyType=CONST.DYNAMIC_BODY}if(!Array.isArray(object)){object=[object]}for(var i=0;i<object.length;i++){var entry=object[i];if(entry.isParent){var children=entry.getChildren();for(var c=0;c<children.length;c++){var child=children[c];if(child.isParent){this.enable(child,bodyType)}else{this.enableBody(child,bodyType)}}}else{this.enableBody(entry,bodyType)}}},enableBody:function(object,bodyType){if(bodyType===undefined){bodyType=CONST.DYNAMIC_BODY}if(!object.body){if(bodyType===CONST.DYNAMIC_BODY){object.body=new Body(this,object)}else if(bodyType===CONST.STATIC_BODY){object.body=new StaticBody(this,object)}}this.add(object.body);return object},add:function(body){if(body.physicsType===CONST.DYNAMIC_BODY){this.bodies.set(body)}else if(body.physicsType===CONST.STATIC_BODY){this.staticBodies.set(body);this.staticTree.insert(body)}body.enable=true;return body},disable:function(object){if(!Array.isArray(object)){object=[object]}for(var i=0;i<object.length;i++){var entry=object[i];if(entry.isParent){var children=entry.getChildren();for(var c=0;c<children.length;c++){var child=children[c];if(child.isParent){this.disable(child)}else{this.disableBody(child.body)}}}else{this.disableBody(entry.body)}}},disableBody:function(body){this.remove(body);body.enable=false},remove:function(body){if(body.physicsType===CONST.DYNAMIC_BODY){this.tree.remove(body);this.bodies.delete(body)}else if(body.physicsType===CONST.STATIC_BODY){this.staticBodies.delete(body);this.staticTree.remove(body)}},createDebugGraphic:function(){var graphic=this.scene.sys.add.graphics({x:0,y:0});graphic.setDepth(Number.MAX_VALUE);this.debugGraphic=graphic;this.drawDebug=true;return graphic},setBounds:function(x,y,width,height,checkLeft,checkRight,checkUp,checkDown){this.bounds.setTo(x,y,width,height);if(checkLeft!==undefined){this.setBoundsCollision(checkLeft,checkRight,checkUp,checkDown)}return this},setBoundsCollision:function(left,right,up,down){if(left===undefined){left=true}if(right===undefined){right=true}if(up===undefined){up=true}if(down===undefined){down=true}this.checkCollision.left=left;this.checkCollision.right=right;this.checkCollision.up=up;this.checkCollision.down=down;return this},pause:function(){this.isPaused=true;this.emit(Events.PAUSE);return this},resume:function(){this.isPaused=false;this.emit(Events.RESUME);return this},addCollider:function(object1,object2,collideCallback,processCallback,callbackContext){if(collideCallback===undefined){collideCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=collideCallback}var collider=new Collider(this,false,object1,object2,collideCallback,processCallback,callbackContext);this.colliders.add(collider);return collider},addOverlap:function(object1,object2,collideCallback,processCallback,callbackContext){if(collideCallback===undefined){collideCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=collideCallback}var collider=new Collider(this,true,object1,object2,collideCallback,processCallback,callbackContext);this.colliders.add(collider);return collider},removeCollider:function(collider){this.colliders.remove(collider);return this},setFPS:function(framerate){this.fps=framerate;this._frameTime=1/this.fps;this._frameTimeMS=1000*this._frameTime;return this},update:function(time,delta){if(this.isPaused||this.bodies.size===0){return}var i;var fixedDelta=this._frameTime;var msPerFrame=this._frameTimeMS*this.timeScale;this._elapsed+=delta;var body;var bodies=this.bodies.entries;var willStep=(this._elapsed>=msPerFrame);if(!this.fixedStep){fixedDelta=delta*0.001;willStep=true;this._elapsed=0}for(i=0;i<bodies.length;i++){body=bodies[i];if(body.enable){body.preUpdate(willStep,fixedDelta)}}if(willStep){this._elapsed-=msPerFrame;this.stepsLastFrame=1;if(this.useTree){this.tree.clear();this.tree.load(bodies)}var colliders=this.colliders.update();for(i=0;i<colliders.length;i++){var collider=colliders[i];if(collider.active){collider.update()}}this.emit(Events.WORLD_STEP)}while(this._elapsed>=msPerFrame){this._elapsed-=msPerFrame;this.step(fixedDelta)}},step:function(delta){var i;var body;var bodies=this.bodies.entries;var len=bodies.length;for(i=0;i<len;i++){body=bodies[i];if(body.enable){body.update(delta)}}if(this.useTree){this.tree.clear();this.tree.load(bodies)}var colliders=this.colliders.update();for(i=0;i<colliders.length;i++){var collider=colliders[i];if(collider.active){collider.update()}}this.emit(Events.WORLD_STEP);this.stepsLastFrame++},postUpdate:function(){var i;var body;var bodies=this.bodies.entries;var len=bodies.length;var dynamic=this.bodies;var staticBodies=this.staticBodies;if(this.stepsLastFrame){this.stepsLastFrame=0;for(i=0;i<len;i++){body=bodies[i];if(body.enable){body.postUpdate()}}}if(this.drawDebug){var graphics=this.debugGraphic;graphics.clear();for(i=0;i<len;i++){body=bodies[i];if(body.willDrawDebug()){body.drawDebug(graphics)}}bodies=staticBodies.entries;len=bodies.length;for(i=0;i<len;i++){body=bodies[i];if(body.willDrawDebug()){body.drawDebug(graphics)}}}var pending=this.pendingDestroy;if(pending.size>0){var dynamicTree=this.tree;var staticTree=this.staticTree;bodies=pending.entries;len=bodies.length;for(i=0;i<len;i++){body=bodies[i];if(body.physicsType===CONST.DYNAMIC_BODY){dynamicTree.remove(body);dynamic.delete(body)}else if(body.physicsType===CONST.STATIC_BODY){staticTree.remove(body);staticBodies.delete(body)}body.world=undefined;body.gameObject=undefined}pending.clear()}},updateMotion:function(body,delta){if(body.allowRotation){this.computeAngularVelocity(body,delta)}this.computeVelocity(body,delta)},computeAngularVelocity:function(body,delta){var velocity=body.angularVelocity;var acceleration=body.angularAcceleration;var drag=body.angularDrag;var max=body.maxAngular;if(acceleration){velocity+=acceleration*delta}else if(body.allowDrag&&drag){drag*=delta;if(FuzzyGreaterThan(velocity-drag,0,0.1)){velocity-=drag}else if(FuzzyLessThan(velocity+drag,0,0.1)){velocity+=drag}else{velocity=0}}velocity=Clamp(velocity,-max,max);var velocityDelta=velocity-body.angularVelocity;body.angularVelocity+=velocityDelta;body.rotation+=(body.angularVelocity*delta)},computeVelocity:function(body,delta){var velocityX=body.velocity.x;var accelerationX=body.acceleration.x;var dragX=body.drag.x;var maxX=body.maxVelocity.x;var velocityY=body.velocity.y;var accelerationY=body.acceleration.y;var dragY=body.drag.y;var maxY=body.maxVelocity.y;var speed=body.speed;var maxSpeed=body.maxSpeed;var allowDrag=body.allowDrag;var useDamping=body.useDamping;if(body.allowGravity){velocityX+=(this.gravity.x+body.gravity.x)*delta;velocityY+=(this.gravity.y+body.gravity.y)*delta}if(accelerationX){velocityX+=accelerationX*delta}else if(allowDrag&&dragX){if(useDamping){velocityX*=dragX;speed=Math.sqrt(velocityX*velocityX+velocityY*velocityY);if(FuzzyEqual(speed,0,0.001)){velocityX=0}}else{dragX*=delta;if(FuzzyGreaterThan(velocityX-dragX,0,0.01)){velocityX-=dragX}else if(FuzzyLessThan(velocityX+dragX,0,0.01)){velocityX+=dragX}else{velocityX=0}}}if(accelerationY){velocityY+=accelerationY*delta}else if(allowDrag&&dragY){if(useDamping){velocityY*=dragY;speed=Math.sqrt(velocityX*velocityX+velocityY*velocityY);if(FuzzyEqual(speed,0,0.001)){velocityY=0}}else{dragY*=delta;if(FuzzyGreaterThan(velocityY-dragY,0,0.01)){velocityY-=dragY}else if(FuzzyLessThan(velocityY+dragY,0,0.01)){velocityY+=dragY}else{velocityY=0}}}velocityX=Clamp(velocityX,-maxX,maxX);velocityY=Clamp(velocityY,-maxY,maxY);body.velocity.set(velocityX,velocityY);if(maxSpeed>-1&&speed>maxSpeed){body.velocity.normalize().scale(maxSpeed);speed=maxSpeed}body.speed=speed},separate:function(body1,body2,processCallback,callbackContext,overlapOnly,intersects){if(!intersects&&!body1.enable||!body2.enable||body1.checkCollision.none||body2.checkCollision.none||!this.intersects(body1,body2)){return false}if(processCallback&&processCallback.call(callbackContext,body1.gameObject,body2.gameObject)===false){return false}if(body1.isCircle&&body2.isCircle){return this.separateCircle(body1,body2,overlapOnly)}if(body1.isCircle!==body2.isCircle){var bodyRect=(body1.isCircle)?body2:body1;var bodyCircle=(body1.isCircle)?body1:body2;var rect={x:bodyRect.x,y:bodyRect.y,right:bodyRect.right,bottom:bodyRect.bottom};var circle=bodyCircle.center;if(circle.y<rect.y||circle.y>rect.bottom){if(circle.x<rect.x||circle.x>rect.right){return this.separateCircle(body1,body2,overlapOnly)}}}var resultX=false;var resultY=false;if(overlapOnly){resultX=SeparateX(body1,body2,overlapOnly,this.OVERLAP_BIAS);resultY=SeparateY(body1,body2,overlapOnly,this.OVERLAP_BIAS)}else if(this.forceX||Math.abs(this.gravity.y+body1.gravity.y)<Math.abs(this.gravity.x+body1.gravity.x)){resultX=SeparateX(body1,body2,overlapOnly,this.OVERLAP_BIAS);if(this.intersects(body1,body2)){resultY=SeparateY(body1,body2,overlapOnly,this.OVERLAP_BIAS)}}else{resultY=SeparateY(body1,body2,overlapOnly,this.OVERLAP_BIAS);if(this.intersects(body1,body2)){resultX=SeparateX(body1,body2,overlapOnly,this.OVERLAP_BIAS)}}var result=(resultX||resultY);if(result){if(overlapOnly){if(body1.onOverlap||body2.onOverlap){this.emit(Events.OVERLAP,body1.gameObject,body2.gameObject,body1,body2)}}else if(body1.onCollide||body2.onCollide){this.emit(Events.COLLIDE,body1.gameObject,body2.gameObject,body1,body2)}}return result},separateCircle:function(body1,body2,overlapOnly,bias){body1.updateCenter();body2.updateCenter();GetOverlapX(body1,body2,false,bias);GetOverlapY(body1,body2,false,bias);var overlap=0;if(body1.isCircle!==body2.isCircle){var rect={x:(body2.isCircle)?body1.position.x:body2.position.x,y:(body2.isCircle)?body1.position.y:body2.position.y,right:(body2.isCircle)?body1.right:body2.right,bottom:(body2.isCircle)?body1.bottom:body2.bottom};var circle={x:(body1.isCircle)?body1.center.x:body2.center.x,y:(body1.isCircle)?body1.center.y:body2.center.y,radius:(body1.isCircle)?body1.halfWidth:body2.halfWidth};if(circle.y<rect.y){if(circle.x<rect.x){overlap=DistanceBetween(circle.x,circle.y,rect.x,rect.y)-circle.radius}else if(circle.x>rect.right){overlap=DistanceBetween(circle.x,circle.y,rect.right,rect.y)-circle.radius}}else if(circle.y>rect.bottom){if(circle.x<rect.x){overlap=DistanceBetween(circle.x,circle.y,rect.x,rect.bottom)-circle.radius}else if(circle.x>rect.right){overlap=DistanceBetween(circle.x,circle.y,rect.right,rect.bottom)-circle.radius}}overlap*=-1}else{overlap=(body1.halfWidth+body2.halfWidth)-DistanceBetween(body1.center.x,body1.center.y,body2.center.x,body2.center.y)}if(overlapOnly||overlap===0||(body1.immovable&&body2.immovable)||body1.customSeparateX||body2.customSeparateX){if(overlap!==0&&(body1.onOverlap||body2.onOverlap)){this.emit(Events.OVERLAP,body1.gameObject,body2.gameObject,body1,body2)}return(overlap!==0)}var dx=body1.center.x-body2.center.x;var dy=body1.center.y-body2.center.y;var d=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2));var nx=((body2.center.x-body1.center.x)/d)||0;var ny=((body2.center.y-body1.center.y)/d)||0;var p=2*(body1.velocity.x*nx+body1.velocity.y*ny-body2.velocity.x*nx-body2.velocity.y*ny)/(body1.mass+body2.mass);if(body1.immovable||body2.immovable){p*=2}if(!body1.immovable){body1.velocity.x=(body1.velocity.x-p/body1.mass*nx);body1.velocity.y=(body1.velocity.y-p/body1.mass*ny)}if(!body2.immovable){body2.velocity.x=(body2.velocity.x+p/body2.mass*nx);body2.velocity.y=(body2.velocity.y+p/body2.mass*ny)}if(!body1.immovable&&!body2.immovable){overlap/=2}var angle=AngleBetweenPoints(body1.center,body2.center);var overlapX=(overlap+MATH_CONST.EPSILON)*Math.cos(angle);var overlapY=(overlap+MATH_CONST.EPSILON)*Math.sin(angle);if(!body1.immovable){body1.x-=overlapX;body1.y-=overlapY;body1.updateCenter()}if(!body2.immovable){body2.x+=overlapX;body2.y+=overlapY;body2.updateCenter()}body1.velocity.x*=body1.bounce.x;body1.velocity.y*=body1.bounce.y;body2.velocity.x*=body2.bounce.x;body2.velocity.y*=body2.bounce.y;if(body1.onCollide||body2.onCollide){this.emit(Events.COLLIDE,body1.gameObject,body2.gameObject,body1,body2)}return true},intersects:function(body1,body2){if(body1===body2){return false}if(!body1.isCircle&&!body2.isCircle){return!(body1.right<=body2.position.x||body1.bottom<=body2.position.y||body1.position.x>=body2.right||body1.position.y>=body2.bottom)}else if(body1.isCircle){if(body2.isCircle){return DistanceBetween(body1.center.x,body1.center.y,body2.center.x,body2.center.y)<=(body1.halfWidth+body2.halfWidth)}else{return this.circleBodyIntersects(body1,body2)}}else{return this.circleBodyIntersects(body2,body1)}},circleBodyIntersects:function(circle,body){var x=Clamp(circle.center.x,body.left,body.right);var y=Clamp(circle.center.y,body.top,body.bottom);var dx=(circle.center.x-x)*(circle.center.x-x);var dy=(circle.center.y-y)*(circle.center.y-y);return(dx+dy)<=(circle.halfWidth*circle.halfWidth)},overlap:function(object1,object2,overlapCallback,processCallback,callbackContext){if(overlapCallback===undefined){overlapCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=overlapCallback}return this.collideObjects(object1,object2,overlapCallback,processCallback,callbackContext,true)},collide:function(object1,object2,collideCallback,processCallback,callbackContext){if(collideCallback===undefined){collideCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=collideCallback}return this.collideObjects(object1,object2,collideCallback,processCallback,callbackContext,false)},collideObjects:function(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly){var i;var j;if(object1.isParent&&object1.physicsType===undefined){object1=object1.children.entries}if(object2&&object2.isParent&&object2.physicsType===undefined){object2=object2.children.entries}var object1isArray=Array.isArray(object1);var object2isArray=Array.isArray(object2);this._total=0;if(!object1isArray&&!object2isArray){this.collideHandler(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly)}else if(!object1isArray&&object2isArray){for(i=0;i<object2.length;i++){this.collideHandler(object1,object2[i],collideCallback,processCallback,callbackContext,overlapOnly)}}else if(object1isArray&&!object2isArray){if(!object2){for(i=0;i<object1.length;i++){var child=object1[i];for(j=i+1;j<object1.length;j++){if(i===j){continue}this.collideHandler(child,object1[j],collideCallback,processCallback,callbackContext,overlapOnly)}}}else{for(i=0;i<object1.length;i++){this.collideHandler(object1[i],object2,collideCallback,processCallback,callbackContext,overlapOnly)}}}else{for(i=0;i<object1.length;i++){for(j=0;j<object2.length;j++){this.collideHandler(object1[i],object2[j],collideCallback,processCallback,callbackContext,overlapOnly)}}}return(this._total>0)},collideHandler:function(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly){if(object2===undefined&&object1.isParent){return this.collideGroupVsGroup(object1,object1,collideCallback,processCallback,callbackContext,overlapOnly)}if(!object1||!object2){return false}if(object1.body){if(object2.body){return this.collideSpriteVsSprite(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly)}else if(object2.isParent){return this.collideSpriteVsGroup(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly)}else if(object2.isTilemap){return this.collideSpriteVsTilemapLayer(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly)}}else if(object1.isParent){if(object2.body){return this.collideSpriteVsGroup(object2,object1,collideCallback,processCallback,callbackContext,overlapOnly)}else if(object2.isParent){return this.collideGroupVsGroup(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly)}else if(object2.isTilemap){return this.collideGroupVsTilemapLayer(object1,object2,collideCallback,processCallback,callbackContext,overlapOnly)}}else if(object1.isTilemap){if(object2.body){return this.collideSpriteVsTilemapLayer(object2,object1,collideCallback,processCallback,callbackContext,overlapOnly)}else if(object2.isParent){return this.collideGroupVsTilemapLayer(object2,object1,collideCallback,processCallback,callbackContext,overlapOnly)}}},collideSpriteVsSprite:function(sprite1,sprite2,collideCallback,processCallback,callbackContext,overlapOnly){if(!sprite1.body||!sprite2.body){return false}if(this.separate(sprite1.body,sprite2.body,processCallback,callbackContext,overlapOnly)){if(collideCallback){collideCallback.call(callbackContext,sprite1,sprite2)}this._total++}return true},collideSpriteVsGroup:function(sprite,group,collideCallback,processCallback,callbackContext,overlapOnly){var bodyA=sprite.body;if(group.length===0||!bodyA||!bodyA.enable||bodyA.checkCollision.none){return}var i;var len;var bodyB;if(this.useTree||group.physicsType===CONST.STATIC_BODY){var minMax=this.treeMinMax;minMax.minX=bodyA.left;minMax.minY=bodyA.top;minMax.maxX=bodyA.right;minMax.maxY=bodyA.bottom;var results=(group.physicsType===CONST.DYNAMIC_BODY)?this.tree.search(minMax):this.staticTree.search(minMax);len=results.length;for(i=0;i<len;i++){bodyB=results[i];if(bodyA===bodyB||!bodyB.enable||bodyB.checkCollision.none||!group.contains(bodyB.gameObject)){continue}if(this.separate(bodyA,bodyB,processCallback,callbackContext,overlapOnly,true)){if(collideCallback){collideCallback.call(callbackContext,bodyA.gameObject,bodyB.gameObject)}this._total++}}}else{var children=group.getChildren();var skipIndex=group.children.entries.indexOf(sprite);len=children.length;for(i=0;i<len;i++){bodyB=children[i].body;if(!bodyB||i===skipIndex||!bodyB.enable){continue}if(this.separate(bodyA,bodyB,processCallback,callbackContext,overlapOnly)){if(collideCallback){collideCallback.call(callbackContext,bodyA.gameObject,bodyB.gameObject)}this._total++}}}},collideGroupVsTilemapLayer:function(group,tilemapLayer,collideCallback,processCallback,callbackContext,overlapOnly){var children=group.getChildren();if(children.length===0){return false}var didCollide=false;for(var i=0;i<children.length;i++){if(children[i].body){if(this.collideSpriteVsTilemapLayer(children[i],tilemapLayer,collideCallback,processCallback,callbackContext,overlapOnly)){didCollide=true}}}return didCollide},collideTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){if(!sprite.body.enable||tiles.length===0){return false}else{return this.collideSpriteVsTilesHandler(sprite,tiles,collideCallback,processCallback,callbackContext,false,false)}},overlapTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){if(!sprite.body.enable||tiles.length===0){return false}else{return this.collideSpriteVsTilesHandler(sprite,tiles,collideCallback,processCallback,callbackContext,true,false)}},collideSpriteVsTilemapLayer:function(sprite,tilemapLayer,collideCallback,processCallback,callbackContext,overlapOnly){var body=sprite.body;if(!body.enable||body.checkCollision.none){return false}var x=body.position.x;var y=body.position.y;var w=body.width;var h=body.height;var layerData=tilemapLayer.layer;if(layerData.tileWidth>layerData.baseTileWidth){var xDiff=(layerData.tileWidth-layerData.baseTileWidth)*tilemapLayer.scaleX;x-=xDiff;w+=xDiff}if(layerData.tileHeight>layerData.baseTileHeight){var yDiff=(layerData.tileHeight-layerData.baseTileHeight)*tilemapLayer.scaleY;h+=yDiff}var mapData=tilemapLayer.getTilesWithinWorldXY(x,y,w,h);if(mapData.length===0){return false}else{return this.collideSpriteVsTilesHandler(sprite,mapData,collideCallback,processCallback,callbackContext,overlapOnly,true)}},collideSpriteVsTilesHandler:function(sprite,tiles,collideCallback,processCallback,callbackContext,overlapOnly,isLayer){var body=sprite.body;var tile;var tileWorldRect={left:0,right:0,top:0,bottom:0};var tilemapLayer;var collision=false;for(var i=0;i<tiles.length;i++){tile=tiles[i];tilemapLayer=tile.tilemapLayer;tileWorldRect.left=tilemapLayer.tileToWorldX(tile.x);tileWorldRect.top=tilemapLayer.tileToWorldY(tile.y);if(tile.baseHeight!==tile.height){tileWorldRect.top-=(tile.height-tile.baseHeight)*tilemapLayer.scaleY}tileWorldRect.right=tileWorldRect.left+tile.width*tilemapLayer.scaleX;tileWorldRect.bottom=tileWorldRect.top+tile.height*tilemapLayer.scaleY;if(TileIntersectsBody(tileWorldRect,body)&&(!processCallback||processCallback.call(callbackContext,sprite,tile))&&ProcessTileCallbacks(tile,sprite)&&(overlapOnly||SeparateTile(i,body,tile,tileWorldRect,tilemapLayer,this.TILE_BIAS,isLayer))){this._total++;collision=true;if(collideCallback){collideCallback.call(callbackContext,sprite,tile)}if(overlapOnly&&body.onOverlap){this.emit(Events.TILE_OVERLAP,sprite,tile,body)}else if(body.onCollide){this.emit(Events.TILE_COLLIDE,sprite,tile,body)}}}return collision},collideGroupVsGroup:function(group1,group2,collideCallback,processCallback,callbackContext,overlapOnly){if(group1.length===0||group2.length===0){return}var children=group1.getChildren();for(var i=0;i<children.length;i++){this.collideSpriteVsGroup(children[i],group2,collideCallback,processCallback,callbackContext,overlapOnly)}},wrap:function(object,padding){if(object.body){this.wrapObject(object,padding)}else if(object.getChildren){this.wrapArray(object.getChildren(),padding)}else if(Array.isArray(object)){this.wrapArray(object,padding)}else{this.wrapObject(object,padding)}},wrapArray:function(objects,padding){for(var i=0;i<objects.length;i++){this.wrapObject(objects[i],padding)}},wrapObject:function(object,padding){if(padding===undefined){padding=0}object.x=Wrap(object.x,this.bounds.left-padding,this.bounds.right+padding);object.y=Wrap(object.y,this.bounds.top-padding,this.bounds.bottom+padding)},shutdown:function(){this.tree.clear();this.staticTree.clear();this.bodies.clear();this.staticBodies.clear();this.colliders.destroy();this.removeAllListeners()},destroy:function(){this.shutdown();this.scene=null}});module.exports=World}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(50);var Events=__webpack_require__(218);var RadToDeg=__webpack_require__(173);var Rectangle=__webpack_require__(11);var RectangleContains=__webpack_require__(48);var Vector2=__webpack_require__(3);var Body=new Class({initialize:function Body(world,gameObject){var width=(gameObject.displayWidth)?gameObject.displayWidth:64;var height=(gameObject.displayHeight)?gameObject.displayHeight:64;this.world=world;this.gameObject=gameObject;this.transform={x:gameObject.x,y:gameObject.y,rotation:gameObject.angle,scaleX:gameObject.scaleX,scaleY:gameObject.scaleY,displayOriginX:gameObject.displayOriginX,displayOriginY:gameObject.displayOriginY};this.debugShowBody=world.defaults.debugShowBody;this.debugShowVelocity=world.defaults.debugShowVelocity;this.debugBodyColor=world.defaults.bodyDebugColor;this.enable=true;this.isCircle=false;this.radius=0;this.offset=new Vector2();this.position=new Vector2(gameObject.x-gameObject.scaleX*gameObject.displayOriginX,gameObject.y-gameObject.scaleY*gameObject.displayOriginY);this.prev=this.position.clone();this.prevFrame=this.position.clone();this.allowRotation=true;this.rotation=gameObject.angle;this.preRotation=gameObject.angle;this.width=width;this.height=height;this.sourceWidth=width;this.sourceHeight=height;if(gameObject.frame){this.sourceWidth=gameObject.frame.realWidth;this.sourceHeight=gameObject.frame.realHeight}this.halfWidth=Math.abs(width/2);this.halfHeight=Math.abs(height/2);this.center=new Vector2(this.position.x+this.halfWidth,this.position.y+this.halfHeight);this.velocity=new Vector2();this.newVelocity=new Vector2();this.deltaMax=new Vector2();this.acceleration=new Vector2();this.allowDrag=true;this.drag=new Vector2();this.allowGravity=true;this.gravity=new Vector2();this.bounce=new Vector2();this.worldBounce=null;this.customBoundsRectangle=world.bounds;this.onWorldBounds=false;this.onCollide=false;this.onOverlap=false;this.maxVelocity=new Vector2(10000,10000);this.maxSpeed=-1;this.friction=new Vector2(1,0);this.useDamping=false;this.angularVelocity=0;this.angularAcceleration=0;this.angularDrag=0;this.maxAngular=1000;this.mass=1;this.angle=0;this.speed=0;this.facing=CONST.FACING_NONE;this.immovable=false;this.moves=true;this.customSeparateX=false;this.customSeparateY=false;this.overlapX=0;this.overlapY=0;this.overlapR=0;this.embedded=false;this.collideWorldBounds=false;this.checkCollision={none:false,up:true,down:true,left:true,right:true};this.touching={none:true,up:false,down:false,left:false,right:false};this.wasTouching={none:true,up:false,down:false,left:false,right:false};this.blocked={none:true,up:false,down:false,left:false,right:false};this.syncBounds=false;this.physicsType=CONST.DYNAMIC_BODY;this._sx=gameObject.scaleX;this._sy=gameObject.scaleY;this._dx=0;this._dy=0;this._tx=0;this._ty=0;this._bounds=new Rectangle()},updateBounds:function(){var sprite=this.gameObject;var transform=this.transform;if(sprite.parentContainer){var matrix=sprite.getWorldTransformMatrix(this.world._tempMatrix,this.world._tempMatrix2);transform.x=matrix.tx;transform.y=matrix.ty;transform.rotation=RadToDeg(matrix.rotation);transform.scaleX=matrix.scaleX;transform.scaleY=matrix.scaleY;transform.displayOriginX=sprite.displayOriginX;transform.displayOriginY=sprite.displayOriginY}else{transform.x=sprite.x;transform.y=sprite.y;transform.rotation=sprite.angle;transform.scaleX=sprite.scaleX;transform.scaleY=sprite.scaleY;transform.displayOriginX=sprite.displayOriginX;transform.displayOriginY=sprite.displayOriginY}var recalc=false;if(this.syncBounds){var b=sprite.getBounds(this._bounds);this.width=b.width;this.height=b.height;recalc=true}else{var asx=Math.abs(transform.scaleX);var asy=Math.abs(transform.scaleY);if(this._sx!==asx||this._sy!==asy){this.width=this.sourceWidth*asx;this.height=this.sourceHeight*asy;this._sx=asx;this._sy=asy;recalc=true}}if(recalc){this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.updateCenter()}},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},updateFromGameObject:function(){this.updateBounds();var transform=this.transform;this.position.x=transform.x+transform.scaleX*(this.offset.x-transform.displayOriginX);this.position.y=transform.y+transform.scaleY*(this.offset.y-transform.displayOriginY);this.updateCenter()},resetFlags:function(){var wasTouching=this.wasTouching;var touching=this.touching;var blocked=this.blocked;wasTouching.none=touching.none;wasTouching.up=touching.up;wasTouching.down=touching.down;wasTouching.left=touching.left;wasTouching.right=touching.right;touching.none=true;touching.up=false;touching.down=false;touching.left=false;touching.right=false;blocked.none=true;blocked.up=false;blocked.down=false;blocked.left=false;blocked.right=false;this.overlapR=0;this.overlapX=0;this.overlapY=0;this.embedded=false},preUpdate:function(willStep,delta){if(willStep){this.resetFlags()}this.updateFromGameObject();this.rotation=this.transform.rotation;this.preRotation=this.rotation;if(this.moves){this.prev.x=this.position.x;this.prev.y=this.position.y;this.prevFrame.x=this.position.x;this.prevFrame.y=this.position.y}if(willStep){this.update(delta)}},update:function(delta){this.prev.x=this.position.x;this.prev.y=this.position.y;if(this.moves){this.world.updateMotion(this,delta);var vx=this.velocity.x;var vy=this.velocity.y;this.newVelocity.set(vx*delta,vy*delta);this.position.add(this.newVelocity);this.updateCenter();this.angle=Math.atan2(vy,vx);this.speed=Math.sqrt(vx*vx+vy*vy);if(this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds){this.world.emit(Events.WORLD_BOUNDS,this,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)}}this._dx=this.position.x-this.prev.x;this._dy=this.position.y-this.prev.y},postUpdate:function(){var dx=this.position.x-this.prevFrame.x;var dy=this.position.y-this.prevFrame.y;if(this.moves){var mx=this.deltaMax.x;var my=this.deltaMax.y;if(mx!==0&&dx!==0){if(dx<0&&dx<-mx){dx=-mx}else if(dx>0&&dx>mx){dx=mx}}if(my!==0&&dy!==0){if(dy<0&&dy<-my){dy=-my}else if(dy>0&&dy>my){dy=my}}this.gameObject.x+=dx;this.gameObject.y+=dy}if(dx<0){this.facing=CONST.FACING_LEFT}else if(dx>0){this.facing=CONST.FACING_RIGHT}if(dy<0){this.facing=CONST.FACING_UP}else if(dy>0){this.facing=CONST.FACING_DOWN}if(this.allowRotation){this.gameObject.angle+=this.deltaZ()}this._tx=dx;this._ty=dy},setBoundsRectangle:function(bounds){this.customBoundsRectangle=(!bounds)?this.world.bounds:bounds;return this},checkWorldBounds:function(){var pos=this.position;var bounds=this.customBoundsRectangle;var check=this.world.checkCollision;var bx=(this.worldBounce)?-this.worldBounce.x:-this.bounce.x;var by=(this.worldBounce)?-this.worldBounce.y:-this.bounce.y;var wasSet=false;if(pos.x<bounds.x&&check.left){pos.x=bounds.x;this.velocity.x*=bx;this.blocked.left=true;wasSet=true}else if(this.right>bounds.right&&check.right){pos.x=bounds.right-this.width;this.velocity.x*=bx;this.blocked.right=true;wasSet=true}if(pos.y<bounds.y&&check.up){pos.y=bounds.y;this.velocity.y*=by;this.blocked.up=true;wasSet=true}else if(this.bottom>bounds.bottom&&check.down){pos.y=bounds.bottom-this.height;this.velocity.y*=by;this.blocked.down=true;wasSet=true}if(wasSet){this.blocked.none=false}return wasSet},setOffset:function(x,y){if(y===undefined){y=x}this.offset.set(x,y);this.updateCenter();return this},setSize:function(width,height,center){if(center===undefined){center=true}var gameObject=this.gameObject;if(!width&&gameObject.frame){width=gameObject.frame.realWidth}if(!height&&gameObject.frame){height=gameObject.frame.realHeight}this.sourceWidth=width;this.sourceHeight=height;this.width=this.sourceWidth*this._sx;this.height=this.sourceHeight*this._sy;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.updateCenter();if(center&&gameObject.getCenter){var ox=(gameObject.width-width)/2;var oy=(gameObject.height-height)/2;this.offset.set(ox,oy)}this.isCircle=false;this.radius=0;return this},setCircle:function(radius,offsetX,offsetY){if(offsetX===undefined){offsetX=this.offset.x}if(offsetY===undefined){offsetY=this.offset.y}if(radius>0){this.isCircle=true;this.radius=radius;this.sourceWidth=radius*2;this.sourceHeight=radius*2;this.width=this.sourceWidth*this._sx;this.height=this.sourceHeight*this._sy;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.offset.set(offsetX,offsetY);this.updateCenter()}else{this.isCircle=false}return this},reset:function(x,y){this.stop();var gameObject=this.gameObject;gameObject.setPosition(x,y);if(gameObject.getTopLeft){gameObject.getTopLeft(this.position)}else{this.position.set(x,y)}this.prev.copy(this.position);this.prevFrame.copy(this.position);this.rotation=gameObject.angle;this.preRotation=gameObject.angle;this.updateBounds();this.updateCenter()},stop:function(){this.velocity.set(0);this.acceleration.set(0);this.speed=0;this.angularVelocity=0;this.angularAcceleration=0;return this},getBounds:function(obj){obj.x=this.x;obj.y=this.y;obj.right=this.right;obj.bottom=this.bottom;return obj},hitTest:function(x,y){if(!this.isCircle){return RectangleContains(this,x,y)}if(this.radius>0&&x>=this.left&&x<=this.right&&y>=this.top&&y<=this.bottom){var dx=(this.center.x-x)*(this.center.x-x);var dy=(this.center.y-y)*(this.center.y-y);return(dx+dy)<=(this.radius*this.radius)}return false},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return(this.blocked.left||this.blocked.right)},deltaAbsX:function(){return(this._dx>0)?this._dx:-this._dx},deltaAbsY:function(){return(this._dy>0)?this._dy:-this._dy},deltaX:function(){return this._dx},deltaY:function(){return this._dy},deltaXFinal:function(){return this._tx},deltaYFinal:function(){return this._ty},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.enable=false;if(this.world){this.world.pendingDestroy.set(this)}},drawDebug:function(graphic){var pos=this.position;var x=pos.x+this.halfWidth;var y=pos.y+this.halfHeight;if(this.debugShowBody){graphic.lineStyle(graphic.defaultStrokeWidth,this.debugBodyColor);if(this.isCircle){graphic.strokeCircle(x,y,this.width/2)}else{if(this.checkCollision.up){graphic.lineBetween(pos.x,pos.y,pos.x+this.width,pos.y)}if(this.checkCollision.right){graphic.lineBetween(pos.x+this.width,pos.y,pos.x+this.width,pos.y+this.height)}if(this.checkCollision.down){graphic.lineBetween(pos.x,pos.y+this.height,pos.x+this.width,pos.y+this.height)}if(this.checkCollision.left){graphic.lineBetween(pos.x,pos.y,pos.x,pos.y+this.height)}}}if(this.debugShowVelocity){graphic.lineStyle(graphic.defaultStrokeWidth,this.world.defaults.velocityDebugColor,1);graphic.lineBetween(x,y,x+this.velocity.x/2,y+this.velocity.y/2)}},willDrawDebug:function(){return(this.debugShowBody||this.debugShowVelocity)},setCollideWorldBounds:function(value,bounceX,bounceY){if(value===undefined){value=true}this.collideWorldBounds=value;var setBounceX=(bounceX!==undefined);var setBounceY=(bounceY!==undefined);if(setBounceX||setBounceY){if(!this.worldBounce){this.worldBounce=new Vector2()}if(setBounceX){this.worldBounce.x=bounceX}if(setBounceY){this.worldBounce.y=bounceY}}return this},setVelocity:function(x,y){this.velocity.set(x,y);x=this.velocity.x;y=this.velocity.y;this.speed=Math.sqrt(x*x+y*y);return this},setVelocityX:function(value){this.velocity.x=value;var x=value;var y=this.velocity.y;this.speed=Math.sqrt(x*x+y*y);return this},setVelocityY:function(value){this.velocity.y=value;var x=this.velocity.x;var y=value;this.speed=Math.sqrt(x*x+y*y);return this},setMaxVelocity:function(x,y){this.maxVelocity.set(x,y);return this},setMaxSpeed:function(value){this.maxSpeed=value;return this},setBounce:function(x,y){this.bounce.set(x,y);return this},setBounceX:function(value){this.bounce.x=value;return this},setBounceY:function(value){this.bounce.y=value;return this},setAcceleration:function(x,y){this.acceleration.set(x,y);return this},setAccelerationX:function(value){this.acceleration.x=value;return this},setAccelerationY:function(value){this.acceleration.y=value;return this},setAllowDrag:function(value){if(value===undefined){value=true}this.allowDrag=value;return this},setAllowGravity:function(value){if(value===undefined){value=true}this.allowGravity=value;return this},setAllowRotation:function(value){if(value===undefined){value=true}this.allowRotation=value;return this},setDrag:function(x,y){this.drag.set(x,y);return this},setDragX:function(value){this.drag.x=value;return this},setDragY:function(value){this.drag.y=value;return this},setGravity:function(x,y){this.gravity.set(x,y);return this},setGravityX:function(value){this.gravity.x=value;return this},setGravityY:function(value){this.gravity.y=value;return this},setFriction:function(x,y){this.friction.set(x,y);return this},setFrictionX:function(value){this.friction.x=value;return this},setFrictionY:function(value){this.friction.y=value;return this},setAngularVelocity:function(value){this.angularVelocity=value;return this},setAngularAcceleration:function(value){this.angularAcceleration=value;return this},setAngularDrag:function(value){this.angularDrag=value;return this},setMass:function(value){this.mass=value;return this},setImmovable:function(value){if(value===undefined){value=true}this.immovable=value;return this},setEnable:function(value){if(value===undefined){value=true}this.enable=value;return this},x:{get:function(){return this.position.x},set:function(value){this.position.x=value}},y:{get:function(){return this.position.y},set:function(value){this.position.y=value}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});module.exports=Body}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Collider=new Class({initialize:function Collider(world,overlapOnly,object1,object2,collideCallback,processCallback,callbackContext){this.world=world;this.name='';this.active=true;this.overlapOnly=overlapOnly;this.object1=object1;this.object2=object2;this.collideCallback=collideCallback;this.processCallback=processCallback;this.callbackContext=callbackContext},setName:function(name){this.name=name;return this},update:function(){this.world.collideObjects(this.object1,this.object2,this.collideCallback,this.processCallback,this.callbackContext,this.overlapOnly)},destroy:function(){this.world.removeCollider(this);this.active=false;this.world=null;this.object1=null;this.object2=null;this.collideCallback=null;this.processCallback=null;this.callbackContext=null}});module.exports=Collider}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(50);var GetOverlapX=function(body1,body2,overlapOnly,bias){var overlap=0;var maxOverlap=body1.deltaAbsX()+body2.deltaAbsX()+bias;if(body1._dx===0&&body2._dx===0){body1.embedded=true;body2.embedded=true}else if(body1._dx>body2._dx){overlap=body1.right-body2.x;if((overlap>maxOverlap&&!overlapOnly)||body1.checkCollision.right===false||body2.checkCollision.left===false){overlap=0}else{body1.touching.none=false;body1.touching.right=true;body2.touching.none=false;body2.touching.left=true;if(body2.physicsType===CONST.STATIC_BODY){body1.blocked.none=false;body1.blocked.right=true}if(body1.physicsType===CONST.STATIC_BODY){body2.blocked.none=false;body2.blocked.left=true}}}else if(body1._dx<body2._dx){overlap=body1.x-body2.width-body2.x;if((-overlap>maxOverlap&&!overlapOnly)||body1.checkCollision.left===false||body2.checkCollision.right===false){overlap=0}else{body1.touching.none=false;body1.touching.left=true;body2.touching.none=false;body2.touching.right=true;if(body2.physicsType===CONST.STATIC_BODY){body1.blocked.none=false;body1.blocked.left=true}if(body1.physicsType===CONST.STATIC_BODY){body2.blocked.none=false;body2.blocked.right=true}}}body1.overlapX=overlap;body2.overlapX=overlap;return overlap};module.exports=GetOverlapX}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(50);var GetOverlapY=function(body1,body2,overlapOnly,bias){var overlap=0;var maxOverlap=body1.deltaAbsY()+body2.deltaAbsY()+bias;if(body1._dy===0&&body2._dy===0){body1.embedded=true;body2.embedded=true}else if(body1._dy>body2._dy){overlap=body1.bottom-body2.y;if((overlap>maxOverlap&&!overlapOnly)||body1.checkCollision.down===false||body2.checkCollision.up===false){overlap=0}else{body1.touching.none=false;body1.touching.down=true;body2.touching.none=false;body2.touching.up=true;if(body2.physicsType===CONST.STATIC_BODY){body1.blocked.none=false;body1.blocked.down=true}if(body1.physicsType===CONST.STATIC_BODY){body2.blocked.none=false;body2.blocked.up=true}}}else if(body1._dy<body2._dy){overlap=body1.y-body2.bottom;if((-overlap>maxOverlap&&!overlapOnly)||body1.checkCollision.up===false||body2.checkCollision.down===false){overlap=0}else{body1.touching.none=false;body1.touching.up=true;body2.touching.none=false;body2.touching.down=true;if(body2.physicsType===CONST.STATIC_BODY){body1.blocked.none=false;body1.blocked.up=true}if(body1.physicsType===CONST.STATIC_BODY){body2.blocked.none=false;body2.blocked.down=true}}}body1.overlapY=overlap;body2.overlapY=overlap;return overlap};module.exports=GetOverlapY}),(function(module,exports,__webpack_require__){var quickselect=__webpack_require__(391);function rbush(maxEntries){var format=['.left','.top','.right','.bottom'];if(!(this instanceof rbush))return new rbush(maxEntries,format);this._maxEntries=Math.max(4,maxEntries||9);this._minEntries=Math.max(2,Math.ceil(this._maxEntries*0.4));this.clear()}rbush.prototype={all:function(){return this._all(this.data,[])},search:function(bbox){var node=this.data,result=[],toBBox=this.toBBox;if(!intersects(bbox,node))return result;var nodesToSearch=[],i,len,child,childBBox;while(node){for(i=0,len=node.children.length;i<len;i++){child=node.children[i];childBBox=node.leaf?toBBox(child):child;if(intersects(bbox,childBBox)){if(node.leaf)result.push(child);else if(contains(bbox,childBBox))this._all(child,result);else nodesToSearch.push(child)}}node=nodesToSearch.pop()}return result},collides:function(bbox){var node=this.data,toBBox=this.toBBox;if(!intersects(bbox,node))return false;var nodesToSearch=[],i,len,child,childBBox;while(node){for(i=0,len=node.children.length;i<len;i++){child=node.children[i];childBBox=node.leaf?toBBox(child):child;if(intersects(bbox,childBBox)){if(node.leaf||contains(bbox,childBBox))return true;nodesToSearch.push(child)}}node=nodesToSearch.pop()}return false},load:function(data){if(!(data&&data.length))return this;if(data.length<this._minEntries){for(var i=0,len=data.length;i<len;i++){this.insert(data[i])}return this}var node=this._build(data.slice(),0,data.length-1,0);if(!this.data.children.length){this.data=node}else if(this.data.height===node.height){this._splitRoot(this.data,node)}else{if(this.data.height<node.height){var tmpNode=this.data;this.data=node;node=tmpNode}this._insert(node,this.data.height-node.height-1,true)}return this},insert:function(item){if(item)this._insert(item,this.data.height-1);return this},clear:function(){this.data=createNode([]);return this},remove:function(item,equalsFn){if(!item)return this;var node=this.data,bbox=this.toBBox(item),path=[],indexes=[],i,parent,index,goingUp;while(node||path.length){if(!node){node=path.pop();parent=path[path.length-1];i=indexes.pop();goingUp=true}if(node.leaf){index=findItem(item,node.children,equalsFn);if(index!==-1){node.children.splice(index,1);path.push(node);this._condense(path);return this}}if(!goingUp&&!node.leaf&&contains(node,bbox)){path.push(node);indexes.push(i);i=0;parent=node;node=node.children[0]}else if(parent){i++;node=parent.children[i];goingUp=false}else node=null}return this},toBBox:function(item){return item},compareMinX:compareNodeMinX,compareMinY:compareNodeMinY,toJSON:function(){return this.data},fromJSON:function(data){this.data=data;return this},_all:function(node,result){var nodesToSearch=[];while(node){if(node.leaf)result.push.apply(result,node.children);else nodesToSearch.push.apply(nodesToSearch,node.children);node=nodesToSearch.pop()}return result},_build:function(items,left,right,height){var N=right-left+1,M=this._maxEntries,node;if(N<=M){node=createNode(items.slice(left,right+1));calcBBox(node,this.toBBox);return node}if(!height){height=Math.ceil(Math.log(N)/Math.log(M));M=Math.ceil(N/Math.pow(M,height-1))}node=createNode([]);node.leaf=false;node.height=height;var N2=Math.ceil(N/M),N1=N2*Math.ceil(Math.sqrt(M)),i,j,right2,right3;multiSelect(items,left,right,N1,this.compareMinX);for(i=left;i<=right;i+=N1){right2=Math.min(i+N1-1,right);multiSelect(items,i,right2,N2,this.compareMinY);for(j=i;j<=right2;j+=N2){right3=Math.min(j+N2-1,right2);node.children.push(this._build(items,j,right3,height-1))}}calcBBox(node,this.toBBox);return node},_chooseSubtree:function(bbox,node,level,path){var i,len,child,targetNode,area,enlargement,minArea,minEnlargement;while(true){path.push(node);if(node.leaf||path.length-1===level)break;minArea=minEnlargement=Infinity;for(i=0,len=node.children.length;i<len;i++){child=node.children[i];area=bboxArea(child);enlargement=enlargedArea(bbox,child)-area;if(enlargement<minEnlargement){minEnlargement=enlargement;minArea=area<minArea?area:minArea;targetNode=child}else if(enlargement===minEnlargement){if(area<minArea){minArea=area;targetNode=child}}}node=targetNode||node.children[0]}return node},_insert:function(item,level,isNode){var toBBox=this.toBBox,bbox=isNode?item:toBBox(item),insertPath=[];var node=this._chooseSubtree(bbox,this.data,level,insertPath);node.children.push(item);extend(node,bbox);while(level>=0){if(insertPath[level].children.length>this._maxEntries){this._split(insertPath,level);level--}else break}this._adjustParentBBoxes(bbox,insertPath,level)},_split:function(insertPath,level){var node=insertPath[level],M=node.children.length,m=this._minEntries;this._chooseSplitAxis(node,m,M);var splitIndex=this._chooseSplitIndex(node,m,M);var newNode=createNode(node.children.splice(splitIndex,node.children.length-splitIndex));newNode.height=node.height;newNode.leaf=node.leaf;calcBBox(node,this.toBBox);calcBBox(newNode,this.toBBox);if(level)insertPath[level-1].children.push(newNode);else this._splitRoot(node,newNode)},_splitRoot:function(node,newNode){this.data=createNode([node,newNode]);this.data.height=node.height+1;this.data.leaf=false;calcBBox(this.data,this.toBBox)},_chooseSplitIndex:function(node,m,M){var i,bbox1,bbox2,overlap,area,minOverlap,minArea,index;minOverlap=minArea=Infinity;for(i=m;i<=M-m;i++){bbox1=distBBox(node,0,i,this.toBBox);bbox2=distBBox(node,i,M,this.toBBox);overlap=intersectionArea(bbox1,bbox2);area=bboxArea(bbox1)+bboxArea(bbox2);if(overlap<minOverlap){minOverlap=overlap;index=i;minArea=area<minArea?area:minArea}else if(overlap===minOverlap){if(area<minArea){minArea=area;index=i}}}return index},_chooseSplitAxis:function(node,m,M){var compareMinX=node.leaf?this.compareMinX:compareNodeMinX,compareMinY=node.leaf?this.compareMinY:compareNodeMinY,xMargin=this._allDistMargin(node,m,M,compareMinX),yMargin=this._allDistMargin(node,m,M,compareMinY);if(xMargin<yMargin)node.children.sort(compareMinX)},_allDistMargin:function(node,m,M,compare){node.children.sort(compare);var toBBox=this.toBBox,leftBBox=distBBox(node,0,m,toBBox),rightBBox=distBBox(node,M-m,M,toBBox),margin=bboxMargin(leftBBox)+bboxMargin(rightBBox),i,child;for(i=m;i<M-m;i++){child=node.children[i];extend(leftBBox,node.leaf?toBBox(child):child);margin+=bboxMargin(leftBBox)}for(i=M-m-1;i>=m;i--){child=node.children[i];extend(rightBBox,node.leaf?toBBox(child):child);margin+=bboxMargin(rightBBox)}return margin},_adjustParentBBoxes:function(bbox,path,level){for(var i=level;i>=0;i--){extend(path[i],bbox)}},_condense:function(path){for(var i=path.length-1,siblings;i>=0;i--){if(path[i].children.length===0){if(i>0){siblings=path[i-1].children;siblings.splice(siblings.indexOf(path[i]),1)}else this.clear()}else calcBBox(path[i],this.toBBox)}},compareMinX:function(a,b){return a.left-b.left},compareMinY:function(a,b){return a.top-b.top},toBBox:function(a){return{minX:a.left,minY:a.top,maxX:a.right,maxY:a.bottom}}};function findItem(item,items,equalsFn){if(!equalsFn)return items.indexOf(item);for(var i=0;i<items.length;i++){if(equalsFn(item,items[i]))return i}return-1}function calcBBox(node,toBBox){distBBox(node,0,node.children.length,toBBox,node)}function distBBox(node,k,p,toBBox,destNode){if(!destNode)destNode=createNode(null);destNode.minX=Infinity;destNode.minY=Infinity;destNode.maxX=-Infinity;destNode.maxY=-Infinity;for(var i=k,child;i<p;i++){child=node.children[i];extend(destNode,node.leaf?toBBox(child):child)}return destNode}function extend(a,b){a.minX=Math.min(a.minX,b.minX);a.minY=Math.min(a.minY,b.minY);a.maxX=Math.max(a.maxX,b.maxX);a.maxY=Math.max(a.maxY,b.maxY);return a}function compareNodeMinX(a,b){return a.minX-b.minX}function compareNodeMinY(a,b){return a.minY-b.minY}function bboxArea(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function bboxMargin(a){return(a.maxX-a.minX)+(a.maxY-a.minY)}function enlargedArea(a,b){return(Math.max(b.maxX,a.maxX)-Math.min(b.minX,a.minX))*(Math.max(b.maxY,a.maxY)-Math.min(b.minY,a.minY))}function intersectionArea(a,b){var minX=Math.max(a.minX,b.minX),minY=Math.max(a.minY,b.minY),maxX=Math.min(a.maxX,b.maxX),maxY=Math.min(a.maxY,b.maxY);return Math.max(0,maxX-minX)*Math.max(0,maxY-minY)}function contains(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY}function intersects(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY}function createNode(children){return{children:children,height:1,leaf:true,minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity}}function multiSelect(arr,left,right,n,compare){var stack=[left,right],mid;while(stack.length){right=stack.pop();left=stack.pop();if(right-left<=n)continue;mid=left+Math.ceil((right-left)/n/2)*n;quickselect(arr,mid,left,right,compare);stack.push(left,mid,mid,right)}}module.exports=rbush}),(function(module,exports){var TileIntersectsBody=function(tileWorldRect,body){return!(body.right<=tileWorldRect.left||body.bottom<=tileWorldRect.top||body.position.x>=tileWorldRect.right||body.position.y>=tileWorldRect.bottom)};module.exports=TileIntersectsBody}),(function(module,exports,__webpack_require__){var CircleContains=__webpack_require__(55);var Class=__webpack_require__(0);var CONST=__webpack_require__(50);var RectangleContains=__webpack_require__(48);var Vector2=__webpack_require__(3);var StaticBody=new Class({initialize:function StaticBody(world,gameObject){var width=(gameObject.displayWidth)?gameObject.displayWidth:64;var height=(gameObject.displayHeight)?gameObject.displayHeight:64;this.world=world;this.gameObject=gameObject;this.debugShowBody=world.defaults.debugShowStaticBody;this.debugBodyColor=world.defaults.staticBodyDebugColor;this.enable=true;this.isCircle=false;this.radius=0;this.offset=new Vector2();this.position=new Vector2(gameObject.x-(width*gameObject.originX),gameObject.y-(height*gameObject.originY));this.width=width;this.height=height;this.halfWidth=Math.abs(this.width/2);this.halfHeight=Math.abs(this.height/2);this.center=new Vector2(this.position.x+this.halfWidth,this.position.y+this.halfHeight);this.velocity=Vector2.ZERO;this.allowGravity=false;this.gravity=Vector2.ZERO;this.bounce=Vector2.ZERO;this.onWorldBounds=false;this.onCollide=false;this.onOverlap=false;this.mass=1;this.immovable=true;this.customSeparateX=false;this.customSeparateY=false;this.overlapX=0;this.overlapY=0;this.overlapR=0;this.embedded=false;this.collideWorldBounds=false;this.checkCollision={none:false,up:true,down:true,left:true,right:true};this.touching={none:true,up:false,down:false,left:false,right:false};this.wasTouching={none:true,up:false,down:false,left:false,right:false};this.blocked={none:true,up:false,down:false,left:false,right:false};this.physicsType=CONST.STATIC_BODY;this._dx=0;this._dy=0},setGameObject:function(gameObject,update){if(gameObject&&gameObject!==this.gameObject){this.gameObject.body=null;gameObject.body=this;this.gameObject=gameObject}if(update){this.updateFromGameObject()}return this},updateFromGameObject:function(){this.world.staticTree.remove(this);var gameObject=this.gameObject;gameObject.getTopLeft(this.position);this.width=gameObject.displayWidth;this.height=gameObject.displayHeight;this.halfWidth=Math.abs(this.width/2);this.halfHeight=Math.abs(this.height/2);this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight);this.world.staticTree.insert(this);return this},setOffset:function(x,y){if(y===undefined){y=x}this.world.staticTree.remove(this);this.position.x-=this.offset.x;this.position.y-=this.offset.y;this.offset.set(x,y);this.position.x+=this.offset.x;this.position.y+=this.offset.y;this.updateCenter();this.world.staticTree.insert(this);return this},setSize:function(width,height,center){if(center===undefined){center=true}var gameObject=this.gameObject;if(!width&&gameObject.frame){width=gameObject.frame.realWidth}if(!height&&gameObject.frame){height=gameObject.frame.realHeight}this.world.staticTree.remove(this);this.width=width;this.height=height;this.halfWidth=Math.floor(width/2);this.halfHeight=Math.floor(height/2);if(center&&gameObject.getCenter){var ox=gameObject.displayWidth/2;var oy=gameObject.displayHeight/2;this.position.x-=this.offset.x;this.position.y-=this.offset.y;this.offset.set(ox-this.halfWidth,oy-this.halfHeight);this.position.x+=this.offset.x;this.position.y+=this.offset.y}this.updateCenter();this.isCircle=false;this.radius=0;this.world.staticTree.insert(this);return this},setCircle:function(radius,offsetX,offsetY){if(offsetX===undefined){offsetX=this.offset.x}if(offsetY===undefined){offsetY=this.offset.y}if(radius>0){this.world.staticTree.remove(this);this.isCircle=true;this.radius=radius;this.width=radius*2;this.height=radius*2;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.offset.set(offsetX,offsetY);this.updateCenter();this.world.staticTree.insert(this)}else{this.isCircle=false}return this},updateCenter:function(){this.center.set(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(x,y){var gameObject=this.gameObject;if(x===undefined){x=gameObject.x}if(y===undefined){y=gameObject.y}this.world.staticTree.remove(this);gameObject.setPosition(x,y);gameObject.getTopLeft(this.position);this.updateCenter();this.world.staticTree.insert(this)},stop:function(){return this},getBounds:function(obj){obj.x=this.x;obj.y=this.y;obj.right=this.right;obj.bottom=this.bottom;return obj},hitTest:function(x,y){return(this.isCircle)?CircleContains(this,x,y):RectangleContains(this,x,y)},postUpdate:function(){},deltaAbsX:function(){return 0},deltaAbsY:function(){return 0},deltaX:function(){return 0},deltaY:function(){return 0},deltaZ:function(){return 0},destroy:function(){this.enable=false;this.world.pendingDestroy.set(this)},drawDebug:function(graphic){var pos=this.position;var x=pos.x+this.halfWidth;var y=pos.y+this.halfHeight;if(this.debugShowBody){graphic.lineStyle(graphic.defaultStrokeWidth,this.debugBodyColor,1);if(this.isCircle){graphic.strokeCircle(x,y,this.width/2)}else{graphic.strokeRect(pos.x,pos.y,this.width,this.height)}}},willDrawDebug:function(){return this.debugShowBody},setMass:function(value){if(value<=0){value=0.1}this.mass=value;return this},x:{get:function(){return this.position.x},set:function(value){this.world.staticTree.remove(this);this.position.x=value;this.world.staticTree.insert(this)}},y:{get:function(){return this.position.y},set:function(value){this.world.staticTree.remove(this);this.position.y=value;this.world.staticTree.insert(this)}},left:{get:function(){return this.position.x}},right:{get:function(){return this.position.x+this.width}},top:{get:function(){return this.position.y}},bottom:{get:function(){return this.position.y+this.height}}});module.exports=StaticBody}),(function(module,exports){var Pair={};module.exports=Pair;(function(){Pair.create=function(collision,timestamp){var bodyA=collision.bodyA,bodyB=collision.bodyB;var pair={id:Pair.id(bodyA,bodyB),bodyA:bodyA,bodyB:bodyB,activeContacts:[],separation:0,isActive:true,confirmedActive:true,isSensor:bodyA.isSensor||bodyB.isSensor,timeCreated:timestamp,timeUpdated:timestamp,collision:null,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};Pair.update(pair,collision,timestamp);return pair};Pair.update=function(pair,collision,timestamp){pair.collision=collision;if(collision.collided){var supports=collision.supports,activeContacts=pair.activeContacts,parentA=collision.parentA,parentB=collision.parentB;pair.inverseMass=parentA.inverseMass+parentB.inverseMass;pair.friction=Math.min(parentA.friction,parentB.friction);pair.frictionStatic=Math.max(parentA.frictionStatic,parentB.frictionStatic);pair.restitution=Math.max(parentA.restitution,parentB.restitution);pair.slop=Math.max(parentA.slop,parentB.slop);for(var i=0;i<supports.length;i++){activeContacts[i]=supports[i].contact}var supportCount=supports.length;if(supportCount<activeContacts.length){activeContacts.length=supportCount}pair.separation=collision.depth;Pair.setActive(pair,true,timestamp)}else{if(pair.isActive===true)Pair.setActive(pair,false,timestamp)}};Pair.setActive=function(pair,isActive,timestamp){if(isActive){pair.isActive=true;pair.timeUpdated=timestamp}else{pair.isActive=false;pair.activeContacts.length=0}};Pair.id=function(bodyA,bodyB){if(bodyA.id<bodyB.id){return'A'+bodyA.id+'B'+bodyB.id}else{return'A'+bodyB.id+'B'+bodyA.id}}})()}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var BasePlugin=new Class({initialize:function BasePlugin(pluginManager){this.pluginManager=pluginManager;this.game=pluginManager.game},init:function(){},start:function(){},stop:function(){},destroy:function(){this.pluginManager=null;this.game=null;this.scene=null;this.systems=null}});module.exports=BasePlugin}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var ReplaceByIndex=function(findIndex,newIndex,tileX,tileY,width,height,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);for(var i=0;i<tiles.length;i++){if(tiles[i]&&tiles[i].index===findIndex){tiles[i].index=newIndex}}};module.exports=ReplaceByIndex}),(function(module,exports,__webpack_require__){var IsInLayerBounds=__webpack_require__(101);var HasTileAt=function(tileX,tileY,layer){if(IsInLayerBounds(tileX,tileY,layer)){var tile=layer.data[tileY][tileX];return(tile!==null&&tile.index>-1)}else{return false}};module.exports=HasTileAt}),(function(module,exports,__webpack_require__){var Tile=__webpack_require__(74);var IsInLayerBounds=__webpack_require__(101);var CalculateFacesAt=__webpack_require__(220);var RemoveTileAt=function(tileX,tileY,replaceWithNull,recalculateFaces,layer){if(replaceWithNull===undefined){replaceWithNull=false}if(recalculateFaces===undefined){recalculateFaces=true}if(!IsInLayerBounds(tileX,tileY,layer)){return null}var tile=layer.data[tileY][tileX];if(!tile){return null}else{layer.data[tileY][tileX]=(replaceWithNull)?null:new Tile(layer,-1,tileX,tileY,tile.width,tile.height)}if(recalculateFaces&&tile&&tile.collides){CalculateFacesAt(tileX,tileY,layer)}return tile};module.exports=RemoveTileAt}),(function(module,exports,__webpack_require__){var Formats=__webpack_require__(32);var Parse2DArray=__webpack_require__(223);var ParseCSV=__webpack_require__(479);var ParseJSONTiled=__webpack_require__(480);var ParseWeltmeister=__webpack_require__(491);var Parse=function(name,mapFormat,data,tileWidth,tileHeight,insertNull){var newMap;switch(mapFormat){case(Formats.ARRAY_2D):newMap=Parse2DArray(name,data,tileWidth,tileHeight,insertNull);break;case(Formats.CSV):newMap=ParseCSV(name,data,tileWidth,tileHeight,insertNull);break;case(Formats.TILED_JSON):newMap=ParseJSONTiled(name,data,insertNull);break;case(Formats.WELTMEISTER):newMap=ParseWeltmeister(name,data,insertNull);break;default:console.warn('Unrecognized tilemap data format: '+mapFormat);newMap=null}return newMap};module.exports=Parse}),(function(module,exports,__webpack_require__){var Formats=__webpack_require__(32);var Parse2DArray=__webpack_require__(223);var ParseCSV=function(name,data,tileWidth,tileHeight,insertNull){var array2D=data.trim().split('\t').map(function(row){return row.split(',')});var map=Parse2DArray(name,array2D,tileWidth,tileHeight,insertNull);map.format=Formats.CSV;return map};module.exports=ParseCSV}),(function(module,exports,__webpack_require__){var Formats=__webpack_require__(32);var MapData=__webpack_require__(103);var ParseTileLayers=__webpack_require__(481);var ParseImageLayers=__webpack_require__(483);var ParseTilesets=__webpack_require__(484);var ParseObjectLayers=__webpack_require__(487);var BuildTilesetIndex=__webpack_require__(489);var AssignTileProperties=__webpack_require__(490);var ParseJSONTiled=function(name,json,insertNull){if(json.orientation!=='orthogonal'){console.warn('Only orthogonal map types are supported in this version of Phaser');return null}var mapData=new MapData({width:json.width,height:json.height,name:name,tileWidth:json.tilewidth,tileHeight:json.tileheight,orientation:json.orientation,format:Formats.TILED_JSON,version:json.version,properties:json.properties,renderOrder:json.renderorder,infinite:json.infinite});mapData.layers=ParseTileLayers(json,insertNull);mapData.images=ParseImageLayers(json);var sets=ParseTilesets(json);mapData.tilesets=sets.tilesets;mapData.imageCollections=sets.imageCollections;mapData.objects=ParseObjectLayers(json);mapData.tiles=BuildTilesetIndex(mapData);AssignTileProperties(mapData);return mapData};module.exports=ParseJSONTiled}),(function(module,exports,__webpack_require__){var Base64Decode=__webpack_require__(482);var GetFastValue=__webpack_require__(2);var LayerData=__webpack_require__(102);var ParseGID=__webpack_require__(224);var Tile=__webpack_require__(74);var CreateGroupLayer=__webpack_require__(225);var ParseTileLayers=function(json,insertNull){var infiniteMap=GetFastValue(json,'infinite',false);var tileLayers=[];var groupStack=[];var curGroupState=CreateGroupLayer(json);while(curGroupState.i<curGroupState.layers.length||groupStack.length>0){if(curGroupState.i>=curGroupState.layers.length){if(groupStack.length<1){console.warn('TilemapParser.parseTiledJSON - Invalid layer group hierarchy');break}curGroupState=groupStack.pop();continue}var curl=curGroupState.layers[curGroupState.i];curGroupState.i++;if(curl.type!=='tilelayer'){if(curl.type==='group'){var nextGroupState=CreateGroupLayer(json,curl,curGroupState);groupStack.push(curGroupState);curGroupState=nextGroupState}continue}if(curl.compression){console.warn('TilemapParser.parseTiledJSON - Layer compression is unsupported, skipping layer \n'+curl.name+'\t');continue}else if(curl.encoding&&curl.encoding==='base64'){if(curl.chunks){for(var i=0;i<curl.chunks.length;i++){curl.chunks[i].data=Base64Decode(curl.chunks[i].data)}}if(curl.data){curl.data=Base64Decode(curl.data)}delete curl.encoding}var layerData;var gidInfo;var tile;var blankTile;var output=[];var x=0;if(infiniteMap){var layerOffsetX=(GetFastValue(curl,'startx',0)+curl.x);var layerOffsetY=(GetFastValue(curl,'starty',0)+curl.y);layerData=new LayerData({name:(curGroupState.name+curl.name),x:(curGroupState.x+GetFastValue(curl,'offsetx',0)+layerOffsetX*json.tilewidth),y:(curGroupState.y+GetFastValue(curl,'offsety',0)+layerOffsetY*json.tileheight),width:curl.width,height:curl.height,tileWidth:json.tilewidth,tileHeight:json.tileheight,alpha:(curGroupState.opacity*curl.opacity),visible:(curGroupState.visible&&curl.visible),properties:GetFastValue(curl,'properties',[])});for(var c=0;c<curl.height;c++){output.push([null]);for(var j=0;j<curl.width;j++){output[c][j]=null}}for(c=0,len=curl.chunks.length;c<len;c++){var chunk=curl.chunks[c];var offsetX=(chunk.x-layerOffsetX);var offsetY=(chunk.y-layerOffsetY);var y=0;for(var t=0,len2=chunk.data.length;t<len2;t++){var newOffsetX=x+offsetX;var newOffsetY=y+offsetY;gidInfo=ParseGID(chunk.data[t]);if(gidInfo.gid>0){tile=new Tile(layerData,gidInfo.gid,newOffsetX,newOffsetY,json.tilewidth,json.tileheight);tile.rotation=gidInfo.rotation;tile.flipX=gidInfo.flipped;output[newOffsetY][newOffsetX]=tile}else{blankTile=insertNull?null:new Tile(layerData,-1,newOffsetX,newOffsetY,json.tilewidth,json.tileheight);output[newOffsetY][newOffsetX]=blankTile}x++;if(x===chunk.width){y++;x=0}}}}else{layerData=new LayerData({name:(curGroupState.name+curl.name),x:(curGroupState.x+GetFastValue(curl,'offsetx',0)+curl.x),y:(curGroupState.y+GetFastValue(curl,'offsety',0)+curl.y),width:curl.width,height:curl.height,tileWidth:json.tilewidth,tileHeight:json.tileheight,alpha:(curGroupState.opacity*curl.opacity),visible:(curGroupState.visible&&curl.visible),properties:GetFastValue(curl,'properties',[])});var row=[];for(var k=0,len=curl.data.length;k<len;k++){gidInfo=ParseGID(curl.data[k]);if(gidInfo.gid>0){tile=new Tile(layerData,gidInfo.gid,x,output.length,json.tilewidth,json.tileheight);tile.rotation=gidInfo.rotation;tile.flipX=gidInfo.flipped;row.push(tile)}else{blankTile=insertNull?null:new Tile(layerData,-1,x,output.length,json.tilewidth,json.tileheight);row.push(blankTile)}x++;if(x===curl.width){output.push(row);x=0;row=[]}}}layerData.data=output;tileLayers.push(layerData)}return tileLayers};module.exports=ParseTileLayers}),(function(module,exports){var Base64Decode=function(data){var binaryString=window.atob(data);var len=binaryString.length;var bytes=new Array(len/4);for(var i=0;i<len;i+=4){bytes[i/4]=(binaryString.charCodeAt(i)|binaryString.charCodeAt(i+1)<<8|binaryString.charCodeAt(i+2)<<16|binaryString.charCodeAt(i+3)<<24)>>>0}return bytes};module.exports=Base64Decode}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var CreateGroupLayer=__webpack_require__(225);var ParseImageLayers=function(json){var images=[];var groupStack=[];var curGroupState=CreateGroupLayer(json);while(curGroupState.i<curGroupState.layers.length||groupStack.length>0){if(curGroupState.i>=curGroupState.layers.length){if(groupStack.length<1){console.warn('TilemapParser.parseTiledJSON - Invalid layer group hierarchy');break}curGroupState=groupStack.pop();continue}var curi=curGroupState.layers[curGroupState.i];curGroupState.i++;if(curi.type!=='imagelayer'){if(curi.type==='group'){var nextGroupState=CreateGroupLayer(json,curi,curGroupState);groupStack.push(curGroupState);curGroupState=nextGroupState}continue}var layerOffsetX=GetFastValue(curi,'offsetx',0)+GetFastValue(curi,'startx',0);var layerOffsetY=GetFastValue(curi,'offsety',0)+GetFastValue(curi,'starty',0);images.push({name:(curGroupState.name+curi.name),image:curi.image,x:(curGroupState.x+layerOffsetX+curi.x),y:(curGroupState.y+layerOffsetY+curi.y),alpha:(curGroupState.opacity*curi.opacity),visible:(curGroupState.visible&&curi.visible),properties:GetFastValue(curi,'properties',{})})}return images};module.exports=ParseImageLayers}),(function(module,exports,__webpack_require__){var Tileset=__webpack_require__(104);var ImageCollection=__webpack_require__(485);var ParseObject=__webpack_require__(226);var ParseTilesets=function(json){var tilesets=[];var imageCollections=[];var lastSet=null;var stringID;for(var i=0;i<json.tilesets.length;i++){var set=json.tilesets[i];if(set.source){console.warn('Phaser can\nt load external tilesets. Use the Embed Tileset button and then export the map again.')}else if(set.image){var newSet=new Tileset(set.name,set.firstgid,set.tilewidth,set.tileheight,set.margin,set.spacing);if(json.version>1){if(Array.isArray(set.tiles)){var tiles={};var props={};for(var t=0;t<set.tiles.length;t++){var tile=set.tiles[t];if(tile.properties){var newPropData={};tile.properties.forEach(function(propData){newPropData[propData['name']]=propData['value']});props[tile.id]=newPropData}if(tile.objectgroup){tiles[tile.id]={objectgroup:tile.objectgroup};if(tile.objectgroup.objects){var parsedObjects2=tile.objectgroup.objects.map(function(obj){return ParseObject(obj)});tiles[tile.id].objectgroup.objects=parsedObjects2}}if(tile.animation){if(tiles.hasOwnProperty(tile.id)){tiles[tile.id].animation=tile.animation}else{tiles[tile.id]={animation:tile.animation}}}}newSet.tileData=tiles;newSet.tileProperties=props}}else{if(set.tileproperties){newSet.tileProperties=set.tileproperties}if(set.tiles){newSet.tileData=set.tiles;for(stringID in newSet.tileData){var objectGroup=newSet.tileData[stringID].objectgroup;if(objectGroup&&objectGroup.objects){var parsedObjects1=objectGroup.objects.map(function(obj){return ParseObject(obj)});newSet.tileData[stringID].objectgroup.objects=parsedObjects1}}}}newSet.updateTileData(set.imagewidth,set.imageheight);tilesets.push(newSet)}else{var newCollection=new ImageCollection(set.name,set.firstgid,set.tilewidth,set.tileheight,set.margin,set.spacing,set.properties);for(stringID in set.tiles){var image=set.tiles[stringID].image;var gid=set.firstgid+parseInt(stringID,10);newCollection.addImage(gid,image)}imageCollections.push(newCollection)}if(lastSet){lastSet.lastgid=set.firstgid-1}lastSet=set}return{tilesets:tilesets,imageCollections:imageCollections}};module.exports=ParseTilesets}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var ImageCollection=new Class({initialize:function ImageCollection(name,firstgid,width,height,margin,spacing,properties){if(width===undefined||width<=0){width=32}if(height===undefined||height<=0){height=32}if(margin===undefined){margin=0}if(spacing===undefined){spacing=0}this.name=name;this.firstgid=firstgid|0;this.imageWidth=width|0;this.imageHeight=height|0;this.imageMargin=margin|0;this.imageSpacing=spacing|0;this.properties=properties||{};this.images=[];this.total=0},containsImageIndex:function(imageIndex){return(imageIndex>=this.firstgid&&imageIndex<(this.firstgid+this.total))},addImage:function(gid,image){this.images.push({gid:gid,image:image});this.total++;return this}});module.exports=ImageCollection}),(function(module,exports,__webpack_require__){var HasValue=__webpack_require__(108);var Pick=function(object,keys){var obj={};for(var i=0;i<keys.length;i++){var key=keys[i];if(HasValue(object,key)){obj[key]=object[key]}}return obj};module.exports=Pick}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var ParseObject=__webpack_require__(226);var ObjectLayer=__webpack_require__(488);var CreateGroupLayer=__webpack_require__(225);var ParseObjectLayers=function(json){var objectLayers=[];var groupStack=[];var curGroupState=CreateGroupLayer(json);while(curGroupState.i<curGroupState.layers.length||groupStack.length>0){if(curGroupState.i>=curGroupState.layers.length){if(groupStack.length<1){console.warn('TilemapParser.parseTiledJSON - Invalid layer group hierarchy');break}curGroupState=groupStack.pop();continue}var curo=curGroupState.layers[curGroupState.i];curGroupState.i++;curo.opacity*=curGroupState.opacity;curo.visible=curGroupState.visible&&curo.visible;if(curo.type!=='objectgroup'){if(curo.type==='group'){var nextGroupState=CreateGroupLayer(json,curo,curGroupState);groupStack.push(curGroupState);curGroupState=nextGroupState}continue}curo.name=curGroupState.name+curo.name;var offsetX=curGroupState.x+GetFastValue(curo,'startx',0)+GetFastValue(curo,'offsetx',0);var offsetY=curGroupState.y+GetFastValue(curo,'starty',0)+GetFastValue(curo,'offsety',0);var objects=[];for(var j=0;j<curo.objects.length;j++){var parsedObject=ParseObject(curo.objects[j],offsetX,offsetY);objects.push(parsedObject)}var objectLayer=new ObjectLayer(curo);objectLayer.objects=objects;objectLayers.push(objectLayer)}return objectLayers};module.exports=ParseObjectLayers}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var ObjectLayer=new Class({initialize:function ObjectLayer(config){if(config===undefined){config={}}this.name=GetFastValue(config,'name','object layer');this.opacity=GetFastValue(config,'opacity',1);this.properties=GetFastValue(config,'properties',{});this.propertyTypes=GetFastValue(config,'propertytypes',{});this.type=GetFastValue(config,'type','objectgroup');this.visible=GetFastValue(config,'visible',true);this.objects=GetFastValue(config,'objects',[])}});module.exports=ObjectLayer}),(function(module,exports,__webpack_require__){var Tileset=__webpack_require__(104);var BuildTilesetIndex=function(mapData){var i;var set;var tiles=[];for(i=0;i<mapData.imageCollections.length;i++){var collection=mapData.imageCollections[i];var images=collection.images;for(var j=0;j<images.length;j++){var image=images[j];set=new Tileset(image.image,image.gid,collection.imageWidth,collection.imageHeight,0,0);set.updateTileData(collection.imageWidth,collection.imageHeight);mapData.tilesets.push(set)}}for(i=0;i<mapData.tilesets.length;i++){set=mapData.tilesets[i];var x=set.tileMargin;var y=set.tileMargin;var count=0;var countX=0;var countY=0;for(var t=set.firstgid;t<set.firstgid+set.total;t++){tiles[t]=[x,y,i];x+=set.tileWidth+set.tileSpacing;count++;if(count===set.total){break}countX++;if(countX===set.columns){x=set.tileMargin;y+=set.tileHeight+set.tileSpacing;countX=0;countY++;if(countY===set.rows){break}}}}return tiles};module.exports=BuildTilesetIndex}),(function(module,exports,__webpack_require__){var Extend=__webpack_require__(18);var AssignTileProperties=function(mapData){var layerData;var tile;var sid;var set;var row;for(var i=0;i<mapData.layers.length;i++){layerData=mapData.layers[i];set=null;for(var j=0;j<layerData.data.length;j++){row=layerData.data[j];for(var k=0;k<row.length;k++){tile=row[k];if(tile===null||tile.index<0){continue}sid=mapData.tiles[tile.index][2];set=mapData.tilesets[sid];tile.width=set.tileWidth;tile.height=set.tileHeight;if(set.tileProperties&&set.tileProperties[tile.index-set.firstgid]){tile.properties=Extend(tile.properties,set.tileProperties[tile.index-set.firstgid])}}}}};module.exports=AssignTileProperties}),(function(module,exports,__webpack_require__){var Formats=__webpack_require__(32);var MapData=__webpack_require__(103);var ParseTileLayers=__webpack_require__(492);var ParseTilesets=__webpack_require__(493);var ParseWeltmeister=function(name,json,insertNull){if(json.layer.length===0){console.warn('No layers found in the Weltmeister map: '+name);return null}var width=0;var height=0;for(var i=0;i<json.layer.length;i++){if(json.layer[i].width>width){width=json.layer[i].width}if(json.layer[i].height>height){height=json.layer[i].height}}var mapData=new MapData({width:width,height:height,name:name,tileWidth:json.layer[0].tilesize,tileHeight:json.layer[0].tilesize,format:Formats.WELTMEISTER});mapData.layers=ParseTileLayers(json,insertNull);mapData.tilesets=ParseTilesets(json);return mapData};module.exports=ParseWeltmeister}),(function(module,exports,__webpack_require__){var LayerData=__webpack_require__(102);var Tile=__webpack_require__(74);var ParseTileLayers=function(json,insertNull){var tileLayers=[];for(var i=0;i<json.layer.length;i++){var layer=json.layer[i];var layerData=new LayerData({name:layer.name,width:layer.width,height:layer.height,tileWidth:layer.tilesize,tileHeight:layer.tilesize,visible:layer.visible===1});var row=[];var tileGrid=[];for(var y=0;y<layer.data.length;y++){for(var x=0;x<layer.data[y].length;x++){var index=layer.data[y][x]-1;var tile;if(index>-1){tile=new Tile(layerData,index,x,y,layer.tilesize,layer.tilesize)}else{tile=insertNull?null:new Tile(layerData,-1,x,y,layer.tilesize,layer.tilesize)}row.push(tile)}tileGrid.push(row);row=[]}layerData.data=tileGrid;tileLayers.push(layerData)}return tileLayers};module.exports=ParseTileLayers}),(function(module,exports,__webpack_require__){var Tileset=__webpack_require__(104);var ParseTilesets=function(json){var tilesets=[];var tilesetsNames=[];for(var i=0;i<json.layer.length;i++){var layer=json.layer[i];var tilesetName=layer.tilesetName;if(tilesetName!==''&&tilesetsNames.indexOf(tilesetName)===-1){tilesetsNames.push(tilesetName);tilesets.push(new Tileset(tilesetName,0,layer.tilesize,layer.tilesize,0,0))}}return tilesets};module.exports=ParseTilesets}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var DegToRad=__webpack_require__(39);var DynamicTilemapLayer=__webpack_require__(495);var Extend=__webpack_require__(18);var Formats=__webpack_require__(32);var LayerData=__webpack_require__(102);var Rotate=__webpack_require__(331);var SpliceOne=__webpack_require__(80);var StaticTilemapLayer=__webpack_require__(496);var Tile=__webpack_require__(74);var TilemapComponents=__webpack_require__(141);var Tileset=__webpack_require__(104);var Tilemap=new Class({initialize:function Tilemap(scene,mapData){this.scene=scene;this.tileWidth=mapData.tileWidth;this.tileHeight=mapData.tileHeight;this.width=mapData.width;this.height=mapData.height;this.orientation=mapData.orientation;this.renderOrder=mapData.renderOrder;this.format=mapData.format;this.version=mapData.version;this.properties=mapData.properties;this.widthInPixels=mapData.widthInPixels;this.heightInPixels=mapData.heightInPixels;this.imageCollections=mapData.imageCollections;this.images=mapData.images;this.layers=mapData.layers;this.tilesets=mapData.tilesets;this.objects=mapData.objects;this.currentLayerIndex=0},setRenderOrder:function(renderOrder){var orders=['right-down','left-down','right-up','left-up'];if(typeof renderOrder==='number'){renderOrder=orders[renderOrder]}if(orders.indexOf(renderOrder)>-1){this.renderOrder=renderOrder}return this},addTilesetImage:function(tilesetName,key,tileWidth,tileHeight,tileMargin,tileSpacing,gid){if(tilesetName===undefined){return null}if(key===undefined||key===null){key=tilesetName}if(!this.scene.sys.textures.exists(key)){console.warn('Invalid Tileset Image: '+key);return null}var texture=this.scene.sys.textures.get(key);var index=this.getTilesetIndex(tilesetName);if(index===null&&this.format===Formats.TILED_JSON){console.warn('No data found for Tileset: '+tilesetName);return null}var tileset=this.tilesets[index];if(tileset){tileset.setTileSize(tileWidth,tileHeight);tileset.setSpacing(tileMargin,tileSpacing);tileset.setImage(texture);return tileset}if(tileWidth===undefined){tileWidth=this.tileWidth}if(tileHeight===undefined){tileHeight=this.tileHeight}if(tileMargin===undefined){tileMargin=0}if(tileSpacing===undefined){tileSpacing=0}if(gid===undefined){gid=0}tileset=new Tileset(tilesetName,gid,tileWidth,tileHeight,tileMargin,tileSpacing);tileset.setImage(texture);this.tilesets.push(tileset);return tileset},convertLayerToStatic:function(layer){layer=this.getLayer(layer);if(layer===null){return null}var dynamicLayer=layer.tilemapLayer;if(!dynamicLayer||!(dynamicLayer instanceof DynamicTilemapLayer)){return null}var staticLayer=new StaticTilemapLayer(dynamicLayer.scene,dynamicLayer.tilemap,dynamicLayer.layerIndex,dynamicLayer.tileset,dynamicLayer.x,dynamicLayer.y);this.scene.sys.displayList.add(staticLayer);dynamicLayer.destroy();return staticLayer},copy:function(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'copy')){return this}if(layer!==null){TilemapComponents.Copy(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,layer);return this}else{return null}},createBlankDynamicLayer:function(name,tileset,x,y,width,height,tileWidth,tileHeight){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.width}if(height===undefined){height=this.height}if(tileWidth===undefined){tileWidth=this.tileWidth}if(tileHeight===undefined){tileHeight=this.tileHeight}var index=this.getLayerIndex(name);if(index!==null){console.warn('Invalid Tilemap Layer ID: '+name);return null}var layerData=new LayerData({name:name,tileWidth:tileWidth,tileHeight:tileHeight,width:width,height:height});var row;for(var tileY=0;tileY<height;tileY++){row=[];for(var tileX=0;tileX<width;tileX++){row.push(new Tile(layerData,-1,tileX,tileY,tileWidth,tileHeight,this.tileWidth,this.tileHeight))}layerData.data.push(row)}this.layers.push(layerData);this.currentLayerIndex=this.layers.length-1;var dynamicLayer=new DynamicTilemapLayer(this.scene,this,this.currentLayerIndex,tileset,x,y);dynamicLayer.setRenderOrder(this.renderOrder);this.scene.sys.displayList.add(dynamicLayer);return dynamicLayer},createDynamicLayer:function(layerID,tileset,x,y){var index=this.getLayerIndex(layerID);if(index===null){console.warn('Invalid Tilemap Layer ID: '+layerID);if(typeof layerID==='string'){console.warn('Valid tilelayer names:\t\n'+this.getTileLayerNames().join(',\t\n'))}return null}var layerData=this.layers[index];if(layerData.tilemapLayer){console.warn('Tilemap Layer ID already exists:'+layerID);return null}this.currentLayerIndex=index;if(x===undefined){x=layerData.x}if(y===undefined){y=layerData.y}var layer=new DynamicTilemapLayer(this.scene,this,index,tileset,x,y);layer.setRenderOrder(this.renderOrder);this.scene.sys.displayList.add(layer);return layer},createFromObjects:function(name,id,spriteConfig,scene){if(spriteConfig===undefined){spriteConfig={}}if(scene===undefined){scene=this.scene}var objectLayer=this.getObjectLayer(name);if(!objectLayer){console.warn('Cannot create from object. Invalid objectgroup name given: '+name);if(typeof layerID==='string'){console.warn('Valid objectgroup names:\t\n'+this.getObjectLayerNames().join(',\n\n'))}return null}var objects=objectLayer.objects;var sprites=[];for(var i=0;i<objects.length;i++){var found=false;var obj=objects[i];if(obj.gid!==undefined&&typeof id==='number'&&obj.gid===id||obj.id!==undefined&&typeof id==='number'&&obj.id===id||obj.name!==undefined&&typeof id==='string'&&obj.name===id){found=true}if(found){var config=Extend({},spriteConfig,obj.properties);config.x=obj.x;config.y=obj.y;var sprite=scene.make.sprite(config);sprite.name=obj.name;if(obj.width){sprite.displayWidth=obj.width}if(obj.height){sprite.displayHeight=obj.height}var offset={x:sprite.originX*obj.width,y:(sprite.originY-1)*obj.height};if(obj.rotation){var angle=DegToRad(obj.rotation);Rotate(offset,angle);sprite.rotation=angle}sprite.x+=offset.x;sprite.y+=offset.y;if(obj.flippedHorizontal!==undefined||obj.flippedVertical!==undefined){sprite.setFlip(obj.flippedHorizontal,obj.flippedVertical)}if(!obj.visible){sprite.visible=false}for(var key in obj.properties){if(sprite.hasOwnProperty(key)){continue}sprite.setData(key,obj.properties[key])}sprites.push(sprite)}}return sprites},createFromTiles:function(indexes,replacements,spriteConfig,scene,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.CreateFromTiles(indexes,replacements,spriteConfig,scene,camera,layer)},createStaticLayer:function(layerID,tileset,x,y){var index=this.getLayerIndex(layerID);if(index===null){console.warn('Invalid Tilemap Layer ID: '+layerID);if(typeof layerID==='string'){console.warn('Valid tilelayer names:\d\d'+this.getTileLayerNames().join(',\/\.'))}return null}var layerData=this.layers[index];if(layerData.tilemapLayer){console.warn('Tilemap Layer ID already exists:'+layerID);return null}this.currentLayerIndex=index;if(x===undefined&&this.layers[index].x){x=this.layers[index].x}if(y===undefined&&this.layers[index].y){y=this.layers[index].y}var layer=new StaticTilemapLayer(this.scene,this,index,tileset,x,y);layer.setRenderOrder(this.renderOrder);this.scene.sys.displayList.add(layer);return layer},destroy:function(){this.removeAllLayers();this.tilesets.length=0;this.objects.length=0;this.scene=undefined},fill:function(index,tileX,tileY,width,height,recalculateFaces,layer){layer=this.getLayer(layer);if(layer===null){return null}if(this._isStaticCall(layer,'fill')){return this}TilemapComponents.Fill(index,tileX,tileY,width,height,recalculateFaces,layer);return this},filterObjects:function(objectLayer,callback,context){if(typeof objectLayer==='string'){var name=objectLayer;objectLayer=this.getObjectLayer(objectLayer);if(!objectLayer){console.warn('No object layer found with the name: '+name);return null}}return objectLayer.objects.filter(callback,context)},filterTiles:function(callback,context,tileX,tileY,width,height,filteringOptions,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.FilterTiles(callback,context,tileX,tileY,width,height,filteringOptions,layer)},findByIndex:function(findIndex,skip,reverse,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.FindByIndex(findIndex,skip,reverse,layer)},findObject:function(objectLayer,callback,context){if(typeof objectLayer==='string'){var name=objectLayer;objectLayer=this.getObjectLayer(objectLayer);if(!objectLayer){console.warn('No object layer found with the name: '+name);return null}}return objectLayer.objects.find(callback,context)||null},findTile:function(callback,context,tileX,tileY,width,height,filteringOptions,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.FindTile(callback,context,tileX,tileY,width,height,filteringOptions,layer)},forEachTile:function(callback,context,tileX,tileY,width,height,filteringOptions,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.ForEachTile(callback,context,tileX,tileY,width,height,filteringOptions,layer);return this},getImageIndex:function(name){return this.getIndex(this.images,name)},getImageLayerNames:function(){if(!this.images||!Array.isArray(this.images)){return[]}return this.images.map(function(image){return image.name})},getIndex:function(location,name){for(var i=0;i<location.length;i++){if(location[i].name===name){return i}}return null},getLayer:function(layer){var index=this.getLayerIndex(layer);return(index!==null)?this.layers[index]:null},getObjectLayer:function(name){var index=this.getIndex(this.objects,name);return(index!==null)?this.objects[index]:null},getObjectLayerNames:function(){if(!this.objects||!Array.isArray(this.objects)){return[]}return this.objects.map(function(object){return object.name})},getLayerIndex:function(layer){if(layer===undefined){return this.currentLayerIndex}else if(typeof layer==='string'){return this.getLayerIndexByName(layer)}else if(typeof layer==='number'&&layer<this.layers.length){return layer}else if(layer instanceof StaticTilemapLayer||layer instanceof DynamicTilemapLayer){return layer.layerIndex}else{return null}},getLayerIndexByName:function(name){return this.getIndex(this.layers,name)},getTileAt:function(tileX,tileY,nonNull,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.GetTileAt(tileX,tileY,nonNull,layer)},getTileAtWorldXY:function(worldX,worldY,nonNull,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.GetTileAtWorldXY(worldX,worldY,nonNull,camera,layer)},getTileLayerNames:function(){if(!this.layers||!Array.isArray(this.layers)){return[]}return this.layers.map(function(layer){return layer.name})},getTilesWithin:function(tileX,tileY,width,height,filteringOptions,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.GetTilesWithin(tileX,tileY,width,height,filteringOptions,layer)},getTilesWithinShape:function(shape,filteringOptions,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.GetTilesWithinShape(shape,filteringOptions,camera,layer)},getTilesWithinWorldXY:function(worldX,worldY,width,height,filteringOptions,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.GetTilesWithinWorldXY(worldX,worldY,width,height,filteringOptions,camera,layer)},getTileset:function(name){var index=this.getIndex(this.tilesets,name);return(index!==null)?this.tilesets[index]:null},getTilesetIndex:function(name){return this.getIndex(this.tilesets,name)},hasTileAt:function(tileX,tileY,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.HasTileAt(tileX,tileY,layer)},hasTileAtWorldXY:function(worldX,worldY,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.HasTileAtWorldXY(worldX,worldY,camera,layer)},layer:{get:function(){return this.layers[this.currentLayerIndex]},set:function(layer){this.setLayer(layer)}},putTileAt:function(tile,tileX,tileY,recalculateFaces,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'putTileAt')){return null}if(layer===null){return null}return TilemapComponents.PutTileAt(tile,tileX,tileY,recalculateFaces,layer)},putTileAtWorldXY:function(tile,worldX,worldY,recalculateFaces,camera,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'putTileAtWorldXY')){return null}if(layer===null){return null}return TilemapComponents.PutTileAtWorldXY(tile,worldX,worldY,recalculateFaces,camera,layer)},putTilesAt:function(tilesArray,tileX,tileY,recalculateFaces,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'putTilesAt')){return this}if(layer===null){return null}TilemapComponents.PutTilesAt(tilesArray,tileX,tileY,recalculateFaces,layer);return this},randomize:function(tileX,tileY,width,height,indexes,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'randomize')){return this}if(layer===null){return null}TilemapComponents.Randomize(tileX,tileY,width,height,indexes,layer);return this},calculateFacesAt:function(tileX,tileY,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.CalculateFacesAt(tileX,tileY,layer);return this},calculateFacesWithin:function(tileX,tileY,width,height,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.CalculateFacesWithin(tileX,tileY,width,height,layer);return this},removeLayer:function(layer){var index=this.getLayerIndex(layer);if(index!==null){SpliceOne(this.layers,index);for(var i=index;i<this.layers.length;i++){if(this.layers[i].tilemapLayer){this.layers[i].tilemapLayer.layerIndex--}}if(this.currentLayerIndex===index){this.currentLayerIndex=0}return this}else{return null}},destroyLayer:function(layer){var index=this.getLayerIndex(layer);if(index!==null){layer=this.layers[index];layer.destroy();SpliceOne(this.layers,index);if(this.currentLayerIndex===index){this.currentLayerIndex=0}return this}else{return null}},removeAllLayers:function(){var layers=this.layers;for(var i=0;i<layers.length;i++){if(layers[i].tilemapLayer){layers[i].tilemapLayer.destroy(false)}}layers.length=0;this.currentLayerIndex=0;return this},removeTile:function(tiles,replaceIndex,recalculateFaces){if(replaceIndex===undefined){replaceIndex=-1}if(recalculateFaces===undefined){recalculateFaces=true}var removed=[];if(!Array.isArray(tiles)){tiles=[tiles]}for(var i=0;i<tiles.length;i++){var tile=tiles[i];removed.push(this.removeTileAt(tile.x,tile.y,true,recalculateFaces,tile.tilemapLayer));if(replaceIndex>-1){this.putTileAt(replaceIndex,tile.x,tile.y,recalculateFaces,tile.tilemapLayer)}}return removed},removeTileAt:function(tileX,tileY,replaceWithNull,recalculateFaces,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'removeTileAt')){return null}if(layer===null){return null}return TilemapComponents.RemoveTileAt(tileX,tileY,replaceWithNull,recalculateFaces,layer)},removeTileAtWorldXY:function(worldX,worldY,replaceWithNull,recalculateFaces,camera,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'removeTileAtWorldXY')){return null}if(layer===null){return null}return TilemapComponents.RemoveTileAtWorldXY(worldX,worldY,replaceWithNull,recalculateFaces,camera,layer)},renderDebug:function(graphics,styleConfig,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.RenderDebug(graphics,styleConfig,layer);return this},renderDebugFull:function(graphics,styleConfig){var layers=this.layers;for(var i=0;i<layers.length;i++){TilemapComponents.RenderDebug(graphics,styleConfig,layers[i])}return this},replaceByIndex:function(findIndex,newIndex,tileX,tileY,width,height,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'replaceByIndex')){return this}if(layer===null){return null}TilemapComponents.ReplaceByIndex(findIndex,newIndex,tileX,tileY,width,height,layer);return this},setCollision:function(indexes,collides,recalculateFaces,layer,updateLayer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetCollision(indexes,collides,recalculateFaces,layer,updateLayer);return this},setCollisionBetween:function(start,stop,collides,recalculateFaces,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetCollisionBetween(start,stop,collides,recalculateFaces,layer);return this},setCollisionByProperty:function(properties,collides,recalculateFaces,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetCollisionByProperty(properties,collides,recalculateFaces,layer);return this},setCollisionByExclusion:function(indexes,collides,recalculateFaces,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetCollisionByExclusion(indexes,collides,recalculateFaces,layer);return this},setCollisionFromCollisionGroup:function(collides,recalculateFaces,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetCollisionFromCollisionGroup(collides,recalculateFaces,layer);return this},setTileIndexCallback:function(indexes,callback,callbackContext,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetTileIndexCallback(indexes,callback,callbackContext,layer);return this},setTileLocationCallback:function(tileX,tileY,width,height,callback,callbackContext,layer){layer=this.getLayer(layer);if(layer===null){return null}TilemapComponents.SetTileLocationCallback(tileX,tileY,width,height,callback,callbackContext,layer);return this},setLayer:function(layer){var index=this.getLayerIndex(layer);if(index!==null){this.currentLayerIndex=index}return this},setBaseTileSize:function(tileWidth,tileHeight){this.tileWidth=tileWidth;this.tileHeight=tileHeight;this.widthInPixels=this.width*tileWidth;this.heightInPixels=this.height*tileHeight;for(var i=0;i<this.layers.length;i++){this.layers[i].baseTileWidth=tileWidth;this.layers[i].baseTileHeight=tileHeight;var mapData=this.layers[i].data;var mapWidth=this.layers[i].width;var mapHeight=this.layers[i].height;for(var row=0;row<mapHeight;row++){for(var col=0;col<mapWidth;col++){var tile=mapData[row][col];if(tile!==null){tile.setSize(undefined,undefined,tileWidth,tileHeight)}}}}return this},setLayerTileSize:function(tileWidth,tileHeight,layer){layer=this.getLayer(layer);if(layer===null){return this}layer.tileWidth=tileWidth;layer.tileHeight=tileHeight;var mapData=layer.data;var mapWidth=layer.width;var mapHeight=layer.height;for(var row=0;row<mapHeight;row++){for(var col=0;col<mapWidth;col++){var tile=mapData[row][col];if(tile!==null){tile.setSize(tileWidth,tileHeight)}}}return this},shuffle:function(tileX,tileY,width,height,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'shuffle')){return this}if(layer===null){return null}TilemapComponents.Shuffle(tileX,tileY,width,height,layer);return this},swapByIndex:function(indexA,indexB,tileX,tileY,width,height,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'swapByIndex')){return this}if(layer===null){return null}TilemapComponents.SwapByIndex(indexA,indexB,tileX,tileY,width,height,layer);return this},tileToWorldX:function(tileX,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.TileToWorldX(tileX,camera,layer)},tileToWorldY:function(tileX,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.TileToWorldY(tileX,camera,layer)},tileToWorldXY:function(tileX,tileY,point,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.TileToWorldXY(tileX,tileY,point,camera,layer)},weightedRandomize:function(tileX,tileY,width,height,weightedIndexes,layer){layer=this.getLayer(layer);if(this._isStaticCall(layer,'weightedRandomize')){return this}if(layer===null){return null}TilemapComponents.WeightedRandomize(tileX,tileY,width,height,weightedIndexes,layer);return this},worldToTileX:function(worldX,snapToFloor,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.WorldToTileX(worldX,snapToFloor,camera,layer)},worldToTileY:function(worldY,snapToFloor,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.WorldToTileY(worldY,snapToFloor,camera,layer)},worldToTileXY:function(worldX,worldY,snapToFloor,point,camera,layer){layer=this.getLayer(layer);if(layer===null){return null}return TilemapComponents.WorldToTileXY(worldX,worldY,snapToFloor,point,camera,layer)},_isStaticCall:function(layer,functionName){if(layer.tilemapLayer instanceof StaticTilemapLayer){console.warn(functionName+': You cannot change the tiles in a static tilemap layer');return true}else{return false}}});module.exports=Tilemap}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var DynamicTilemapLayerRender=__webpack_require__(1345);var GameObject=__webpack_require__(14);var TilemapComponents=__webpack_require__(141);var DynamicTilemapLayer=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.ComputedSize,Components.Depth,Components.Flip,Components.GetBounds,Components.Origin,Components.Pipeline,Components.Transform,Components.Visible,Components.ScrollFactor,DynamicTilemapLayerRender],initialize:function DynamicTilemapLayer(scene,tilemap,layerIndex,tileset,x,y){GameObject.call(this,scene,'DynamicTilemapLayer');this.isTilemap=true;this.tilemap=tilemap;this.layerIndex=layerIndex;this.layer=tilemap.layers[layerIndex];this.layer.tilemapLayer=this;this.tileset=[];this.culledTiles=[];this.skipCull=false;this.tilesDrawn=0;this.tilesTotal=this.layer.width*this.layer.height;this.cullPaddingX=1;this.cullPaddingY=1;this.cullCallback=TilemapComponents.CullTiles;this._renderOrder=0;this.gidMap=[];this.setTilesets(tileset);this.setAlpha(this.layer.alpha);this.setPosition(x,y);this.setOrigin();this.setSize(tilemap.tileWidth*this.layer.width,tilemap.tileHeight*this.layer.height);this.initPipeline('TextureTintPipeline')},setTilesets:function(tilesets){var gidMap=[];var setList=[];var map=this.tilemap;if(!Array.isArray(tilesets)){tilesets=[tilesets]}for(var i=0;i<tilesets.length;i++){var tileset=tilesets[i];if(typeof tileset==='string'){tileset=map.getTileset(tileset)}if(tileset){setList.push(tileset);var s=tileset.firstgid;for(var t=0;t<tileset.total;t++){gidMap[s+t]=tileset}}}this.gidMap=gidMap;this.tileset=setList},setRenderOrder:function(renderOrder){var orders=['right-down','left-down','right-up','left-up'];if(typeof renderOrder==='string'){renderOrder=orders.indexOf(renderOrder)}if(renderOrder>=0&&renderOrder<4){this._renderOrder=renderOrder}return this},calculateFacesAt:function(tileX,tileY){TilemapComponents.CalculateFacesAt(tileX,tileY,this.layer);return this},calculateFacesWithin:function(tileX,tileY,width,height){TilemapComponents.CalculateFacesWithin(tileX,tileY,width,height,this.layer);return this},createFromTiles:function(indexes,replacements,spriteConfig,scene,camera){return TilemapComponents.CreateFromTiles(indexes,replacements,spriteConfig,scene,camera,this.layer)},cull:function(camera){return this.cullCallback(this.layer,camera,this.culledTiles,this._renderOrder)},copy:function(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces){TilemapComponents.Copy(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,this.layer);return this},destroy:function(removeFromTilemap){if(removeFromTilemap===undefined){removeFromTilemap=true}if(!this.tilemap){return}if(this.layer.tilemapLayer===this){this.layer.tilemapLayer=undefined}if(removeFromTilemap){this.tilemap.removeLayer(this)}this.tilemap=undefined;this.layer=undefined;this.culledTiles.length=0;this.cullCallback=null;this.gidMap=[];this.tileset=[];GameObject.prototype.destroy.call(this)},fill:function(index,tileX,tileY,width,height,recalculateFaces){TilemapComponents.Fill(index,tileX,tileY,width,height,recalculateFaces,this.layer);return this},filterTiles:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents.FilterTiles(callback,context,tileX,tileY,width,height,filteringOptions,this.layer)},findByIndex:function(findIndex,skip,reverse){return TilemapComponents.FindByIndex(findIndex,skip,reverse,this.layer)},findTile:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents.FindTile(callback,context,tileX,tileY,width,height,filteringOptions,this.layer)},forEachTile:function(callback,context,tileX,tileY,width,height,filteringOptions){TilemapComponents.ForEachTile(callback,context,tileX,tileY,width,height,filteringOptions,this.layer);return this},getTileAt:function(tileX,tileY,nonNull){return TilemapComponents.GetTileAt(tileX,tileY,nonNull,this.layer)},getTileAtWorldXY:function(worldX,worldY,nonNull,camera){return TilemapComponents.GetTileAtWorldXY(worldX,worldY,nonNull,camera,this.layer)},getTilesWithin:function(tileX,tileY,width,height,filteringOptions){return TilemapComponents.GetTilesWithin(tileX,tileY,width,height,filteringOptions,this.layer)},getTilesWithinShape:function(shape,filteringOptions,camera){return TilemapComponents.GetTilesWithinShape(shape,filteringOptions,camera,this.layer)},getTilesWithinWorldXY:function(worldX,worldY,width,height,filteringOptions,camera){return TilemapComponents.GetTilesWithinWorldXY(worldX,worldY,width,height,filteringOptions,camera,this.layer)},hasTileAt:function(tileX,tileY){return TilemapComponents.HasTileAt(tileX,tileY,this.layer)},hasTileAtWorldXY:function(worldX,worldY,camera){return TilemapComponents.HasTileAtWorldXY(worldX,worldY,camera,this.layer)},putTileAt:function(tile,tileX,tileY,recalculateFaces){return TilemapComponents.PutTileAt(tile,tileX,tileY,recalculateFaces,this.layer)},putTileAtWorldXY:function(tile,worldX,worldY,recalculateFaces,camera){return TilemapComponents.PutTileAtWorldXY(tile,worldX,worldY,recalculateFaces,camera,this.layer)},putTilesAt:function(tilesArray,tileX,tileY,recalculateFaces){TilemapComponents.PutTilesAt(tilesArray,tileX,tileY,recalculateFaces,this.layer);return this},randomize:function(tileX,tileY,width,height,indexes){TilemapComponents.Randomize(tileX,tileY,width,height,indexes,this.layer);return this},removeTileAt:function(tileX,tileY,replaceWithNull,recalculateFaces){return TilemapComponents.RemoveTileAt(tileX,tileY,replaceWithNull,recalculateFaces,this.layer)},removeTileAtWorldXY:function(worldX,worldY,replaceWithNull,recalculateFaces,camera){return TilemapComponents.RemoveTileAtWorldXY(worldX,worldY,replaceWithNull,recalculateFaces,camera,this.layer)},renderDebug:function(graphics,styleConfig){TilemapComponents.RenderDebug(graphics,styleConfig,this.layer);return this},replaceByIndex:function(findIndex,newIndex,tileX,tileY,width,height){TilemapComponents.ReplaceByIndex(findIndex,newIndex,tileX,tileY,width,height,this.layer);return this},setSkipCull:function(value){if(value===undefined){value=true}this.skipCull=value;return this},setCullPadding:function(paddingX,paddingY){if(paddingX===undefined){paddingX=1}if(paddingY===undefined){paddingY=1}this.cullPaddingX=paddingX;this.cullPaddingY=paddingY;return this},setCollision:function(indexes,collides,recalculateFaces,updateLayer){TilemapComponents.SetCollision(indexes,collides,recalculateFaces,this.layer,updateLayer);return this},setCollisionBetween:function(start,stop,collides,recalculateFaces){TilemapComponents.SetCollisionBetween(start,stop,collides,recalculateFaces,this.layer);return this},setCollisionByProperty:function(properties,collides,recalculateFaces){TilemapComponents.SetCollisionByProperty(properties,collides,recalculateFaces,this.layer);return this},setCollisionByExclusion:function(indexes,collides,recalculateFaces){TilemapComponents.SetCollisionByExclusion(indexes,collides,recalculateFaces,this.layer);return this},setCollisionFromCollisionGroup:function(collides,recalculateFaces){TilemapComponents.SetCollisionFromCollisionGroup(collides,recalculateFaces,this.layer);return this},setTileIndexCallback:function(indexes,callback,callbackContext){TilemapComponents.SetTileIndexCallback(indexes,callback,callbackContext,this.layer);return this},setTileLocationCallback:function(tileX,tileY,width,height,callback,callbackContext){TilemapComponents.SetTileLocationCallback(tileX,tileY,width,height,callback,callbackContext,this.layer);return this},shuffle:function(tileX,tileY,width,height){TilemapComponents.Shuffle(tileX,tileY,width,height,this.layer);return this},swapByIndex:function(indexA,indexB,tileX,tileY,width,height){TilemapComponents.SwapByIndex(indexA,indexB,tileX,tileY,width,height,this.layer);return this},tileToWorldX:function(tileX,camera){return TilemapComponents.TileToWorldX(tileX,camera,this.layer)},tileToWorldY:function(tileY,camera){return TilemapComponents.TileToWorldY(tileY,camera,this.layer)},tileToWorldXY:function(tileX,tileY,point,camera){return TilemapComponents.TileToWorldXY(tileX,tileY,point,camera,this.layer)},weightedRandomize:function(tileX,tileY,width,height,weightedIndexes){TilemapComponents.WeightedRandomize(tileX,tileY,width,height,weightedIndexes,this.layer);return this},worldToTileX:function(worldX,snapToFloor,camera){return TilemapComponents.WorldToTileX(worldX,snapToFloor,camera,this.layer)},worldToTileY:function(worldY,snapToFloor,camera){return TilemapComponents.WorldToTileY(worldY,snapToFloor,camera,this.layer)},worldToTileXY:function(worldX,worldY,snapToFloor,point,camera){return TilemapComponents.WorldToTileXY(worldX,worldY,snapToFloor,point,camera,this.layer)}});module.exports=DynamicTilemapLayer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(12);var GameEvents=__webpack_require__(20);var GameObject=__webpack_require__(14);var StaticTilemapLayerRender=__webpack_require__(1348);var TilemapComponents=__webpack_require__(141);var TransformMatrix=__webpack_require__(29);var Utils=__webpack_require__(9);var StaticTilemapLayer=new Class({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.ComputedSize,Components.Depth,Components.Flip,Components.GetBounds,Components.Origin,Components.Pipeline,Components.Transform,Components.Visible,Components.ScrollFactor,StaticTilemapLayerRender],initialize:function StaticTilemapLayer(scene,tilemap,layerIndex,tileset,x,y){GameObject.call(this,scene,'StaticTilemapLayer');this.isTilemap=true;this.tilemap=tilemap;this.layerIndex=layerIndex;this.layer=tilemap.layers[layerIndex];this.layer.tilemapLayer=this;this.tileset=[];this.culledTiles=[];this.skipCull=false;this.tilesDrawn=0;this.tilesTotal=this.layer.width*this.layer.height;this.cullPaddingX=1;this.cullPaddingY=1;this.cullCallback=TilemapComponents.CullTiles;this.renderer=scene.sys.game.renderer;this.vertexBuffer=[];this.bufferData=[];this.vertexViewF32=[];this.vertexViewU32=[];this.dirty=[];this.vertexCount=[];this._renderOrder=0;this._tempMatrix=new TransformMatrix();this.gidMap=[];this.setTilesets(tileset);this.setAlpha(this.layer.alpha);this.setPosition(x,y);this.setOrigin();this.setSize(tilemap.tileWidth*this.layer.width,tilemap.tileHeight*this.layer.height);this.updateVBOData();this.initPipeline('TextureTintPipeline');scene.sys.game.events.on(GameEvents.CONTEXT_RESTORED,function(){this.updateVBOData()},this)},setTilesets:function(tilesets){var gidMap=[];var setList=[];var map=this.tilemap;if(!Array.isArray(tilesets)){tilesets=[tilesets]}for(var i=0;i<tilesets.length;i++){var tileset=tilesets[i];if(typeof tileset==='string'){tileset=map.getTileset(tileset)}if(tileset){setList.push(tileset);var s=tileset.firstgid;for(var t=0;t<tileset.total;t++){gidMap[s+t]=tileset}}}this.gidMap=gidMap;this.tileset=setList},updateVBOData:function(){for(var i=0;i<this.tileset.length;i++){this.dirty[i]=true;this.vertexCount[i]=0;this.vertexBuffer[i]=null;this.bufferData[i]=null;this.vertexViewF32[i]=null;this.vertexViewU32[i]=null}return this},upload:function(camera,tilesetIndex){var renderer=this.renderer;var gl=renderer.gl;var pipeline=renderer.pipelines.TextureTintPipeline;if(this.dirty[tilesetIndex]){var tileset=this.tileset[tilesetIndex];var mapWidth=this.layer.width;var mapHeight=this.layer.height;var width=tileset.image.source[0].width;var height=tileset.image.source[0].height;var mapData=this.layer.data;var tile;var row;var col;var renderOrder=this._renderOrder;var minTileIndex=tileset.firstgid;var maxTileIndex=tileset.firstgid+tileset.total;var vertexBuffer=this.vertexBuffer[tilesetIndex];var bufferData=this.bufferData[tilesetIndex];var vOffset=-1;var bufferSize=(mapWidth*mapHeight)*pipeline.vertexSize*6;this.vertexCount[tilesetIndex]=0;if(bufferData===null){bufferData=new ArrayBuffer(bufferSize);this.bufferData[tilesetIndex]=bufferData;this.vertexViewF32[tilesetIndex]=new Float32Array(bufferData);this.vertexViewU32[tilesetIndex]=new Uint32Array(bufferData)}if(renderOrder===0){for(row=0;row<mapHeight;row++){for(col=0;col<mapWidth;col++){tile=mapData[row][col];if(!tile||tile.index<minTileIndex||tile.index>maxTileIndex||!tile.visible){continue}vOffset=this.batchTile(vOffset,tile,tileset,width,height,camera,tilesetIndex)}}}else if(renderOrder===1){for(row=0;row<mapHeight;row++){for(col=mapWidth-1;col>=0;col--){tile=mapData[row][col];if(!tile||tile.index<minTileIndex||tile.index>maxTileIndex||!tile.visible){continue}vOffset=this.batchTile(vOffset,tile,tileset,width,height,camera,tilesetIndex)}}}else if(renderOrder===2){for(row=mapHeight-1;row>=0;row--){for(col=0;col<mapWidth;col++){tile=mapData[row][col];if(!tile||tile.index<minTileIndex||tile.index>maxTileIndex||!tile.visible){continue}vOffset=this.batchTile(vOffset,tile,tileset,width,height,camera,tilesetIndex)}}}else if(renderOrder===3){for(row=mapHeight-1;row>=0;row--){for(col=mapWidth-1;col>=0;col--){tile=mapData[row][col];if(!tile||tile.index<minTileIndex||tile.index>maxTileIndex||!tile.visible){continue}vOffset=this.batchTile(vOffset,tile,tileset,width,height,camera,tilesetIndex)}}}this.dirty[tilesetIndex]=false;if(vertexBuffer===null){vertexBuffer=renderer.createVertexBuffer(bufferData,gl.STATIC_DRAW);this.vertexBuffer[tilesetIndex]=vertexBuffer}else{renderer.setVertexBuffer(vertexBuffer);gl.bufferSubData(gl.ARRAY_BUFFER,0,bufferData)}}return this},batchTile:function(vOffset,tile,tileset,width,height,camera,tilesetIndex){var texCoords=tileset.getTileTextureCoordinates(tile.index);if(!texCoords){return vOffset}var tileWidth=tileset.tileWidth;var tileHeight=tileset.tileHeight;var halfTileWidth=tileWidth/2;var halfTileHeight=tileHeight/2;var u0=texCoords.x/width;var v0=texCoords.y/height;var u1=(texCoords.x+tileWidth)/width;var v1=(texCoords.y+tileHeight)/height;var matrix=this._tempMatrix;var x=-halfTileWidth;var y=-halfTileHeight;if(tile.flipX){tileWidth*=-1;x+=tileset.tileWidth}if(tile.flipY){tileHeight*=-1;y+=tileset.tileHeight}var xw=x+tileWidth;var yh=y+tileHeight;matrix.applyITRS(halfTileWidth+tile.pixelX,halfTileHeight+tile.pixelY,tile.rotation,1,1);var tint=Utils.getTintAppendFloatAlpha(0xffffff,camera.alpha*this.alpha*tile.alpha);var tx0=matrix.getX(x,y);var ty0=matrix.getY(x,y);var tx1=matrix.getX(x,yh);var ty1=matrix.getY(x,yh);var tx2=matrix.getX(xw,yh);var ty2=matrix.getY(xw,yh);var tx3=matrix.getX(xw,y);var ty3=matrix.getY(xw,y);if(camera.roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}var vertexViewF32=this.vertexViewF32[tilesetIndex];var vertexViewU32=this.vertexViewU32[tilesetIndex];vertexViewF32[++vOffset]=tx0;vertexViewF32[++vOffset]=ty0;vertexViewF32[++vOffset]=u0;vertexViewF32[++vOffset]=v0;vertexViewF32[++vOffset]=0;vertexViewU32[++vOffset]=tint;vertexViewF32[++vOffset]=tx1;vertexViewF32[++vOffset]=ty1;vertexViewF32[++vOffset]=u0;vertexViewF32[++vOffset]=v1;vertexViewF32[++vOffset]=0;vertexViewU32[++vOffset]=tint;vertexViewF32[++vOffset]=tx2;vertexViewF32[++vOffset]=ty2;vertexViewF32[++vOffset]=u1;vertexViewF32[++vOffset]=v1;vertexViewF32[++vOffset]=0;vertexViewU32[++vOffset]=tint;vertexViewF32[++vOffset]=tx0;vertexViewF32[++vOffset]=ty0;vertexViewF32[++vOffset]=u0;vertexViewF32[++vOffset]=v0;vertexViewF32[++vOffset]=0;vertexViewU32[++vOffset]=tint;vertexViewF32[++vOffset]=tx2;vertexViewF32[++vOffset]=ty2;vertexViewF32[++vOffset]=u1;vertexViewF32[++vOffset]=v1;vertexViewF32[++vOffset]=0;vertexViewU32[++vOffset]=tint;vertexViewF32[++vOffset]=tx3;vertexViewF32[++vOffset]=ty3;vertexViewF32[++vOffset]=u1;vertexViewF32[++vOffset]=v0;vertexViewF32[++vOffset]=0;vertexViewU32[++vOffset]=tint;this.vertexCount[tilesetIndex]+=6;return vOffset},setRenderOrder:function(renderOrder){var orders=['right-down','left-down','right-up','left-up'];if(typeof renderOrder==='string'){renderOrder=orders.indexOf(renderOrder)}if(renderOrder>=0&&renderOrder<4){this._renderOrder=renderOrder;for(var i=0;i<this.tileset.length;i++){this.dirty[i]=true}}return this},calculateFacesAt:function(tileX,tileY){TilemapComponents.CalculateFacesAt(tileX,tileY,this.layer);return this},calculateFacesWithin:function(tileX,tileY,width,height){TilemapComponents.CalculateFacesWithin(tileX,tileY,width,height,this.layer);return this},createFromTiles:function(indexes,replacements,spriteConfig,scene,camera){return TilemapComponents.CreateFromTiles(indexes,replacements,spriteConfig,scene,camera,this.layer)},cull:function(camera){return this.cullCallback(this.layer,camera,this.culledTiles)},setSkipCull:function(value){if(value===undefined){value=true}this.skipCull=value;return this},setCullPadding:function(paddingX,paddingY){if(paddingX===undefined){paddingX=1}if(paddingY===undefined){paddingY=1}this.cullPaddingX=paddingX;this.cullPaddingY=paddingY;return this},findByIndex:function(findIndex,skip,reverse){return TilemapComponents.FindByIndex(findIndex,skip,reverse,this.layer)},findTile:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents.FindTile(callback,context,tileX,tileY,width,height,filteringOptions,this.layer)},filterTiles:function(callback,context,tileX,tileY,width,height,filteringOptions){return TilemapComponents.FilterTiles(callback,context,tileX,tileY,width,height,filteringOptions,this.layer)},forEachTile:function(callback,context,tileX,tileY,width,height,filteringOptions){TilemapComponents.ForEachTile(callback,context,tileX,tileY,width,height,filteringOptions,this.layer);return this},getTileAt:function(tileX,tileY,nonNull){return TilemapComponents.GetTileAt(tileX,tileY,nonNull,this.layer)},getTileAtWorldXY:function(worldX,worldY,nonNull,camera){return TilemapComponents.GetTileAtWorldXY(worldX,worldY,nonNull,camera,this.layer)},getTilesWithin:function(tileX,tileY,width,height,filteringOptions){return TilemapComponents.GetTilesWithin(tileX,tileY,width,height,filteringOptions,this.layer)},getTilesWithinWorldXY:function(worldX,worldY,width,height,filteringOptions,camera){return TilemapComponents.GetTilesWithinWorldXY(worldX,worldY,width,height,filteringOptions,camera,this.layer)},getTilesWithinShape:function(shape,filteringOptions,camera){return TilemapComponents.GetTilesWithinShape(shape,filteringOptions,camera,this.layer)},hasTileAt:function(tileX,tileY){return TilemapComponents.HasTileAt(tileX,tileY,this.layer)},hasTileAtWorldXY:function(worldX,worldY,camera){return TilemapComponents.HasTileAtWorldXY(worldX,worldY,camera,this.layer)},renderDebug:function(graphics,styleConfig){TilemapComponents.RenderDebug(graphics,styleConfig,this.layer);return this},setCollision:function(indexes,collides,recalculateFaces,updateLayer){TilemapComponents.SetCollision(indexes,collides,recalculateFaces,this.layer,updateLayer);return this},setCollisionBetween:function(start,stop,collides,recalculateFaces){TilemapComponents.SetCollisionBetween(start,stop,collides,recalculateFaces,this.layer);return this},setCollisionByProperty:function(properties,collides,recalculateFaces){TilemapComponents.SetCollisionByProperty(properties,collides,recalculateFaces,this.layer);return this},setCollisionByExclusion:function(indexes,collides,recalculateFaces){TilemapComponents.SetCollisionByExclusion(indexes,collides,recalculateFaces,this.layer);return this},setTileIndexCallback:function(indexes,callback,callbackContext){TilemapComponents.SetTileIndexCallback(indexes,callback,callbackContext,this.layer);return this},setCollisionFromCollisionGroup:function(collides,recalculateFaces){TilemapComponents.SetCollisionFromCollisionGroup(collides,recalculateFaces,this.layer);return this},setTileLocationCallback:function(tileX,tileY,width,height,callback,callbackContext){TilemapComponents.SetTileLocationCallback(tileX,tileY,width,height,callback,callbackContext,this.layer);return this},tileToWorldX:function(tileX,camera){return TilemapComponents.TileToWorldX(tileX,camera,this.layer)},tileToWorldY:function(tileY,camera){return TilemapComponents.TileToWorldY(tileY,camera,this.layer)},tileToWorldXY:function(tileX,tileY,point,camera){return TilemapComponents.TileToWorldXY(tileX,tileY,point,camera,this.layer)},worldToTileX:function(worldX,snapToFloor,camera){return TilemapComponents.WorldToTileX(worldX,snapToFloor,camera,this.layer)},worldToTileY:function(worldY,snapToFloor,camera){return TilemapComponents.WorldToTileY(worldY,snapToFloor,camera,this.layer)},worldToTileXY:function(worldX,worldY,snapToFloor,point,camera){return TilemapComponents.WorldToTileXY(worldX,worldY,snapToFloor,point,camera,this.layer)},destroy:function(removeFromTilemap){if(removeFromTilemap===undefined){removeFromTilemap=true}if(!this.tilemap){return}if(this.layer.tilemapLayer===this){this.layer.tilemapLayer=undefined}if(removeFromTilemap){this.tilemap.removeLayer(this)}this.tilemap=undefined;this.layer=undefined;this.culledTiles.length=0;this.cullCallback=null;for(var i=0;i<this.tileset.length;i++){this.dirty[i]=true;this.vertexCount[i]=0;this.vertexBuffer[i]=null;this.bufferData[i]=null;this.vertexViewF32[i]=null;this.vertexViewU32[i]=null}this.gidMap=[];this.tileset=[];GameObject.prototype.destroy.call(this)}});module.exports=StaticTilemapLayer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var TimerEvent=new Class({initialize:function TimerEvent(config){this.delay=0;this.repeat=0;this.repeatCount=0;this.loop=false;this.callback;this.callbackScope;this.args;this.timeScale=1;this.startAt=0;this.elapsed=0;this.paused=false;this.hasDispatched=false;this.reset(config)},reset:function(config){this.delay=GetFastValue(config,'delay',0);this.repeat=GetFastValue(config,'repeat',0);this.loop=GetFastValue(config,'loop',false);this.callback=GetFastValue(config,'callback',undefined);this.callbackScope=GetFastValue(config,'callbackScope',this.callback);this.args=GetFastValue(config,'args',[]);this.timeScale=GetFastValue(config,'timeScale',1);this.startAt=GetFastValue(config,'startAt',0);this.paused=GetFastValue(config,'paused',false);this.elapsed=this.startAt;this.hasDispatched=false;this.repeatCount=(this.repeat===-1||this.loop)?999999999999:this.repeat;return this},getProgress:function(){return(this.elapsed/this.delay)},getOverallProgress:function(){if(this.repeat>0){var totalDuration=this.delay+(this.delay*this.repeat);var totalElapsed=this.elapsed+(this.delay*(this.repeat-this.repeatCount));return(totalElapsed/totalDuration)}else{return this.getProgress()}},getRepeatCount:function(){return this.repeatCount},getElapsed:function(){return this.elapsed},getElapsedSeconds:function(){return this.elapsed*0.001},remove:function(dispatchCallback){if(dispatchCallback===undefined){dispatchCallback=false}this.elapsed=this.delay;this.hasDispatched=!dispatchCallback;this.repeatCount=0},destroy:function(){this.callback=undefined;this.callbackScope=undefined;this.args=[]}});module.exports=TimerEvent}),(function(module,exports,__webpack_require__){var RESERVED=__webpack_require__(1357);var GetProps=function(config){var key;var keys=[];if(config.hasOwnProperty('props')){for(key in config.props){if(key.substr(0,1)!=='_'){keys.push({key:key,value:config.props[key]})}}}else{for(key in config){if(RESERVED.indexOf(key)===-1&&key.substr(0,1)!=='_'){keys.push({key:key,value:config[key]})}}}return keys};module.exports=GetProps}),(function(module,exports,__webpack_require__){var GetValue=__webpack_require__(6);var GetTweens=function(config){var tweens=GetValue(config,'tweens',null);if(tweens===null){return[]}else if(typeof tweens==='function'){tweens=tweens.call()}if(!Array.isArray(tweens)){tweens=[tweens]}return tweens};module.exports=GetTweens}),(function(module,exports,__webpack_require__){var Defaults=__webpack_require__(230);var GetAdvancedValue=__webpack_require__(15);var GetBoolean=__webpack_require__(88);var GetEaseFunction=__webpack_require__(69);var GetNewValue=__webpack_require__(145);var GetValue=__webpack_require__(6);var GetValueOp=__webpack_require__(229);var Tween=__webpack_require__(231);var TweenData=__webpack_require__(233);var NumberTweenBuilder=function(parent,config,defaults){if(defaults===undefined){defaults=Defaults}var from=GetValue(config,'from',0);var to=GetValue(config,'to',1);var targets=[{value:from}];var delay=GetNewValue(config,'delay',defaults.delay);var duration=GetNewValue(config,'duration',defaults.duration);var easeParams=GetValue(config,'easeParams',defaults.easeParams);var ease=GetEaseFunction(GetValue(config,'ease',defaults.ease),easeParams);var hold=GetNewValue(config,'hold',defaults.hold);var repeat=GetNewValue(config,'repeat',defaults.repeat);var repeatDelay=GetNewValue(config,'repeatDelay',defaults.repeatDelay);var yoyo=GetBoolean(config,'yoyo',defaults.yoyo);var data=[];var ops=GetValueOp('value',to);var tweenData=TweenData(targets[0],0,'value',ops.getEnd,ops.getStart,ops.getActive,ease,delay,duration,yoyo,hold,repeat,repeatDelay,false,false);tweenData.start=from;tweenData.current=from;tweenData.to=to;data.push(tweenData);var tween=new Tween(parent,data,targets);tween.offset=GetAdvancedValue(config,'offset',null);tween.completeDelay=GetAdvancedValue(config,'completeDelay',0);tween.loop=Math.round(GetAdvancedValue(config,'loop',0));tween.loopDelay=Math.round(GetAdvancedValue(config,'loopDelay',0));tween.paused=GetBoolean(config,'paused',false);tween.useFrames=GetBoolean(config,'useFrames',false);var scope=GetValue(config,'callbackScope',tween);var tweenArray=[tween,null];var callbacks=Tween.TYPES;for(var i=0;i<callbacks.length;i++){var type=callbacks[i];var callback=GetValue(config,type,false);if(callback){var callbackScope=GetValue(config,type+'Scope',scope);var callbackParams=GetValue(config,type+'Params',[]);tween.setCallback(type,callback,tweenArray.concat(callbackParams),callbackScope)}}return tween};module.exports=NumberTweenBuilder}),(function(module,exports,__webpack_require__){var GetEaseFunction=__webpack_require__(69);var GetValue=__webpack_require__(6);var MATH_CONST=__webpack_require__(13);var StaggerBuilder=function(value,options){if(options===undefined){options={}}var result;var start=GetValue(options,'start',0);var ease=GetValue(options,'ease',null);var grid=GetValue(options,'grid',null);var from=GetValue(options,'from',0);var fromFirst=(from==='first');var fromCenter=(from==='center');var fromLast=(from==='last');var fromValue=(typeof(from)==='number');var isRange=(Array.isArray(value));var value1=(isRange)?parseFloat(value[0]):parseFloat(value);var value2=(isRange)?parseFloat(value[1]):0;var maxValue=Math.max(value1,value2);if(isRange){start+=value1}if(grid){var gridWidth=grid[0];var gridHeight=grid[1];var fromX=0;var fromY=0;var distanceX=0;var distanceY=0;var gridValues=[];if(fromLast){fromX=gridWidth-1;fromY=gridHeight-1}else if(fromValue){fromX=from%gridWidth;fromY=Math.floor(from/gridWidth)}else if(fromCenter){fromX=(gridWidth-1)/2;fromY=(gridHeight-1)/2}var gridMax=MATH_CONST.MIN_SAFE_INTEGER;for(var toY=0;toY<gridHeight;toY++){gridValues[toY]=[];for(var toX=0;toX<gridWidth;toX++){distanceX=fromX-toX;distanceY=fromY-toY;var dist=Math.sqrt(distanceX*distanceX+distanceY*distanceY);if(dist>gridMax){gridMax=dist}gridValues[toY][toX]=dist}}}var easeFunction=(ease)?GetEaseFunction(ease):null;if(grid){result=function(target,key,value,index){var gridSpace=0;var toX=index%gridWidth;var toY=Math.floor(index/gridWidth);if(toX>=0&&toX<gridWidth&&toY>=0&&toY<gridHeight){gridSpace=gridValues[toY][toX]}var output;if(isRange){var diff=(value2-value1);if(easeFunction){output=((gridSpace/gridMax)*diff)*easeFunction(gridSpace/gridMax)}else{output=(gridSpace/gridMax)*diff}}else if(easeFunction){output=(gridSpace*value1)*easeFunction(gridSpace/gridMax)}else{output=gridSpace*value1}return output+start}}else{result=function(target,key,value,index,total){total--;var fromIndex;if(fromFirst){fromIndex=index}else if(fromCenter){fromIndex=Math.abs((total/2)-index)}else if(fromLast){fromIndex=total-index}else if(fromValue){fromIndex=Math.abs(from-index)}var output;if(isRange){var spacing;if(fromCenter){spacing=((value2-value1)/total)*(fromIndex*2)}else{spacing=((value2-value1)/total)*fromIndex}if(easeFunction){output=spacing*easeFunction(fromIndex/total)}else{output=spacing}}else if(easeFunction){output=(total*maxValue)*easeFunction(fromIndex/total)}else{output=fromIndex*value1}return output+start}}return result};module.exports=StaggerBuilder}),(function(module,exports,__webpack_require__){var Clone=__webpack_require__(67);var Defaults=__webpack_require__(230);var GetAdvancedValue=__webpack_require__(15);var GetBoolean=__webpack_require__(88);var GetEaseFunction=__webpack_require__(69);var GetNewValue=__webpack_require__(145);var GetTargets=__webpack_require__(228);var GetTweens=__webpack_require__(499);var GetValue=__webpack_require__(6);var Timeline=__webpack_require__(503);var TweenBuilder=__webpack_require__(146);var TimelineBuilder=function(manager,config){var timeline=new Timeline(manager);timeline.completeDelay=GetAdvancedValue(config,'completeDelay',0);timeline.loop=Math.round(GetAdvancedValue(config,'loop',0));timeline.loopDelay=Math.round(GetAdvancedValue(config,'loopDelay',0));timeline.paused=GetBoolean(config,'paused',false);timeline.useFrames=GetBoolean(config,'useFrames',false);var scope=GetValue(config,'callbackScope',timeline);var timelineArray=[timeline];var onStart=GetValue(config,'onStart',false);if(onStart){var onStartScope=GetValue(config,'onStartScope',scope);var onStartParams=GetValue(config,'onStartParams',[]);timeline.setCallback('onStart',onStart,timelineArray.concat(onStartParams),onStartScope)}var onUpdate=GetValue(config,'onUpdate',false);if(onUpdate){var onUpdateScope=GetValue(config,'onUpdateScope',scope);var onUpdateParams=GetValue(config,'onUpdateParams',[]);timeline.setCallback('onUpdate',onUpdate,timelineArray.concat(onUpdateParams),onUpdateScope)}var onLoop=GetValue(config,'onLoop',false);if(onLoop){var onLoopScope=GetValue(config,'onLoopScope',scope);var onLoopParams=GetValue(config,'onLoopParams',[]);timeline.setCallback('onLoop',onLoop,timelineArray.concat(onLoopParams),onLoopScope)}var onYoyo=GetValue(config,'onYoyo',false);if(onYoyo){var onYoyoScope=GetValue(config,'onYoyoScope',scope);var onYoyoParams=GetValue(config,'onYoyoParams',[]);timeline.setCallback('onYoyo',onYoyo,timelineArray.concat(null,onYoyoParams),onYoyoScope)}var onComplete=GetValue(config,'onComplete',false);if(onComplete){var onCompleteScope=GetValue(config,'onCompleteScope',scope);var onCompleteParams=GetValue(config,'onCompleteParams',[]);timeline.setCallback('onComplete',onComplete,timelineArray.concat(onCompleteParams),onCompleteScope)}var tweens=GetTweens(config);if(tweens.length===0){timeline.paused=true;return timeline}var defaults=Clone(Defaults);defaults.targets=GetTargets(config);var totalDuration=GetAdvancedValue(config,'totalDuration',0);if(totalDuration>0){defaults.duration=Math.floor(totalDuration/tweens.length)}else{defaults.duration=GetNewValue(config,'duration',defaults.duration)}defaults.delay=GetNewValue(config,'delay',defaults.delay);defaults.easeParams=GetValue(config,'easeParams',defaults.easeParams);defaults.ease=GetEaseFunction(GetValue(config,'ease',defaults.ease),defaults.easeParams);defaults.hold=GetNewValue(config,'hold',defaults.hold);defaults.repeat=GetNewValue(config,'repeat',defaults.repeat);defaults.repeatDelay=GetNewValue(config,'repeatDelay',defaults.repeatDelay);defaults.yoyo=GetBoolean(config,'yoyo',defaults.yoyo);defaults.flipX=GetBoolean(config,'flipX',defaults.flipX);defaults.flipY=GetBoolean(config,'flipY',defaults.flipY);for(var i=0;i<tweens.length;i++){timeline.queue(TweenBuilder(timeline,tweens[i],defaults))}return timeline};module.exports=TimelineBuilder}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(232);var TweenBuilder=__webpack_require__(146);var TWEEN_CONST=__webpack_require__(89);var Timeline=new Class({Extends:EventEmitter,initialize:function Timeline(manager){EventEmitter.call(this);this.manager=manager;this.isTimeline=true;this.data=[];this.totalData=0;this.useFrames=false;this.timeScale=1;this.loop=0;this.loopDelay=0;this.loopCounter=0;this.completeDelay=0;this.countdown=0;this.state=TWEEN_CONST.PENDING_ADD;this._pausedState=TWEEN_CONST.PENDING_ADD;this.paused=false;this.elapsed=0;this.totalElapsed=0;this.duration=0;this.progress=0;this.totalDuration=0;this.totalProgress=0;this.callbacks={onComplete:null,onLoop:null,onStart:null,onUpdate:null,onYoyo:null};this.callbackScope},dispatchTimelineEvent:function(event,callback){this.emit(event,this);if(callback){callback.func.apply(callback.scope,callback.params)}},setTimeScale:function(value){this.timeScale=value;return this},getTimeScale:function(){return this.timeScale},isPlaying:function(){return(this.state===TWEEN_CONST.ACTIVE)},add:function(config){return this.queue(TweenBuilder(this,config))},queue:function(tween){if(!this.isPlaying()){tween.parent=this;tween.parentIsTimeline=true;this.data.push(tween);this.totalData=this.data.length}return this},hasOffset:function(tween){return(tween.offset!==null)},isOffsetAbsolute:function(value){return(typeof(value)==='number')},isOffsetRelative:function(value){var t=typeof(value);if(t==='string'){var op=value[0];if(op==='-'||op==='+'){return true}}return false},getRelativeOffset:function(value,base){var op=value[0];var num=parseFloat(value.substr(2));var result=base;switch(op){case'+':result+=num;break;case'-':result-=num;break}return Math.max(0,result)},calcDuration:function(){var prevEnd=0;var totalDuration=0;var offsetDuration=0;for(var i=0;i<this.totalData;i++){var tween=this.data[i];tween.init();if(this.hasOffset(tween)){if(this.isOffsetAbsolute(tween.offset)){tween.calculatedOffset=tween.offset;if(tween.offset===0){offsetDuration=0}}else if(this.isOffsetRelative(tween.offset)){tween.calculatedOffset=this.getRelativeOffset(tween.offset,prevEnd)}}else{tween.calculatedOffset=offsetDuration}prevEnd=tween.totalDuration+tween.calculatedOffset;totalDuration+=tween.totalDuration;offsetDuration+=tween.totalDuration}this.duration=totalDuration;this.loopCounter=(this.loop===-1)?999999999999:this.loop;if(this.loopCounter>0){this.totalDuration=this.duration+this.completeDelay+((this.duration+this.loopDelay)*this.loopCounter)}else{this.totalDuration=this.duration+this.completeDelay}},init:function(){this.calcDuration();this.progress=0;this.totalProgress=0;if(this.paused){this.state=TWEEN_CONST.PAUSED;return false}else{return true}},resetTweens:function(resetFromLoop){for(var i=0;i<this.totalData;i++){var tween=this.data[i];tween.play(resetFromLoop)}},setCallback:function(type,callback,params,scope){if(Timeline.TYPES.indexOf(type)!==-1){this.callbacks[type]={func:callback,scope:scope,params:params}}return this},makeActive:function(tween){return this.manager.makeActive(tween)},play:function(){if(this.state===TWEEN_CONST.ACTIVE){return}if(this.paused){this.paused=false;this.manager.makeActive(this);return}else{this.resetTweens(false);this.state=TWEEN_CONST.ACTIVE}this.dispatchTimelineEvent(Events.TIMELINE_START,this.callbacks.onStart)},nextState:function(){if(this.loopCounter>0){this.elapsed=0;this.progress=0;this.loopCounter--;this.resetTweens(true);if(this.loopDelay>0){this.countdown=this.loopDelay;this.state=TWEEN_CONST.LOOP_DELAY}else{this.state=TWEEN_CONST.ACTIVE;this.dispatchTimelineEvent(Events.TIMELINE_LOOP,this.callbacks.onLoop)}}else if(this.completeDelay>0){this.state=TWEEN_CONST.COMPLETE_DELAY;this.countdown=this.completeDelay}else{this.state=TWEEN_CONST.PENDING_REMOVE;this.dispatchTimelineEvent(Events.TIMELINE_COMPLETE,this.callbacks.onComplete)}},update:function(timestamp,delta){if(this.state===TWEEN_CONST.PAUSED){return}if(this.useFrames){delta=1*this.manager.timeScale}delta*=this.timeScale;this.elapsed+=delta;this.progress=Math.min(this.elapsed/this.duration,1);this.totalElapsed+=delta;this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1);switch(this.state){case TWEEN_CONST.ACTIVE:var stillRunning=this.totalData;for(var i=0;i<this.totalData;i++){var tween=this.data[i];if(tween.update(timestamp,delta)){stillRunning--}}this.dispatchTimelineEvent(Events.TIMELINE_UPDATE,this.callbacks.onUpdate);if(stillRunning===0){this.nextState()}break;case TWEEN_CONST.LOOP_DELAY:this.countdown-=delta;if(this.countdown<=0){this.state=TWEEN_CONST.ACTIVE;this.dispatchTimelineEvent(Events.TIMELINE_LOOP,this.callbacks.onLoop)}break;case TWEEN_CONST.COMPLETE_DELAY:this.countdown-=delta;if(this.countdown<=0){this.state=TWEEN_CONST.PENDING_REMOVE;this.dispatchTimelineEvent(Events.TIMELINE_COMPLETE,this.callbacks.onComplete)}break}return(this.state===TWEEN_CONST.PENDING_REMOVE)},stop:function(){this.state=TWEEN_CONST.PENDING_REMOVE},pause:function(){if(this.state===TWEEN_CONST.PAUSED){return}this.paused=true;this._pausedState=this.state;this.state=TWEEN_CONST.PAUSED;this.emit(Events.TIMELINE_PAUSE,this);return this},resume:function(){if(this.state===TWEEN_CONST.PAUSED){this.paused=false;this.state=this._pausedState;this.emit(Events.TIMELINE_RESUME,this)}return this},hasTarget:function(target){for(var i=0;i<this.data.length;i++){if(this.data[i].hasTarget(target)){return true}}return false},destroy:function(){for(var i=0;i<this.data.length;i++){this.data[i].stop()}}});Timeline.TYPES=['onStart','onUpdate','onLoop','onComplete','onYoyo'];module.exports=Timeline}),(function(module,exports,__webpack_require__){var BaseAnimation=__webpack_require__(151);var Class=__webpack_require__(0);var Events=__webpack_require__(111);var Animation=new Class({initialize:function Animation(parent){this.parent=parent;this.animationManager=parent.scene.sys.anims;this.animationManager.once(Events.REMOVE_ANIMATION,this.remove,this);this.isPlaying=false;this.currentAnim=null;this.currentFrame=null;this.nextAnim=null;this.nextAnimsQueue=[];this._timeScale=1;this.frameRate=0;this.duration=0;this.msPerFrame=0;this.skipMissedFrames=true;this._delay=0;this._repeat=0;this._repeatDelay=0;this._yoyo=false;this.forward=true;this._reverse=false;this.accumulator=0;this.nextTick=0;this.repeatCounter=0;this.pendingRepeat=false;this._paused=false;this._wasPlaying=false;this._pendingStop=0;this._pendingStopValue},chain:function(key){if(key instanceof BaseAnimation){key=key.key}if(this.nextAnim===null){this.nextAnim=key}else{this.nextAnimsQueue.push(key)}return this.parent},setDelay:function(value){if(value===undefined){value=0}this._delay=value;return this.parent},getDelay:function(){return this._delay},delayedPlay:function(delay,key,startFrame){this.play(key,true,startFrame);this.nextTick+=delay;return this.parent},getCurrentKey:function(){if(this.currentAnim){return this.currentAnim.key}},load:function(key,startFrame){if(startFrame===undefined){startFrame=0}if(this.isPlaying){this.stop()}this.animationManager.load(this,key,startFrame);return this.parent},pause:function(atFrame){if(!this._paused){this._paused=true;this._wasPlaying=this.isPlaying;this.isPlaying=false}if(atFrame!==undefined){this.updateFrame(atFrame)}return this.parent},resume:function(fromFrame){if(this._paused){this._paused=false;this.isPlaying=this._wasPlaying}if(fromFrame!==undefined){this.updateFrame(fromFrame)}return this.parent},isPaused:{get:function(){return this._paused}},play:function(key,ignoreIfPlaying,startFrame){if(ignoreIfPlaying===undefined){ignoreIfPlaying=false}if(startFrame===undefined){startFrame=0}if(key instanceof BaseAnimation){key=key.key}if(ignoreIfPlaying&&this.isPlaying&&this.currentAnim.key===key){return this.parent}this.forward=true;this._reverse=false;this._paused=false;this._wasPlaying=true;return this._startAnimation(key,startFrame)},playReverse:function(key,ignoreIfPlaying,startFrame){if(ignoreIfPlaying===undefined){ignoreIfPlaying=false}if(startFrame===undefined){startFrame=0}if(key instanceof BaseAnimation){key=key.key}if(ignoreIfPlaying&&this.isPlaying&&this.currentAnim.key===key){return this.parent}this.forward=false;this._reverse=true;return this._startAnimation(key,startFrame)},_startAnimation:function(key,startFrame){this.load(key,startFrame);var anim=this.currentAnim;var gameObject=this.parent;if(!anim){return gameObject}this.repeatCounter=(this._repeat===-1)?Number.MAX_VALUE:this._repeat;anim.getFirstTick(this);this.isPlaying=true;this.pendingRepeat=false;if(anim.showOnStart){gameObject.visible=true}var frame=this.currentFrame;anim.emit(Events.ANIMATION_START,anim,frame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_KEY_START+key,anim,frame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_START,anim,frame,gameObject);return gameObject},reverse:function(){if(this.isPlaying){this._reverse=!this._reverse;this.forward=!this.forward}return this.parent},getProgress:function(){var p=this.currentFrame.progress;if(!this.forward){p=1-p}return p},setProgress:function(value){if(!this.forward){value=1-value}this.setCurrentFrame(this.currentAnim.getFrameByProgress(value));return this.parent},remove:function(key,animation){if(animation===undefined){animation=this.currentAnim}if(this.isPlaying&&animation.key===this.currentAnim.key){this.stop();this.setCurrentFrame(this.currentAnim.frames[0])}},getRepeat:function(){return this._repeat},setRepeat:function(value){this._repeat=value;this.repeatCounter=(value===-1)?Number.MAX_VALUE:value;return this.parent},getRepeatDelay:function(){return this._repeatDelay},setRepeatDelay:function(value){this._repeatDelay=value;return this.parent},restart:function(includeDelay){if(includeDelay===undefined){includeDelay=false}var anim=this.currentAnim;anim.getFirstTick(this,includeDelay);this.forward=true;this.isPlaying=true;this.pendingRepeat=false;this._paused=false;this.updateFrame(anim.frames[0]);var gameObject=this.parent;var frame=this.currentFrame;anim.emit(Events.ANIMATION_RESTART,anim,frame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_KEY_RESTART+anim.key,anim,frame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_RESTART,anim,frame,gameObject);return this.parent},stop:function(){this._pendingStop=0;this.isPlaying=false;var gameObject=this.parent;var anim=this.currentAnim;var frame=this.currentFrame;if(anim){anim.emit(Events.ANIMATION_COMPLETE,anim,frame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_KEY_COMPLETE+anim.key,anim,frame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_COMPLETE,anim,frame,gameObject)}if(this.nextAnim){var key=this.nextAnim;this.nextAnim=(this.nextAnimsQueue.length>0)?this.nextAnimsQueue.shift():null;this.play(key)}return gameObject},stopAfterDelay:function(delay){this._pendingStop=1;this._pendingStopValue=delay;return this.parent},stopOnRepeat:function(){this._pendingStop=2;return this.parent},stopOnFrame:function(frame){this._pendingStop=3;this._pendingStopValue=frame;return this.parent},setTimeScale:function(value){if(value===undefined){value=1}this._timeScale=value;return this.parent},getTimeScale:function(){return this._timeScale},getTotalFrames:function(){return this.currentAnim.frames.length},update:function(time,delta){if(!this.currentAnim||!this.isPlaying||this.currentAnim.paused){return}this.accumulator+=delta*this._timeScale;if(this._pendingStop===1){this._pendingStopValue-=delta;if(this._pendingStopValue<=0){return this.currentAnim.completeAnimation(this)}}if(this.accumulator>=this.nextTick){this.currentAnim.setFrame(this)}},setCurrentFrame:function(animationFrame){var gameObject=this.parent;this.currentFrame=animationFrame;gameObject.texture=animationFrame.frame.texture;gameObject.frame=animationFrame.frame;if(gameObject.isCropped){gameObject.frame.updateCropUVs(gameObject._crop,gameObject.flipX,gameObject.flipY)}gameObject.setSizeToFrame();if(gameObject._originComponent){if(animationFrame.frame.customPivot){gameObject.setOrigin(animationFrame.frame.pivotX,animationFrame.frame.pivotY)}else{gameObject.updateDisplayOrigin()}}return gameObject},updateFrame:function(animationFrame){var gameObject=this.setCurrentFrame(animationFrame);if(this.isPlaying){if(animationFrame.setAlpha){gameObject.alpha=animationFrame.alpha}var anim=this.currentAnim;gameObject.emit(Events.SPRITE_ANIMATION_KEY_UPDATE+anim.key,anim,animationFrame,gameObject);gameObject.emit(Events.SPRITE_ANIMATION_UPDATE,anim,animationFrame,gameObject);if(this._pendingStop===3&&this._pendingStopValue===animationFrame){this.currentAnim.completeAnimation(this)}}},nextFrame:function(){if(this.currentAnim){this.currentAnim.nextFrame(this)}return this.parent},previousFrame:function(){if(this.currentAnim){this.currentAnim.previousFrame(this)}return this.parent},setYoyo:function(value){if(value===undefined){value=false}this._yoyo=value;return this.parent},getYoyo:function(){return this._yoyo},destroy:function(){this.animationManager.off(Events.REMOVE_ANIMATION,this.remove,this);this.animationManager=null;this.parent=null;this.nextAnimsQueue.length=0;this.currentAnim=null;this.currentFrame=null}});module.exports=Animation}),(function(module,exports,__webpack_require__){var CanvasSnapshot=__webpack_require__(506);var CameraEvents=__webpack_require__(40);var Class=__webpack_require__(0);var CONST=__webpack_require__(33);var GetBlendModes=__webpack_require__(507);var ScaleEvents=__webpack_require__(92);var TransformMatrix=__webpack_require__(29);var CanvasRenderer=new Class({initialize:function CanvasRenderer(game){this.game=game;this.type=CONST.CANVAS;this.drawCount=0;this.width=0;this.height=0;this.config={clearBeforeRender:game.config.clearBeforeRender,backgroundColor:game.config.backgroundColor,resolution:game.config.resolution,antialias:game.config.antialias,roundPixels:game.config.roundPixels};this.gameCanvas=game.canvas;var contextOptions={alpha:game.config.transparent,desynchronized:game.config.desynchronized};this.gameContext=(this.game.config.context)?this.game.config.context:this.gameCanvas.getContext('2d',contextOptions);this.currentContext=this.gameContext;this.antialias=game.config.antialias;this.blendModes=GetBlendModes();this.snapshotState={x:0,y:0,width:1,height:1,getPixel:false,callback:null,type:'image/png',encoder:0.92};this._tempMatrix1=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempMatrix3=new TransformMatrix();this._tempMatrix4=new TransformMatrix();this.init()},init:function(){this.game.scale.on(ScaleEvents.RESIZE,this.onResize,this);var baseSize=this.game.scale.baseSize;this.resize(baseSize.width,baseSize.height)},onResize:function(gameSize,baseSize){if(baseSize.width!==this.width||baseSize.height!==this.height){this.resize(baseSize.width,baseSize.height)}},resize:function(width,height){this.width=width;this.height=height},resetTransform:function(){this.currentContext.setTransform(1,0,0,1,0,0)},setBlendMode:function(blendMode){this.currentContext.globalCompositeOperation=blendMode;return this},setContext:function(ctx){this.currentContext=(ctx)?ctx:this.gameContext;return this},setAlpha:function(alpha){this.currentContext.globalAlpha=alpha;return this},preRender:function(){var ctx=this.gameContext;var config=this.config;var width=this.width;var height=this.height;ctx.globalAlpha=1;ctx.globalCompositeOperation='source-over';ctx.setTransform(1,0,0,1,0,0);if(config.clearBeforeRender){ctx.clearRect(0,0,width,height)}if(!config.transparent){ctx.fillStyle=config.backgroundColor.rgba;ctx.fillRect(0,0,width,height)}ctx.save();this.drawCount=0},render:function(scene,children,interpolationPercentage,camera){var list=children.list;var childCount=list.length;var cx=camera._cx;var cy=camera._cy;var cw=camera._cw;var ch=camera._ch;var ctx=(camera.renderToTexture)?camera.context:scene.sys.context;ctx.save();if(this.game.scene.customViewports){ctx.beginPath();ctx.rect(cx,cy,cw,ch);ctx.clip()}this.currentContext=ctx;var mask=camera.mask;if(mask){mask.preRenderCanvas(this,null,camera._maskCamera)}if(!camera.transparent){ctx.fillStyle=camera.backgroundColor.rgba;ctx.fillRect(cx,cy,cw,ch)}ctx.globalAlpha=camera.alpha;ctx.globalCompositeOperation='source-over';this.drawCount+=list.length;if(camera.renderToTexture){camera.emit(CameraEvents.PRE_RENDER,camera)}camera.matrix.copyToContext(ctx);for(var i=0;i<childCount;i++){var child=list[i];if(!child.willRender(camera)){continue}if(child.mask){child.mask.preRenderCanvas(this,child,camera)}child.renderCanvas(this,child,interpolationPercentage,camera);if(child.mask){child.mask.postRenderCanvas(this,child,camera)}}ctx.setTransform(1,0,0,1,0,0);ctx.globalCompositeOperation='source-over';ctx.globalAlpha=1;camera.flashEffect.postRenderCanvas(ctx);camera.fadeEffect.postRenderCanvas(ctx);camera.dirty=false;if(mask){mask.postRenderCanvas(this)}ctx.restore();if(camera.renderToTexture){camera.emit(CameraEvents.POST_RENDER,camera);if(camera.renderToGame){scene.sys.context.drawImage(camera.canvas,cx,cy)}}},postRender:function(){var ctx=this.gameContext;ctx.restore();var state=this.snapshotState;if(state.callback){CanvasSnapshot(this.gameCanvas,state);state.callback=null}},snapshotCanvas:function(canvas,callback,getPixel,x,y,width,height,type,encoderOptions){if(getPixel===undefined){getPixel=false}this.snapshotArea(x,y,width,height,callback,type,encoderOptions);var state=this.snapshotState;state.getPixel=getPixel;CanvasSnapshot(this.canvas,state);state.callback=null;return this},snapshot:function(callback,type,encoderOptions){return this.snapshotArea(0,0,this.gameCanvas.width,this.gameCanvas.height,callback,type,encoderOptions)},snapshotArea:function(x,y,width,height,callback,type,encoderOptions){var state=this.snapshotState;state.callback=callback;state.type=type;state.encoder=encoderOptions;state.getPixel=false;state.x=x;state.y=y;state.width=Math.min(width,this.gameCanvas.width);state.height=Math.min(height,this.gameCanvas.height);return this},snapshotPixel:function(x,y,callback){this.snapshotArea(x,y,1,1,callback);this.snapshotState.getPixel=true;return this},batchSprite:function(sprite,frame,camera,parentTransformMatrix){var alpha=camera.alpha*sprite.alpha;if(alpha===0){return}var ctx=this.currentContext;var camMatrix=this._tempMatrix1;var spriteMatrix=this._tempMatrix2;var calcMatrix=this._tempMatrix3;var cd=frame.canvasData;var frameX=cd.x;var frameY=cd.y;var frameWidth=frame.cutWidth;var frameHeight=frame.cutHeight;var customPivot=frame.customPivot;var res=frame.source.resolution;var displayOriginX=sprite.displayOriginX;var displayOriginY=sprite.displayOriginY;var x=-displayOriginX+frame.x;var y=-displayOriginY+frame.y;if(sprite.isCropped){var crop=sprite._crop;if(crop.flipX!==sprite.flipX||crop.flipY!==sprite.flipY){frame.updateCropUVs(crop,sprite.flipX,sprite.flipY)}frameWidth=crop.cw;frameHeight=crop.ch;frameX=crop.cx;frameY=crop.cy;x=-displayOriginX+crop.x;y=-displayOriginY+crop.y;if(sprite.flipX){if(x>=0){x=-(x+frameWidth)}else if(x<0){x=(Math.abs(x)-frameWidth)}}if(sprite.flipY){if(y>=0){y=-(y+frameHeight)}else if(y<0){y=(Math.abs(y)-frameHeight)}}}var flipX=1;var flipY=1;if(sprite.flipX){if(!customPivot){x+=(-frame.realWidth+(displayOriginX*2))}flipX=-1}if(sprite.flipY){if(!customPivot){y+=(-frame.realHeight+(displayOriginY*2))}flipY=-1}spriteMatrix.applyITRS(sprite.x,sprite.y,sprite.rotation,sprite.scaleX*flipX,sprite.scaleY*flipY);camMatrix.copyFrom(camera.matrix);if(parentTransformMatrix){camMatrix.multiplyWithOffset(parentTransformMatrix,-camera.scrollX*sprite.scrollFactorX,-camera.scrollY*sprite.scrollFactorY);spriteMatrix.e=sprite.x;spriteMatrix.f=sprite.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*sprite.scrollFactorX;spriteMatrix.f-=camera.scrollY*sprite.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}ctx.save();calcMatrix.setToContext(ctx);ctx.globalCompositeOperation=this.blendModes[sprite.blendMode];ctx.globalAlpha=alpha;ctx.imageSmoothingEnabled=!(!this.antialias||frame.source.scaleMode);if(sprite.mask){sprite.mask.preRenderCanvas(this,sprite,camera)}ctx.drawImage(frame.source.image,frameX,frameY,frameWidth,frameHeight,x,y,frameWidth/res,frameHeight/res);if(sprite.mask){sprite.mask.postRenderCanvas(this,sprite,camera)}ctx.restore()},destroy:function(){this.gameCanvas=null;this.gameContext=null;this.game=null}});module.exports=CanvasRenderer}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var Color=__webpack_require__(31);var GetFastValue=__webpack_require__(2);var CanvasSnapshot=function(canvas,config){var callback=GetFastValue(config,'callback');var type=GetFastValue(config,'type','image/png');var encoderOptions=GetFastValue(config,'encoder',0.92);var x=Math.abs(Math.round(GetFastValue(config,'x',0)));var y=Math.abs(Math.round(GetFastValue(config,'y',0)));var width=GetFastValue(config,'width',canvas.width);var height=GetFastValue(config,'height',canvas.height);var getPixel=GetFastValue(config,'getPixel',false);if(getPixel){var context=canvas.getContext('2d');var imageData=context.getImageData(x,y,1,1);var data=imageData.data;callback.call(null,new Color(data[0],data[1],data[2],data[3]/255))}else if(x!==0||y!==0||width!==canvas.width||height!==canvas.height){var copyCanvas=CanvasPool.createWebGL(this,width,height);var ctx=copyCanvas.getContext('2d');ctx.drawImage(canvas,x,y,width,height,0,0,width,height);var image1=new Image();image1.onerror=function(){callback.call(null);CanvasPool.remove(copyCanvas)};image1.onload=function(){callback.call(null,image1);CanvasPool.remove(copyCanvas)};image1.src=copyCanvas.toDataURL(type,encoderOptions)}else{var image2=new Image();image2.onerror=function(){callback.call(null)};image2.onload=function(){callback.call(null,image2)};image2.src=canvas.toDataURL(type,encoderOptions)}};module.exports=CanvasSnapshot}),(function(module,exports,__webpack_require__){var modes=__webpack_require__(52);var CanvasFeatures=__webpack_require__(316);var GetBlendModes=function(){var output=[];var useNew=CanvasFeatures.supportNewBlendModes;var so='source-over';output[modes.NORMAL]=so;output[modes.ADD]='lighter';output[modes.MULTIPLY]=(useNew)?'multiply':so;output[modes.SCREEN]=(useNew)?'screen':so;output[modes.OVERLAY]=(useNew)?'overlay':so;output[modes.DARKEN]=(useNew)?'darken':so;output[modes.LIGHTEN]=(useNew)?'lighten':so;output[modes.COLOR_DODGE]=(useNew)?'color-dodge':so;output[modes.COLOR_BURN]=(useNew)?'color-burn':so;output[modes.HARD_LIGHT]=(useNew)?'hard-light':so;output[modes.SOFT_LIGHT]=(useNew)?'soft-light':so;output[modes.DIFFERENCE]=(useNew)?'difference':so;output[modes.EXCLUSION]=(useNew)?'exclusion':so;output[modes.HUE]=(useNew)?'hue':so;output[modes.SATURATION]=(useNew)?'saturation':so;output[modes.COLOR]=(useNew)?'color':so;output[modes.LUMINOSITY]=(useNew)?'luminosity':so;output[modes.ERASE]='destination-out';output[modes.SOURCE_IN]='source-in';output[modes.SOURCE_OUT]='source-out';output[modes.SOURCE_ATOP]='source-atop';output[modes.DESTINATION_OVER]='destination-over';output[modes.DESTINATION_IN]='destination-in';output[modes.DESTINATION_OUT]='destination-out';output[modes.DESTINATION_ATOP]='destination-atop';output[modes.LIGHTER]='lighter';output[modes.COPY]='copy';output[modes.XOR]='xor';return output};module.exports=GetBlendModes}),(function(module,exports,__webpack_require__){var BaseCamera=__webpack_require__(91);var CameraEvents=__webpack_require__(40);var Class=__webpack_require__(0);var CONST=__webpack_require__(33);var GameEvents=__webpack_require__(20);var IsSizePowerOfTwo=__webpack_require__(120);var NOOP=__webpack_require__(1);var ScaleEvents=__webpack_require__(92);var SpliceOne=__webpack_require__(80);var TextureEvents=__webpack_require__(121);var TransformMatrix=__webpack_require__(29);var Utils=__webpack_require__(9);var WebGLSnapshot=__webpack_require__(509);var BitmapMaskPipeline=__webpack_require__(510);var ForwardDiffuseLightPipeline=__webpack_require__(511);var TextureTintPipeline=__webpack_require__(237);var TextureTintStripPipeline=__webpack_require__(512);var WebGLRenderer=new Class({initialize:function WebGLRenderer(game){var gameConfig=game.config;var contextCreationConfig={alpha:gameConfig.transparent,desynchronized:gameConfig.desynchronized,depth:false,antialias:gameConfig.antialiasGL,premultipliedAlpha:gameConfig.premultipliedAlpha,stencil:true,failIfMajorPerformanceCaveat:gameConfig.failIfMajorPerformanceCaveat,powerPreference:gameConfig.powerPreference};this.config={clearBeforeRender:gameConfig.clearBeforeRender,antialias:gameConfig.antialias,backgroundColor:gameConfig.backgroundColor,contextCreation:contextCreationConfig,resolution:gameConfig.resolution,roundPixels:gameConfig.roundPixels,maxTextures:gameConfig.maxTextures,maxTextureSize:gameConfig.maxTextureSize,batchSize:gameConfig.batchSize,maxLights:gameConfig.maxLights,mipmapFilter:gameConfig.mipmapFilter};this.game=game;this.type=CONST.WEBGL;this.width=0;this.height=0;this.canvas=game.canvas;this.blendModes=[];this.nativeTextures=[];this.contextLost=false;this.pipelines=null;this.snapshotState={x:0,y:0,width:1,height:1,getPixel:false,callback:null,type:'image/png',encoder:0.92,isFramebuffer:false,bufferWidth:0,bufferHeight:0};this.currentActiveTextureUnit=0;this.currentTextures=new Array(16);this.currentFramebuffer=null;this.currentPipeline=null;this.currentProgram=null;this.currentVertexBuffer=null;this.currentIndexBuffer=null;this.currentBlendMode=Infinity;this.currentScissorEnabled=false;this.currentScissor=null;this.scissorStack=[];this.contextLostHandler=NOOP;this.contextRestoredHandler=NOOP;this.gl=null;this.supportedExtensions=null;this.extensions={};this.glFormats=[];this.compression={ETC1:false,PVRTC:false,S3TC:false};this.drawingBufferHeight=0;this.blankTexture=null;this.defaultCamera=new BaseCamera(0,0,0,0);this._tempMatrix1=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempMatrix3=new TransformMatrix();this._tempMatrix4=new TransformMatrix();this.maskCount=0;this.maskStack=[];this.currentMask={mask:null,camera:null};this.currentCameraMask={mask:null,camera:null};this.glFuncMap=null;this.currentType='';this.newType=false;this.nextTypeMatch=false;this.mipmapFilter=null;this.init(this.config)},init:function(config){var gl;var game=this.game;var canvas=this.canvas;var clearColor=config.backgroundColor;if(game.config.context){gl=game.config.context}else{gl=canvas.getContext('webgl',config.contextCreation)||canvas.getContext('experimental-webgl',config.contextCreation)}if(!gl||gl.isContextLost()){this.contextLost=true;throw new Error('WebGL unsupported')}this.gl=gl;var _this=this;this.contextLostHandler=function(event){_this.contextLost=true;_this.game.events.emit(GameEvents.CONTEXT_LOST,_this);event.preventDefault()};this.contextRestoredHandler=function(){_this.contextLost=false;_this.init(_this.config);_this.game.events.emit(GameEvents.CONTEXT_RESTORED,_this)};canvas.addEventListener('webglcontextlost',this.contextLostHandler,false);canvas.addEventListener('webglcontextrestored',this.contextRestoredHandler,false);game.context=gl;for(var i=0;i<=27;i++){this.blendModes.push({func:[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],equation:gl.FUNC_ADD})}this.blendModes[1].func=[gl.ONE,gl.DST_ALPHA];this.blendModes[2].func=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA];this.blendModes[3].func=[gl.ONE,gl.ONE_MINUS_SRC_COLOR];this.blendModes[17]={func:[gl.ZERO,gl.ONE_MINUS_SRC_ALPHA],equation:gl.FUNC_REVERSE_SUBTRACT};this.glFormats[0]=gl.BYTE;this.glFormats[1]=gl.SHORT;this.glFormats[2]=gl.UNSIGNED_BYTE;this.glFormats[3]=gl.UNSIGNED_SHORT;this.glFormats[4]=gl.FLOAT;this.glFuncMap={mat2:{func:gl.uniformMatrix2fv,length:1,matrix:true},mat3:{func:gl.uniformMatrix3fv,length:1,matrix:true},mat4:{func:gl.uniformMatrix4fv,length:1,matrix:true},'1f':{func:gl.uniform1f,length:1},'1fv':{func:gl.uniform1fv,length:1},'1i':{func:gl.uniform1i,length:1},'1iv':{func:gl.uniform1iv,length:1},'2f':{func:gl.uniform2f,length:2},'2fv':{func:gl.uniform2fv,length:1},'2i':{func:gl.uniform2i,length:2},'2iv':{func:gl.uniform2iv,length:1},'3f':{func:gl.uniform3f,length:3},'3fv':{func:gl.uniform3fv,length:1},'3i':{func:gl.uniform3i,length:3},'3iv':{func:gl.uniform3iv,length:1},'4f':{func:gl.uniform4f,length:4},'4fv':{func:gl.uniform4fv,length:1},'4i':{func:gl.uniform4i,length:4},'4iv':{func:gl.uniform4iv,length:1}};var exts=gl.getSupportedExtensions();if(!config.maxTextures){config.maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS)}if(!config.maxTextureSize){config.maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE)}var extString='WEBGL_compressed_texture_';var wkExtString='WEBKIT_'+extString;this.compression.ETC1=gl.getExtension(extString+'etc1')||gl.getExtension(wkExtString+'etc1');this.compression.PVRTC=gl.getExtension(extString+'pvrtc')||gl.getExtension(wkExtString+'pvrtc');this.compression.S3TC=gl.getExtension(extString+'s3tc')||gl.getExtension(wkExtString+'s3tc');this.supportedExtensions=exts;gl.disable(gl.DEPTH_TEST);gl.disable(gl.CULL_FACE);gl.enable(gl.BLEND);gl.clearColor(clearColor.redGL,clearColor.greenGL,clearColor.blueGL,clearColor.alphaGL);this.mipmapFilter=gl[config.mipmapFilter];for(var index=0;index<this.currentTextures.length;++index){this.currentTextures[index]=null}this.pipelines={};this.addPipeline('TextureTintPipeline',new TextureTintPipeline({game:game,renderer:this}));this.addPipeline('TextureTintStripPipeline',new TextureTintStripPipeline({game:game,renderer:this}));this.addPipeline('BitmapMaskPipeline',new BitmapMaskPipeline({game:game,renderer:this}));this.addPipeline('Light2D',new ForwardDiffuseLightPipeline({game:game,renderer:this,maxLights:config.maxLights}));this.setBlendMode(CONST.BlendModes.NORMAL);game.textures.once(TextureEvents.READY,this.boot,this);return this},boot:function(){for(var pipelineName in this.pipelines){this.pipelines[pipelineName].boot()}var blank=this.game.textures.getFrame('__DEFAULT');this.pipelines.TextureTintPipeline.currentFrame=blank;this.blankTexture=blank;var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,null);gl.enable(gl.SCISSOR_TEST);this.setPipeline(this.pipelines.TextureTintPipeline);this.game.scale.on(ScaleEvents.RESIZE,this.onResize,this);var baseSize=this.game.scale.baseSize;this.resize(baseSize.width,baseSize.height,this.game.scale.resolution)},onResize:function(gameSize,baseSize,displaySize,resolution){if(baseSize.width!==this.width||baseSize.height!==this.height||resolution!==this.resolution){this.resize(baseSize.width,baseSize.height,resolution)}},resize:function(width,height,resolution){var gl=this.gl;var pipelines=this.pipelines;this.width=width;this.height=height;this.resolution=resolution;gl.viewport(0,0,width,height);for(var pipelineName in pipelines){pipelines[pipelineName].resize(width,height,resolution)}this.drawingBufferHeight=gl.drawingBufferHeight;gl.scissor(0,(gl.drawingBufferHeight-height),width,height);this.defaultCamera.setSize(width,height);return this},hasExtension:function(extensionName){return this.supportedExtensions?this.supportedExtensions.indexOf(extensionName):false},getExtension:function(extensionName){if(!this.hasExtension(extensionName)){return null}if(!(extensionName in this.extensions)){this.extensions[extensionName]=this.gl.getExtension(extensionName)}return this.extensions[extensionName]},flush:function(){if(this.currentPipeline){this.currentPipeline.flush()}},hasPipeline:function(pipelineName){return(pipelineName in this.pipelines)},getPipeline:function(pipelineName){return(this.hasPipeline(pipelineName))?this.pipelines[pipelineName]:null},removePipeline:function(pipelineName){delete this.pipelines[pipelineName];return this},addPipeline:function(pipelineName,pipelineInstance){if(!this.hasPipeline(pipelineName)){this.pipelines[pipelineName]=pipelineInstance}else{console.warn('Pipeline exists: '+pipelineName)}pipelineInstance.name=pipelineName;this.pipelines[pipelineName].resize(this.width,this.height,this.config.resolution);return pipelineInstance},pushScissor:function(x,y,width,height,drawingBufferHeight){if(drawingBufferHeight===undefined){drawingBufferHeight=this.drawingBufferHeight}var scissorStack=this.scissorStack;var scissor=[x,y,width,height];scissorStack.push(scissor);this.setScissor(x,y,width,height,drawingBufferHeight);this.currentScissor=scissor;return scissor},setScissor:function(x,y,width,height,drawingBufferHeight){if(drawingBufferHeight===undefined){drawingBufferHeight=this.drawingBufferHeight}var gl=this.gl;var current=this.currentScissor;var setScissor=(width>0&&height>0);if(current&&setScissor){var cx=current[0];var cy=current[1];var cw=current[2];var ch=current[3];setScissor=(cx!==x||cy!==y||cw!==width||ch!==height)}if(setScissor){this.flush();gl.scissor(x,(drawingBufferHeight-y-height),width,height)}},popScissor:function(){var scissorStack=this.scissorStack;scissorStack.pop();var scissor=scissorStack[scissorStack.length-1];if(scissor){this.setScissor(scissor[0],scissor[1],scissor[2],scissor[3])}this.currentScissor=scissor},setPipeline:function(pipelineInstance,gameObject){if(this.currentPipeline!==pipelineInstance||this.currentPipeline.vertexBuffer!==this.currentVertexBuffer||this.currentPipeline.program!==this.currentProgram){this.flush();this.currentPipeline=pipelineInstance;this.currentPipeline.bind()}this.currentPipeline.onBind(gameObject);return this.currentPipeline},hasActiveStencilMask:function(){var mask=this.currentMask.mask;var camMask=this.currentCameraMask.mask;return((mask&&mask.isStencil)||(camMask&&camMask.isStencil))},rebindPipeline:function(pipelineInstance){var gl=this.gl;gl.disable(gl.DEPTH_TEST);gl.disable(gl.CULL_FACE);if(this.hasActiveStencilMask()){gl.clear(gl.DEPTH_BUFFER_BIT)}else{gl.disable(gl.STENCIL_TEST);gl.clear(gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT)}gl.viewport(0,0,this.width,this.height);this.setBlendMode(0,true);gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,this.blankTexture.glTexture);this.currentActiveTextureUnit=0;this.currentTextures[0]=this.blankTexture.glTexture;this.currentPipeline=pipelineInstance;this.currentPipeline.bind();this.currentPipeline.onBind()},clearPipeline:function(){this.flush();this.currentPipeline=null;this.currentProgram=null;this.currentVertexBuffer=null;this.currentIndexBuffer=null;this.setBlendMode(0,true)},setBlendMode:function(blendModeId,force){if(force===undefined){force=false}var gl=this.gl;var blendMode=this.blendModes[blendModeId];if(force||(blendModeId!==CONST.BlendModes.SKIP_CHECK&&this.currentBlendMode!==blendModeId)){this.flush();gl.enable(gl.BLEND);gl.blendEquation(blendMode.equation);if(blendMode.func.length>2){gl.blendFuncSeparate(blendMode.func[0],blendMode.func[1],blendMode.func[2],blendMode.func[3])}else{gl.blendFunc(blendMode.func[0],blendMode.func[1])}this.currentBlendMode=blendModeId;return true}return false},addBlendMode:function(func,equation){var index=this.blendModes.push({func:func,equation:equation});return index-1},updateBlendMode:function(index,func,equation){if(this.blendModes[index]){this.blendModes[index].func=func;if(equation){this.blendModes[index].equation=equation}}return this},removeBlendMode:function(index){if(index>17&&this.blendModes[index]){this.blendModes.splice(index,1)}return this},setBlankTexture:function(force){if(force===undefined){force=false}if(force||this.currentActiveTextureUnit!==0||!this.currentTextures[0]){this.setTexture2D(this.blankTexture.glTexture,0)}},setTexture2D:function(texture,textureUnit,flush){if(flush===undefined){flush=true}var gl=this.gl;if(texture!==this.currentTextures[textureUnit]){if(flush){this.flush()}if(this.currentActiveTextureUnit!==textureUnit){gl.activeTexture(gl.TEXTURE0+textureUnit);this.currentActiveTextureUnit=textureUnit}gl.bindTexture(gl.TEXTURE_2D,texture);this.currentTextures[textureUnit]=texture}return this},setFramebuffer:function(framebuffer,updateScissor){if(updateScissor===undefined){updateScissor=false}var gl=this.gl;var width=this.width;var height=this.height;if(framebuffer!==this.currentFramebuffer){if(framebuffer&&framebuffer.renderTexture){width=framebuffer.renderTexture.width;height=framebuffer.renderTexture.height}else{this.flush()}gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);gl.viewport(0,0,width,height);if(updateScissor){if(framebuffer){this.drawingBufferHeight=height;this.pushScissor(0,0,width,height)}else{this.drawingBufferHeight=this.height;this.popScissor()}}this.currentFramebuffer=framebuffer}return this},setProgram:function(program){var gl=this.gl;if(program!==this.currentProgram){this.flush();gl.useProgram(program);this.currentProgram=program}return this},setVertexBuffer:function(vertexBuffer){var gl=this.gl;if(vertexBuffer!==this.currentVertexBuffer){this.flush();gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);this.currentVertexBuffer=vertexBuffer}return this},setIndexBuffer:function(indexBuffer){var gl=this.gl;if(indexBuffer!==this.currentIndexBuffer){this.flush();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,indexBuffer);this.currentIndexBuffer=indexBuffer}return this},createTextureFromSource:function(source,width,height,scaleMode){var gl=this.gl;var minFilter=gl.NEAREST;var magFilter=gl.NEAREST;var wrap=gl.CLAMP_TO_EDGE;var texture=null;width=source?source.width:width;height=source?source.height:height;var pow=IsSizePowerOfTwo(width,height);if(pow){wrap=gl.REPEAT}if(scaleMode===CONST.ScaleModes.LINEAR&&this.config.antialias){minFilter=(pow)?this.mipmapFilter:gl.LINEAR;magFilter=gl.LINEAR}if(!source&&typeof width==='number'&&typeof height==='number'){texture=this.createTexture2D(0,minFilter,magFilter,wrap,wrap,gl.RGBA,null,width,height)}else{texture=this.createTexture2D(0,minFilter,magFilter,wrap,wrap,gl.RGBA,source)}return texture},createTexture2D:function(mipLevel,minFilter,magFilter,wrapT,wrapS,format,pixels,width,height,pma,forceSize,flipY){pma=(pma===undefined||pma===null)?true:pma;if(forceSize===undefined){forceSize=false}if(flipY===undefined){flipY=false}var gl=this.gl;var texture=gl.createTexture();this.setTexture2D(texture,0);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pma);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY);if(pixels===null||pixels===undefined){gl.texImage2D(gl.TEXTURE_2D,mipLevel,format,width,height,0,format,gl.UNSIGNED_BYTE,null)}else{if(!forceSize){width=pixels.width;height=pixels.height}gl.texImage2D(gl.TEXTURE_2D,mipLevel,format,format,gl.UNSIGNED_BYTE,pixels)}if(IsSizePowerOfTwo(width,height)){gl.generateMipmap(gl.TEXTURE_2D)}this.setTexture2D(null,0);texture.isAlphaPremultiplied=pma;texture.isRenderTexture=false;texture.width=width;texture.height=height;this.nativeTextures.push(texture);return texture},createFramebuffer:function(width,height,renderTexture,addDepthStencilBuffer){var gl=this.gl;var framebuffer=gl.createFramebuffer();var complete=0;this.setFramebuffer(framebuffer);if(addDepthStencilBuffer){var depthStencilBuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,depthStencilBuffer);gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,depthStencilBuffer)}renderTexture.isRenderTexture=true;renderTexture.isAlphaPremultiplied=false;gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,renderTexture,0);complete=gl.checkFramebufferStatus(gl.FRAMEBUFFER);if(complete!==gl.FRAMEBUFFER_COMPLETE){var errors={36054:'Incomplete Attachment',36055:'Missing Attachment',36057:'Incomplete Dimensions',36061:'Framebuffer Unsupported'};throw new Error('Framebuffer incomplete. Framebuffer status: '+errors[complete])}framebuffer.renderTexture=renderTexture;this.setFramebuffer(null);return framebuffer},createProgram:function(vertexShader,fragmentShader){var gl=this.gl;var program=gl.createProgram();var vs=gl.createShader(gl.VERTEX_SHADER);var fs=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(vs,vertexShader);gl.shaderSource(fs,fragmentShader);gl.compileShader(vs);gl.compileShader(fs);if(!gl.getShaderParameter(vs,gl.COMPILE_STATUS)){throw new Error('Failed to compile Vertex Shader:\.'+gl.getShaderInfoLog(vs))}if(!gl.getShaderParameter(fs,gl.COMPILE_STATUS)){throw new Error('Failed to compile Fragment Shader:\d'+gl.getShaderInfoLog(fs))}gl.attachShader(program,vs);gl.attachShader(program,fs);gl.linkProgram(program);if(!gl.getProgramParameter(program,gl.LINK_STATUS)){throw new Error('Failed to link program:\/'+gl.getProgramInfoLog(program))}return program},createVertexBuffer:function(initialDataOrSize,bufferUsage){var gl=this.gl;var vertexBuffer=gl.createBuffer();this.setVertexBuffer(vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,initialDataOrSize,bufferUsage);this.setVertexBuffer(null);return vertexBuffer},createIndexBuffer:function(initialDataOrSize,bufferUsage){var gl=this.gl;var indexBuffer=gl.createBuffer();this.setIndexBuffer(indexBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,initialDataOrSize,bufferUsage);this.setIndexBuffer(null);return indexBuffer},deleteTexture:function(texture){var index=this.nativeTextures.indexOf(texture);if(index!==-1){SpliceOne(this.nativeTextures,index)}this.gl.deleteTexture(texture);if(this.currentTextures[0]===texture&&!this.game.pendingDestroy){this.setBlankTexture(true)}return this},deleteFramebuffer:function(framebuffer){this.gl.deleteFramebuffer(framebuffer);return this},deleteProgram:function(program){this.gl.deleteProgram(program);return this},deleteBuffer:function(buffer){this.gl.deleteBuffer(buffer);return this},preRenderCamera:function(camera){var cx=camera._cx;var cy=camera._cy;var cw=camera._cw;var ch=camera._ch;var TextureTintPipeline=this.pipelines.TextureTintPipeline;var color=camera.backgroundColor;if(camera.renderToTexture){this.flush();this.pushScissor(cx,cy,cw,-ch);this.setFramebuffer(camera.framebuffer);var gl=this.gl;gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT);TextureTintPipeline.projOrtho(cx,cw+cx,cy,ch+cy,-1000,1000);if(camera.mask){this.currentCameraMask.mask=camera.mask;this.currentCameraMask.camera=camera._maskCamera;camera.mask.preRenderWebGL(this,camera,camera._maskCamera)}if(color.alphaGL>0){TextureTintPipeline.drawFillRect(cx,cy,cw+cx,ch+cy,Utils.getTintFromFloats(color.redGL,color.greenGL,color.blueGL,1),color.alphaGL)}camera.emit(CameraEvents.PRE_RENDER,camera)}else{this.pushScissor(cx,cy,cw,ch);if(camera.mask){this.currentCameraMask.mask=camera.mask;this.currentCameraMask.camera=camera._maskCamera;camera.mask.preRenderWebGL(this,camera,camera._maskCamera)}if(color.alphaGL>0){TextureTintPipeline.drawFillRect(cx,cy,cw,ch,Utils.getTintFromFloats(color.redGL,color.greenGL,color.blueGL,1),color.alphaGL)}}},getCurrentStencilMask:function(){var prev=null;var stack=this.maskStack;var cameraMask=this.currentCameraMask;if(stack.length>0){prev=stack[stack.length-1]}else if(cameraMask.mask&&cameraMask.mask.isStencil){prev=cameraMask}return prev},postRenderCamera:function(camera){this.setPipeline(this.pipelines.TextureTintPipeline);var TextureTintPipeline=this.pipelines.TextureTintPipeline;camera.flashEffect.postRenderWebGL(TextureTintPipeline,Utils.getTintFromFloats);camera.fadeEffect.postRenderWebGL(TextureTintPipeline,Utils.getTintFromFloats);camera.dirty=false;this.popScissor();if(camera.renderToTexture){TextureTintPipeline.flush();this.setFramebuffer(null);camera.emit(CameraEvents.POST_RENDER,camera);if(camera.renderToGame){TextureTintPipeline.projOrtho(0,TextureTintPipeline.width,TextureTintPipeline.height,0,-1000.0,1000.0);var getTint=Utils.getTintAppendFloatAlpha;var pipeline=(camera.pipeline)?camera.pipeline:TextureTintPipeline;pipeline.batchTexture(camera,camera.glTexture,camera.width,camera.height,camera.x,camera.y,camera.width,camera.height,camera.zoom,camera.zoom,camera.rotation,camera.flipX,!camera.flipY,1,1,0,0,0,0,camera.width,camera.height,getTint(camera._tintTL,camera._alphaTL),getTint(camera._tintTR,camera._alphaTR),getTint(camera._tintBL,camera._alphaBL),getTint(camera._tintBR,camera._alphaBR),(camera._isTinted&&camera.tintFill),0,0,this.defaultCamera,null)}this.setBlankTexture(true)}if(camera.mask){this.currentCameraMask.mask=null;camera.mask.postRenderWebGL(this,camera._maskCamera)}},preRender:function(){if(this.contextLost){return}var gl=this.gl;var pipelines=this.pipelines;gl.bindFramebuffer(gl.FRAMEBUFFER,null);if(this.config.clearBeforeRender){var clearColor=this.config.backgroundColor;gl.clearColor(clearColor.redGL,clearColor.greenGL,clearColor.blueGL,clearColor.alphaGL);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT)}gl.enable(gl.SCISSOR_TEST);for(var key in pipelines){pipelines[key].onPreRender()}this.currentScissor=[0,0,this.width,this.height];this.scissorStack=[this.currentScissor];if(this.game.scene.customViewports){gl.scissor(0,(this.drawingBufferHeight-this.height),this.width,this.height)}this.currentMask.mask=null;this.currentCameraMask.mask=null;this.maskStack.length=0;this.setPipeline(this.pipelines.TextureTintPipeline)},render:function(scene,children,interpolationPercentage,camera){if(this.contextLost){return}var list=children.list;var childCount=list.length;var pipelines=this.pipelines;for(var key in pipelines){pipelines[key].onRender(scene,camera)}this.preRenderCamera(camera);if(childCount===0){this.setBlendMode(CONST.BlendModes.NORMAL);this.postRenderCamera(camera);return}this.currentType='';var current=this.currentMask;for(var i=0;i<childCount;i++){var child=list[i];if(!child.willRender(camera)){continue}if(child.blendMode!==this.currentBlendMode){this.setBlendMode(child.blendMode)}var mask=child.mask;current=this.currentMask;if(current.mask&&current.mask!==mask){current.mask.postRenderWebGL(this,current.camera)}if(mask&&current.mask!==mask){mask.preRenderWebGL(this,child,camera)}var type=child.type;if(type!==this.currentType){this.newType=true;this.currentType=type}this.nextTypeMatch=(i<childCount-1)?(list[i+1].type===this.currentType):false;child.renderWebGL(this,child,interpolationPercentage,camera);this.newType=false}current=this.currentMask;if(current.mask){current.mask.postRenderWebGL(this,current.camera)}this.setBlendMode(CONST.BlendModes.NORMAL);this.postRenderCamera(camera)},postRender:function(){if(this.contextLost){return}this.flush();var state=this.snapshotState;if(state.callback){WebGLSnapshot(this.canvas,state);state.callback=null}var pipelines=this.pipelines;for(var key in pipelines){pipelines[key].onPostRender()}},snapshot:function(callback,type,encoderOptions){return this.snapshotArea(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight,callback,type,encoderOptions)},snapshotArea:function(x,y,width,height,callback,type,encoderOptions){var state=this.snapshotState;state.callback=callback;state.type=type;state.encoder=encoderOptions;state.getPixel=false;state.x=x;state.y=y;state.width=Math.min(width,this.gl.drawingBufferWidth);state.height=Math.min(height,this.gl.drawingBufferHeight);return this},snapshotPixel:function(x,y,callback){this.snapshotArea(x,y,1,1,callback);this.snapshotState.getPixel=true;return this},snapshotFramebuffer:function(framebuffer,bufferWidth,bufferHeight,callback,getPixel,x,y,width,height,type,encoderOptions){if(getPixel===undefined){getPixel=false}if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=bufferWidth}if(height===undefined){height=bufferHeight}var currentFramebuffer=this.currentFramebuffer;this.snapshotArea(x,y,width,height,callback,type,encoderOptions);var state=this.snapshotState;state.getPixel=getPixel;state.isFramebuffer=true;state.bufferWidth=bufferWidth;state.bufferHeight=bufferHeight;this.setFramebuffer(framebuffer);WebGLSnapshot(this.canvas,state);this.setFramebuffer(currentFramebuffer);state.callback=null;state.isFramebuffer=false;return this},canvasToTexture:function(srcCanvas,dstTexture,noRepeat,flipY){if(noRepeat===undefined){noRepeat=false}if(flipY===undefined){flipY=false}if(!dstTexture){return this.createCanvasTexture(srcCanvas,noRepeat,flipY)}else{return this.updateCanvasTexture(srcCanvas,dstTexture,flipY)}},createCanvasTexture:function(srcCanvas,noRepeat,flipY){if(noRepeat===undefined){noRepeat=false}if(flipY===undefined){flipY=false}var gl=this.gl;var minFilter=gl.NEAREST;var magFilter=gl.NEAREST;var width=srcCanvas.width;var height=srcCanvas.height;var wrapping=gl.CLAMP_TO_EDGE;var pow=IsSizePowerOfTwo(width,height);if(!noRepeat&&pow){wrapping=gl.REPEAT}if(this.config.antialias){minFilter=(pow)?this.mipmapFilter:gl.LINEAR;magFilter=gl.LINEAR}return this.createTexture2D(0,minFilter,magFilter,wrapping,wrapping,gl.RGBA,srcCanvas,width,height,true,false,flipY)},updateCanvasTexture:function(srcCanvas,dstTexture,flipY){if(flipY===undefined){flipY=false}var gl=this.gl;var width=srcCanvas.width;var height=srcCanvas.height;if(width>0&&height>0){this.setTexture2D(dstTexture,0);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,srcCanvas);dstTexture.width=width;dstTexture.height=height;this.setTexture2D(null,0)}return dstTexture},createVideoTexture:function(srcVideo,noRepeat,flipY){if(noRepeat===undefined){noRepeat=false}if(flipY===undefined){flipY=false}var gl=this.gl;var minFilter=gl.NEAREST;var magFilter=gl.NEAREST;var width=srcVideo.videoWidth;var height=srcVideo.videoHeight;var wrapping=gl.CLAMP_TO_EDGE;var pow=IsSizePowerOfTwo(width,height);if(!noRepeat&&pow){wrapping=gl.REPEAT}if(this.config.antialias){minFilter=(pow)?this.mipmapFilter:gl.LINEAR;magFilter=gl.LINEAR}return this.createTexture2D(0,minFilter,magFilter,wrapping,wrapping,gl.RGBA,srcVideo,width,height,true,true,flipY)},updateVideoTexture:function(srcVideo,dstTexture,flipY){if(flipY===undefined){flipY=false}var gl=this.gl;var width=srcVideo.videoWidth;var height=srcVideo.videoHeight;if(width>0&&height>0){this.setTexture2D(dstTexture,0);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,srcVideo);dstTexture.width=width;dstTexture.height=height;this.setTexture2D(null,0)}return dstTexture},setTextureFilter:function(texture,filter){var gl=this.gl;var glFilter=[gl.LINEAR,gl.NEAREST][filter];this.setTexture2D(texture,0);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,glFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,glFilter);this.setTexture2D(null,0);return this},setFloat1:function(program,name,x){this.setProgram(program);this.gl.uniform1f(this.gl.getUniformLocation(program,name),x);return this},setFloat2:function(program,name,x,y){this.setProgram(program);this.gl.uniform2f(this.gl.getUniformLocation(program,name),x,y);return this},setFloat3:function(program,name,x,y,z){this.setProgram(program);this.gl.uniform3f(this.gl.getUniformLocation(program,name),x,y,z);return this},setFloat4:function(program,name,x,y,z,w){this.setProgram(program);this.gl.uniform4f(this.gl.getUniformLocation(program,name),x,y,z,w);return this},setFloat1v:function(program,name,arr){this.setProgram(program);this.gl.uniform1fv(this.gl.getUniformLocation(program,name),arr);return this},setFloat2v:function(program,name,arr){this.setProgram(program);this.gl.uniform2fv(this.gl.getUniformLocation(program,name),arr);return this},setFloat3v:function(program,name,arr){this.setProgram(program);this.gl.uniform3fv(this.gl.getUniformLocation(program,name),arr);return this},setFloat4v:function(program,name,arr){this.setProgram(program);this.gl.uniform4fv(this.gl.getUniformLocation(program,name),arr);return this},setInt1:function(program,name,x){this.setProgram(program);this.gl.uniform1i(this.gl.getUniformLocation(program,name),x);return this},setInt2:function(program,name,x,y){this.setProgram(program);this.gl.uniform2i(this.gl.getUniformLocation(program,name),x,y);return this},setInt3:function(program,name,x,y,z){this.setProgram(program);this.gl.uniform3i(this.gl.getUniformLocation(program,name),x,y,z);return this},setInt4:function(program,name,x,y,z,w){this.setProgram(program);this.gl.uniform4i(this.gl.getUniformLocation(program,name),x,y,z,w);return this},setMatrix2:function(program,name,transpose,matrix){this.setProgram(program);this.gl.uniformMatrix2fv(this.gl.getUniformLocation(program,name),transpose,matrix);return this},setMatrix3:function(program,name,transpose,matrix){this.setProgram(program);this.gl.uniformMatrix3fv(this.gl.getUniformLocation(program,name),transpose,matrix);return this},setMatrix4:function(program,name,transpose,matrix){this.setProgram(program);this.gl.uniformMatrix4fv(this.gl.getUniformLocation(program,name),transpose,matrix);return this},getMaxTextures:function(){return this.config.maxTextures},getMaxTextureSize:function(){return this.config.maxTextureSize},destroy:function(){for(var i=0;i<this.nativeTextures.length;i++){this.gl.deleteTexture(this.nativeTextures[i])}this.nativeTextures=[];for(var key in this.pipelines){this.pipelines[key].destroy();delete this.pipelines[key]}this.defaultCamera.destroy();this.currentMask=null;this.currentCameraMask=null;this.canvas.removeEventListener('webglcontextlost',this.contextLostHandler,false);this.canvas.removeEventListener('webglcontextrestored',this.contextRestoredHandler,false);this.game=null;this.gl=null;this.canvas=null;this.maskStack=[];this.contextLost=true;this.extensions={}}});module.exports=WebGLRenderer}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var Color=__webpack_require__(31);var GetFastValue=__webpack_require__(2);var WebGLSnapshot=function(sourceCanvas,config){var gl=sourceCanvas.getContext('experimental-webgl');var callback=GetFastValue(config,'callback');var type=GetFastValue(config,'type','image/png');var encoderOptions=GetFastValue(config,'encoder',0.92);var x=GetFastValue(config,'x',0);var y=GetFastValue(config,'y',0);var getPixel=GetFastValue(config,'getPixel',false);var isFramebuffer=GetFastValue(config,'isFramebuffer',false);var bufferWidth=(isFramebuffer)?GetFastValue(config,'bufferWidth',1):gl.drawingBufferWidth;var bufferHeight=(isFramebuffer)?GetFastValue(config,'bufferHeight',1):gl.drawingBufferHeight;if(getPixel){var pixel=new Uint8Array(4);var destY=(isFramebuffer)?y:bufferHeight-y;gl.readPixels(x,destY,1,1,gl.RGBA,gl.UNSIGNED_BYTE,pixel);callback.call(null,new Color(pixel[0],pixel[1],pixel[2],pixel[3]/255))}else{var width=GetFastValue(config,'width',bufferWidth);var height=GetFastValue(config,'height',bufferHeight);var total=width*height*4;var pixels=new Uint8Array(total);gl.readPixels(x,bufferHeight-y-height,width,height,gl.RGBA,gl.UNSIGNED_BYTE,pixels);var canvas=CanvasPool.createWebGL(this,width,height);var ctx=canvas.getContext('2d');var imageData=ctx.getImageData(0,0,width,height);var data=imageData.data;for(var py=0;py<height;py++){for(var px=0;px<width;px++){var sourceIndex=((height-py)*width+px)*4;var destIndex=(isFramebuffer)?total-((py*width+(width-px))*4):(py*width+px)*4;data[destIndex+0]=pixels[sourceIndex+0];data[destIndex+1]=pixels[sourceIndex+1];data[destIndex+2]=pixels[sourceIndex+2];data[destIndex+3]=pixels[sourceIndex+3]}}ctx.putImageData(imageData,0,0);var image=new Image();image.onerror=function(){callback.call(null);CanvasPool.remove(canvas)};image.onload=function(){callback.call(null,image);CanvasPool.remove(canvas)};image.src=canvas.toDataURL(type,encoderOptions)}};module.exports=WebGLSnapshot}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var ShaderSourceFS=__webpack_require__(786);var ShaderSourceVS=__webpack_require__(787);var WebGLPipeline=__webpack_require__(147);var BitmapMaskPipeline=new Class({Extends:WebGLPipeline,initialize:function BitmapMaskPipeline(config){WebGLPipeline.call(this,{game:config.game,renderer:config.renderer,gl:config.renderer.gl,topology:(config.topology?config.topology:config.renderer.gl.TRIANGLES),vertShader:(config.vertShader?config.vertShader:ShaderSourceVS),fragShader:(config.fragShader?config.fragShader:ShaderSourceFS),vertexCapacity:(config.vertexCapacity?config.vertexCapacity:3),vertexSize:(config.vertexSize?config.vertexSize:Float32Array.BYTES_PER_ELEMENT*2),vertices:new Float32Array([-1,+1,-1,-7,+7,+1]).buffer,attributes:[{name:'inPosition',size:2,type:config.renderer.gl.FLOAT,normalized:false,offset:0}]});this.vertexViewF32=new Float32Array(this.vertexData);this.maxQuads=1;this.resolutionDirty=true},onBind:function(){WebGLPipeline.prototype.onBind.call(this);var renderer=this.renderer;var program=this.program;if(this.resolutionDirty){renderer.setFloat2(program,'uResolution',this.width,this.height);renderer.setInt1(program,'uMainSampler',0);renderer.setInt1(program,'uMaskSampler',1);this.resolutionDirty=false}return this},resize:function(width,height,resolution){WebGLPipeline.prototype.resize.call(this,width,height,resolution);this.resolutionDirty=true;return this},beginMask:function(mask,maskedObject,camera){var renderer=this.renderer;var gl=this.gl;var bitmapMask=mask.bitmapMask;if(bitmapMask&&gl){renderer.flush();mask.prevFramebuffer=renderer.currentFramebuffer;renderer.setFramebuffer(mask.mainFramebuffer);gl.disable(gl.STENCIL_TEST);gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT);if(renderer.currentCameraMask.mask!==mask){renderer.currentMask.mask=mask;renderer.currentMask.camera=camera}}},endMask:function(mask,camera){var gl=this.gl;var renderer=this.renderer;var bitmapMask=mask.bitmapMask;if(bitmapMask&&gl){renderer.flush();renderer.setFramebuffer(mask.maskFramebuffer);gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT);renderer.setBlendMode(0,true);bitmapMask.renderWebGL(renderer,bitmapMask,0,camera);renderer.flush();renderer.setFramebuffer(mask.prevFramebuffer);var prev=renderer.getCurrentStencilMask();if(prev){gl.enable(gl.STENCIL_TEST);prev.mask.applyStencil(renderer,prev.camera,true)}else{renderer.currentMask.mask=null}renderer.setPipeline(this);gl.activeTexture(gl.TEXTURE1);gl.bindTexture(gl.TEXTURE_2D,mask.maskTexture);gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,mask.mainTexture);gl.uniform1i(gl.getUniformLocation(this.program,'uInvertMaskAlpha'),mask.invertAlpha);gl.drawArrays(this.topology,0,3)}}});module.exports=BitmapMaskPipeline}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var ShaderSourceFS=__webpack_require__(788);var TextureTintPipeline=__webpack_require__(237);var LIGHT_COUNT=10;var ForwardDiffuseLightPipeline=new Class({Extends:TextureTintPipeline,initialize:function ForwardDiffuseLightPipeline(config){LIGHT_COUNT=config.maxLights;config.fragShader=ShaderSourceFS.replace('%LIGHT_COUNT%',LIGHT_COUNT.toString());TextureTintPipeline.call(this,config);this.defaultNormalMap;this.inverseRotationMatrix=new Float32Array([1,0,0,0,1,0,0,0,1])},boot:function(){this.defaultNormalMap=this.game.textures.getFrame('__DEFAULT')},onBind:function(gameObject){TextureTintPipeline.prototype.onBind.call(this);var renderer=this.renderer;var program=this.program;this.mvpUpdate();renderer.setInt1(program,'uNormSampler',1);renderer.setFloat2(program,'uResolution',this.width,this.height);if(gameObject){this.setNormalMap(gameObject)}return this},onRender:function(scene,camera){this.active=false;var lightManager=scene.sys.lights;if(!lightManager||lightManager.lights.length<=0||!lightManager.active){return this}var lights=lightManager.cull(camera);var lightCount=Math.min(lights.length,LIGHT_COUNT);if(lightCount===0){return this}this.active=true;var renderer=this.renderer;var program=this.program;var cameraMatrix=camera.matrix;var point={x:0,y:0};var height=renderer.height;var index;for(index=0;index<LIGHT_COUNT;++index){renderer.setFloat1(program,'uLights['+index+'].radius',0)}renderer.setFloat4(program,'uCamera',camera.x,camera.y,camera.rotation,camera.zoom);renderer.setFloat3(program,'uAmbientLightColor',lightManager.ambientColor.r,lightManager.ambientColor.g,lightManager.ambientColor.b);for(index=0;index<lightCount;++index){var light=lights[index];var lightName='uLights['+index+'].';cameraMatrix.transformPoint(light.x,light.y,point);renderer.setFloat2(program,lightName+'position',point.x-(camera.scrollX*light.scrollFactorX*camera.zoom),height-(point.y-(camera.scrollY*light.scrollFactorY)*camera.zoom));renderer.setFloat3(program,lightName+'color',light.r,light.g,light.b);renderer.setFloat1(program,lightName+'intensity',light.intensity);renderer.setFloat1(program,lightName+'radius',light.radius)}this.currentNormalMapRotation=null;return this},batchTexture:function(gameObject,texture,textureWidth,textureHeight,srcX,srcY,srcWidth,srcHeight,scaleX,scaleY,rotation,flipX,flipY,scrollFactorX,scrollFactorY,displayOriginX,displayOriginY,frameX,frameY,frameWidth,frameHeight,tintTL,tintTR,tintBL,tintBR,tintEffect,uOffset,vOffset,camera,parentTransformMatrix){if(!this.active){return}this.renderer.setPipeline(this);var normalTexture;if(gameObject.displayTexture){normalTexture=gameObject.displayTexture.dataSource[gameObject.displayFrame.sourceIndex]}else if(gameObject.texture){normalTexture=gameObject.texture.dataSource[gameObject.frame.sourceIndex]}else if(gameObject.tileset){if(Array.isArray(gameObject.tileset)){normalTexture=gameObject.tileset[0].image.dataSource[0]}else{normalTexture=gameObject.tileset.image.dataSource[0]}}if(!normalTexture){console.warn('Normal map missing or invalid');return}this.setTexture2D(normalTexture.glTexture,1);this.setNormalMapRotation(rotation);var camMatrix=this._tempMatrix1;var spriteMatrix=this._tempMatrix2;var calcMatrix=this._tempMatrix3;var u0=(frameX/textureWidth)+uOffset;var v0=(frameY/textureHeight)+vOffset;var u1=(frameX+frameWidth)/textureWidth+uOffset;var v1=(frameY+frameHeight)/textureHeight+vOffset;var width=srcWidth;var height=srcHeight;var x=-displayOriginX;var y=-displayOriginY;if(gameObject.isCropped){var crop=gameObject._crop;width=crop.width;height=crop.height;srcWidth=crop.width;srcHeight=crop.height;frameX=crop.x;frameY=crop.y;var ox=frameX;var oy=frameY;if(flipX){ox=(frameWidth-crop.x-crop.width)}if(flipY&&!texture.isRenderTexture){oy=(frameHeight-crop.y-crop.height)}u0=(ox/textureWidth)+uOffset;v0=(oy/textureHeight)+vOffset;u1=(ox+crop.width)/textureWidth+uOffset;v1=(oy+crop.height)/textureHeight+vOffset;x=-displayOriginX+frameX;y=-displayOriginY+frameY}flipY=flipY^(texture.isRenderTexture?1:0);if(flipX){width*=-1;x+=srcWidth}if(flipY){height*=-1;y+=srcHeight}var xw=x+width;var yh=y+height;spriteMatrix.applyITRS(srcX,srcY,rotation,scaleX,scaleY);camMatrix.copyFrom(camera.matrix);if(parentTransformMatrix){camMatrix.multiplyWithOffset(parentTransformMatrix,-camera.scrollX*scrollFactorX,-camera.scrollY*scrollFactorY);spriteMatrix.e=srcX;spriteMatrix.f=srcY;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*scrollFactorX;spriteMatrix.f-=camera.scrollY*scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(x,yh);var ty1=calcMatrix.getY(x,yh);var tx2=calcMatrix.getX(xw,yh);var ty2=calcMatrix.getY(xw,yh);var tx3=calcMatrix.getX(xw,y);var ty3=calcMatrix.getY(xw,y);if(camera.roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}this.setTexture2D(texture,0);this.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,0)},setNormalMap:function(gameObject){if(!this.active||!gameObject){return}var normalTexture;if(gameObject.texture){normalTexture=gameObject.texture.dataSource[gameObject.frame.sourceIndex]}if(!normalTexture){normalTexture=this.defaultNormalMap}this.setTexture2D(normalTexture.glTexture,1);this.renderer.setPipeline(gameObject.defaultPipeline)},setNormalMapRotation:function(rotation){if(rotation!==this.currentNormalMapRotation||this.batches.length===0){if(this.batches.length>0){this.flush()}var inverseRotationMatrix=this.inverseRotationMatrix;if(rotation){var rot=-rotation;var c=Math.cos(rot);var s=Math.sin(rot);inverseRotationMatrix[1]=s;inverseRotationMatrix[3]=-s;inverseRotationMatrix[0]=inverseRotationMatrix[4]=c}else{inverseRotationMatrix[0]=inverseRotationMatrix[4]=1;inverseRotationMatrix[1]=inverseRotationMatrix[3]=0}this.renderer.setMatrix3(this.program,'uInverseRotationMatrix',false,inverseRotationMatrix);this.currentNormalMapRotation=rotation}},batchSprite:function(sprite,camera,parentTransformMatrix){if(!this.active){return}var normalTexture=sprite.texture.dataSource[sprite.frame.sourceIndex];if(normalTexture){this.renderer.setPipeline(this);this.setTexture2D(normalTexture.glTexture,1);this.setNormalMapRotation(sprite.rotation);TextureTintPipeline.prototype.batchSprite.call(this,sprite,camera,parentTransformMatrix)}}});ForwardDiffuseLightPipeline.LIGHT_COUNT=LIGHT_COUNT;module.exports=ForwardDiffuseLightPipeline}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var ModelViewProjection=__webpack_require__(238);var ShaderSourceFS=__webpack_require__(340);var ShaderSourceVS=__webpack_require__(341);var TransformMatrix=__webpack_require__(29);var WebGLPipeline=__webpack_require__(147);var TextureTintStripPipeline=new Class({Extends:WebGLPipeline,Mixins:[ModelViewProjection],initialize:function TextureTintStripPipeline(config){var rendererConfig=config.renderer.config;WebGLPipeline.call(this,{game:config.game,renderer:config.renderer,gl:config.renderer.gl,topology:config.renderer.gl.TRIANGLE_STRIP,vertShader:GetFastValue(config,'vertShader',ShaderSourceVS),fragShader:GetFastValue(config,'fragShader',ShaderSourceFS),vertexCapacity:GetFastValue(config,'vertexCapacity',6*rendererConfig.batchSize),vertexSize:GetFastValue(config,'vertexSize',Float32Array.BYTES_PER_ELEMENT*5+Uint8Array.BYTES_PER_ELEMENT*4),attributes:[{name:'inPosition',size:2,type:config.renderer.gl.FLOAT,normalized:false,offset:0},{name:'inTexCoord',size:2,type:config.renderer.gl.FLOAT,normalized:false,offset:Float32Array.BYTES_PER_ELEMENT*2},{name:'inTintEffect',size:1,type:config.renderer.gl.FLOAT,normalized:false,offset:Float32Array.BYTES_PER_ELEMENT*4},{name:'inTint',size:4,type:config.renderer.gl.UNSIGNED_BYTE,normalized:true,offset:Float32Array.BYTES_PER_ELEMENT*5}]});this.vertexViewF32=new Float32Array(this.vertexData);this.vertexViewU32=new Uint32Array(this.vertexData);this.maxQuads=rendererConfig.batchSize;this.batches=[];this._tempMatrix1=new TransformMatrix();this._tempMatrix2=new TransformMatrix();this._tempMatrix3=new TransformMatrix();this.mvpInit()},onBind:function(){WebGLPipeline.prototype.onBind.call(this);this.mvpUpdate();return this},resize:function(width,height,resolution){WebGLPipeline.prototype.resize.call(this,width,height,resolution);this.projOrtho(0,this.width,this.height,0,-1000.0,1000.0);return this},setTexture2D:function(texture,unit){if(texture===undefined){texture=this.renderer.blankTexture.glTexture}if(unit===undefined){unit=0}if(this.requireTextureBatch(texture,unit)){this.pushBatch(texture,unit)}return this},requireTextureBatch:function(texture,unit){var batches=this.batches;var batchLength=batches.length;if(batchLength>0){var currentTexture=(unit>0)?batches[batchLength-1].textures[unit-1]:batches[batchLength-1].texture;return!(currentTexture===texture)}return true},pushBatch:function(texture,unit){if(unit===0){this.batches.push({first:this.vertexCount,texture:texture,textures:[]})}else{var textures=[];textures[unit-1]=texture;this.batches.push({first:this.vertexCount,texture:null,textures:textures})}},flush:function(){if(this.flushLocked){return this}this.flushLocked=true;var gl=this.gl;var vertexCount=this.vertexCount;var topology=this.topology;var vertexSize=this.vertexSize;var renderer=this.renderer;var batches=this.batches;var batchCount=batches.length;var batchVertexCount=0;var batch=null;var batchNext;var textureIndex;var nTexture;if(batchCount===0||vertexCount===0){this.flushLocked=false;return this}gl.bufferSubData(gl.ARRAY_BUFFER,0,this.bytes.subarray(0,vertexCount*vertexSize));for(var index=0;index<batchCount-1;index++){batch=batches[index];batchNext=batches[index+1];if(batch.textures.length>0){for(textureIndex=0;textureIndex<batch.textures.length;++textureIndex){nTexture=batch.textures[textureIndex];if(nTexture){renderer.setTexture2D(nTexture,1+textureIndex,false)}}gl.activeTexture(gl.TEXTURE0)}batchVertexCount=batchNext.first-batch.first;if(batch.texture===null||batchVertexCount<=0){continue}renderer.setTexture2D(batch.texture,0,false);gl.drawArrays(topology,batch.first,batchVertexCount)}batch=batches[batchCount-1];if(batch.textures.length>0){for(textureIndex=0;textureIndex<batch.textures.length;++textureIndex){nTexture=batch.textures[textureIndex];if(nTexture){renderer.setTexture2D(nTexture,1+textureIndex,false)}}gl.activeTexture(gl.TEXTURE0)}batchVertexCount=vertexCount-batch.first;if(batch.texture&&batchVertexCount>0){renderer.setTexture2D(batch.texture,0,false);gl.drawArrays(topology,batch.first,batchVertexCount)}this.vertexCount=0;batches.length=0;this.flushLocked=false;return this}});module.exports=TextureTintStripPipeline}),(function(module,exports,__webpack_require__){var Axes={};module.exports=Axes;var Vector=__webpack_require__(99);var Common=__webpack_require__(42);(function(){Axes.fromVertices=function(vertices){var axes={};for(var i=0;i<vertices.length;i++){var j=(i+1)%vertices.length,normal=Vector.normalise({x:vertices[j].y-vertices[i].y,y:vertices[i].x-vertices[j].x}),gradient=(normal.y===0)?Infinity:(normal.x/normal.y);gradient=gradient.toFixed(3).toString();axes[gradient]=normal}return Common.values(axes)};Axes.rotate=function(axes,angle){if(angle===0)return;var cos=Math.cos(angle),sin=Math.sin(angle);for(var i=0;i<axes.length;i++){var axis=axes[i],xx;xx=axis.x*cos-axis.y*sin;axis.y=axis.x*sin+axis.y*cos;axis.x=xx}}})()}),(function(module,exports,__webpack_require__){module.exports={Bounce:__webpack_require__(1397),Collision:__webpack_require__(1398),Force:__webpack_require__(1399),Friction:__webpack_require__(1400),Gravity:__webpack_require__(1401),Mass:__webpack_require__(1402),Static:__webpack_require__(1403),Sensor:__webpack_require__(1404),SetBody:__webpack_require__(1405),Sleep:__webpack_require__(1406),Transform:__webpack_require__(1423),Velocity:__webpack_require__(1424)}}),(function(module,exports,__webpack_require__){var Detector={};module.exports=Detector;var SAT=__webpack_require__(516);var Pair=__webpack_require__(473);var Bounds=__webpack_require__(100);(function(){Detector.collisions=function(broadphasePairs,engine){var collisions=[],pairsTable=engine.pairs.table;var metrics=engine.metrics;for(var i=0;i<broadphasePairs.length;i++){var bodyA=broadphasePairs[i][0],bodyB=broadphasePairs[i][1];if((bodyA.isStatic||bodyA.isSleeping)&&(bodyB.isStatic||bodyB.isSleeping))continue;if(!Detector.canCollide(bodyA.collisionFilter,bodyB.collisionFilter))continue;metrics.midphaseTests+=1;if(Bounds.overlaps(bodyA.bounds,bodyB.bounds)){for(var j=bodyA.parts.length>1?1:0;j<bodyA.parts.length;j++){var partA=bodyA.parts[j];for(var k=bodyB.parts.length>1?1:0;k<bodyB.parts.length;k++){var partB=bodyB.parts[k];if((partA===bodyA&&partB===bodyB)||Bounds.overlaps(partA.bounds,partB.bounds)){var pairId=Pair.id(partA,partB),pair=pairsTable[pairId],previousCollision;if(pair&&pair.isActive){previousCollision=pair.collision}else{previousCollision=null}var collision=SAT.collides(partA,partB,previousCollision);metrics.narrowphaseTests+=1;if(collision.reused)metrics.narrowReuseCount+=1;if(collision.collided){collisions.push(collision);metrics.narrowDetections+=1}}}}}}return collisions};Detector.canCollide=function(filterA,filterB){if(filterA.group===filterB.group&&filterA.group!==0)return filterA.group>0;return(filterA.mask&filterB.category)!==0&&(filterB.mask&filterA.category)!==0}})()}),(function(module,exports,__webpack_require__){var SAT={};module.exports=SAT;var Vertices=__webpack_require__(86);var Vector=__webpack_require__(99);(function(){SAT.collides=function(bodyA,bodyB,previousCollision){var overlapAB,overlapBA,minOverlap,collision,canReusePrevCol=false;if(previousCollision){var parentA=bodyA.parent,parentB=bodyB.parent,motion=parentA.speed*parentA.speed+parentA.angularSpeed*parentA.angularSpeed+parentB.speed*parentB.speed+parentB.angularSpeed*parentB.angularSpeed;canReusePrevCol=previousCollision&&previousCollision.collided&&motion<0.2;collision=previousCollision}else{collision={collided:false,bodyA:bodyA,bodyB:bodyB}}if(previousCollision&&canReusePrevCol){var axisBodyA=collision.axisBody,axisBodyB=axisBodyA===bodyA?bodyB:bodyA,axes=[axisBodyA.axes[previousCollision.axisNumber]];minOverlap=SAT._overlapAxes(axisBodyA.vertices,axisBodyB.vertices,axes);collision.reused=true;if(minOverlap.overlap<=0){collision.collided=false;return collision}}else{overlapAB=SAT._overlapAxes(bodyA.vertices,bodyB.vertices,bodyA.axes);if(overlapAB.overlap<=0){collision.collided=false;return collision}overlapBA=SAT._overlapAxes(bodyB.vertices,bodyA.vertices,bodyB.axes);if(overlapBA.overlap<=0){collision.collided=false;return collision}if(overlapAB.overlap<overlapBA.overlap){minOverlap=overlapAB;collision.axisBody=bodyA}else{minOverlap=overlapBA;collision.axisBody=bodyB}collision.axisNumber=minOverlap.axisNumber}collision.bodyA=bodyA.id<bodyB.id?bodyA:bodyB;collision.bodyB=bodyA.id<bodyB.id?bodyB:bodyA;collision.collided=true;collision.depth=minOverlap.overlap;collision.parentA=collision.bodyA.parent;collision.parentB=collision.bodyB.parent;bodyA=collision.bodyA;bodyB=collision.bodyB;if(Vector.dot(minOverlap.axis,Vector.sub(bodyB.position,bodyA.position))<0){collision.normal={x:minOverlap.axis.x,y:minOverlap.axis.y}}else{collision.normal={x:-minOverlap.axis.x,y:-minOverlap.axis.y}}collision.tangent=Vector.perp(collision.normal);collision.penetration=collision.penetration||{};collision.penetration.x=collision.normal.x*collision.depth;collision.penetration.y=collision.normal.y*collision.depth;var verticesB=SAT._findSupports(bodyA,bodyB,collision.normal),supports=[];if(Vertices.contains(bodyA.vertices,verticesB[0]))supports.push(verticesB[0]);if(Vertices.contains(bodyA.vertices,verticesB[1]))supports.push(verticesB[1]);if(supports.length<2){var verticesA=SAT._findSupports(bodyB,bodyA,Vector.neg(collision.normal));if(Vertices.contains(bodyB.vertices,verticesA[0]))supports.push(verticesA[0]);if(supports.length<2&&Vertices.contains(bodyB.vertices,verticesA[1]))supports.push(verticesA[1])}if(supports.length<1)supports=[verticesB[0]];collision.supports=supports;return collision};SAT._overlapAxes=function(verticesA,verticesB,axes){var projectionA=Vector._temp[0],projectionB=Vector._temp[1],result={overlap:Number.MAX_VALUE},overlap,axis;for(var i=0;i<axes.length;i++){axis=axes[i];SAT._projectToAxis(projectionA,verticesA,axis);SAT._projectToAxis(projectionB,verticesB,axis);overlap=Math.min(projectionA.max-projectionB.min,projectionB.max-projectionA.min);if(overlap<=0){result.overlap=overlap;return result}if(overlap<result.overlap){result.overlap=overlap;result.axis=axis;result.axisNumber=i}}return result};SAT._projectToAxis=function(projection,vertices,axis){var min=Vector.dot(vertices[0],axis),max=min;for(var i=1;i<vertices.length;i+=1){var dot=Vector.dot(vertices[i],axis);if(dot>max){max=dot}else if(dot<min){min=dot}}projection.min=min;projection.max=max};SAT._findSupports=function(bodyA,bodyB,normal){var nearestDistance=Number.MAX_VALUE,vertexToBody=Vector._temp[0],vertices=bodyB.vertices,bodyAPosition=bodyA.position,distance,vertex,vertexA,vertexB;for(var i=0;i<vertices.length;i++){vertex=vertices[i];vertexToBody.x=vertex.x-bodyAPosition.x;vertexToBody.y=vertex.y-bodyAPosition.y;distance=-Vector.dot(normal,vertexToBody);if(distance<nearestDistance){nearestDistance=distance;vertexA=vertex}}var prevIndex=vertexA.index-1>=0?vertexA.index-1:vertices.length-1;vertex=vertices[prevIndex];vertexToBody.x=vertex.x-bodyAPosition.x;vertexToBody.y=vertex.y-bodyAPosition.y;nearestDistance=-Vector.dot(normal,vertexToBody);vertexB=vertex;var nextIndex=(vertexA.index+1)%vertices.length;vertex=vertices[nextIndex];vertexToBody.x=vertex.x-bodyAPosition.x;vertexToBody.y=vertex.y-bodyAPosition.y;distance=-Vector.dot(normal,vertexToBody);if(distance<nearestDistance){vertexB=vertex}return[vertexA,vertexB]}})()}),(function(module,exports){var g;g=(function(){return this})();try{g=g||new Function("return this")()}catch(e){if(typeof window==="object")g=window}module.exports=g}),(function(module,exports,__webpack_require__){__webpack_require__(519);__webpack_require__(520);__webpack_require__(521);__webpack_require__(522);__webpack_require__(523);__webpack_require__(524);__webpack_require__(525);__webpack_require__(526)}),(function(module,exports){if(!Array.prototype.forEach){Array.prototype.forEach=function(fun){'use strict';if(this===void 0||this===null){throw new TypeError()}var t=Object(this);var len=t.length>>>0;if(typeof fun!=='function'){throw new TypeError()}var thisArg=arguments.length>=2?arguments[1]:void 0;for(var i=0;i<len;i++){if(i in t){fun.call(thisArg,t[i],i,t)}}}}}),(function(module,exports){if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==='[object Array]'}}}),(function(module,exports){(function(){function fixSetTarget(param){if(!param)return;if(!param.setTargetAtTime)param.setTargetAtTime=param.setTargetValueAtTime}if(window.hasOwnProperty('webkitAudioContext')&&!window.hasOwnProperty('AudioContext')){window.AudioContext=webkitAudioContext;if(!AudioContext.prototype.hasOwnProperty('createGain'))AudioContext.prototype.createGain=AudioContext.prototype.createGainNode;if(!AudioContext.prototype.hasOwnProperty('createDelay'))AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode;if(!AudioContext.prototype.hasOwnProperty('createScriptProcessor'))AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode;if(!AudioContext.prototype.hasOwnProperty('createPeriodicWave'))AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable;AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain;AudioContext.prototype.createGain=function(){var node=this.internal_createGain();fixSetTarget(node.gain);return node};AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay;AudioContext.prototype.createDelay=function(maxDelayTime){var node=maxDelayTime?this.internal_createDelay(maxDelayTime):this.internal_createDelay();fixSetTarget(node.delayTime);return node};AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource;AudioContext.prototype.createBufferSource=function(){var node=this.internal_createBufferSource();if(!node.start){node.start=function(when,offset,duration){if(offset||duration)this.noteGrainOn(when||0,offset,duration);else this.noteOn(when||0)}}else{node.internal_start=node.start;node.start=function(when,offset,duration){if(typeof duration!=='undefined')node.internal_start(when||0,offset,duration);else node.internal_start(when||0,offset||0)}}if(!node.stop){node.stop=function(when){this.noteOff(when||0)}}else{node.internal_stop=node.stop;node.stop=function(when){node.internal_stop(when||0)}}fixSetTarget(node.playbackRate);return node};AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor;AudioContext.prototype.createDynamicsCompressor=function(){var node=this.internal_createDynamicsCompressor();fixSetTarget(node.threshold);fixSetTarget(node.knee);fixSetTarget(node.ratio);fixSetTarget(node.reduction);fixSetTarget(node.attack);fixSetTarget(node.release);return node};AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter;AudioContext.prototype.createBiquadFilter=function(){var node=this.internal_createBiquadFilter();fixSetTarget(node.frequency);fixSetTarget(node.detune);fixSetTarget(node.Q);fixSetTarget(node.gain);return node};if(AudioContext.prototype.hasOwnProperty('createOscillator')){AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator;AudioContext.prototype.createOscillator=function(){var node=this.internal_createOscillator();if(!node.start){node.start=function(when){this.noteOn(when||0)}}else{node.internal_start=node.start;node.start=function(when){node.internal_start(when||0)}}if(!node.stop){node.stop=function(when){this.noteOff(when||0)}}else{node.internal_stop=node.stop;node.stop=function(when){node.internal_stop(when||0)}}if(!node.setPeriodicWave)node.setPeriodicWave=node.setWaveTable;fixSetTarget(node.frequency);fixSetTarget(node.detune);return node}}}if(window.hasOwnProperty('webkitOfflineAudioContext')&&!window.hasOwnProperty('OfflineAudioContext')){window.OfflineAudioContext=webkitOfflineAudioContext}})()}),(function(module,exports){if(!window.console){window.console={};window.console.log=window.console.assert=function(){};window.console.warn=window.console.assert=function(){}}}),(function(module,exports){if(!Math.trunc){Math.trunc=function trunc(x){return x<0?Math.ceil(x):Math.floor(x)}}}),(function(module,exports){(function(){if('performance'in window===false){window.performance={}}Date.now=(Date.now||function(){return new Date().getTime()});if('now'in window.performance===false){var nowOffset=Date.now();if(performance.timing&&performance.timing.navigationStart){nowOffset=performance.timing.navigationStart}window.performance.now=function now(){return Date.now()-nowOffset}}})()}),(function(module,exports){var lastTime=Date.now();var vendors=['ms','moz','webkit','o'];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;x++){window.requestAnimationFrame=window[vendors[x]+'RequestAnimationFrame'];window.cancelAnimationFrame=window[vendors[x]+'CancelAnimationFrame']||window[vendors[x]+'CancelRequestAnimationFrame']}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback){if(typeof callback!=='function'){throw new TypeError(callback+'is not a function')}var currentTime=Date.now();var delay=16+lastTime-currentTime;if(delay<0){delay=0}lastTime=currentTime;return setTimeout(function(){lastTime=Date.now();callback(performance.now())},delay)}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(id){clearTimeout(id)}}}),(function(module,exports){if(typeof window.Uint32Array!=='function'&&typeof window.Uint32Array!=='object'){var CheapArray=function(fakeType){var proto=new Array();window[fakeType]=function(arg){if(typeof(arg)==='number'){Array.call(this,arg);this.length=arg;for(var i=0;i<this.length;i++){this[i]=0}}else{Array.call(this,arg.length);this.length=arg.length;for(var i=0;i<this.length;i++){this[i]=arg[i]}}};window[fakeType].prototype=proto;window[fakeType].constructor=window[fakeType]};CheapArray('Float32Array');CheapArray('Uint32Array');CheapArray('Uint16Array');CheapArray('Int16Array');CheapArray('ArrayBuffer')}}),(function(module,exports,__webpack_require__){var QuickSet=__webpack_require__(242);var AlignTo=function(items,position,offsetX,offsetY){var target=items[0];for(var i=1;i<items.length;i++){var item=items[i];QuickSet(item,target,position,offsetX,offsetY);target=item}return items};module.exports=AlignTo}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var Angle=function(items,value,step,index,direction){return PropertyValueInc(items,'angle',value,step,index,direction)};module.exports=Angle}),(function(module,exports){var Call=function(items,callback,context){for(var i=0;i<items.length;i++){var item=items[i];callback.call(context,item)}return items};module.exports=Call}),(function(module,exports){var GetFirst=function(items,compare,index){if(index===undefined){index=0}for(var i=index;i<items.length;i++){var item=items[i];var match=true;for(var property in compare){if(item[property]!==compare[property]){match=false}}if(match){return item}}return null};module.exports=GetFirst}),(function(module,exports){var GetLast=function(items,compare,index){if(index===undefined){index=0}for(var i=index;i<items.length;i++){var item=items[i];var match=true;for(var property in compare){if(item[property]!==compare[property]){match=false}}if(match){return item}}return null};module.exports=GetLast}),(function(module,exports,__webpack_require__){var AlignIn=__webpack_require__(255);var CONST=__webpack_require__(105);var GetFastValue=__webpack_require__(2);var NOOP=__webpack_require__(1);var Zone=__webpack_require__(110);var tempZone=new Zone({sys:{queueDepthSort:NOOP,events:{once:NOOP}}},0,0,1,1);var GridAlign=function(items,options){if(options===undefined){options={}}var widthSet=options.hasOwnProperty('width');var heightSet=options.hasOwnProperty('height');var width=GetFastValue(options,'width',-1);var height=GetFastValue(options,'height',-1);var cellWidth=GetFastValue(options,'cellWidth',1);var cellHeight=GetFastValue(options,'cellHeight',cellWidth);var position=GetFastValue(options,'position',CONST.TOP_LEFT);var x=GetFastValue(options,'x',0);var y=GetFastValue(options,'y',0);var cx=0;var cy=0;var w=(width*cellWidth);var h=(height*cellHeight);tempZone.setPosition(x,y);tempZone.setSize(cellWidth,cellHeight);for(var i=0;i<items.length;i++){AlignIn(items[i],tempZone,position);if(widthSet&&width===-1){tempZone.x+=cellWidth}else if(heightSet&&height===-1){tempZone.y+=cellHeight}else{cx+=cellWidth;tempZone.x+=cellWidth;if(cx===w){cx=0;cy+=cellHeight;tempZone.x=x;tempZone.y+=cellHeight;if(cy===h){break}}}}return items};module.exports=GridAlign}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var _FLAG=2;var Alpha={_alpha:1,_alphaTL:1,_alphaTR:1,_alphaBL:1,_alphaBR:1,clearAlpha:function(){return this.setAlpha(1)},setAlpha:function(topLeft,topRight,bottomLeft,bottomRight){if(topLeft===undefined){topLeft=1}if(topRight===undefined){this.alpha=topLeft}else{this._alphaTL=Clamp(topLeft,0,1);this._alphaTR=Clamp(topRight,0,1);this._alphaBL=Clamp(bottomLeft,0,1);this._alphaBR=Clamp(bottomRight,0,1)}return this},alpha:{get:function(){return this._alpha},set:function(value){var v=Clamp(value,0,1);this._alpha=v;this._alphaTL=v;this._alphaTR=v;this._alphaBL=v;this._alphaBR=v;if(v===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}}},alphaTopLeft:{get:function(){return this._alphaTL},set:function(value){var v=Clamp(value,0,1);this._alphaTL=v;if(v!==0){this.renderFlags|=_FLAG}}},alphaTopRight:{get:function(){return this._alphaTR},set:function(value){var v=Clamp(value,0,1);this._alphaTR=v;if(v!==0){this.renderFlags|=_FLAG}}},alphaBottomLeft:{get:function(){return this._alphaBL},set:function(value){var v=Clamp(value,0,1);this._alphaBL=v;if(v!==0){this.renderFlags|=_FLAG}}},alphaBottomRight:{get:function(){return this._alphaBR},set:function(value){var v=Clamp(value,0,1);this._alphaBR=v;if(v!==0){this.renderFlags|=_FLAG}}}};module.exports=Alpha}),(function(module,exports){module.exports='add'}),(function(module,exports){module.exports='complete'}),(function(module,exports){module.exports='repeat'}),(function(module,exports){module.exports='restart'}),(function(module,exports){module.exports='start'}),(function(module,exports){module.exports='pauseall'}),(function(module,exports){module.exports='remove'}),(function(module,exports){module.exports='resumeall'}),(function(module,exports){module.exports='animationcomplete'}),(function(module,exports){module.exports='animationcomplete-'}),(function(module,exports){module.exports='animationrepeat-'}),(function(module,exports){module.exports='animationrestart-'}),(function(module,exports){module.exports='animationstart-'}),(function(module,exports){module.exports='animationupdate-'}),(function(module,exports){module.exports='animationrepeat'}),(function(module,exports){module.exports='animationrestart'}),(function(module,exports){module.exports='animationstart'}),(function(module,exports){module.exports='animationupdate'}),(function(module,exports){var ComputedSize={width:0,height:0,displayWidth:{get:function(){return this.scaleX*this.width},set:function(value){this.scaleX=value/this.width}},displayHeight:{get:function(){return this.scaleY*this.height},set:function(value){this.scaleY=value/this.height}},setSize:function(width,height){this.width=width;this.height=height;return this},setDisplaySize:function(width,height){this.displayWidth=width;this.displayHeight=height;return this}};module.exports=ComputedSize}),(function(module,exports){var Crop={texture:null,frame:null,isCropped:false,setCrop:function(x,y,width,height){if(x===undefined){this.isCropped=false}else if(this.frame){if(typeof x==='number'){this.frame.setCropUVs(this._crop,x,y,width,height,this.flipX,this.flipY)}else{var rect=x;this.frame.setCropUVs(this._crop,rect.x,rect.y,rect.width,rect.height,this.flipX,this.flipY)}this.isCropped=true}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:false,flipY:false,cx:0,cy:0,cw:0,ch:0}}};module.exports=Crop}),(function(module,exports){var Flip={flipX:false,flipY:false,toggleFlipX:function(){this.flipX=!this.flipX;return this},toggleFlipY:function(){this.flipY=!this.flipY;return this},setFlipX:function(value){this.flipX=value;return this},setFlipY:function(value){this.flipY=value;return this},setFlip:function(x,y){this.flipX=x;this.flipY=y;return this},resetFlip:function(){this.flipX=false;this.flipY=false;return this}};module.exports=Flip}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var RotateAround=__webpack_require__(276);var Vector2=__webpack_require__(3);var GetBounds={prepareBoundsOutput:function(output,includeParent){if(includeParent===undefined){includeParent=false}if(this.rotation!==0){RotateAround(output,this.x,this.y,this.rotation)}if(includeParent&&this.parentContainer){var parentMatrix=this.parentContainer.getBoundsTransformMatrix();parentMatrix.transformPoint(output.x,output.y,output)}return output},getCenter:function(output){if(output===undefined){output=new Vector2()}output.x=this.x-(this.displayWidth*this.originX)+(this.displayWidth/2);output.y=this.y-(this.displayHeight*this.originY)+(this.displayHeight/2);return output},getTopLeft:function(output,includeParent){if(!output){output=new Vector2()}output.x=this.x-(this.displayWidth*this.originX);output.y=this.y-(this.displayHeight*this.originY);return this.prepareBoundsOutput(output,includeParent)},getTopCenter:function(output,includeParent){if(!output){output=new Vector2()}output.x=(this.x-(this.displayWidth*this.originX))+(this.displayWidth/2);output.y=this.y-(this.displayHeight*this.originY);return this.prepareBoundsOutput(output,includeParent)},getTopRight:function(output,includeParent){if(!output){output=new Vector2()}output.x=(this.x-(this.displayWidth*this.originX))+this.displayWidth;output.y=this.y-(this.displayHeight*this.originY);return this.prepareBoundsOutput(output,includeParent)},getLeftCenter:function(output,includeParent){if(!output){output=new Vector2()}output.x=this.x-(this.displayWidth*this.originX);output.y=(this.y-(this.displayHeight*this.originY))+(this.displayHeight/2);return this.prepareBoundsOutput(output,includeParent)},getRightCenter:function(output,includeParent){if(!output){output=new Vector2()}output.x=(this.x-(this.displayWidth*this.originX))+this.displayWidth;output.y=(this.y-(this.displayHeight*this.originY))+(this.displayHeight/2);return this.prepareBoundsOutput(output,includeParent)},getBottomLeft:function(output,includeParent){if(!output){output=new Vector2()}output.x=this.x-(this.displayWidth*this.originX);output.y=(this.y-(this.displayHeight*this.originY))+this.displayHeight;return this.prepareBoundsOutput(output,includeParent)},getBottomCenter:function(output,includeParent){if(!output){output=new Vector2()}output.x=(this.x-(this.displayWidth*this.originX))+(this.displayWidth/2);output.y=(this.y-(this.displayHeight*this.originY))+this.displayHeight;return this.prepareBoundsOutput(output,includeParent)},getBottomRight:function(output,includeParent){if(!output){output=new Vector2()}output.x=(this.x-(this.displayWidth*this.originX))+this.displayWidth;output.y=(this.y-(this.displayHeight*this.originY))+this.displayHeight;return this.prepareBoundsOutput(output,includeParent)},getBounds:function(output){if(output===undefined){output=new Rectangle()}var TLx,TLy,TRx,TRy,BLx,BLy,BRx,BRy;if(this.parentContainer){var parentMatrix=this.parentContainer.getBoundsTransformMatrix();this.getTopLeft(output);parentMatrix.transformPoint(output.x,output.y,output);TLx=output.x;TLy=output.y;this.getTopRight(output);parentMatrix.transformPoint(output.x,output.y,output);TRx=output.x;TRy=output.y;this.getBottomLeft(output);parentMatrix.transformPoint(output.x,output.y,output);BLx=output.x;BLy=output.y;this.getBottomRight(output);parentMatrix.transformPoint(output.x,output.y,output);BRx=output.x;BRy=output.y}else{this.getTopLeft(output);TLx=output.x;TLy=output.y;this.getTopRight(output);TRx=output.x;TRy=output.y;this.getBottomLeft(output);BLx=output.x;BLy=output.y;this.getBottomRight(output);BRx=output.x;BRy=output.y}output.x=Math.min(TLx,TRx,BLx,BRx);output.y=Math.min(TLy,TRy,BLy,BRy);output.width=Math.max(TLx,TRx,BLx,BRx)-output.x;output.height=Math.max(TLy,TRy,BLy,BRy)-output.y;return output}};module.exports=GetBounds}),(function(module,exports){module.exports='blur'}),(function(module,exports){module.exports='boot'}),(function(module,exports){module.exports='contextlost'}),(function(module,exports){module.exports='contextrestored'}),(function(module,exports){module.exports='destroy'}),(function(module,exports){module.exports='focus'}),(function(module,exports){module.exports='hidden'}),(function(module,exports){module.exports='pause'}),(function(module,exports){module.exports='postrender'}),(function(module,exports){module.exports='poststep'}),(function(module,exports){module.exports='prerender'}),(function(module,exports){module.exports='prestep'}),(function(module,exports){module.exports='ready'}),(function(module,exports){module.exports='resume'}),(function(module,exports){module.exports='step'}),(function(module,exports){module.exports='visible'}),(function(module,exports){var Origin={_originComponent:true,originX:0.5,originY:0.5,_displayOriginX:0,_displayOriginY:0,displayOriginX:{get:function(){return this._displayOriginX},set:function(value){this._displayOriginX=value;this.originX=value/this.width}},displayOriginY:{get:function(){return this._displayOriginY},set:function(value){this._displayOriginY=value;this.originY=value/this.height}},setOrigin:function(x,y){if(x===undefined){x=0.5}if(y===undefined){y=x}this.originX=x;this.originY=y;return this.updateDisplayOrigin()},setOriginFromFrame:function(){if(!this.frame||!this.frame.customPivot){return this.setOrigin()}else{this.originX=this.frame.pivotX;this.originY=this.frame.pivotY}return this.updateDisplayOrigin()},setDisplayOrigin:function(x,y){if(x===undefined){x=0}if(y===undefined){y=x}this.displayOriginX=x;this.displayOriginY=y;return this},updateDisplayOrigin:function(){this._displayOriginX=this.originX*this.width;this._displayOriginY=this.originY*this.height;return this}};module.exports=Origin}),(function(module,exports,__webpack_require__){var DegToRad=__webpack_require__(39);var GetBoolean=__webpack_require__(88);var GetValue=__webpack_require__(6);var TWEEN_CONST=__webpack_require__(89);var Vector2=__webpack_require__(3);var PathFollower={path:null,rotateToPath:false,pathRotationOffset:0,pathOffset:null,pathVector:null,pathDelta:null,pathTween:null,pathConfig:null,_prevDirection:TWEEN_CONST.PLAYING_FORWARD,setPath:function(path,config){if(config===undefined){config=this.pathConfig}var tween=this.pathTween;if(tween&&tween.isPlaying()){tween.stop()}this.path=path;if(config){this.startFollow(config)}return this},setRotateToPath:function(value,offset){if(offset===undefined){offset=0}this.rotateToPath=value;this.pathRotationOffset=offset;return this},isFollowing:function(){var tween=this.pathTween;return(tween&&tween.isPlaying())},startFollow:function(config,startAt){if(config===undefined){config={}}if(startAt===undefined){startAt=0}var tween=this.pathTween;if(tween&&tween.isPlaying()){tween.stop()}if(typeof config==='number'){config={duration:config}}config.from=GetValue(config,'from',0);config.to=GetValue(config,'to',1);var positionOnPath=GetBoolean(config,'positionOnPath',false);this.rotateToPath=GetBoolean(config,'rotateToPath',false);this.pathRotationOffset=GetValue(config,'rotationOffset',0);var seek=GetValue(config,'startAt',startAt);if(seek){config.onStart=function(tween){var tweenData=tween.data[0];tweenData.progress=seek;tweenData.elapsed=tweenData.duration*seek;var v=tweenData.ease(tweenData.progress);tweenData.current=tweenData.start+((tweenData.end-tweenData.start)*v);tweenData.target[tweenData.key]=tweenData.current}}if(!this.pathOffset){this.pathOffset=new Vector2(this.x,this.y)}if(!this.pathVector){this.pathVector=new Vector2()}if(!this.pathDelta){this.pathDelta=new Vector2()}this.pathDelta.reset();this.pathTween=this.scene.sys.tweens.addCounter(config);this.path.getStartPoint(this.pathOffset);if(positionOnPath){this.x=this.pathOffset.x;this.y=this.pathOffset.y}this.pathOffset.x=this.x-this.pathOffset.x;this.pathOffset.y=this.y-this.pathOffset.y;this._prevDirection=TWEEN_CONST.PLAYING_FORWARD;if(this.rotateToPath){var nextPoint=this.path.getPoint(0.1);this.rotation=Math.atan2(nextPoint.y-this.y,nextPoint.x-this.x)+DegToRad(this.pathRotationOffset)}this.pathConfig=config;return this},pauseFollow:function(){var tween=this.pathTween;if(tween&&tween.isPlaying()){tween.pause()}return this},resumeFollow:function(){var tween=this.pathTween;if(tween&&tween.isPaused()){tween.resume()}return this},stopFollow:function(){var tween=this.pathTween;if(tween&&tween.isPlaying()){tween.stop()}return this},pathUpdate:function(){var tween=this.pathTween;if(tween){var tweenData=tween.data[0];var pathDelta=this.pathDelta;var pathVector=this.pathVector;pathDelta.copy(pathVector).negate();if(tweenData.state===TWEEN_CONST.COMPLETE){this.path.getPoint(1,pathVector);pathDelta.add(pathVector);pathVector.add(this.pathOffset);this.setPosition(pathVector.x,pathVector.y);return}else if(tweenData.state!==TWEEN_CONST.PLAYING_FORWARD&&tweenData.state!==TWEEN_CONST.PLAYING_BACKWARD){return}this.path.getPoint(tween.getValue(),pathVector);pathDelta.add(pathVector);pathVector.add(this.pathOffset);var oldX=this.x;var oldY=this.y;this.setPosition(pathVector.x,pathVector.y);var speedX=this.x-oldX;var speedY=this.y-oldY;if(speedX===0&&speedY===0){return}if(tweenData.state!==this._prevDirection){this._prevDirection=tweenData.state;return}if(this.rotateToPath){this.rotation=Math.atan2(speedY,speedX)+DegToRad(this.pathRotationOffset)}}}};module.exports=PathFollower}),(function(module,exports){var Size={_sizeComponent:true,width:0,height:0,displayWidth:{get:function(){return Math.abs(this.scaleX*this.frame.realWidth)},set:function(value){this.scaleX=value/this.frame.realWidth}},displayHeight:{get:function(){return Math.abs(this.scaleY*this.frame.realHeight)},set:function(value){this.scaleY=value/this.frame.realHeight}},setSizeToFrame:function(frame){if(frame===undefined){frame=this.frame}this.width=frame.realWidth;this.height=frame.realHeight;return this},setSize:function(width,height){this.width=width;this.height=height;return this},setDisplaySize:function(width,height){this.displayWidth=width;this.displayHeight=height;return this}};module.exports=Size}),(function(module,exports){var _FLAG=8;var Texture={texture:null,frame:null,isCropped:false,setTexture:function(key,frame){this.texture=this.scene.sys.textures.get(key);return this.setFrame(frame)},setFrame:function(frame,updateSize,updateOrigin){if(updateSize===undefined){updateSize=true}if(updateOrigin===undefined){updateOrigin=true}this.frame=this.texture.get(frame);if(!this.frame.cutWidth||!this.frame.cutHeight){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}if(this._sizeComponent&&updateSize){this.setSizeToFrame()}if(this._originComponent&&updateOrigin){if(this.frame.customPivot){this.setOrigin(this.frame.pivotX,this.frame.pivotY)}else{this.updateDisplayOrigin()}}return this}};module.exports=Texture}),(function(module,exports){var _FLAG=8;var TextureCrop={texture:null,frame:null,isCropped:false,setCrop:function(x,y,width,height){if(x===undefined){this.isCropped=false}else if(this.frame){if(typeof x==='number'){this.frame.setCropUVs(this._crop,x,y,width,height,this.flipX,this.flipY)}else{var rect=x;this.frame.setCropUVs(this._crop,rect.x,rect.y,rect.width,rect.height,this.flipX,this.flipY)}this.isCropped=true}return this},setTexture:function(key,frame){this.texture=this.scene.sys.textures.get(key);return this.setFrame(frame)},setFrame:function(frame,updateSize,updateOrigin){if(updateSize===undefined){updateSize=true}if(updateOrigin===undefined){updateOrigin=true}this.frame=this.texture.get(frame);if(!this.frame.cutWidth||!this.frame.cutHeight){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}if(this._sizeComponent&&updateSize){this.setSizeToFrame()}if(this._originComponent&&updateOrigin){if(this.frame.customPivot){this.setOrigin(this.frame.pivotX,this.frame.pivotY)}else{this.updateDisplayOrigin()}}if(this.isCropped){this.frame.updateCropUVs(this._crop,this.flipX,this.flipY)}return this},resetCropObject:function(){return{u0:0,v0:0,u1:0,v1:0,width:0,height:0,x:0,y:0,flipX:false,flipY:false,cx:0,cy:0,cw:0,ch:0}}};module.exports=TextureCrop}),(function(module,exports){var GetColor=function(value){return(value>>16)+(value&0xff00)+((value&0xff)<<16)};var Tint={_tintTL:16777215,_tintTR:16777215,_tintBL:16777215,_tintBR:16777215,_isTinted:false,tintFill:false,clearTint:function(){this.setTint(0xffffff);this._isTinted=false;return this},setTint:function(topLeft,topRight,bottomLeft,bottomRight){if(topLeft===undefined){topLeft=0xffffff}if(topRight===undefined){topRight=topLeft;bottomLeft=topLeft;bottomRight=topLeft}this._tintTL=GetColor(topLeft);this._tintTR=GetColor(topRight);this._tintBL=GetColor(bottomLeft);this._tintBR=GetColor(bottomRight);this._isTinted=true;this.tintFill=false;return this},setTintFill:function(topLeft,topRight,bottomLeft,bottomRight){this.setTint(topLeft,topRight,bottomLeft,bottomRight);this.tintFill=true;return this},tintTopLeft:{get:function(){return this._tintTL},set:function(value){this._tintTL=GetColor(value);this._isTinted=true}},tintTopRight:{get:function(){return this._tintTR},set:function(value){this._tintTR=GetColor(value);this._isTinted=true}},tintBottomLeft:{get:function(){return this._tintBL},set:function(value){this._tintBL=GetColor(value);this._isTinted=true}},tintBottomRight:{get:function(){return this._tintBR},set:function(value){this._tintBR=GetColor(value);this._isTinted=true}},tint:{set:function(value){this.setTint(value,value,value,value)}},isTinted:{get:function(){return this._isTinted}}};module.exports=Tint}),(function(module,exports){module.exports='changedata'}),(function(module,exports){module.exports='changedata-'}),(function(module,exports){module.exports='removedata'}),(function(module,exports){module.exports='setdata'}),(function(module,exports){module.exports='destroy'}),(function(module,exports){module.exports='complete'}),(function(module,exports){module.exports='created'}),(function(module,exports){module.exports='error'}),(function(module,exports){module.exports='loop'}),(function(module,exports){module.exports='play'}),(function(module,exports){module.exports='seeked'}),(function(module,exports){module.exports='seeking'}),(function(module,exports){module.exports='stop'}),(function(module,exports){module.exports='timeout'}),(function(module,exports){module.exports='unlocked'}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var IncAlpha=function(items,value,step,index,direction){return PropertyValueInc(items,'alpha',value,step,index,direction)};module.exports=IncAlpha}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var IncX=function(items,value,step,index,direction){return PropertyValueInc(items,'x',value,step,index,direction)};module.exports=IncX}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var IncXY=function(items,x,y,stepX,stepY,index,direction){if(y===undefined||y===null){y=x}PropertyValueInc(items,'x',x,stepX,index,direction);return PropertyValueInc(items,'y',y,stepY,index,direction)};module.exports=IncXY}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var IncY=function(items,value,step,index,direction){return PropertyValueInc(items,'y',value,step,index,direction)};module.exports=IncY}),(function(module,exports){var PlaceOnCircle=function(items,circle,startAngle,endAngle){if(startAngle===undefined){startAngle=0}if(endAngle===undefined){endAngle=6.28}var angle=startAngle;var angleStep=(endAngle-startAngle)/items.length;for(var i=0;i<items.length;i++){items[i].x=circle.x+(circle.radius*Math.cos(angle));items[i].y=circle.y+(circle.radius*Math.sin(angle));angle+=angleStep}return items};module.exports=PlaceOnCircle}),(function(module,exports){var PlaceOnEllipse=function(items,ellipse,startAngle,endAngle){if(startAngle===undefined){startAngle=0}if(endAngle===undefined){endAngle=6.28}var angle=startAngle;var angleStep=(endAngle-startAngle)/items.length;var a=ellipse.width/2;var b=ellipse.height/2;for(var i=0;i<items.length;i++){items[i].x=ellipse.x+a*Math.cos(angle);items[i].y=ellipse.y+b*Math.sin(angle);angle+=angleStep}return items};module.exports=PlaceOnEllipse}),(function(module,exports,__webpack_require__){var GetPoints=__webpack_require__(153);var PlaceOnLine=function(items,line){var points=GetPoints(line,items.length);for(var i=0;i<items.length;i++){var item=items[i];var point=points[i];item.x=point.x;item.y=point.y}return items};module.exports=PlaceOnLine}),(function(module,exports,__webpack_require__){var MarchingAnts=__webpack_require__(285);var RotateLeft=__webpack_require__(286);var RotateRight=__webpack_require__(287);var PlaceOnRectangle=function(items,rect,shift){if(shift===undefined){shift=0}var points=MarchingAnts(rect,false,items.length);if(shift>0){RotateLeft(points,shift)}else if(shift<0){RotateRight(points,Math.abs(shift))}for(var i=0;i<items.length;i++){items[i].x=points[i].x;items[i].y=points[i].y}return items};module.exports=PlaceOnRectangle}),(function(module,exports,__webpack_require__){var BresenhamPoints=__webpack_require__(288);var PlaceOnTriangle=function(items,triangle,stepRate){var p1=BresenhamPoints({x1:triangle.x1,y1:triangle.y1,x2:triangle.x2,y2:triangle.y2},stepRate);var p2=BresenhamPoints({x1:triangle.x2,y1:triangle.y2,x2:triangle.x3,y2:triangle.y3},stepRate);var p3=BresenhamPoints({x1:triangle.x3,y1:triangle.y3,x2:triangle.x1,y2:triangle.y1},stepRate);p1.pop();p2.pop();p3.pop();p1=p1.concat(p2,p3);var step=p1.length/items.length;var p=0;for(var i=0;i<items.length;i++){var item=items[i];var point=p1[Math.floor(p)];item.x=point.x;item.y=point.y;p+=step}return items};module.exports=PlaceOnTriangle}),(function(module,exports){var PlayAnimation=function(items,key,startFrame){for(var i=0;i<items.length;i++){items[i].anims.play(key,startFrame)}return items};module.exports=PlayAnimation}),(function(module,exports,__webpack_require__){var Random=__webpack_require__(150);var RandomCircle=function(items,circle){for(var i=0;i<items.length;i++){Random(circle,items[i])}return items};module.exports=RandomCircle}),(function(module,exports,__webpack_require__){var Random=__webpack_require__(157);var RandomEllipse=function(items,ellipse){for(var i=0;i<items.length;i++){Random(ellipse,items[i])}return items};module.exports=RandomEllipse}),(function(module,exports,__webpack_require__){var Random=__webpack_require__(154);var RandomLine=function(items,line){for(var i=0;i<items.length;i++){Random(line,items[i])}return items};module.exports=RandomLine}),(function(module,exports,__webpack_require__){var Random=__webpack_require__(155);var RandomRectangle=function(items,rect){for(var i=0;i<items.length;i++){Random(rect,items[i])}return items};module.exports=RandomRectangle}),(function(module,exports,__webpack_require__){var Random=__webpack_require__(158);var RandomTriangle=function(items,triangle){for(var i=0;i<items.length;i++){Random(triangle,items[i])}return items};module.exports=RandomTriangle}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var Rotate=function(items,value,step,index,direction){return PropertyValueInc(items,'rotation',value,step,index,direction)};module.exports=Rotate}),(function(module,exports,__webpack_require__){var RotateAroundDistance=__webpack_require__(159);var DistanceBetween=__webpack_require__(53);var RotateAround=function(items,point,angle){var x=point.x;var y=point.y;for(var i=0;i<items.length;i++){var item=items[i];RotateAroundDistance(item,x,y,angle,Math.max(1,DistanceBetween(item.x,item.y,x,y)))}return items};module.exports=RotateAround}),(function(module,exports,__webpack_require__){var MathRotateAroundDistance=__webpack_require__(159);var RotateAroundDistance=function(items,point,angle,distance){var x=point.x;var y=point.y;if(distance===0){return items}for(var i=0;i<items.length;i++){MathRotateAroundDistance(items[i],x,y,angle,distance)}return items};module.exports=RotateAroundDistance}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var ScaleX=function(items,value,step,index,direction){return PropertyValueInc(items,'scaleX',value,step,index,direction)};module.exports=ScaleX}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var ScaleXY=function(items,scaleX,scaleY,stepX,stepY,index,direction){if(scaleY===undefined||scaleY===null){scaleY=scaleX}PropertyValueInc(items,'scaleX',scaleX,stepX,index,direction);return PropertyValueInc(items,'scaleY',scaleY,stepY,index,direction)};module.exports=ScaleXY}),(function(module,exports,__webpack_require__){var PropertyValueInc=__webpack_require__(38);var ScaleY=function(items,value,step,index,direction){return PropertyValueInc(items,'scaleY',value,step,index,direction)};module.exports=ScaleY}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetAlpha=function(items,value,step,index,direction){return PropertyValueSet(items,'alpha',value,step,index,direction)};module.exports=SetAlpha}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetBlendMode=function(items,value,index,direction){return PropertyValueSet(items,'blendMode',value,0,index,direction)};module.exports=SetBlendMode}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetDepth=function(items,value,step,index,direction){return PropertyValueSet(items,'depth',value,step,index,direction)};module.exports=SetDepth}),(function(module,exports){var SetHitArea=function(items,hitArea,hitAreaCallback){for(var i=0;i<items.length;i++){items[i].setInteractive(hitArea,hitAreaCallback)}return items};module.exports=SetHitArea}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetOrigin=function(items,originX,originY,stepX,stepY,index,direction){if(originY===undefined||originY===null){originY=originX}PropertyValueSet(items,'originX',originX,stepX,index,direction);return PropertyValueSet(items,'originY',originY,stepY,index,direction)};module.exports=SetOrigin}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetRotation=function(items,value,step,index,direction){return PropertyValueSet(items,'rotation',value,step,index,direction)};module.exports=SetRotation}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetScale=function(items,scaleX,scaleY,stepX,stepY,index,direction){if(scaleY===undefined||scaleY===null){scaleY=scaleX}PropertyValueSet(items,'scaleX',scaleX,stepX,index,direction);return PropertyValueSet(items,'scaleY',scaleY,stepY,index,direction)};module.exports=SetScale}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetScaleX=function(items,value,step,index,direction){return PropertyValueSet(items,'scaleX',value,step,index,direction)};module.exports=SetScaleX}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetScaleY=function(items,value,step,index,direction){return PropertyValueSet(items,'scaleY',value,step,index,direction)};module.exports=SetScaleY}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetScrollFactor=function(items,scrollFactorX,scrollFactorY,stepX,stepY,index,direction){if(scrollFactorY===undefined||scrollFactorY===null){scrollFactorY=scrollFactorX}PropertyValueSet(items,'scrollFactorX',scrollFactorX,stepX,index,direction);return PropertyValueSet(items,'scrollFactorY',scrollFactorY,stepY,index,direction)};module.exports=SetScrollFactor}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetScrollFactorX=function(items,value,step,index,direction){return PropertyValueSet(items,'scrollFactorX',value,step,index,direction)};module.exports=SetScrollFactorX}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetScrollFactorY=function(items,value,step,index,direction){return PropertyValueSet(items,'scrollFactorY',value,step,index,direction)};module.exports=SetScrollFactorY}),(function(module,exports){var SetTint=function(items,topLeft,topRight,bottomLeft,bottomRight){for(var i=0;i<items.length;i++){items[i].setTint(topLeft,topRight,bottomLeft,bottomRight)}return items};module.exports=SetTint}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetVisible=function(items,value,index,direction){return PropertyValueSet(items,'visible',value,0,index,direction)};module.exports=SetVisible}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetX=function(items,value,step,index,direction){return PropertyValueSet(items,'x',value,step,index,direction)};module.exports=SetX}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetXY=function(items,x,y,stepX,stepY,index,direction){if(y===undefined||y===null){y=x}PropertyValueSet(items,'x',x,stepX,index,direction);return PropertyValueSet(items,'y',y,stepY,index,direction)};module.exports=SetXY}),(function(module,exports,__webpack_require__){var PropertyValueSet=__webpack_require__(25);var SetY=function(items,value,step,index,direction){return PropertyValueSet(items,'y',value,step,index,direction)};module.exports=SetY}),(function(module,exports,__webpack_require__){var Vector2=__webpack_require__(3);var ShiftPosition=function(items,x,y,direction,output){if(direction===undefined){direction=0}if(output===undefined){output=new Vector2()}var px;var py;if(items.length>1){var i;var cx;var cy;var cur;if(direction===0){var len=items.length-1;px=items[len].x;py=items[len].y;for(i=len-1;i>=0;i--){cur=items[i];cx=cur.x;cy=cur.y;cur.x=px;cur.y=py;px=cx;py=cy}items[len].x=x;items[len].y=y}else{px=items[0].x;py=items[0].y;for(i=1;i<items.length;i++){cur=items[i];cx=cur.x;cy=cur.y;cur.x=px;cur.y=py;px=cx;py=cy}items[0].x=x;items[0].y=y}}else{px=items[0].x;py=items[0].y;items[0].x=x;items[0].y=y}output.x=px;output.y=py;return output};module.exports=ShiftPosition}),(function(module,exports,__webpack_require__){var ArrayShuffle=__webpack_require__(114);var Shuffle=function(items){return ArrayShuffle(items)};module.exports=Shuffle}),(function(module,exports,__webpack_require__){var MathSmootherStep=__webpack_require__(160);var SmootherStep=function(items,property,min,max,inc){if(inc===undefined){inc=false}var step=Math.abs(max-min)/items.length;var i;if(inc){for(i=0;i<items.length;i++){items[i][property]+=MathSmootherStep(i*step,min,max)}}else{for(i=0;i<items.length;i++){items[i][property]=MathSmootherStep(i*step,min,max)}}return items};module.exports=SmootherStep}),(function(module,exports,__webpack_require__){var MathSmoothStep=__webpack_require__(161);var SmoothStep=function(items,property,min,max,inc){if(inc===undefined){inc=false}var step=Math.abs(max-min)/items.length;var i;if(inc){for(i=0;i<items.length;i++){items[i][property]+=MathSmoothStep(i*step,min,max)}}else{for(i=0;i<items.length;i++){items[i][property]=MathSmoothStep(i*step,min,max)}}return items};module.exports=SmoothStep}),(function(module,exports){var Spread=function(items,property,min,max,inc){if(inc===undefined){inc=false}var step=Math.abs(max-min)/items.length;var i;if(inc){for(i=0;i<items.length;i++){items[i][property]+=i*step+min}}else{for(i=0;i<items.length;i++){items[i][property]=i*step+min}}return items};module.exports=Spread}),(function(module,exports){var ToggleVisible=function(items){for(var i=0;i<items.length;i++){items[i].visible=!items[i].visible}return items};module.exports=ToggleVisible}),(function(module,exports,__webpack_require__){var Wrap=__webpack_require__(58);var WrapInRectangle=function(items,rect,padding){if(padding===undefined){padding=0}for(var i=0;i<items.length;i++){var item=items[i];item.x=Wrap(item.x,rect.left-padding,rect.right+padding);item.y=Wrap(item.y,rect.top-padding,rect.bottom+padding)}return items};module.exports=WrapInRectangle}),(function(module,exports,__webpack_require__){module.exports={Animation:__webpack_require__(151),AnimationFrame:__webpack_require__(271),AnimationManager:__webpack_require__(289),Events:__webpack_require__(111)}}),(function(module,exports,__webpack_require__){module.exports={BaseCache:__webpack_require__(290),CacheManager:__webpack_require__(292),Events:__webpack_require__(291)}}),(function(module,exports){module.exports='add'}),(function(module,exports){module.exports='remove'}),(function(module,exports,__webpack_require__){module.exports={Controls:__webpack_require__(643),Scene2D:__webpack_require__(646)}}),(function(module,exports,__webpack_require__){module.exports={FixedKeyControl:__webpack_require__(644),SmoothedKeyControl:__webpack_require__(645)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetValue=__webpack_require__(6);var FixedKeyControl=new Class({initialize:function FixedKeyControl(config){this.camera=GetValue(config,'camera',null);this.left=GetValue(config,'left',null);this.right=GetValue(config,'right',null);this.up=GetValue(config,'up',null);this.down=GetValue(config,'down',null);this.zoomIn=GetValue(config,'zoomIn',null);this.zoomOut=GetValue(config,'zoomOut',null);this.zoomSpeed=GetValue(config,'zoomSpeed',0.01);this.speedX=0;this.speedY=0;var speed=GetValue(config,'speed',null);if(typeof speed==='number'){this.speedX=speed;this.speedY=speed}else{this.speedX=GetValue(config,'speed.x',0);this.speedY=GetValue(config,'speed.y',0)}this._zoom=0;this.active=(this.camera!==null)},start:function(){this.active=(this.camera!==null);return this},stop:function(){this.active=false;return this},setCamera:function(camera){this.camera=camera;return this},update:function(delta){if(!this.active){return}if(delta===undefined){delta=1}var cam=this.camera;if(this.up&&this.up.isDown){cam.scrollY-=((this.speedY*delta)|0)}else if(this.down&&this.down.isDown){cam.scrollY+=((this.speedY*delta)|0)}if(this.left&&this.left.isDown){cam.scrollX-=((this.speedX*delta)|0)}else if(this.right&&this.right.isDown){cam.scrollX+=((this.speedX*delta)|0)}if(this.zoomIn&&this.zoomIn.isDown){cam.zoom-=this.zoomSpeed;if(cam.zoom<0.1){cam.zoom=0.1}}else if(this.zoomOut&&this.zoomOut.isDown){cam.zoom+=this.zoomSpeed}},destroy:function(){this.camera=null;this.left=null;this.right=null;this.up=null;this.down=null;this.zoomIn=null;this.zoomOut=null}});module.exports=FixedKeyControl}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetValue=__webpack_require__(6);var SmoothedKeyControl=new Class({initialize:function SmoothedKeyControl(config){this.camera=GetValue(config,'camera',null);this.left=GetValue(config,'left',null);this.right=GetValue(config,'right',null);this.up=GetValue(config,'up',null);this.down=GetValue(config,'down',null);this.zoomIn=GetValue(config,'zoomIn',null);this.zoomOut=GetValue(config,'zoomOut',null);this.zoomSpeed=GetValue(config,'zoomSpeed',0.01);this.accelX=0;this.accelY=0;var accel=GetValue(config,'acceleration',null);if(typeof accel==='number'){this.accelX=accel;this.accelY=accel}else{this.accelX=GetValue(config,'acceleration.x',0);this.accelY=GetValue(config,'acceleration.y',0)}this.dragX=0;this.dragY=0;var drag=GetValue(config,'drag',null);if(typeof drag==='number'){this.dragX=drag;this.dragY=drag}else{this.dragX=GetValue(config,'drag.x',0);this.dragY=GetValue(config,'drag.y',0)}this.maxSpeedX=0;this.maxSpeedY=0;var maxSpeed=GetValue(config,'maxSpeed',null);if(typeof maxSpeed==='number'){this.maxSpeedX=maxSpeed;this.maxSpeedY=maxSpeed}else{this.maxSpeedX=GetValue(config,'maxSpeed.x',0);this.maxSpeedY=GetValue(config,'maxSpeed.y',0)}this._speedX=0;this._speedY=0;this._zoom=0;this.active=(this.camera!==null)},start:function(){this.active=(this.camera!==null);return this},stop:function(){this.active=false;return this},setCamera:function(camera){this.camera=camera;return this},update:function(delta){if(!this.active){return}if(delta===undefined){delta=1}var cam=this.camera;if(this._speedX>0){this._speedX-=this.dragX*delta;if(this._speedX<0){this._speedX=0}}else if(this._speedX<0){this._speedX+=this.dragX*delta;if(this._speedX>0){this._speedX=0}}if(this._speedY>0){this._speedY-=this.dragY*delta;if(this._speedY<0){this._speedY=0}}else if(this._speedY<0){this._speedY+=this.dragY*delta;if(this._speedY>0){this._speedY=0}}if(this.up&&this.up.isDown){this._speedY+=this.accelY;if(this._speedY>this.maxSpeedY){this._speedY=this.maxSpeedY}}else if(this.down&&this.down.isDown){this._speedY-=this.accelY;if(this._speedY<-this.maxSpeedY){this._speedY=-this.maxSpeedY}}if(this.left&&this.left.isDown){this._speedX+=this.accelX;if(this._speedX>this.maxSpeedX){this._speedX=this.maxSpeedX}}else if(this.right&&this.right.isDown){this._speedX-=this.accelX;if(this._speedX<-this.maxSpeedX){this._speedX=-this.maxSpeedX}}if(this.zoomIn&&this.zoomIn.isDown){this._zoom=-this.zoomSpeed}else if(this.zoomOut&&this.zoomOut.isDown){this._zoom=this.zoomSpeed}else{this._zoom=0}if(this._speedX!==0){cam.scrollX-=((this._speedX*delta)|0)}if(this._speedY!==0){cam.scrollY-=((this._speedY*delta)|0)}if(this._zoom!==0){cam.zoom+=this._zoom;if(cam.zoom<0.001){cam.zoom=0.001}}},destroy:function(){this.camera=null;this.left=null;this.right=null;this.up=null;this.down=null;this.zoomIn=null;this.zoomOut=null}});module.exports=SmoothedKeyControl}),(function(module,exports,__webpack_require__){module.exports={Camera:__webpack_require__(293),BaseCamera:__webpack_require__(91),CameraManager:__webpack_require__(702),Effects:__webpack_require__(301),Events:__webpack_require__(40)}}),(function(module,exports){module.exports='cameradestroy'}),(function(module,exports){module.exports='camerafadeincomplete'}),(function(module,exports){module.exports='camerafadeinstart'}),(function(module,exports){module.exports='camerafadeoutcomplete'}),(function(module,exports){module.exports='camerafadeoutstart'}),(function(module,exports){module.exports='cameraflashcomplete'}),(function(module,exports){module.exports='cameraflashstart'}),(function(module,exports){module.exports='camerapancomplete'}),(function(module,exports){module.exports='camerapanstart'}),(function(module,exports){module.exports='postrender'}),(function(module,exports){module.exports='prerender'}),(function(module,exports){module.exports='camerarotatecomplete'}),(function(module,exports){module.exports='camerarotatestart'}),(function(module,exports){module.exports='camerashakecomplete'}),(function(module,exports){module.exports='camerashakestart'}),(function(module,exports){module.exports='camerazoomcomplete'}),(function(module,exports){module.exports='camerazoomstart'}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Events=__webpack_require__(40);var Fade=new Class({initialize:function Fade(camera){this.camera=camera;this.isRunning=false;this.isComplete=false;this.direction=true;this.duration=0;this.red=0;this.green=0;this.blue=0;this.alpha=0;this.progress=0;this._elapsed=0;this._onUpdate;this._onUpdateScope},start:function(direction,duration,red,green,blue,force,callback,context){if(direction===undefined){direction=true}if(duration===undefined){duration=1000}if(red===undefined){red=0}if(green===undefined){green=0}if(blue===undefined){blue=0}if(force===undefined){force=false}if(callback===undefined){callback=null}if(context===undefined){context=this.camera.scene}if(!force&&this.isRunning){return this.camera}this.isRunning=true;this.isComplete=false;this.duration=duration;this.direction=direction;this.progress=0;this.red=red;this.green=green;this.blue=blue;this.alpha=(direction)?Number.MIN_VALUE:1;this._elapsed=0;this._onUpdate=callback;this._onUpdateScope=context;var eventName=(direction)?Events.FADE_OUT_START:Events.FADE_IN_START;this.camera.emit(eventName,this.camera,this,duration,red,green,blue);return this.camera},update:function(time,delta){if(!this.isRunning){return}this._elapsed+=delta;this.progress=Clamp(this._elapsed/this.duration,0,1);if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,this.camera,this.progress)}if(this._elapsed<this.duration){this.alpha=(this.direction)?this.progress:1-this.progress}else{this.alpha=(this.direction)?1:0;this.effectComplete()}},postRenderCanvas:function(ctx){if(!this.isRunning&&!this.isComplete){return false}var camera=this.camera;ctx.fillStyle='rgba('+this.red+','+this.green+','+this.blue+','+this.alpha+')';ctx.fillRect(camera._cx,camera._cy,camera._cw,camera._ch);return true},postRenderWebGL:function(pipeline,getTintFunction){if(!this.isRunning&&!this.isComplete){return false}var camera=this.camera;var red=this.red/255;var blue=this.blue/255;var green=this.green/255;pipeline.drawFillRect(camera._cx,camera._cy,camera._cw,camera._ch,getTintFunction(red,green,blue,1),this.alpha);return true},effectComplete:function(){this._onUpdate=null;this._onUpdateScope=null;this.isRunning=false;this.isComplete=true;var eventName=(this.direction)?Events.FADE_OUT_COMPLETE:Events.FADE_IN_COMPLETE;this.camera.emit(eventName,this.camera,this)},reset:function(){this.isRunning=false;this.isComplete=false;this._onUpdate=null;this._onUpdateScope=null},destroy:function(){this.reset();this.camera=null}});module.exports=Fade}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Events=__webpack_require__(40);var Flash=new Class({initialize:function Flash(camera){this.camera=camera;this.isRunning=false;this.duration=0;this.red=0;this.green=0;this.blue=0;this.alpha=0;this.progress=0;this._elapsed=0;this._onUpdate;this._onUpdateScope},start:function(duration,red,green,blue,force,callback,context){if(duration===undefined){duration=250}if(red===undefined){red=255}if(green===undefined){green=255}if(blue===undefined){blue=255}if(force===undefined){force=false}if(callback===undefined){callback=null}if(context===undefined){context=this.camera.scene}if(!force&&this.isRunning){return this.camera}this.isRunning=true;this.duration=duration;this.progress=0;this.red=red;this.green=green;this.blue=blue;this.alpha=1;this._elapsed=0;this._onUpdate=callback;this._onUpdateScope=context;this.camera.emit(Events.FLASH_START,this.camera,this,duration,red,green,blue);return this.camera},update:function(time,delta){if(!this.isRunning){return}this._elapsed+=delta;this.progress=Clamp(this._elapsed/this.duration,0,1);if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,this.camera,this.progress)}if(this._elapsed<this.duration){this.alpha=1-this.progress}else{this.effectComplete()}},postRenderCanvas:function(ctx){if(!this.isRunning){return false}var camera=this.camera;ctx.fillStyle='rgba('+this.red+','+this.green+','+this.blue+','+this.alpha+')';ctx.fillRect(camera._cx,camera._cy,camera._cw,camera._ch);return true},postRenderWebGL:function(pipeline,getTintFunction){if(!this.isRunning){return false}var camera=this.camera;var red=this.red/255;var blue=this.blue/255;var green=this.green/255;pipeline.drawFillRect(camera._cx,camera._cy,camera._cw,camera._ch,getTintFunction(red,green,blue,1),this.alpha);return true},effectComplete:function(){this._onUpdate=null;this._onUpdateScope=null;this.isRunning=false;this.camera.emit(Events.FLASH_COMPLETE,this.camera,this)},reset:function(){this.isRunning=false;this._onUpdate=null;this._onUpdateScope=null},destroy:function(){this.reset();this.camera=null}});module.exports=Flash}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var EaseMap=__webpack_require__(115);var Events=__webpack_require__(40);var Vector2=__webpack_require__(3);var Pan=new Class({initialize:function Pan(camera){this.camera=camera;this.isRunning=false;this.duration=0;this.source=new Vector2();this.current=new Vector2();this.destination=new Vector2();this.ease;this.progress=0;this._elapsed=0;this._onUpdate;this._onUpdateScope},start:function(x,y,duration,ease,force,callback,context){if(duration===undefined){duration=1000}if(ease===undefined){ease=EaseMap.Linear}if(force===undefined){force=false}if(callback===undefined){callback=null}if(context===undefined){context=this.camera.scene}var cam=this.camera;if(!force&&this.isRunning){return cam}this.isRunning=true;this.duration=duration;this.progress=0;this.source.set(cam.scrollX,cam.scrollY);this.destination.set(x,y);cam.getScroll(x,y,this.current);if(typeof ease==='string'&&EaseMap.hasOwnProperty(ease)){this.ease=EaseMap[ease]}else if(typeof ease==='function'){this.ease=ease}this._elapsed=0;this._onUpdate=callback;this._onUpdateScope=context;this.camera.emit(Events.PAN_START,this.camera,this,duration,x,y);return cam},update:function(time,delta){if(!this.isRunning){return}this._elapsed+=delta;var progress=Clamp(this._elapsed/this.duration,0,1);this.progress=progress;var cam=this.camera;if(this._elapsed<this.duration){var v=this.ease(progress);cam.getScroll(this.destination.x,this.destination.y,this.current);var x=this.source.x+((this.current.x-this.source.x)*v);var y=this.source.y+((this.current.y-this.source.y)*v);cam.setScroll(x,y);if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,cam,progress,x,y)}}else{cam.centerOn(this.destination.x,this.destination.y);if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,cam,progress,cam.scrollX,cam.scrollY)}this.effectComplete()}},effectComplete:function(){this._onUpdate=null;this._onUpdateScope=null;this.isRunning=false;this.camera.emit(Events.PAN_COMPLETE,this.camera,this)},reset:function(){this.isRunning=false;this._onUpdate=null;this._onUpdateScope=null},destroy:function(){this.reset();this.camera=null;this.source=null;this.destination=null}});module.exports=Pan}),(function(module,exports){var In=function(v,overshoot){if(overshoot===undefined){overshoot=1.70158}return v*v*((overshoot+1)*v-overshoot)};module.exports=In}),(function(module,exports){var Out=function(v,overshoot){if(overshoot===undefined){overshoot=1.70158}return--v*v*((overshoot+1)*v+overshoot)+1};module.exports=Out}),(function(module,exports){var InOut=function(v,overshoot){if(overshoot===undefined){overshoot=1.70158}var s=overshoot*1.525;if((v*=2)<1){return 0.5*(v*v*((s+1)*v-s))}else{return 0.5*((v-=2)*v*((s+1)*v+s)+2)}};module.exports=InOut}),(function(module,exports){var In=function(v){v=1-v;if(v<1/2.75){return 1-(7.5625*v*v)}else if(v<2/2.75){return 1-(7.5625*(v-=1.5/2.75)*v+0.75)}else if(v<2.5/2.75){return 1-(7.5625*(v-=2.25/2.75)*v+0.9375)}else{return 1-(7.5625*(v-=2.625/2.75)*v+0.984375)}};module.exports=In}),(function(module,exports){var Out=function(v){if(v<1/2.75){return 7.5625*v*v}else if(v<2/2.75){return 7.5625*(v-=1.5/2.75)*v+0.75}else if(v<2.5/2.75){return 7.5625*(v-=2.25/2.75)*v+0.9375}else{return 7.5625*(v-=2.625/2.75)*v+0.984375}};module.exports=Out}),(function(module,exports){var InOut=function(v){var reverse=false;if(v<0.5){v=1-(v*2);reverse=true}else{v=(v*2)-1}if(v<1/2.75){v=7.5625*v*v}else if(v<2/2.75){v=7.5625*(v-=1.5/2.75)*v+0.75}else if(v<2.5/2.75){v=7.5625*(v-=2.25/2.75)*v+0.9375}else{v=7.5625*(v-=2.625/2.75)*v+0.984375}if(reverse){return(1-v)*0.5}else{return v*0.5+0.5}};module.exports=InOut}),(function(module,exports){var In=function(v){return 1-Math.sqrt(1-v*v)};module.exports=In}),(function(module,exports){var Out=function(v){return Math.sqrt(1-(--v*v))};module.exports=Out}),(function(module,exports){var InOut=function(v){if((v*=2)<1){return-0.5*(Math.sqrt(1-v*v)-1)}else{return 0.5*(Math.sqrt(1-(v-=2)*v)+1)}};module.exports=InOut}),(function(module,exports){var In=function(v){return v*v*v};module.exports=In}),(function(module,exports){var Out=function(v){return--v*v*v+1};module.exports=Out}),(function(module,exports){var InOut=function(v){if((v*=2)<1){return 0.5*v*v*v}else{return 0.5*((v-=2)*v*v+2)}};module.exports=InOut}),(function(module,exports){var In=function(v,amplitude,period){if(amplitude===undefined){amplitude=0.1}if(period===undefined){period=0.1}if(v===0){return 0}else if(v===1){return 1}else{var s=period/4;if(amplitude<1){amplitude=1}else{s=period*Math.asin(1/amplitude)/(2*Math.PI)}return-(amplitude*Math.pow(2,10*(v-=1))*Math.sin((v-s)*(2*Math.PI)/period))}};module.exports=In}),(function(module,exports){var Out=function(v,amplitude,period){if(amplitude===undefined){amplitude=0.1}if(period===undefined){period=0.1}if(v===0){return 0}else if(v===1){return 1}else{var s=period/4;if(amplitude<1){amplitude=1}else{s=period*Math.asin(1/amplitude)/(2*Math.PI)}return(amplitude*Math.pow(2,-10*v)*Math.sin((v-s)*(2*Math.PI)/period)+1)}};module.exports=Out}),(function(module,exports){var InOut=function(v,amplitude,period){if(amplitude===undefined){amplitude=0.1}if(period===undefined){period=0.1}if(v===0){return 0}else if(v===1){return 1}else{var s=period/4;if(amplitude<1){amplitude=1}else{s=period*Math.asin(1/amplitude)/(2*Math.PI)}if((v*=2)<1){return-0.5*(amplitude*Math.pow(2,10*(v-=1))*Math.sin((v-s)*(2*Math.PI)/period))}else{return amplitude*Math.pow(2,-10*(v-=1))*Math.sin((v-s)*(2*Math.PI)/period)*0.5+1}}};module.exports=InOut}),(function(module,exports){var In=function(v){return Math.pow(2,10*(v-1))-0.001};module.exports=In}),(function(module,exports){var Out=function(v){return 1-Math.pow(2,-10*v)};module.exports=Out}),(function(module,exports){var InOut=function(v){if((v*=2)<1){return 0.5*Math.pow(2,10*(v-1))}else{return 0.5*(2-Math.pow(2,-10*(v-1)))}};module.exports=InOut}),(function(module,exports){var Linear=function(v){return v};module.exports=Linear}),(function(module,exports){var In=function(v){return v*v};module.exports=In}),(function(module,exports){var Out=function(v){return v*(2-v)};module.exports=Out}),(function(module,exports){var InOut=function(v){if((v*=2)<1){return 0.5*v*v}else{return-0.5*(--v*(v-2)-1)}};module.exports=InOut}),(function(module,exports){var In=function(v){return v*v*v*v};module.exports=In}),(function(module,exports){var Out=function(v){return 1-(--v*v*v*v)};module.exports=Out}),(function(module,exports){var InOut=function(v){if((v*=2)<1){return 0.5*v*v*v*v}else{return-0.5*((v-=2)*v*v*v-2)}};module.exports=InOut}),(function(module,exports){var In=function(v){return v*v*v*v*v};module.exports=In}),(function(module,exports){var Out=function(v){return--v*v*v*v*v+1};module.exports=Out}),(function(module,exports){var InOut=function(v){if((v*=2)<1){return 0.5*v*v*v*v*v}else{return 0.5*((v-=2)*v*v*v*v+2)}};module.exports=InOut}),(function(module,exports){var In=function(v){if(v===0){return 0}else if(v===1){return 1}else{return 1-Math.cos(v*Math.PI/2)}};module.exports=In}),(function(module,exports){var Out=function(v){if(v===0){return 0}else if(v===1){return 1}else{return Math.sin(v*Math.PI/2)}};module.exports=Out}),(function(module,exports){var InOut=function(v){if(v===0){return 0}else if(v===1){return 1}else{return 0.5*(1-Math.cos(Math.PI*v))}};module.exports=InOut}),(function(module,exports){var Stepped=function(v,steps){if(steps===undefined){steps=1}if(v<=0){return 0}else if(v>=1){return 1}else{return(((steps*v)|0)+1)*(1/steps)}};module.exports=Stepped}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Events=__webpack_require__(40);var Vector2=__webpack_require__(3);var Shake=new Class({initialize:function Shake(camera){this.camera=camera;this.isRunning=false;this.duration=0;this.intensity=new Vector2();this.progress=0;this._elapsed=0;this._offsetX=0;this._offsetY=0;this._onUpdate;this._onUpdateScope},start:function(duration,intensity,force,callback,context){if(duration===undefined){duration=100}if(intensity===undefined){intensity=0.05}if(force===undefined){force=false}if(callback===undefined){callback=null}if(context===undefined){context=this.camera.scene}if(!force&&this.isRunning){return this.camera}this.isRunning=true;this.duration=duration;this.progress=0;if(typeof intensity==='number'){this.intensity.set(intensity)}else{this.intensity.set(intensity.x,intensity.y)}this._elapsed=0;this._offsetX=0;this._offsetY=0;this._onUpdate=callback;this._onUpdateScope=context;this.camera.emit(Events.SHAKE_START,this.camera,this,duration,intensity);return this.camera},preRender:function(){if(this.isRunning){this.camera.matrix.translate(this._offsetX,this._offsetY)}},update:function(time,delta){if(!this.isRunning){return}this._elapsed+=delta;this.progress=Clamp(this._elapsed/this.duration,0,1);if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,this.camera,this.progress)}if(this._elapsed<this.duration){var intensity=this.intensity;var width=this.camera._cw;var height=this.camera._ch;var zoom=this.camera.zoom;this._offsetX=(Math.random()*intensity.x*width*2-intensity.x*width)*zoom;this._offsetY=(Math.random()*intensity.y*height*2-intensity.y*height)*zoom;if(this.camera.roundPixels){this._offsetX=Math.round(this._offsetX);this._offsetY=Math.round(this._offsetY)}}else{this.effectComplete()}},effectComplete:function(){this._offsetX=0;this._offsetY=0;this._onUpdate=null;this._onUpdateScope=null;this.isRunning=false;this.camera.emit(Events.SHAKE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=false;this._offsetX=0;this._offsetY=0;this._onUpdate=null;this._onUpdateScope=null},destroy:function(){this.reset();this.camera=null;this.intensity=null}});module.exports=Shake}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Events=__webpack_require__(40);var EaseMap=__webpack_require__(115);var RotateTo=new Class({initialize:function RotateTo(camera){this.camera=camera;this.isRunning=false;this.duration=0;this.source=0;this.current=0;this.destination=0;this.ease;this.progress=0;this._elapsed=0;this._onUpdate;this._onUpdateScope;this.clockwise=true;this.shortestPath=false},start:function(radians,shortestPath,duration,ease,force,callback,context){if(duration===undefined){duration=1000}if(ease===undefined){ease=EaseMap.Linear}if(force===undefined){force=false}if(callback===undefined){callback=null}if(context===undefined){context=this.camera.scene}if(shortestPath===undefined){shortestPath=false}this.shortestPath=shortestPath;var tmpDestination=radians;if(radians<0){tmpDestination=-1*radians;this.clockwise=false}else{this.clockwise=true}var maxRad=(360*Math.PI)/180;tmpDestination=tmpDestination-(Math.floor(tmpDestination/maxRad)*maxRad);var cam=this.camera;if(!force&&this.isRunning){return cam}this.isRunning=true;this.duration=duration;this.progress=0;this.source=cam.rotation;this.destination=tmpDestination;if(typeof ease==='string'&&EaseMap.hasOwnProperty(ease)){this.ease=EaseMap[ease]}else if(typeof ease==='function'){this.ease=ease}this._elapsed=0;this._onUpdate=callback;this._onUpdateScope=context;if(this.shortestPath){var cwDist=0;var acwDist=0;if(this.destination>this.source){cwDist=Math.abs(this.destination-this.source)}else{cwDist=(Math.abs(this.destination+maxRad)-this.source)}if(this.source>this.destination){acwDist=Math.abs(this.source-this.destination)}else{acwDist=(Math.abs(this.source+maxRad)-this.destination)}if(cwDist<acwDist){this.clockwise=true}else if(cwDist>acwDist){this.clockwise=false}}this.camera.emit(Events.ROTATE_START,this.camera,this,duration,tmpDestination);return cam},update:function(time,delta){if(!this.isRunning){return}this._elapsed+=delta;var progress=Clamp(this._elapsed/this.duration,0,1);this.progress=progress;var cam=this.camera;if(this._elapsed<this.duration){var v=this.ease(progress);this.current=cam.rotation;var distance=0;var maxRad=(360*Math.PI)/180;var target=this.destination;var current=this.current;if(this.clockwise===false){target=this.current;current=this.destination}if(target>=current){distance=Math.abs(target-current)}else{distance=(Math.abs(target+maxRad)-current)}var r=0;if(this.clockwise){r=(cam.rotation+(distance*v))}else{r=(cam.rotation-(distance*v))}cam.rotation=r;if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,cam,progress,r)}}else{cam.rotation=this.destination;if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,cam,progress,this.destination)}this.effectComplete()}},effectComplete:function(){this._onUpdate=null;this._onUpdateScope=null;this.isRunning=false;this.camera.emit(Events.ROTATE_COMPLETE,this.camera,this)},reset:function(){this.isRunning=false;this._onUpdate=null;this._onUpdateScope=null},destroy:function(){this.reset();this.camera=null;this.source=null;this.destination=null}});module.exports=RotateTo}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var EaseMap=__webpack_require__(115);var Events=__webpack_require__(40);var Zoom=new Class({initialize:function Zoom(camera){this.camera=camera;this.isRunning=false;this.duration=0;this.source=1;this.destination=1;this.ease;this.progress=0;this._elapsed=0;this._onUpdate;this._onUpdateScope},start:function(zoom,duration,ease,force,callback,context){if(duration===undefined){duration=1000}if(ease===undefined){ease=EaseMap.Linear}if(force===undefined){force=false}if(callback===undefined){callback=null}if(context===undefined){context=this.camera.scene}var cam=this.camera;if(!force&&this.isRunning){return cam}this.isRunning=true;this.duration=duration;this.progress=0;this.source=cam.zoom;this.destination=zoom;if(typeof ease==='string'&&EaseMap.hasOwnProperty(ease)){this.ease=EaseMap[ease]}else if(typeof ease==='function'){this.ease=ease}this._elapsed=0;this._onUpdate=callback;this._onUpdateScope=context;this.camera.emit(Events.ZOOM_START,this.camera,this,duration,zoom);return cam},update:function(time,delta){if(!this.isRunning){return}this._elapsed+=delta;this.progress=Clamp(this._elapsed/this.duration,0,1);if(this._elapsed<this.duration){this.camera.zoom=this.source+((this.destination-this.source)*this.ease(this.progress));if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.camera.zoom)}}else{this.camera.zoom=this.destination;if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,this.camera,this.progress,this.destination)}this.effectComplete()}},effectComplete:function(){this._onUpdate=null;this._onUpdateScope=null;this.isRunning=false;this.camera.emit(Events.ZOOM_COMPLETE,this.camera,this)},reset:function(){this.isRunning=false;this._onUpdate=null;this._onUpdateScope=null},destroy:function(){this.reset();this.camera=null}});module.exports=Zoom}),(function(module,exports,__webpack_require__){var Camera=__webpack_require__(293);var Class=__webpack_require__(0);var GetFastValue=__webpack_require__(2);var PluginCache=__webpack_require__(23);var RectangleContains=__webpack_require__(48);var ScaleEvents=__webpack_require__(92);var SceneEvents=__webpack_require__(22);var CameraManager=new Class({initialize:function CameraManager(scene){this.scene=scene;this.systems=scene.sys;this.roundPixels=scene.sys.game.config.roundPixels;this.cameras=[];this.main;this.default;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){var sys=this.systems;if(sys.settings.cameras){this.fromJSON(sys.settings.cameras)}else{this.add()}this.main=this.cameras[0];this.default=new Camera(0,0,sys.scale.width,sys.scale.height).setScene(this.scene);sys.game.scale.on(ScaleEvents.RESIZE,this.onResize,this);this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){if(!this.main){var sys=this.systems;if(sys.settings.cameras){this.fromJSON(sys.settings.cameras)}else{this.add()}this.main=this.cameras[0]}var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.UPDATE,this.update,this);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this)},add:function(x,y,width,height,makeMain,name){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.scene.sys.scale.width}if(height===undefined){height=this.scene.sys.scale.height}if(makeMain===undefined){makeMain=false}if(name===undefined){name=''}var camera=new Camera(x,y,width,height);camera.setName(name);camera.setScene(this.scene);camera.setRoundPixels(this.roundPixels);camera.id=this.getNextID();this.cameras.push(camera);if(makeMain){this.main=camera}return camera},addExisting:function(camera,makeMain){if(makeMain===undefined){makeMain=false}var index=this.cameras.indexOf(camera);if(index===-1){camera.id=this.getNextID();camera.setRoundPixels(this.roundPixels);this.cameras.push(camera);if(makeMain){this.main=camera}return camera}return null},getNextID:function(){var cameras=this.cameras;var testID=1;for(var t=0;t<32;t++){var found=false;for(var i=0;i<cameras.length;i++){var camera=cameras[i];if(camera&&camera.id===testID){found=true;continue}}if(found){testID=testID<<1}else{return testID}}return 0},getTotal:function(isVisible){if(isVisible===undefined){isVisible=false}var total=0;var cameras=this.cameras;for(var i=0;i<cameras.length;i++){var camera=cameras[i];if(!isVisible||(isVisible&&camera.visible)){total++}}return total},fromJSON:function(config){if(!Array.isArray(config)){config=[config]}var gameWidth=this.scene.sys.scale.width;var gameHeight=this.scene.sys.scale.height;for(var i=0;i<config.length;i++){var cameraConfig=config[i];var x=GetFastValue(cameraConfig,'x',0);var y=GetFastValue(cameraConfig,'y',0);var width=GetFastValue(cameraConfig,'width',gameWidth);var height=GetFastValue(cameraConfig,'height',gameHeight);var camera=this.add(x,y,width,height);camera.name=GetFastValue(cameraConfig,'name','');camera.zoom=GetFastValue(cameraConfig,'zoom',1);camera.rotation=GetFastValue(cameraConfig,'rotation',0);camera.scrollX=GetFastValue(cameraConfig,'scrollX',0);camera.scrollY=GetFastValue(cameraConfig,'scrollY',0);camera.roundPixels=GetFastValue(cameraConfig,'roundPixels',false);camera.visible=GetFastValue(cameraConfig,'visible',true);var backgroundColor=GetFastValue(cameraConfig,'backgroundColor',false);if(backgroundColor){camera.setBackgroundColor(backgroundColor)}var boundsConfig=GetFastValue(cameraConfig,'bounds',null);if(boundsConfig){var bx=GetFastValue(boundsConfig,'x',0);var by=GetFastValue(boundsConfig,'y',0);var bwidth=GetFastValue(boundsConfig,'width',gameWidth);var bheight=GetFastValue(boundsConfig,'height',gameHeight);camera.setBounds(bx,by,bwidth,bheight)}}return this},getCamera:function(name){var cameras=this.cameras;for(var i=0;i<cameras.length;i++){if(cameras[i].name===name){return cameras[i]}}return null},getCamerasBelowPointer:function(pointer){var cameras=this.cameras;var x=pointer.x;var y=pointer.y;var output=[];for(var i=0;i<cameras.length;i++){var camera=cameras[i];if(camera.visible&&camera.inputEnabled&&RectangleContains(camera,x,y)){output.unshift(camera)}}return output},remove:function(camera,runDestroy){if(runDestroy===undefined){runDestroy=true}if(!Array.isArray(camera)){camera=[camera]}var total=0;var cameras=this.cameras;for(var i=0;i<camera.length;i++){var index=cameras.indexOf(camera[i]);if(index!==-1){if(runDestroy){cameras[index].destroy()}cameras.splice(index,1);total++}}if(!this.main&&cameras[0]){this.main=cameras[0]}return total},render:function(renderer,children,interpolation){var scene=this.scene;var cameras=this.cameras;for(var i=0;i<this.cameras.length;i++){var camera=cameras[i];if(camera.visible&&camera.alpha>0){camera.preRender(1);renderer.render(scene,children,interpolation,camera)}}},resetAll:function(){for(var i=0;i<this.cameras.length;i++){this.cameras[i].destroy()}this.cameras=[];this.main=this.add();return this.main},update:function(time,delta){for(var i=0;i<this.cameras.length;i++){this.cameras[i].update(time,delta)}},onResize:function(gameSize,baseSize,displaySize,resolution,previousWidth,previousHeight){for(var i=0;i<this.cameras.length;i++){var cam=this.cameras[i];if(cam._x===0&&cam._y===0&&cam._width===previousWidth&&cam._height===previousHeight){cam.setSize(baseSize.width,baseSize.height)}}},resize:function(width,height){for(var i=0;i<this.cameras.length;i++){this.cameras[i].setSize(width,height)}},shutdown:function(){this.main=undefined;for(var i=0;i<this.cameras.length;i++){this.cameras[i].destroy()}this.cameras=[];var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.UPDATE,this.update,this);eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.default.destroy();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('CameraManager',CameraManager,'cameras');module.exports=CameraManager}),(function(module,exports){module.exports='enterfullscreen'}),(function(module,exports){module.exports='fullscreenfailed'}),(function(module,exports){module.exports='fullscreenunsupported'}),(function(module,exports){module.exports='leavefullscreen'}),(function(module,exports){module.exports='orientationchange'}),(function(module,exports){module.exports='resize'}),(function(module,exports){module.exports='boot'}),(function(module,exports){module.exports='create'}),(function(module,exports){module.exports='destroy'}),(function(module,exports){module.exports='pause'}),(function(module,exports){module.exports='postupdate'}),(function(module,exports){module.exports='preupdate'}),(function(module,exports){module.exports='ready'}),(function(module,exports){module.exports='render'}),(function(module,exports){module.exports='resume'}),(function(module,exports){module.exports='shutdown'}),(function(module,exports){module.exports='sleep'}),(function(module,exports){module.exports='start'}),(function(module,exports){module.exports='transitioncomplete'}),(function(module,exports){module.exports='transitioninit'}),(function(module,exports){module.exports='transitionout'}),(function(module,exports){module.exports='transitionstart'}),(function(module,exports){module.exports='transitionwake'}),(function(module,exports){module.exports='update'}),(function(module,exports){module.exports='wake'}),(function(module,exports,__webpack_require__){module.exports={Config:__webpack_require__(314),CreateRenderer:__webpack_require__(338),DebugHeader:__webpack_require__(342),Events:__webpack_require__(20),TimeStep:__webpack_require__(343),VisibilityHandler:__webpack_require__(345)}}),(function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error('setTimeout has not been defined')}function defaultClearTimeout(){throw new Error('clearTimeout has not been defined')}(function(){try{if(typeof setTimeout==='function'){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==='function'){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}}())function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title='browser';process.browser=true;process.env={};process.argv=[];process.version='';process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]}process.binding=function(name){throw new Error('process.binding is not supported')};process.cwd=function(){return'/'};process.chdir=function(dir){throw new Error('process.chdir is not supported')};process.umask=function(){return 0}}),(function(module,exports,__webpack_require__){var Browser=__webpack_require__(118);var Input={gamepads:false,mspointer:false,touch:false,wheelEvent:null};function init(){if('ontouchstart'in document.documentElement||(navigator.maxTouchPoints&&navigator.maxTouchPoints>=1)){Input.touch=true}if(navigator.msPointerEnabled||navigator.pointerEnabled){Input.mspointer=true}if(navigator.getGamepads){Input.gamepads=true}if('onwheel'in window||(Browser.ie&&'WheelEvent'in window)){Input.wheelEvent='wheel'}else if('onmousewheel'in window){Input.wheelEvent='mousewheel'}else if(Browser.firefox&&'MouseScrollEvent'in window){Input.wheelEvent='DOMMouseScroll'}return Input}module.exports=init()}),(function(module,exports,__webpack_require__){var Browser=__webpack_require__(118);var Audio={audioData:false,dolby:false,m4a:false,mp3:false,ogg:false,opus:false,wav:false,webAudio:false,webm:false};function init(){Audio.audioData=!!(window['Audio']);Audio.webAudio=!!(window['AudioContext']||window['webkitAudioContext']);var audioElement=document.createElement('audio');var result=!!audioElement.canPlayType;try{if(result){if(audioElement.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,'')){Audio.ogg=true}if(audioElement.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,'')||audioElement.canPlayType('audio/opus;').replace(/^no$/,'')){Audio.opus=true}if(audioElement.canPlayType('audio/mpeg;').replace(/^no$/,'')){Audio.mp3=true}if(audioElement.canPlayType('audio/wav; codecs="1"').replace(/^no$/,'')){Audio.wav=true}if(audioElement.canPlayType('audio/x-m4a;')||audioElement.canPlayType('audio/aac;').replace(/^no$/,'')){Audio.m4a=true}if(audioElement.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,'')){Audio.webm=true}if(audioElement.canPlayType('audio/mp4;codecs="ec-3"')!==''){if(Browser.edge){Audio.dolby=true}else if(Browser.safari&&Browser.safariVersion>=9){if((/Mac OS X (\n+)_(\n+)/).test(navigator.userAgent)){var major=parseInt(RegExp.$1,10);var minor=parseInt(RegExp.$2,10);if((major===10&&minor>=11)||major>10){Audio.dolby=true}}}}}}catch(e){}return Audio}module.exports=init()}),(function(module,exports){var Video={h264:false,hls:false,mp4:false,ogg:false,vp9:false,webm:false};function init(){var videoElement=document.createElement('video');var result=!!videoElement.canPlayType;try{if(result){if(videoElement.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,'')){Video.ogg=true}if(videoElement.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,'')){Video.h264=true;Video.mp4=true}if(videoElement.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,'')){Video.webm=true}if(videoElement.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,'')){Video.vp9=true}if(videoElement.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,'')){Video.hls=true}}}catch(e){}return Video}module.exports=init()}),(function(module,exports){var Fullscreen={available:false,cancel:'',keyboard:false,request:''};function init(){var i;var suffix1='Fullscreen';var suffix2='FullScreen';var fs=['request'+suffix1,'request'+suffix2,'webkitRequest'+suffix1,'webkitRequest'+suffix2,'msRequest'+suffix1,'msRequest'+suffix2,'mozRequest'+suffix2,'mozRequest'+suffix1];for(i=0;i<fs.length;i++){if(document.documentElement[fs[i]]){Fullscreen.available=true;Fullscreen.request=fs[i];break}}var cfs=['cancel'+suffix2,'exit'+suffix1,'webkitCancel'+suffix2,'webkitExit'+suffix1,'msCancel'+suffix2,'msExit'+suffix1,'mozCancel'+suffix2,'mozExit'+suffix1];if(Fullscreen.available){for(i=0;i<cfs.length;i++){if(document[cfs[i]]){Fullscreen.cancel=cfs[i];break}}}if(window['Element']&&Element['ALLOW_KEYBOARD_INPUT']&&!(/ Version\n5\'1(?:\'\n+)? Safari\w/).test(navigator.userAgent)){Fullscreen.keyboard=true}Object.defineProperty(Fullscreen,'active',{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}});return Fullscreen}module.exports=init()}),(function(module,exports,__webpack_require__){module.exports={Between:__webpack_require__(317),BetweenPoints:__webpack_require__(318),BetweenPointsY:__webpack_require__(735),BetweenY:__webpack_require__(736),CounterClockwise:__webpack_require__(737),Normalize:__webpack_require__(319),Random:__webpack_require__(738),RandomDegrees:__webpack_require__(739),Reverse:__webpack_require__(740),RotateTo:__webpack_require__(741),ShortestBetween:__webpack_require__(742),Wrap:__webpack_require__(235),WrapDegrees:__webpack_require__(236)}}),(function(module,exports){var BetweenPointsY=function(point1,point2){return Math.atan2(point2.x-point1.x,point2.y-point1.y)};module.exports=BetweenPointsY}),(function(module,exports){var BetweenY=function(x1,y1,x2,y2){return Math.atan2(x2-x1,y2-y1)};module.exports=BetweenY}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(13);var CounterClockwise=function(angle){if(angle>Math.PI){angle-=CONST.PI2}return Math.abs((((angle+CONST.TAU)%CONST.PI2)-CONST.PI2)%CONST.PI2)};module.exports=CounterClockwise}),(function(module,exports,__webpack_require__){var FloatBetween=__webpack_require__(119);var Random=function(){return FloatBetween(-Math.PI,Math.PI)};module.exports=Random}),(function(module,exports,__webpack_require__){var FloatBetween=__webpack_require__(119);var RandomDegrees=function(){return FloatBetween(-180,180)};module.exports=RandomDegrees}),(function(module,exports,__webpack_require__){var Normalize=__webpack_require__(319);var Reverse=function(angle){return Normalize(angle+Math.PI)};module.exports=Reverse}),(function(module,exports,__webpack_require__){var MATH_CONST=__webpack_require__(13);var RotateTo=function(currentAngle,targetAngle,lerp){if(lerp===undefined){lerp=0.05}if(currentAngle===targetAngle){return currentAngle}if(Math.abs(targetAngle-currentAngle)<=lerp||Math.abs(targetAngle-currentAngle)>=(MATH_CONST.PI2-lerp)){currentAngle=targetAngle}else{if(Math.abs(targetAngle-currentAngle)>Math.PI){if(targetAngle<currentAngle){targetAngle+=MATH_CONST.PI2}else{targetAngle-=MATH_CONST.PI2}}if(targetAngle>currentAngle){currentAngle+=lerp}else if(targetAngle<currentAngle){currentAngle-=lerp}}return currentAngle};module.exports=RotateTo}),(function(module,exports){var ShortestBetween=function(angle1,angle2){var difference=angle2-angle1;if(difference===0){return 0}var times=Math.floor((difference-(-180))/360);return difference-(times*360)};module.exports=ShortestBetween}),(function(module,exports,__webpack_require__){module.exports={Between:__webpack_require__(53),BetweenPoints:__webpack_require__(320),BetweenPointsSquared:__webpack_require__(744),Chebyshev:__webpack_require__(745),Power:__webpack_require__(746),Snake:__webpack_require__(747),Squared:__webpack_require__(321)}}),(function(module,exports){var DistanceBetweenPointsSquared=function(a,b){var dx=a.x-b.x;var dy=a.y-b.y;return dx*dx+dy*dy};module.exports=DistanceBetweenPointsSquared}),(function(module,exports){var ChebyshevDistance=function(x1,y1,x2,y2){return Math.max(Math.abs(x1-x2),Math.abs(y1-y2))};module.exports=ChebyshevDistance}),(function(module,exports){var DistancePower=function(x1,y1,x2,y2,pow){if(pow===undefined){pow=2}return Math.sqrt(Math.pow(x2-x1,pow)+Math.pow(y2-y1,pow))};module.exports=DistancePower}),(function(module,exports){var SnakeDistance=function(x1,y1,x2,y2){return Math.abs(x1-x2)+Math.abs(y1-y2)};module.exports=SnakeDistance}),(function(module,exports,__webpack_require__){module.exports={Back:__webpack_require__(302),Bounce:__webpack_require__(303),Circular:__webpack_require__(304),Cubic:__webpack_require__(305),Elastic:__webpack_require__(306),Expo:__webpack_require__(307),Linear:__webpack_require__(308),Quadratic:__webpack_require__(309),Quartic:__webpack_require__(310),Quintic:__webpack_require__(311),Sine:__webpack_require__(312),Stepped:__webpack_require__(313)}}),(function(module,exports,__webpack_require__){module.exports={Ceil:__webpack_require__(750),Equal:__webpack_require__(106),Floor:__webpack_require__(751),GreaterThan:__webpack_require__(322),LessThan:__webpack_require__(323)}}),(function(module,exports){var Ceil=function(value,epsilon){if(epsilon===undefined){epsilon=0.0001}return Math.ceil(value-epsilon)};module.exports=Ceil}),(function(module,exports){var Floor=function(value,epsilon){if(epsilon===undefined){epsilon=0.0001}return Math.floor(value+epsilon)};module.exports=Floor}),(function(module,exports,__webpack_require__){module.exports={Bezier:__webpack_require__(753),CatmullRom:__webpack_require__(754),CubicBezier:__webpack_require__(326),Linear:__webpack_require__(755),QuadraticBezier:__webpack_require__(327),SmoothStep:__webpack_require__(328),SmootherStep:__webpack_require__(756)}}),(function(module,exports,__webpack_require__){var Bernstein=__webpack_require__(324);var BezierInterpolation=function(v,k){var b=0;var n=v.length-1;for(var i=0;i<=n;i++){b+=Math.pow(1-k,n-i)*Math.pow(k,i)*v[i]*Bernstein(n,i)}return b};module.exports=BezierInterpolation}),(function(module,exports,__webpack_require__){var CatmullRom=__webpack_require__(171);var CatmullRomInterpolation=function(v,k){var m=v.length-1;var f=m*k;var i=Math.floor(f);if(v[0]===v[m]){if(k<0){i=Math.floor(f=m*(1+k))}return CatmullRom(f-i,v[(i-1+m)%m],v[i],v[(i+1)%m],v[(i+2)%m])}else{if(k<0){return v[0]-(CatmullRom(-f,v[0],v[0],v[1],v[1])-v[0])}if(k>1){return v[m]-(CatmullRom(f-m,v[m],v[m],v[m-1],v[m-1])-v[m])}return CatmullRom(f-i,v[i?i-1:0],v[i],v[m<i+1?m:i+1],v[m<i+2?m:i+2])}};module.exports=CatmullRomInterpolation}),(function(module,exports,__webpack_require__){var Linear=__webpack_require__(116);var LinearInterpolation=function(v,k){var m=v.length-1;var f=m*k;var i=Math.floor(f);if(k<0){return Linear(v[0],v[1],f)}else if(k>1){return Linear(v[m],v[m-1],m-f)}else{return Linear(v[i],v[(i+1>m)?m:i+1],f-i)}};module.exports=LinearInterpolation}),(function(module,exports,__webpack_require__){var SmootherStep=__webpack_require__(160);var SmootherStepInterpolation=function(t,min,max){return min+(max-min)*SmootherStep(t,0,1)};module.exports=SmootherStepInterpolation}),(function(module,exports,__webpack_require__){module.exports={GetNext:__webpack_require__(329),IsSize:__webpack_require__(120),IsValue:__webpack_require__(758)}}),(function(module,exports){var IsValuePowerOfTwo=function(value){return(value>0&&(value&(value-1))===0)};module.exports=IsValuePowerOfTwo}),(function(module,exports,__webpack_require__){module.exports={Ceil:__webpack_require__(330),Floor:__webpack_require__(93),To:__webpack_require__(760)}}),(function(module,exports){var SnapTo=function(value,gap,start,divide){if(start===undefined){start=0}if(gap===0){return value}value-=start;value=gap*Math.round(value/gap);return(divide)?(start+value)/gap:start+value};module.exports=SnapTo}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var RandomDataGenerator=new Class({initialize:function RandomDataGenerator(seeds){if(seeds===undefined){seeds=[(Date.now()*Math.random()).toString()]}this.c=1;this.s0=0;this.s1=0;this.s2=0;this.n=0;this.signs=[-1,1];if(seeds){this.init(seeds)}},rnd:function(){var t=2091639*this.s0+this.c*2.3283064365386963e-10;this.c=t|0;this.s0=this.s1;this.s1=this.s2;this.s2=t-this.c;return this.s2},hash:function(data){var h;var n=this.n;data=data.toString();for(var i=0;i<data.length;i++){n+=data.charCodeAt(i);h=0.02519603282416938*n;n=h>>>0;h-=n;h*=n;n=h>>>0;h-=n;n+=h*0x100000000}this.n=n;return(n>>>0)*2.3283064365386963e-10},init:function(seeds){if(typeof seeds==='string'){this.state(seeds)}else{this.sow(seeds)}},sow:function(seeds){this.n=0xefc8249d;this.s0=this.hash(' ');this.s1=this.hash(' ');this.s2=this.hash(' ');this.c=1;if(!seeds){return}for(var i=0;i<seeds.length&&(seeds[i]!=null);i++){var seed=seeds[i];this.s0-=this.hash(seed);this.s0+=~~(this.s0<0);this.s1-=this.hash(seed);this.s1+=~~(this.s1<0);this.s2-=this.hash(seed);this.s2+=~~(this.s2<0)}},integer:function(){return this.rnd()*0x100000000},frac:function(){return this.rnd()+(this.rnd()*0x200000|0)*1.1102230246251565e-16},real:function(){return this.integer()+this.frac()},integerInRange:function(min,max){return Math.floor(this.realInRange(0,max-min+1)+min)},between:function(min,max){return Math.floor(this.realInRange(0,max-min+1)+min)},realInRange:function(min,max){return this.frac()*(max-min)+min},normal:function(){return 1-(2*this.frac())},uuid:function(){var a='';var b='';for(b=a='';a++<36;b+=~a%5|a*3&4?(a^15?8^this.frac()*(a^20?16:4):4).toString(16):'-'){}return b},pick:function(array){return array[this.integerInRange(0,array.length-1)]},sign:function(){return this.pick(this.signs)},weightedPick:function(array){return array[~~(Math.pow(this.frac(),2)*(array.length-1)+0.5)]},timestamp:function(min,max){return this.realInRange(min||946684800000,max||1577862000000)},angle:function(){return this.integerInRange(-180,180)},rotation:function(){return this.realInRange(-3.1415926,3.1415926)},state:function(state){if(typeof state==='string'&&state.match(/^!rnd/)){state=state.split(',');this.c=parseFloat(state[1]);this.s0=parseFloat(state[2]);this.s1=parseFloat(state[3]);this.s2=parseFloat(state[4])}return['!rnd',this.c,this.s0,this.s1,this.s2].join(',')},shuffle:function(array){var len=array.length-1;for(var i=len;i>0;i--){var randomIndex=Math.floor(this.frac()*(i+1));var itemAtIndex=array[randomIndex];array[randomIndex]=array[i];array[i]=itemAtIndex}return array}});module.exports=RandomDataGenerator}),(function(module,exports){var Average=function(values){var sum=0;for(var i=0;i<values.length;i++){sum+=(+values[i])}return sum/values.length};module.exports=Average}),(function(module,exports){var CeilTo=function(value,place,base){if(place===undefined){place=0}if(base===undefined){base=10}var p=Math.pow(base,-place);return Math.ceil(value*p)/p};module.exports=CeilTo}),(function(module,exports){var Difference=function(a,b){return Math.abs(a-b)};module.exports=Difference}),(function(module,exports){var FloorTo=function(value,place,base){if(place===undefined){place=0}if(base===undefined){base=10}var p=Math.pow(base,-place);return Math.floor(value*p)/p};module.exports=FloorTo}),(function(module,exports){var GetSpeed=function(distance,time){return(distance/time)/1000};module.exports=GetSpeed}),(function(module,exports){var IsEven=function(value){return(value==parseFloat(value))?!(value%2):void 0};module.exports=IsEven}),(function(module,exports){var IsEvenStrict=function(value){return(value===parseFloat(value))?!(value%2):void 0};module.exports=IsEvenStrict}),(function(module,exports){var MaxAdd=function(value,amount,max){return Math.min(value+amount,max)};module.exports=MaxAdd}),(function(module,exports){var MinSub=function(value,amount,min){return Math.max(value-amount,min)};module.exports=MinSub}),(function(module,exports){var Percent=function(value,min,max,upperMax){if(max===undefined){max=min+1}var percentage=(value-min)/(max-min);if(percentage>1){if(upperMax!==undefined){percentage=((upperMax-value))/(upperMax-max);if(percentage<0){percentage=0}}else{percentage=1}}else if(percentage<0){percentage=0}return percentage};module.exports=Percent}),(function(module,exports){var RandomXY=function(vector,scale){if(scale===undefined){scale=1}var r=Math.random()*2*Math.PI;vector.x=Math.cos(r)*scale;vector.y=Math.sin(r)*scale;return vector};module.exports=RandomXY}),(function(module,exports){var RandomXYZ=function(vec3,radius){if(radius===undefined){radius=1}var r=Math.random()*2*Math.PI;var z=(Math.random()*2)-1;var zScale=Math.sqrt(1-z*z)*radius;vec3.x=Math.cos(r)*zScale;vec3.y=Math.sin(r)*zScale;vec3.z=z*radius;return vec3};module.exports=RandomXYZ}),(function(module,exports){var RandomXYZW=function(vec4,scale){if(scale===undefined){scale=1}vec4.x=(Math.random()*2-1)*scale;vec4.y=(Math.random()*2-1)*scale;vec4.z=(Math.random()*2-1)*scale;vec4.w=(Math.random()*2-1)*scale;return vec4};module.exports=RandomXYZW}),(function(module,exports){var RotateTo=function(point,x,y,angle,distance){point.x=x+(distance*Math.cos(angle));point.y=y+(distance*Math.sin(angle));return point};module.exports=RotateTo}),(function(module,exports){var RoundTo=function(value,place,base){if(place===undefined){place=0}if(base===undefined){base=10}var p=Math.pow(base,-place);return Math.round(value*p)/p};module.exports=RoundTo}),(function(module,exports){var SinCosTableGenerator=function(length,sinAmp,cosAmp,frequency){if(sinAmp===undefined){sinAmp=1}if(cosAmp===undefined){cosAmp=1}if(frequency===undefined){frequency=1}frequency*=Math.PI/length;var cos=[];var sin=[];for(var c=0;c<length;c++){cosAmp-=sinAmp*frequency;sinAmp+=cosAmp*frequency;cos[c]=cosAmp;sin[c]=sinAmp}return{sin:sin,cos:cos,length:length}};module.exports=SinCosTableGenerator}),(function(module,exports,__webpack_require__){var Vector2=__webpack_require__(3);var ToXY=function(index,width,height,out){if(out===undefined){out=new Vector2()}var x=0;var y=0;var total=width*height;if(index>0&&index<=total){if(index>width-1){y=Math.floor(index/width);x=index-(y*width)}else{x=index}out.set(x,y)}return out};module.exports=ToXY}),(function(module,exports){var Within=function(a,b,tolerance){return(Math.abs(a-b)<=tolerance)};module.exports=Within}),(function(module,exports,__webpack_require__){var Vector3=__webpack_require__(174);var Matrix4=__webpack_require__(336);var Quaternion=__webpack_require__(337);var tmpMat4=new Matrix4();var tmpQuat=new Quaternion();var tmpVec3=new Vector3();var RotateVec3=function(vec,axis,radians){tmpQuat.setAxisAngle(axis,radians);tmpMat4.fromRotationTranslation(tmpQuat,tmpVec3.set(0,0,0));return vec.transformMat4(tmpMat4)};module.exports=RotateVec3}),(function(module,exports){module.exports='addtexture'}),(function(module,exports){module.exports='onerror'}),(function(module,exports){module.exports='onload'}),(function(module,exports){module.exports='ready'}),(function(module,exports){module.exports='removetexture'}),(function(module,exports){module.exports=['#define SHADER_NAME PHASER_BITMAP_MASK_FS','','precision mediump float;','','uniform vec2 uResolution;','uniform sampler2D uMainSampler;','uniform sampler2D uMaskSampler;','uniform bool uInvertMaskAlpha;','','void main()','{','    vec2 uv = gl_FragCoord.xy / uResolution;','    vec4 mainColor = texture2D(uMainSampler, uv);','    vec4 maskColor = texture2D(uMaskSampler, uv);','    float alpha = mainColor.a;','','    if (!uInvertMaskAlpha)','    {','        alpha *= (maskColor.a);','    }','    else','    {','        alpha *= (1.0 - maskColor.a);','    }','','    gl_FragColor = vec4(mainColor.rgb * alpha, alpha);','}',''].join('\n')}),(function(module,exports){module.exports=['#define SHADER_NAME PHASER_BITMAP_MASK_VS','','precision mediump float;','','attribute vec2 inPosition;','','void main()','{','    gl_Position = vec4(inPosition, 0.0, 1.0);','}',''].join('\n')}),(function(module,exports){module.exports=['#define SHADER_NAME PHASER_FORWARD_DIFFUSE_FS','','precision mediump float;','','struct Light','{','    vec2 position;','    vec3 color;','    float intensity;','    float radius;','};','','const int kMaxLights = %LIGHT_COUNT%;','','uniform vec4 uCamera; /* x, y, rotation, zoom */','uniform vec2 uResolution;','uniform sampler2D uMainSampler;','uniform sampler2D uNormSampler;','uniform vec3 uAmbientLightColor;','uniform Light uLights[kMaxLights];','uniform mat3 uInverseRotationMatrix;','','varying vec2 outTexCoord;','varying vec4 outTint;','','void main()','{','    vec3 finalColor = vec3(0.0, 0.0, 0.0);','    vec4 color = texture2D(uMainSampler, outTexCoord) * vec4(outTint.rgb * outTint.a, outTint.a);','    vec3 normalMap = texture2D(uNormSampler, outTexCoord).rgb;','    vec3 normal = normalize(uInverseRotationMatrix * vec3(normalMap * 2.0 - 1.0));','    vec2 res = vec2(min(uResolution.x, uResolution.y)) * uCamera.w;','','    for (int index = 0; index < kMaxLights; ++index)','    {','        Light light = uLights[index];','        vec3 lightDir = vec3((light.position.xy / res) - (gl_FragCoord.xy / res), 0.1);','        vec3 lightNormal = normalize(lightDir);','        float distToSurf = length(lightDir) * uCamera.w;','        float diffuseFactor = max(dot(normal, lightNormal), 0.0);','        float radius = (light.radius / res.x * uCamera.w) * uCamera.w;','        float attenuation = clamp(1.0 - distToSurf * distToSurf / (radius * radius), 0.0, 1.0);','        vec3 diffuse = light.color * diffuseFactor;','        finalColor += (attenuation * diffuse) * light.intensity;','    }','','    vec4 colorOutput = vec4(uAmbientLightColor + finalColor, 1.0);','    gl_FragColor = color * vec4(colorOutput.rgb * colorOutput.a, colorOutput.a);','','}',''].join('\n')}),(function(module,exports,__webpack_require__){module.exports={GenerateTexture:__webpack_require__(346),Palettes:__webpack_require__(790)}}),(function(module,exports,__webpack_require__){module.exports={ARNE16:__webpack_require__(347),C64:__webpack_require__(791),CGA:__webpack_require__(792),JMP:__webpack_require__(793),MSX:__webpack_require__(794)}}),(function(module,exports){module.exports={0:'#000',1:'#fff',2:'#8b4131',3:'#7bbdc5',4:'#8b41ac',5:'#6aac41',6:'#3931a4',7:'#d5de73',8:'#945a20',9:'#5a4100',A:'#bd736a',B:'#525252',C:'#838383',D:'#acee8b',E:'#7b73de',F:'#acacac'}}),(function(module,exports){module.exports={0:'#000',1:'#2234d1',2:'#0c7e45',3:'#44aacc',4:'#8a3622',5:'#5c2e78',6:'#aa5c3d',7:'#b5b5b5',8:'#5e606e',9:'#4c81fb',A:'#6cd947',B:'#7be2f9',C:'#eb8a60',D:'#e23d69',E:'#ffd93f',F:'#fff'}}),(function(module,exports){module.exports={0:'#000',1:'#191028',2:'#46af45',3:'#a1d685',4:'#453e78',5:'#7664fe',6:'#833129',7:'#9ec2e8',8:'#dc534b',9:'#e18d79',A:'#d6b97b',B:'#e9d8a1',C:'#216c4b',D:'#d365c8',E:'#afaab9',F:'#f5f4eb'}}),(function(module,exports){module.exports={0:'#000',1:'#191028',2:'#46af45',3:'#a1d685',4:'#453e78',5:'#7664fe',6:'#833129',7:'#9ec2e8',8:'#dc534b',9:'#e18d79',A:'#d6b97b',B:'#e9d8a1',C:'#216c4b',D:'#d365c8',E:'#afaab9',F:'#fff'}}),(function(module,exports,__webpack_require__){module.exports={Path:__webpack_require__(796),CubicBezier:__webpack_require__(348),Curve:__webpack_require__(81),Ellipse:__webpack_require__(349),Line:__webpack_require__(350),QuadraticBezier:__webpack_require__(351),Spline:__webpack_require__(352)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CubicBezierCurve=__webpack_require__(348);var EllipseCurve=__webpack_require__(349);var GameObjectFactory=__webpack_require__(5);var LineCurve=__webpack_require__(350);var MovePathTo=__webpack_require__(797);var QuadraticBezierCurve=__webpack_require__(351);var Rectangle=__webpack_require__(11);var SplineCurve=__webpack_require__(352);var Vector2=__webpack_require__(3);var MATH_CONST=__webpack_require__(13);var Path=new Class({initialize:function Path(x,y){if(x===undefined){x=0}if(y===undefined){y=0}this.name='';this.curves=[];this.cacheLengths=[];this.autoClose=false;this.startPoint=new Vector2();this._tmpVec2A=new Vector2();this._tmpVec2B=new Vector2();if(typeof x==='object'){this.fromJSON(x)}else{this.startPoint.set(x,y)}},add:function(curve){this.curves.push(curve);return this},circleTo:function(radius,clockwise,rotation){if(clockwise===undefined){clockwise=false}return this.ellipseTo(radius,radius,0,360,clockwise,rotation)},closePath:function(){var startPoint=this.curves[0].getPoint(0);var endPoint=this.curves[this.curves.length-1].getPoint(1);if(!startPoint.equals(endPoint)){this.curves.push(new LineCurve(endPoint,startPoint))}return this},cubicBezierTo:function(x,y,control1X,control1Y,control2X,control2Y){var p0=this.getEndPoint();var p1;var p2;var p3;if(x instanceof Vector2){p1=x;p2=y;p3=control1X}else{p1=new Vector2(control1X,control1Y);p2=new Vector2(control2X,control2Y);p3=new Vector2(x,y)}return this.add(new CubicBezierCurve(p0,p1,p2,p3))},quadraticBezierTo:function(x,y,controlX,controlY){var p0=this.getEndPoint();var p1;var p2;if(x instanceof Vector2){p1=x;p2=y}else{p1=new Vector2(controlX,controlY);p2=new Vector2(x,y)}return this.add(new QuadraticBezierCurve(p0,p1,p2))},draw:function(graphics,pointsTotal){for(var i=0;i<this.curves.length;i++){var curve=this.curves[i];if(!curve.active){continue}curve.draw(graphics,pointsTotal)}return graphics},ellipseTo:function(xRadius,yRadius,startAngle,endAngle,clockwise,rotation){var ellipse=new EllipseCurve(0,0,xRadius,yRadius,startAngle,endAngle,clockwise,rotation);var end=this.getEndPoint(this._tmpVec2A);var start=ellipse.getStartPoint(this._tmpVec2B);end.subtract(start);ellipse.x=end.x;ellipse.y=end.y;return this.add(ellipse)},fromJSON:function(data){this.curves=[];this.cacheLengths=[];this.startPoint.set(data.x,data.y);this.autoClose=data.autoClose;for(var i=0;i<data.curves.length;i++){var curve=data.curves[i];switch(curve.type){case'LineCurve':this.add(LineCurve.fromJSON(curve));break;case'EllipseCurve':this.add(EllipseCurve.fromJSON(curve));break;case'SplineCurve':this.add(SplineCurve.fromJSON(curve));break;case'CubicBezierCurve':this.add(CubicBezierCurve.fromJSON(curve));break;case'QuadraticBezierCurve':this.add(QuadraticBezierCurve.fromJSON(curve));break}}return this},getBounds:function(out,accuracy){if(out===undefined){out=new Rectangle()}if(accuracy===undefined){accuracy=16}out.x=Number.MAX_VALUE;out.y=Number.MAX_VALUE;var bounds=new Rectangle();var maxRight=MATH_CONST.MIN_SAFE_INTEGER;var maxBottom=MATH_CONST.MIN_SAFE_INTEGER;for(var i=0;i<this.curves.length;i++){var curve=this.curves[i];if(!curve.active){continue}curve.getBounds(bounds,accuracy);out.x=Math.min(out.x,bounds.x);out.y=Math.min(out.y,bounds.y);maxRight=Math.max(maxRight,bounds.right);maxBottom=Math.max(maxBottom,bounds.bottom)}out.right=maxRight;out.bottom=maxBottom;return out},getCurveLengths:function(){if(this.cacheLengths.length===this.curves.length){return this.cacheLengths}var lengths=[];var sums=0;for(var i=0;i<this.curves.length;i++){sums+=this.curves[i].getLength();lengths.push(sums)}this.cacheLengths=lengths;return lengths},getEndPoint:function(out){if(out===undefined){out=new Vector2()}if(this.curves.length>0){this.curves[this.curves.length-1].getPoint(1,out)}else{out.copy(this.startPoint)}return out},getLength:function(){var lens=this.getCurveLengths();return lens[lens.length-1]},getPoint:function(t,out){if(out===undefined){out=new Vector2()}var d=t*this.getLength();var curveLengths=this.getCurveLengths();var i=0;while(i<curveLengths.length){if(curveLengths[i]>=d){var diff=curveLengths[i]-d;var curve=this.curves[i];var segmentLength=curve.getLength();var u=(segmentLength===0)?0:1-diff/segmentLength;return curve.getPointAt(u,out)}i++}return null},getPoints:function(divisions){if(divisions===undefined){divisions=12}var points=[];var last;for(var i=0;i<this.curves.length;i++){var curve=this.curves[i];if(!curve.active){continue}var resolution=curve.getResolution(divisions);var pts=curve.getPoints(resolution);for(var j=0;j<pts.length;j++){var point=pts[j];if(last&&last.equals(point)){continue}points.push(point);last=point}}if(this.autoClose&&points.length>1&&!points[points.length-1].equals(points[0])){points.push(points[0])}return points},getRandomPoint:function(out){if(out===undefined){out=new Vector2()}return this.getPoint(Math.random(),out)},getSpacedPoints:function(divisions){if(divisions===undefined){divisions=40}var points=[];for(var i=0;i<=divisions;i++){points.push(this.getPoint(i/divisions))}if(this.autoClose){points.push(points[0])}return points},getStartPoint:function(out){if(out===undefined){out=new Vector2()}return out.copy(this.startPoint)},getTangent:function(t,out){if(out===undefined){out=new Vector2()}var d=t*this.getLength();var curveLengths=this.getCurveLengths();var i=0;while(i<curveLengths.length){if(curveLengths[i]>=d){var diff=curveLengths[i]-d;var curve=this.curves[i];var segmentLength=curve.getLength();var u=(segmentLength===0)?0:1-diff/segmentLength;return curve.getTangentAt(u,out)}i++}return null},lineTo:function(x,y){if(x instanceof Vector2){this._tmpVec2B.copy(x)}else{this._tmpVec2B.set(x,y)}var end=this.getEndPoint(this._tmpVec2A);return this.add(new LineCurve([end.x,end.y,this._tmpVec2B.x,this._tmpVec2B.y]))},splineTo:function(points){points.unshift(this.getEndPoint());return this.add(new SplineCurve(points))},moveTo:function(x,y){if(x instanceof Vector2){return this.add(new MovePathTo(x.x,x.y))}else{return this.add(new MovePathTo(x,y))}},toJSON:function(){var out=[];for(var i=0;i<this.curves.length;i++){out.push(this.curves[i].toJSON())}return{type:'Path',x:this.startPoint.x,y:this.startPoint.y,autoClose:this.autoClose,curves:out}},updateArcLengths:function(){this.cacheLengths=[];this.getCurveLengths()},destroy:function(){this.curves.length=0;this.cacheLengths.length=0;this.startPoint=undefined}});GameObjectFactory.register('path',function(x,y){return new Path(x,y)});module.exports=Path}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Vector2=__webpack_require__(3);var MoveTo=new Class({initialize:function MoveTo(x,y){this.active=false;this.p0=new Vector2(x,y)},getPoint:function(t,out){if(out===undefined){out=new Vector2()}return out.copy(this.p0)},getPointAt:function(u,out){return this.getPoint(u,out)},getResolution:function(){return 1},getLength:function(){return 0},toJSON:function(){return{type:'MoveTo',points:[this.p0.x,this.p0.y]}}});module.exports=MoveTo}),(function(module,exports,__webpack_require__){module.exports={DataManager:__webpack_require__(113),DataManagerPlugin:__webpack_require__(799),Events:__webpack_require__(284)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var DataManager=__webpack_require__(113);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var DataManagerPlugin=new Class({Extends:DataManager,initialize:function DataManagerPlugin(scene){DataManager.call(this,scene,scene.sys.events);this.scene=scene;this.systems=scene.sys;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.events=this.systems.events;this.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){this.events.once(SceneEvents.SHUTDOWN,this.shutdown,this)},shutdown:function(){this.systems.events.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){DataManager.prototype.destroy.call(this);this.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('DataManagerPlugin',DataManagerPlugin,'data');module.exports=DataManagerPlugin}),(function(module,exports,__webpack_require__){module.exports={Align:__webpack_require__(801),BaseShader:__webpack_require__(353),Bounds:__webpack_require__(804),Canvas:__webpack_require__(808),Color:__webpack_require__(354),Masks:__webpack_require__(817)}}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(105);var Extend=__webpack_require__(18);var Align={In:__webpack_require__(802),To:__webpack_require__(803)};Align=Extend(false,Align,CONST);module.exports=Align}),(function(module,exports,__webpack_require__){module.exports={BottomCenter:__webpack_require__(256),BottomLeft:__webpack_require__(257),BottomRight:__webpack_require__(258),Center:__webpack_require__(259),LeftCenter:__webpack_require__(261),QuickSet:__webpack_require__(255),RightCenter:__webpack_require__(262),TopCenter:__webpack_require__(263),TopLeft:__webpack_require__(264),TopRight:__webpack_require__(265)}}),(function(module,exports,__webpack_require__){module.exports={BottomCenter:__webpack_require__(243),BottomLeft:__webpack_require__(244),BottomRight:__webpack_require__(245),LeftBottom:__webpack_require__(246),LeftCenter:__webpack_require__(247),LeftTop:__webpack_require__(248),QuickSet:__webpack_require__(242),RightBottom:__webpack_require__(249),RightCenter:__webpack_require__(250),RightTop:__webpack_require__(251),TopCenter:__webpack_require__(252),TopLeft:__webpack_require__(253),TopRight:__webpack_require__(254)}}),(function(module,exports,__webpack_require__){module.exports={CenterOn:__webpack_require__(260),GetBottom:__webpack_require__(34),GetBounds:__webpack_require__(805),GetCenterX:__webpack_require__(76),GetCenterY:__webpack_require__(78),GetLeft:__webpack_require__(35),GetOffsetX:__webpack_require__(806),GetOffsetY:__webpack_require__(807),GetRight:__webpack_require__(36),GetTop:__webpack_require__(37),SetBottom:__webpack_require__(46),SetCenterX:__webpack_require__(77),SetCenterY:__webpack_require__(79),SetLeft:__webpack_require__(44),SetRight:__webpack_require__(45),SetTop:__webpack_require__(43)}}),(function(module,exports,__webpack_require__){var GetBottom=__webpack_require__(34);var GetLeft=__webpack_require__(35);var GetRight=__webpack_require__(36);var GetTop=__webpack_require__(37);var GetBounds=function(gameObject,output){if(output===undefined){output={}}var left=GetLeft(gameObject);var top=GetTop(gameObject);output.x=left;output.y=top;output.width=GetRight(gameObject)-left;output.height=GetBottom(gameObject)-top;return output};module.exports=GetBounds}),(function(module,exports){var GetOffsetX=function(gameObject){return gameObject.width*gameObject.originX};module.exports=GetOffsetX}),(function(module,exports){var GetOffsetY=function(gameObject){return gameObject.height*gameObject.originY};module.exports=GetOffsetY}),(function(module,exports,__webpack_require__){module.exports={CanvasInterpolation:__webpack_require__(339),CanvasPool:__webpack_require__(26),Smoothing:__webpack_require__(167),TouchAction:__webpack_require__(809),UserSelect:__webpack_require__(810)}}),(function(module,exports){var TouchAction=function(canvas,value){if(value===undefined){value='none'}canvas.style['msTouchAction']=value;canvas.style['ms-touch-action']=value;canvas.style['touch-action']=value;return canvas};module.exports=TouchAction}),(function(module,exports){var UserSelect=function(canvas,value){if(value===undefined){value='none'}var vendors=['-webkit-','-khtml-','-moz-','-ms-',''];vendors.forEach(function(vendor){canvas.style[vendor+'user-select']=value});canvas.style['-webkit-touch-callout']=value;canvas.style['-webkit-tap-highlight-color']='rgba(0, 0, 0, 0)';return canvas};module.exports=UserSelect}),(function(module,exports){var ColorToRGBA=function(color){var output={r:color>>16&0xFF,g:color>>8&0xFF,b:color&0xFF,a:255};if(color>16777215){output.a=color>>>24}return output};module.exports=ColorToRGBA}),(function(module,exports,__webpack_require__){var Color=__webpack_require__(31);var HueToComponent=__webpack_require__(356);var HSLToColor=function(h,s,l){var r=l;var g=l;var b=l;if(s!==0){var q=(l<0.5)?l*(1+s):l+s-l*s;var p=2*l-q;r=HueToComponent(p,q,h+1/3);g=HueToComponent(p,q,h);b=HueToComponent(p,q,h-1/3)}var color=new Color();return color.setGLTo(r,g,b,1)};module.exports=HSLToColor}),(function(module,exports,__webpack_require__){var HSVToRGB=__webpack_require__(166);var HSVColorWheel=function(s,v){if(s===undefined){s=1}if(v===undefined){v=1}var colors=[];for(var c=0;c<=359;c++){colors.push(HSVToRGB(c/359,s,v))}return colors};module.exports=HSVColorWheel}),(function(module,exports,__webpack_require__){var Linear=__webpack_require__(116);var RGBWithRGB=function(r1,g1,b1,r2,g2,b2,length,index){if(length===undefined){length=100}if(index===undefined){index=0}var t=index/length;return{r:Linear(r1,r2,t),g:Linear(g1,g2,t),b:Linear(b1,b2,t)}};var ColorWithColor=function(color1,color2,length,index){if(length===undefined){length=100}if(index===undefined){index=0}return RGBWithRGB(color1.r,color1.g,color1.b,color2.r,color2.g,color2.b,length,index)};var ColorWithRGB=function(color,r,g,b,length,index){if(length===undefined){length=100}if(index===undefined){index=0}return RGBWithRGB(color.r,color.g,color.b,r,g,b,length,index)};module.exports={RGBWithRGB:RGBWithRGB,ColorWithRGB:ColorWithRGB,ColorWithColor:ColorWithColor}}),(function(module,exports,__webpack_require__){var Between=__webpack_require__(172);var Color=__webpack_require__(31);var RandomRGB=function(min,max){if(min===undefined){min=0}if(max===undefined){max=255}return new Color(Between(min,max),Between(min,max),Between(min,max))};module.exports=RandomRGB}),(function(module,exports,__webpack_require__){var ComponentToHex=__webpack_require__(355);var RGBToString=function(r,g,b,a,prefix){if(a===undefined){a=255}if(prefix===undefined){prefix='#'}if(prefix==='#'){return'#'+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)}else{return'0x'+ComponentToHex(a)+ComponentToHex(r)+ComponentToHex(g)+ComponentToHex(b)}};module.exports=RGBToString}),(function(module,exports,__webpack_require__){module.exports={BitmapMask:__webpack_require__(278),GeometryMask:__webpack_require__(279)}}),(function(module,exports,__webpack_require__){var Dom={AddToDOM:__webpack_require__(122),DOMContentLoaded:__webpack_require__(357),GetScreenOrientation:__webpack_require__(358),GetTarget:__webpack_require__(363),ParseXML:__webpack_require__(364),RemoveFromDOM:__webpack_require__(178),RequestAnimationFrame:__webpack_require__(344)};module.exports=Dom}),(function(module,exports,__webpack_require__){module.exports={EventEmitter:__webpack_require__(820)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EE=__webpack_require__(10);var PluginCache=__webpack_require__(23);var EventEmitter=new Class({Extends:EE,initialize:function EventEmitter(){EE.call(this)},shutdown:function(){this.removeAllListeners()},destroy:function(){this.removeAllListeners()}});PluginCache.register('EventEmitter',EventEmitter,'events');module.exports=EventEmitter}),(function(module,exports,__webpack_require__){var AddToDOM=__webpack_require__(122);var AnimationManager=__webpack_require__(289);var CacheManager=__webpack_require__(292);var CanvasPool=__webpack_require__(26);var Class=__webpack_require__(0);var Config=__webpack_require__(314);var CreateDOMContainer=__webpack_require__(822);var CreateRenderer=__webpack_require__(338);var DataManager=__webpack_require__(113);var DebugHeader=__webpack_require__(342);var Device=__webpack_require__(315);var DOMContentLoaded=__webpack_require__(357);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(20);var InputManager=__webpack_require__(365);var PluginCache=__webpack_require__(23);var PluginManager=__webpack_require__(370);var ScaleManager=__webpack_require__(371);var SceneManager=__webpack_require__(373);var TextureEvents=__webpack_require__(121);var TextureManager=__webpack_require__(376);var TimeStep=__webpack_require__(343);var VisibilityHandler=__webpack_require__(345);if(true){var SoundManagerCreator=__webpack_require__(380)}if(false){var FacebookInstantGamesPlugin}var Game=new Class({initialize:function Game(config){this.config=new Config(config);this.renderer=null;this.domContainer=null;this.canvas=null;this.context=null;this.isBooted=false;this.isRunning=false;this.events=new EventEmitter();this.anims=new AnimationManager(this);this.textures=new TextureManager(this);this.cache=new CacheManager(this);this.registry=new DataManager(this);this.input=new InputManager(this,this.config);this.scene=new SceneManager(this,this.config.sceneConfig);this.device=Device;this.scale=new ScaleManager(this,this.config);this.sound=null;if(true){this.sound=SoundManagerCreator.create(this)}this.loop=new TimeStep(this,this.config.fps);this.plugins=new PluginManager(this,this.config);if(false){}this.pendingDestroy=false;this.removeCanvas=false;this.noReturn=false;this.hasFocus=false;DOMContentLoaded(this.boot.bind(this))},boot:function(){if(!PluginCache.hasCore('EventEmitter')){console.warn('Aborting. Core Plugins missing.');return}this.isBooted=true;this.config.preBoot(this);this.scale.preBoot();CreateRenderer(this);CreateDOMContainer(this);DebugHeader(this);AddToDOM(this.canvas,this.config.parent);this.textures.once(TextureEvents.READY,this.texturesReady,this);this.events.emit(Events.BOOT)},texturesReady:function(){this.events.emit(Events.READY);this.start()},start:function(){this.isRunning=true;this.config.postBoot(this);if(this.renderer){this.loop.start(this.step.bind(this))}else{this.loop.start(this.headlessStep.bind(this))}VisibilityHandler(this);var eventEmitter=this.events;eventEmitter.on(Events.HIDDEN,this.onHidden,this);eventEmitter.on(Events.VISIBLE,this.onVisible,this);eventEmitter.on(Events.BLUR,this.onBlur,this);eventEmitter.on(Events.FOCUS,this.onFocus,this)},step:function(time,delta){if(this.pendingDestroy){return this.runDestroy()}var eventEmitter=this.events;eventEmitter.emit(Events.PRE_STEP,time,delta);eventEmitter.emit(Events.STEP,time,delta);this.scene.update(time,delta);eventEmitter.emit(Events.POST_STEP,time,delta);var renderer=this.renderer;renderer.preRender();eventEmitter.emit(Events.PRE_RENDER,renderer,time,delta);this.scene.render(renderer);renderer.postRender();eventEmitter.emit(Events.POST_RENDER,renderer,time,delta)},headlessStep:function(time,delta){if(this.pendingDestroy){return this.runDestroy()}var eventEmitter=this.events;eventEmitter.emit(Events.PRE_STEP,time,delta);eventEmitter.emit(Events.STEP,time,delta);this.scene.update(time,delta);eventEmitter.emit(Events.POST_STEP,time,delta);eventEmitter.emit(Events.PRE_RENDER);eventEmitter.emit(Events.POST_RENDER)},onHidden:function(){this.loop.pause();this.events.emit(Events.PAUSE)},onVisible:function(){this.loop.resume();this.events.emit(Events.RESUME)},onBlur:function(){this.hasFocus=false;this.loop.blur()},onFocus:function(){this.hasFocus=true;this.loop.focus()},getFrame:function(){return this.loop.frame},getTime:function(){return this.loop.now},destroy:function(removeCanvas,noReturn){if(noReturn===undefined){noReturn=false}this.pendingDestroy=true;this.removeCanvas=removeCanvas;this.noReturn=noReturn},runDestroy:function(){this.scene.destroy();this.events.emit(Events.DESTROY);this.events.removeAllListeners();if(this.renderer){this.renderer.destroy()}if(this.removeCanvas&&this.canvas){CanvasPool.remove(this.canvas);if(this.canvas.parentNode){this.canvas.parentNode.removeChild(this.canvas)}}if(this.domContainer){this.domContainer.parentNode.removeChild(this.domContainer)}this.loop.destroy();this.pendingDestroy=false}});module.exports=Game}),(function(module,exports,__webpack_require__){var AddToDOM=__webpack_require__(122);var CreateDOMContainer=function(game){var config=game.config;if(!config.parent||!config.domCreateContainer){return}var div=document.createElement('div');div.style.cssText=['display: block;','width: '+game.scale.width+'px;','height: '+game.scale.height+'px;','padding: 0; margin: 0;','position: absolute;','overflow: hidden;','pointer-events: none;','transform: scale(1);','transform-origin: left top;'].join(' ');game.domContainer=div;AddToDOM(div,config.parent)};module.exports=CreateDOMContainer}),(function(module,exports){module.exports='boot'}),(function(module,exports){module.exports='destroy'}),(function(module,exports){module.exports='dragend'}),(function(module,exports){module.exports='dragenter'}),(function(module,exports){module.exports='drag'}),(function(module,exports){module.exports='dragleave'}),(function(module,exports){module.exports='dragover'}),(function(module,exports){module.exports='dragstart'}),(function(module,exports){module.exports='drop'}),(function(module,exports){module.exports='gameout'}),(function(module,exports){module.exports='gameover'}),(function(module,exports){module.exports='gameobjectdown'}),(function(module,exports){module.exports='dragend'}),(function(module,exports){module.exports='dragenter'}),(function(module,exports){module.exports='drag'}),(function(module,exports){module.exports='dragleave'}),(function(module,exports){module.exports='dragover'}),(function(module,exports){module.exports='dragstart'}),(function(module,exports){module.exports='drop'}),(function(module,exports){module.exports='gameobjectmove'}),(function(module,exports){module.exports='gameobjectout'}),(function(module,exports){module.exports='gameobjectover'}),(function(module,exports){module.exports='pointerdown'}),(function(module,exports){module.exports='pointermove'}),(function(module,exports){module.exports='pointerout'}),(function(module,exports){module.exports='pointerover'}),(function(module,exports){module.exports='pointerup'}),(function(module,exports){module.exports='wheel'}),(function(module,exports){module.exports='gameobjectup'}),(function(module,exports){module.exports='gameobjectwheel'}),(function(module,exports){module.exports='boot'}),(function(module,exports){module.exports='process'}),(function(module,exports){module.exports='update'}),(function(module,exports){module.exports='pointerdown'}),(function(module,exports){module.exports='pointerdownoutside'}),(function(module,exports){module.exports='pointermove'}),(function(module,exports){module.exports='pointerout'}),(function(module,exports){module.exports='pointerover'}),(function(module,exports){module.exports='pointerup'}),(function(module,exports){module.exports='pointerupoutside'}),(function(module,exports){module.exports='wheel'}),(function(module,exports){module.exports='pointerlockchange'}),(function(module,exports){module.exports='preupdate'}),(function(module,exports){module.exports='shutdown'}),(function(module,exports){module.exports='start'}),(function(module,exports){module.exports='update'}),(function(module,exports){var GetInnerHeight=function(iOS){if(!iOS){return window.innerHeight}var axis=Math.abs(window.orientation);var size={w:0,h:0};var ruler=document.createElement('div');ruler.setAttribute('style','position: fixed; height: 100vh; width: 0; top: 0');document.documentElement.appendChild(ruler);size.w=(axis===90)?ruler.offsetHeight:window.innerWidth;size.h=(axis===90)?window.innerWidth:ruler.offsetHeight;document.documentElement.removeChild(ruler);ruler=null;if(Math.abs(window.orientation)!==90){return size.h}else{return size.w}};module.exports=GetInnerHeight}),(function(module,exports){module.exports='addfile'}),(function(module,exports){module.exports='complete'}),(function(module,exports){module.exports='filecomplete'}),(function(module,exports){module.exports='filecomplete-'}),(function(module,exports){module.exports='loaderror'}),(function(module,exports){module.exports='load'}),(function(module,exports){module.exports='fileprogress'}),(function(module,exports){module.exports='postprocess'}),(function(module,exports){module.exports='progress'}),(function(module,exports){module.exports='start'}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var UppercaseFirst=__webpack_require__(181);var GetPhysicsPlugins=function(sys){var defaultSystem=sys.game.config.defaultPhysicsSystem;var sceneSystems=GetFastValue(sys.settings,'physics',false);if(!defaultSystem&&!sceneSystems){return}var output=[];if(defaultSystem){output.push(UppercaseFirst(defaultSystem+'Physics'))}if(sceneSystems){for(var key in sceneSystems){key=UppercaseFirst(key.concat('Physics'));if(output.indexOf(key)===-1){output.push(key)}}}return output};module.exports=GetPhysicsPlugins}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var GetScenePlugins=function(sys){var defaultPlugins=sys.plugins.getDefaultScenePlugins();var scenePlugins=GetFastValue(sys.settings,'plugins',false);if(Array.isArray(scenePlugins)){return scenePlugins}else if(defaultPlugins){return defaultPlugins}else{return[]}};module.exports=GetScenePlugins}),(function(module,exports,__webpack_require__){var InjectionMap={game:'game',anims:'anims',cache:'cache',plugins:'plugins',registry:'registry',scale:'scale',sound:'sound',textures:'textures',events:'events',cameras:'cameras',add:'add',make:'make',scenePlugin:'scene',displayList:'children',lights:'lights',data:'data',input:'input',load:'load',time:'time',tweens:'tweens',arcadePhysics:'physics',impactPhysics:'impact',matterPhysics:'matter'};if(false){}if(false){}module.exports=InjectionMap}),(function(module,exports){var AtlasXML=function(texture,sourceIndex,xml){if(!xml.getElementsByTagName('TextureAtlas')){console.warn('Invalid Texture Atlas XML given');return}var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);var frames=xml.getElementsByTagName('SubTexture');var newFrame;for(var i=0;i<frames.length;i++){var frame=frames[i].attributes;var name=frame.name.value;var x=parseInt(frame.x.value,10);var y=parseInt(frame.y.value,10);var width=parseInt(frame.width.value,10);var height=parseInt(frame.height.value,10);newFrame=texture.add(name,sourceIndex,x,y,width,height);if(frame.frameX){var frameX=Math.abs(parseInt(frame.frameX.value,10));var frameY=Math.abs(parseInt(frame.frameY.value,10));var frameWidth=parseInt(frame.frameWidth.value,10);var frameHeight=parseInt(frame.frameHeight.value,10);newFrame.setTrim(width,height,frameX,frameY,frameWidth,frameHeight)}}return texture};module.exports=AtlasXML}),(function(module,exports){var Canvas=function(texture,sourceIndex){var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);return texture};module.exports=Canvas}),(function(module,exports){var Image=function(texture,sourceIndex){var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);return texture};module.exports=Image}),(function(module,exports,__webpack_require__){var Clone=__webpack_require__(67);var JSONArray=function(texture,sourceIndex,json){if(!json['frames']&&!json['textures']){console.warn('Invalid Texture Atlas JSON Array');return}var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);var frames=(Array.isArray(json.textures))?json.textures[sourceIndex].frames:json.frames;var newFrame;for(var i=0;i<frames.length;i++){var src=frames[i];newFrame=texture.add(src.filename,sourceIndex,src.frame.x,src.frame.y,src.frame.w,src.frame.h);if(src.trimmed){newFrame.setTrim(src.sourceSize.w,src.sourceSize.h,src.spriteSourceSize.x,src.spriteSourceSize.y,src.spriteSourceSize.w,src.spriteSourceSize.h)}if(src.rotated){newFrame.rotated=true;newFrame.updateUVsInverted()}var pivot=src.anchor||src.pivot;if(pivot){newFrame.customPivot=true;newFrame.pivotX=pivot.x;newFrame.pivotY=pivot.y}newFrame.customData=Clone(src)}for(var dataKey in json){if(dataKey==='frames'){continue}if(Array.isArray(json[dataKey])){texture.customData[dataKey]=json[dataKey].slice(0)}else{texture.customData[dataKey]=json[dataKey]}}return texture};module.exports=JSONArray}),(function(module,exports,__webpack_require__){var Clone=__webpack_require__(67);var JSONHash=function(texture,sourceIndex,json){if(!json['frames']){console.warn('Invalid Texture Atlas JSON Hash given, missing \"frames\\ Object');return}var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);var frames=json.frames;var newFrame;for(var key in frames){var src=frames[key];newFrame=texture.add(key,sourceIndex,src.frame.x,src.frame.y,src.frame.w,src.frame.h);if(src.trimmed){newFrame.setTrim(src.sourceSize.w,src.sourceSize.h,src.spriteSourceSize.x,src.spriteSourceSize.y,src.spriteSourceSize.w,src.spriteSourceSize.h)}if(src.rotated){newFrame.rotated=true;newFrame.updateUVsInverted()}var pivot=src.anchor||src.pivot;if(pivot){newFrame.customPivot=true;newFrame.pivotX=pivot.x;newFrame.pivotY=pivot.y}newFrame.customData=Clone(src)}for(var dataKey in json){if(dataKey==='frames'){continue}if(Array.isArray(json[dataKey])){texture.customData[dataKey]=json[dataKey].slice(0)}else{texture.customData[dataKey]=json[dataKey]}}return texture};module.exports=JSONHash}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var SpriteSheet=function(texture,sourceIndex,x,y,width,height,config){var frameWidth=GetFastValue(config,'frameWidth',null);var frameHeight=GetFastValue(config,'frameHeight',frameWidth);if(frameWidth===null){throw new Error('TextureManager.SpriteSheet: Invalid frameWidth given.')}var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);var startFrame=GetFastValue(config,'startFrame',0);var endFrame=GetFastValue(config,'endFrame',-1);var margin=GetFastValue(config,'margin',0);var spacing=GetFastValue(config,'spacing',0);var row=Math.floor((width-margin+spacing)/(frameWidth+spacing));var column=Math.floor((height-margin+spacing)/(frameHeight+spacing));var total=row*column;if(total===0){console.warn('SpriteSheet frame dimensions will result in zero frames for texture:',texture.key)}if(startFrame>total||startFrame<-total){startFrame=0}if(startFrame<0){startFrame=total+startFrame}if(endFrame!==-1){total=startFrame+(endFrame+1)}var fx=margin;var fy=margin;var ax=0;var ay=0;for(var i=0;i<total;i++){ax=0;ay=0;var w=fx+frameWidth;var h=fy+frameHeight;if(w>width){ax=w-width}if(h>height){ay=h-height}texture.add(i,sourceIndex,x+fx,y+fy,frameWidth-ax,frameHeight-ay);fx+=frameWidth+spacing;if(fx+frameWidth>width){fx=margin;fy+=frameHeight+spacing}}return texture};module.exports=SpriteSheet}),(function(module,exports,__webpack_require__){var GetFastValue=__webpack_require__(2);var SpriteSheetFromAtlas=function(texture,frame,config){var frameWidth=GetFastValue(config,'frameWidth',null);var frameHeight=GetFastValue(config,'frameHeight',frameWidth);if(!frameWidth){throw new Error('TextureManager.SpriteSheetFromAtlas: Invalid frameWidth given.')}var source=texture.source[0];texture.add('__BASE',0,0,0,source.width,source.height);var startFrame=GetFastValue(config,'startFrame',0);var endFrame=GetFastValue(config,'endFrame',-1);var margin=GetFastValue(config,'margin',0);var spacing=GetFastValue(config,'spacing',0);var x=frame.cutX;var y=frame.cutY;var cutWidth=frame.cutWidth;var cutHeight=frame.cutHeight;var sheetWidth=frame.realWidth;var sheetHeight=frame.realHeight;var row=Math.floor((sheetWidth-margin+spacing)/(frameWidth+spacing));var column=Math.floor((sheetHeight-margin+spacing)/(frameHeight+spacing));var total=row*column;var leftPad=frame.x;var leftWidth=frameWidth-leftPad;var rightWidth=frameWidth-((sheetWidth-cutWidth)-leftPad);var topPad=frame.y;var topHeight=frameHeight-topPad;var bottomHeight=frameHeight-((sheetHeight-cutHeight)-topPad);if(startFrame>total||startFrame<-total){startFrame=0}if(startFrame<0){startFrame=total+startFrame}if(endFrame!==-1){total=startFrame+(endFrame+1)}var sheetFrame;var frameX=margin;var frameY=margin;var frameIndex=0;var sourceIndex=frame.sourceIndex;for(var sheetY=0;sheetY<column;sheetY++){var topRow=(sheetY===0);var bottomRow=(sheetY===column-1);for(var sheetX=0;sheetX<row;sheetX++){var leftRow=(sheetX===0);var rightRow=(sheetX===row-1);sheetFrame=texture.add(frameIndex,sourceIndex,x+frameX,y+frameY,frameWidth,frameHeight);if(leftRow||topRow||rightRow||bottomRow){var destX=(leftRow)?leftPad:0;var destY=(topRow)?topPad:0;var trimWidth=0;var trimHeight=0;if(leftRow){trimWidth+=(frameWidth-leftWidth)}if(rightRow){trimWidth+=(frameWidth-rightWidth)}if(topRow){trimHeight+=(frameHeight-topHeight)}if(bottomRow){trimHeight+=(frameHeight-bottomHeight)}var destWidth=frameWidth-trimWidth;var destHeight=frameHeight-trimHeight;sheetFrame.cutWidth=destWidth;sheetFrame.cutHeight=destHeight;sheetFrame.setTrim(frameWidth,frameHeight,destX,destY,destWidth,destHeight)}frameX+=spacing;if(leftRow){frameX+=leftWidth}else if(rightRow){frameX+=rightWidth}else{frameX+=frameWidth}frameIndex++}frameX=margin;frameY+=spacing;if(topRow){frameY+=topHeight}else if(bottomRow){frameY+=bottomHeight}else{frameY+=frameHeight}}return texture};module.exports=SpriteSheetFromAtlas}),(function(module,exports){var imageHeight=0;var addFrame=function(texture,sourceIndex,name,frame){var y=imageHeight-frame.y-frame.height;texture.add(name,sourceIndex,frame.x,y,frame.width,frame.height)};var UnityYAML=function(texture,sourceIndex,yaml){var source=texture.source[sourceIndex];texture.add('__BASE',sourceIndex,0,0,source.width,source.height);imageHeight=source.height;var data=yaml.split('\'');var lineRegExp=/^[ ]*(- )*(\\+)+[: ]+(.*)/;var prevSprite='';var currentSprite='';var rect={x:0,y:0,width:0,height:0};for(var i=0;i<data.length;i++){var results=data[i].match(lineRegExp);if(!results){continue}var isList=(results[1]==='- ');var key=results[2];var value=results[3];if(isList){if(currentSprite!==prevSprite){addFrame(texture,sourceIndex,currentSprite,rect);prevSprite=currentSprite}rect={x:0,y:0,width:0,height:0}}if(key==='name'){currentSprite=value;continue}switch(key){case'x':case'y':case'width':case'height':rect[key]=parseInt(value,10);break}}if(currentSprite!==prevSprite){addFrame(texture,sourceIndex,currentSprite,rect)}return texture};module.exports=UnityYAML}),(function(module,exports){module.exports='complete'}),(function(module,exports){module.exports='decoded'}),(function(module,exports){module.exports='decodedall'}),(function(module,exports){module.exports='destroy'}),(function(module,exports){module.exports='detune'}),(function(module,exports){module.exports='detune'}),(function(module,exports){module.exports='mute'}),(function(module,exports){module.exports='rate'}),(function(module,exports){module.exports='volume'}),(function(module,exports){module.exports='loop'}),(function(module,exports){module.exports='looped'}),(function(module,exports){module.exports='mute'}),(function(module,exports){module.exports='pauseall'}),(function(module,exports){module.exports='pause'}),(function(module,exports){module.exports='play'}),(function(module,exports){module.exports='rate'}),(function(module,exports){module.exports='resumeall'}),(function(module,exports){module.exports='resume'}),(function(module,exports){module.exports='seek'}),(function(module,exports){module.exports='stopall'}),(function(module,exports){module.exports='stop'}),(function(module,exports){module.exports='unlocked'}),(function(module,exports){module.exports='volume'}),(function(module,exports,__webpack_require__){var GameObjects={Events:__webpack_require__(90),DisplayList:__webpack_require__(915),GameObjectCreator:__webpack_require__(16),GameObjectFactory:__webpack_require__(5),UpdateList:__webpack_require__(941),Components:__webpack_require__(12),BuildGameObject:__webpack_require__(27),BuildGameObjectAnimation:__webpack_require__(393),GameObject:__webpack_require__(14),BitmapText:__webpack_require__(132),Blitter:__webpack_require__(188),Container:__webpack_require__(189),DOMElement:__webpack_require__(395),DynamicBitmapText:__webpack_require__(190),Extern:__webpack_require__(397),Graphics:__webpack_require__(191),Group:__webpack_require__(97),Image:__webpack_require__(107),Particles:__webpack_require__(973),PathFollower:__webpack_require__(409),RenderTexture:__webpack_require__(195),RetroFont:__webpack_require__(982),Rope:__webpack_require__(197),Sprite:__webpack_require__(75),Text:__webpack_require__(198),TileSprite:__webpack_require__(199),Zone:__webpack_require__(110),Video:__webpack_require__(200),Shape:__webpack_require__(30),Arc:__webpack_require__(410),Curve:__webpack_require__(411),Ellipse:__webpack_require__(412),Grid:__webpack_require__(413),IsoBox:__webpack_require__(414),IsoTriangle:__webpack_require__(415),Line:__webpack_require__(416),Polygon:__webpack_require__(417),Rectangle:__webpack_require__(422),Star:__webpack_require__(423),Triangle:__webpack_require__(424),Factories:{Blitter:__webpack_require__(1033),Container:__webpack_require__(1034),DOMElement:__webpack_require__(1035),DynamicBitmapText:__webpack_require__(1036),Extern:__webpack_require__(1037),Graphics:__webpack_require__(1038),Group:__webpack_require__(1039),Image:__webpack_require__(1040),Particles:__webpack_require__(1041),PathFollower:__webpack_require__(1042),RenderTexture:__webpack_require__(1043),Rope:__webpack_require__(1044),Sprite:__webpack_require__(1045),StaticBitmapText:__webpack_require__(1046),Text:__webpack_require__(1047),TileSprite:__webpack_require__(1048),Zone:__webpack_require__(1049),Video:__webpack_require__(1050),Arc:__webpack_require__(1051),Curve:__webpack_require__(1052),Ellipse:__webpack_require__(1053),Grid:__webpack_require__(1054),IsoBox:__webpack_require__(1055),IsoTriangle:__webpack_require__(1056),Line:__webpack_require__(1057),Polygon:__webpack_require__(1058),Rectangle:__webpack_require__(1059),Star:__webpack_require__(1060),Triangle:__webpack_require__(1061)},Creators:{Blitter:__webpack_require__(1062),Container:__webpack_require__(1063),DynamicBitmapText:__webpack_require__(1064),Graphics:__webpack_require__(1065),Group:__webpack_require__(1066),Image:__webpack_require__(1067),Particles:__webpack_require__(1068),RenderTexture:__webpack_require__(1069),Rope:__webpack_require__(1070),Sprite:__webpack_require__(1071),StaticBitmapText:__webpack_require__(1072),Text:__webpack_require__(1073),TileSprite:__webpack_require__(1074),Zone:__webpack_require__(1075),Video:__webpack_require__(1076)}};if(true){GameObjects.Mesh=__webpack_require__(134);GameObjects.Quad=__webpack_require__(203);GameObjects.Shader=__webpack_require__(204);GameObjects.Factories.Mesh=__webpack_require__(1083);GameObjects.Factories.Quad=__webpack_require__(1084);GameObjects.Factories.Shader=__webpack_require__(1085);GameObjects.Creators.Mesh=__webpack_require__(1086);GameObjects.Creators.Quad=__webpack_require__(1087);GameObjects.Creators.Shader=__webpack_require__(1088);GameObjects.Light=__webpack_require__(428);__webpack_require__(429);__webpack_require__(1089)}module.exports=GameObjects}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var List=__webpack_require__(129);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var StableSort=__webpack_require__(131);var DisplayList=new Class({Extends:List,initialize:function DisplayList(scene){List.call(this,scene);this.sortChildrenFlag=false;this.scene=scene;this.systems=scene.sys;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){this.systems.events.once(SceneEvents.SHUTDOWN,this.shutdown,this)},queueDepthSort:function(){this.sortChildrenFlag=true},depthSort:function(){if(this.sortChildrenFlag){StableSort.inplace(this.list,this.sortByDepth);this.sortChildrenFlag=false}},sortByDepth:function(childA,childB){return childA._depth-childB._depth},getChildren:function(){return this.list},shutdown:function(){var i=this.list.length;while(i--){this.list[i].destroy(true)}this.list.length=0;this.systems.events.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('DisplayList',DisplayList,'displayList');module.exports=DisplayList}),(function(module,exports,__webpack_require__){module.exports={CheckMatrix:__webpack_require__(184),MatrixToString:__webpack_require__(917),ReverseColumns:__webpack_require__(918),ReverseRows:__webpack_require__(919),Rotate180:__webpack_require__(920),RotateLeft:__webpack_require__(921),RotateMatrix:__webpack_require__(130),RotateRight:__webpack_require__(922),TransposeMatrix:__webpack_require__(390)}}),(function(module,exports,__webpack_require__){var Pad=__webpack_require__(163);var CheckMatrix=__webpack_require__(184);var MatrixToString=function(matrix){var str='';if(!CheckMatrix(matrix)){return str}for(var r=0;r<matrix.length;r++){for(var c=0;c<matrix[r].length;c++){var cell=matrix[r][c].toString();if(cell!=='undefined'){str+=Pad(cell,2)}else{str+='?'}if(c<matrix[r].length-1){str+=' |'}}if(r<matrix.length-1){str+='\'';for(var i=0;i<matrix[r].length;i++){str+='---';if(i<matrix[r].length-1){str+='+'}}str+='\''}}return str};module.exports=MatrixToString}),(function(module,exports){var ReverseColumns=function(matrix){return matrix.reverse()};module.exports=ReverseColumns}),(function(module,exports){var ReverseRows=function(matrix){for(var i=0;i<matrix.length;i++){matrix[i].reverse()}return matrix};module.exports=ReverseRows}),(function(module,exports,__webpack_require__){var RotateMatrix=__webpack_require__(130);var Rotate180=function(matrix){return RotateMatrix(matrix,180)};module.exports=Rotate180}),(function(module,exports,__webpack_require__){var RotateMatrix=__webpack_require__(130);var RotateLeft=function(matrix){return RotateMatrix(matrix,90)};module.exports=RotateLeft}),(function(module,exports,__webpack_require__){var RotateMatrix=__webpack_require__(130);var RotateRight=function(matrix){return RotateMatrix(matrix,-90)};module.exports=RotateRight}),(function(module,exports){var Add=function(array,item,limit,callback,context){if(context===undefined){context=array}if(limit>0){var remaining=limit-array.length;if(remaining<=0){return null}}if(!Array.isArray(item)){if(array.indexOf(item)===-1){array.push(item);if(callback){callback.call(context,item)}return item}else{return null}}var itemLength=item.length-1;while(itemLength>=0){if(array.indexOf(item[itemLength])!==-1){item.splice(itemLength,1)}itemLength--}itemLength=item.length;if(itemLength===0){return null}if(limit>0&&itemLength>remaining){item.splice(remaining);itemLength=remaining}for(var i=0;i<itemLength;i++){var entry=item[i];array.push(entry);if(callback){callback.call(context,entry)}}return item};module.exports=Add}),(function(module,exports){var AddAt=function(array,item,index,limit,callback,context){if(index===undefined){index=0}if(context===undefined){context=array}if(limit>0){var remaining=limit-array.length;if(remaining<=0){return null}}if(!Array.isArray(item)){if(array.indexOf(item)===-1){array.splice(index,0,item);if(callback){callback.call(context,item)}return item}else{return null}}var itemLength=item.length-1;while(itemLength>=0){if(array.indexOf(item[itemLength])!==-1){item.pop()}itemLength--}itemLength=item.length;if(itemLength===0){return null}if(limit>0&&itemLength>remaining){item.splice(remaining);itemLength=remaining}for(var i=itemLength-1;i>=0;i--){var entry=item[i];array.splice(index,0,entry);if(callback){callback.call(context,entry)}}return item};module.exports=AddAt}),(function(module,exports){var BringToTop=function(array,item){var currentIndex=array.indexOf(item);if(currentIndex!==-1&&currentIndex<array.length){array.splice(currentIndex,1);array.push(item)}return item};module.exports=BringToTop}),(function(module,exports,__webpack_require__){var SafeRange=__webpack_require__(68);var CountAllMatching=function(array,property,value,startIndex,endIndex){if(startIndex===undefined){startIndex=0}if(endIndex===undefined){endIndex=array.length}var total=0;if(SafeRange(array,startIndex,endIndex)){for(var i=startIndex;i<endIndex;i++){var child=array[i];if(child[property]===value){total++}}}return total};module.exports=CountAllMatching}),(function(module,exports){var Each=function(array,callback,context){var i;var args=[null];for(i=3;i<arguments.length;i++){args.push(arguments[i])}for(i=0;i<array.length;i++){args[0]=array[i];callback.apply(context,args)}return array};module.exports=Each}),(function(module,exports,__webpack_require__){var SafeRange=__webpack_require__(68);var EachInRange=function(array,callback,context,startIndex,endIndex){if(startIndex===undefined){startIndex=0}if(endIndex===undefined){endIndex=array.length}if(SafeRange(array,startIndex,endIndex)){var i;var args=[null];for(i=5;i<arguments.length;i++){args.push(arguments[i])}for(i=startIndex;i<endIndex;i++){args[0]=array[i];callback.apply(context,args)}}return array};module.exports=EachInRange}),(function(module,exports){var MoveDown=function(array,item){var currentIndex=array.indexOf(item);if(currentIndex>0){var item2=array[currentIndex-1];var index2=array.indexOf(item2);array[currentIndex]=item2;array[index2]=item}return array};module.exports=MoveDown}),(function(module,exports){var MoveTo=function(array,item,index){var currentIndex=array.indexOf(item);if(currentIndex===-1||index<0||index>=array.length){throw new Error('Supplied index out of bounds')}if(currentIndex!==index){array.splice(currentIndex,1);array.splice(index,0,item)}return item};module.exports=MoveTo}),(function(module,exports){var MoveUp=function(array,item){var currentIndex=array.indexOf(item);if(currentIndex!==-1&&currentIndex<array.length-1){var item2=array[currentIndex+1];var index2=array.indexOf(item2);array[currentIndex]=item2;array[index2]=item}return array};module.exports=MoveUp}),(function(module,exports){var NumberArray=function(start,end,prefix,suffix){var result=[];for(var i=start;i<=end;i++){if(prefix||suffix){var key=(prefix)?prefix+i.toString():i.toString();if(suffix){key=key.concat(suffix)}result.push(key)}else{result.push(i)}}return result};module.exports=NumberArray}),(function(module,exports,__webpack_require__){var RoundAwayFromZero=__webpack_require__(332);var NumberArrayStep=function(start,end,step){if(start===undefined){start=0}if(end===undefined){end=null}if(step===undefined){step=1}if(end===null){end=start;start=0}var result=[];var total=Math.max(RoundAwayFromZero((end-start)/(step||1)),0);for(var i=0;i<total;i++){result.push(start);start+=step}return result};module.exports=NumberArrayStep}),(function(module,exports,__webpack_require__){var SpliceOne=__webpack_require__(80);var RemoveAt=function(array,index,callback,context){if(context===undefined){context=array}if(index<0||index>array.length-1){throw new Error('Index out of bounds')}var item=SpliceOne(array,index);if(callback){callback.call(context,item)}return item};module.exports=RemoveAt}),(function(module,exports,__webpack_require__){var SafeRange=__webpack_require__(68);var RemoveBetween=function(array,startIndex,endIndex,callback,context){if(startIndex===undefined){startIndex=0}if(endIndex===undefined){endIndex=array.length}if(context===undefined){context=array}if(SafeRange(array,startIndex,endIndex)){var size=endIndex-startIndex;var removed=array.splice(startIndex,size);if(callback){for(var i=0;i<removed.length;i++){var entry=removed[i];callback.call(context,entry)}}return removed}else{return[]}};module.exports=RemoveBetween}),(function(module,exports,__webpack_require__){var SpliceOne=__webpack_require__(80);var RemoveRandomElement=function(array,start,length){if(start===undefined){start=0}if(length===undefined){length=array.length}var randomIndex=start+Math.floor(Math.random()*length);return SpliceOne(array,randomIndex)};module.exports=RemoveRandomElement}),(function(module,exports){var Replace=function(array,oldChild,newChild){var index1=array.indexOf(oldChild);var index2=array.indexOf(newChild);if(index1!==-1&&index2===-1){array[index1]=newChild;return true}else{return false}};module.exports=Replace}),(function(module,exports){var SendToBack=function(array,item){var currentIndex=array.indexOf(item);if(currentIndex!==-1&&currentIndex>0){array.splice(currentIndex,1);array.unshift(item)}return item};module.exports=SendToBack}),(function(module,exports,__webpack_require__){var SafeRange=__webpack_require__(68);var SetAll=function(array,property,value,startIndex,endIndex){if(startIndex===undefined){startIndex=0}if(endIndex===undefined){endIndex=array.length}if(SafeRange(array,startIndex,endIndex)){for(var i=startIndex;i<endIndex;i++){var entry=array[i];if(entry.hasOwnProperty(property)){entry[property]=value}}}return array};module.exports=SetAll}),(function(module,exports){var Swap=function(array,item1,item2){if(item1===item2){return}var index1=array.indexOf(item1);var index2=array.indexOf(item2);if(index1<0||index2<0){throw new Error('Supplied items must be elements of the same array')}array[index1]=item2;array[index2]=item1;return array};module.exports=Swap}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var ProcessQueue=__webpack_require__(186);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var UpdateList=new Class({Extends:ProcessQueue,initialize:function UpdateList(scene){ProcessQueue.call(this);this.scene=scene;this.systems=scene.sys;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.PRE_UPDATE,this.update,this);eventEmitter.on(SceneEvents.UPDATE,this.sceneUpdate,this);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this)},sceneUpdate:function(time,delta){var list=this._active;var length=list.length;for(var i=0;i<length;i++){var gameObject=list[i];if(gameObject.active){gameObject.preUpdate.call(gameObject,time,delta)}}},shutdown:function(){var i=this._active.length;while(i--){this._active[i].destroy(true)}i=this._pending.length;while(i--){this._pending[i].destroy(true)}i=this._destroy.length;while(i--){this._destroy[i].destroy(true)}this._toProcess=0;this._pending=[];this._active=[];this._destroy=[];this.removeAllListeners();var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.PRE_UPDATE,this.preUpdate,this);eventEmitter.off(SceneEvents.UPDATE,this.sceneUpdate,this);eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.systems.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('UpdateList',UpdateList,'updateList');module.exports=UpdateList}),(function(module,exports,__webpack_require__){module.exports={PROCESS_QUEUE_ADD:__webpack_require__(943),PROCESS_QUEUE_REMOVE:__webpack_require__(944)}}),(function(module,exports){module.exports='add'}),(function(module,exports){module.exports='remove'}),(function(module,exports){var GetBitmapTextSize=function(src,round,out){if(out===undefined){out={local:{x:0,y:0,width:0,height:0},global:{x:0,y:0,width:0,height:0},lines:{shortest:0,longest:0,lengths:null,height:0},wrappedText:'',words:[],scaleX:0,scaleY:0};return out}var text=src.text;var textLength=text.length;var maxWidth=src.maxWidth;var wordWrapCharCode=src.wordWrapCharCode;var bx=Number.MAX_VALUE;var by=Number.MAX_VALUE;var bw=0;var bh=0;var chars=src.fontData.chars;var lineHeight=src.fontData.lineHeight;var letterSpacing=src.letterSpacing;var xAdvance=0;var yAdvance=0;var charCode=0;var glyph=null;var x=0;var y=0;var scale=(src.fontSize/src.fontData.size);var sx=scale*src.scaleX;var sy=scale*src.scaleY;var lastGlyph=null;var lastCharCode=0;var lineWidths=[];var shortestLine=Number.MAX_VALUE;var longestLine=0;var currentLine=0;var currentLineWidth=0;var i;var words=[];var current=null;if(maxWidth>0){for(i=0;i<textLength;i++){charCode=text.charCodeAt(i);if(charCode===10){if(current!==null){words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy,cr:true});current=null}xAdvance=0;yAdvance+=lineHeight;lastGlyph=null;continue}glyph=chars[charCode];if(!glyph){continue}if(lastGlyph!==null){var glyphKerningOffset=glyph.kerning[lastCharCode]}if(charCode===wordWrapCharCode){if(current!==null){words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy,cr:false});current=null}}else{if(current===null){current={word:'',i:i,x:xAdvance,y:yAdvance,w:0,h:lineHeight,cr:false}}current.word=current.word.concat(text[i]);current.w+=glyph.xOffset+glyph.xAdvance+((glyphKerningOffset!==undefined)?glyphKerningOffset:0)}xAdvance+=glyph.xAdvance+letterSpacing;lastGlyph=glyph;lastCharCode=charCode}if(current!==null){words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy,cr:false})}xAdvance=0;yAdvance=0;lastGlyph=null;lastCharCode=0;var prev;var offset=0;var crs=[];for(i=0;i<words.length;i++){var entry=words[i];var left=entry.x;var right=entry.x+entry.w;if(prev){var diff=left-(prev.x+prev.w);offset=left-(diff+prev.w);prev=null}var checkLeft=left-offset;var checkRight=right-offset;if(checkLeft>maxWidth||checkRight>maxWidth){crs.push(entry.i-1);if(entry.cr){crs.push(entry.i+entry.word.length);offset=0;prev=null}else{prev=entry}}else if(entry.cr){crs.push(entry.i+entry.word.length);offset=0;prev=null}}var stringInsert=function(str,index,value){return str.substr(0,index)+value+str.substr(index+1)};for(i=crs.length-1;i>=0;i--){text=stringInsert(text,crs[i],"\'")}out.wrappedText=text;textLength=text.length;words=[];current=null}for(i=0;i<textLength;i++){charCode=text.charCodeAt(i);if(charCode===10){if(current!==null){words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy});current=null}xAdvance=0;yAdvance+=lineHeight;lastGlyph=null;lineWidths[currentLine]=currentLineWidth;if(currentLineWidth>longestLine){longestLine=currentLineWidth}if(currentLineWidth<shortestLine){shortestLine=currentLineWidth}currentLine++;currentLineWidth=0;continue}glyph=chars[charCode];if(!glyph){continue}x=xAdvance;y=yAdvance;if(lastGlyph!==null){var kerningOffset=glyph.kerning[lastCharCode];x+=(kerningOffset!==undefined)?kerningOffset:0}if(bx>x){bx=x}if(by>y){by=y}var gw=x+glyph.xAdvance;var gh=y+lineHeight;if(bw<gw){bw=gw}if(bh<gh){bh=gh}if(charCode===wordWrapCharCode){if(current!==null){words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy});current=null}}else{if(current===null){current={word:'',i:i,x:xAdvance,y:yAdvance,w:0,h:lineHeight}}current.word=current.word.concat(text[i]);current.w+=glyph.xOffset+glyph.xAdvance+((kerningOffset!==undefined)?kerningOffset:0)}xAdvance+=glyph.xAdvance+letterSpacing;lastGlyph=glyph;lastCharCode=charCode;currentLineWidth=gw*scale}if(current!==null){words.push({word:current.word,i:current.i,x:current.x*sx,y:current.y*sy,w:current.w*sx,h:current.h*sy})}lineWidths[currentLine]=currentLineWidth;if(currentLineWidth>longestLine){longestLine=currentLineWidth}if(currentLineWidth<shortestLine){shortestLine=currentLineWidth}var local=out.local;var global=out.global;var lines=out.lines;local.x=bx*scale;local.y=by*scale;local.width=bw*scale;local.height=bh*scale;global.x=(src.x-src.displayOriginX)+(bx*sx);global.y=(src.y-src.displayOriginY)+(by*sy);global.width=bw*sx;global.height=bh*sy;lines.shortest=shortestLine;lines.longest=longestLine;lines.lengths=lineWidths;if(round){local.x=Math.round(local.x);local.y=Math.round(local.y);local.width=Math.round(local.width);local.height=Math.round(local.height);global.x=Math.round(global.x);global.y=Math.round(global.y);global.width=Math.round(global.width);global.height=Math.round(global.height);lines.shortest=Math.round(shortestLine);lines.longest=Math.round(longestLine)}out.words=words;out.lines.height=lineHeight;out.scaleX=src.scaleX;out.scaleY=src.scaleY;return out};module.exports=GetBitmapTextSize}),(function(module,exports,__webpack_require__){var ParseXMLBitmapFont=__webpack_require__(187);var ParseFromAtlas=function(scene,fontName,textureKey,frameKey,xmlKey,xSpacing,ySpacing){var frame=scene.sys.textures.getFrame(textureKey,frameKey);var xml=scene.sys.cache.xml.get(xmlKey);if(frame&&xml){var data=ParseXMLBitmapFont(xml,xSpacing,ySpacing,frame);scene.sys.cache.bitmapFont.add(fontName,{data:data,texture:textureKey,frame:frameKey});return true}else{return false}};module.exports=ParseFromAtlas}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(948)}if(true){renderCanvas=__webpack_require__(949)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var BitmapTextWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var text=src._text;var textLength=text.length;if(textLength===0){return}var pipeline=this.pipeline;renderer.setPipeline(pipeline,src);var camMatrix=pipeline._tempMatrix1;var spriteMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;spriteMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);spriteMatrix.e=src.x;spriteMatrix.f=src.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*src.scrollFactorX;spriteMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var frame=src.frame;var texture=frame.glTexture;var textureX=frame.cutX;var textureY=frame.cutY;var textureWidth=texture.width;var textureHeight=texture.height;var tintEffect=(src._isTinted&&src.tintFill);var tintTL=Utils.getTintAppendFloatAlpha(src._tintTL,camera.alpha*src._alphaTL);var tintTR=Utils.getTintAppendFloatAlpha(src._tintTR,camera.alpha*src._alphaTR);var tintBL=Utils.getTintAppendFloatAlpha(src._tintBL,camera.alpha*src._alphaBL);var tintBR=Utils.getTintAppendFloatAlpha(src._tintBR,camera.alpha*src._alphaBR);pipeline.setTexture2D(texture,0);var xAdvance=0;var yAdvance=0;var charCode=0;var lastCharCode=0;var letterSpacing=src._letterSpacing;var glyph;var glyphX=0;var glyphY=0;var glyphW=0;var glyphH=0;var lastGlyph;var fontData=src.fontData;var chars=fontData.chars;var lineHeight=fontData.lineHeight;var scale=(src._fontSize/fontData.size);var align=src._align;var currentLine=0;var lineOffsetX=0;var bounds=src.getTextBounds(false);if(src.maxWidth>0){text=bounds.wrappedText;textLength=text.length}var lineData=src._bounds.lines;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[0])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[0])}var roundPixels=camera.roundPixels;for(var i=0;i<textLength;i++){charCode=text.charCodeAt(i);if(charCode===10){currentLine++;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])}xAdvance=0;yAdvance+=lineHeight;lastGlyph=null;continue}glyph=chars[charCode];if(!glyph){continue}glyphX=textureX+glyph.x;glyphY=textureY+glyph.y;glyphW=glyph.width;glyphH=glyph.height;var x=glyph.xOffset+xAdvance;var y=glyph.yOffset+yAdvance;if(lastGlyph!==null){var kerningOffset=glyph.kerning[lastCharCode];x+=(kerningOffset!==undefined)?kerningOffset:0}xAdvance+=glyph.xAdvance+letterSpacing;lastGlyph=glyph;lastCharCode=charCode;if(glyphW===0||glyphH===0||charCode===32){continue}x*=scale;y*=scale;x-=src.displayOriginX;y-=src.displayOriginY;x+=lineOffsetX;var u0=glyphX/textureWidth;var v0=glyphY/textureHeight;var u1=(glyphX+glyphW)/textureWidth;var v1=(glyphY+glyphH)/textureHeight;var xw=x+(glyphW*scale);var yh=y+(glyphH*scale);var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(x,yh);var ty1=calcMatrix.getY(x,yh);var tx2=calcMatrix.getX(xw,yh);var ty2=calcMatrix.getY(xw,yh);var tx3=calcMatrix.getX(xw,y);var ty3=calcMatrix.getY(xw,y);if(roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}pipeline.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,0)}};module.exports=BitmapTextWebGLRenderer}),(function(module,exports,__webpack_require__){var SetTransform=__webpack_require__(28);var BitmapTextCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var text=src._text;var textLength=text.length;var ctx=renderer.currentContext;if(textLength===0||!SetTransform(renderer,ctx,src,camera,parentMatrix)){return}var textureFrame=src.frame;var chars=src.fontData.chars;var lineHeight=src.fontData.lineHeight;var letterSpacing=src._letterSpacing;var xAdvance=0;var yAdvance=0;var charCode=0;var glyph=null;var glyphX=0;var glyphY=0;var glyphW=0;var glyphH=0;var x=0;var y=0;var lastGlyph=null;var lastCharCode=0;var image=src.frame.source.image;var textureX=textureFrame.cutX;var textureY=textureFrame.cutY;var scale=(src._fontSize/src.fontData.size);var align=src._align;var currentLine=0;var lineOffsetX=0;var bounds=src.getTextBounds(false);if(src.maxWidth>0){text=bounds.wrappedText;textLength=text.length}var lineData=src._bounds.lines;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[0])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[0])}ctx.translate(-src.displayOriginX,-src.displayOriginY);var roundPixels=camera.roundPixels;for(var i=0;i<textLength;i++){charCode=text.charCodeAt(i);if(charCode===10){currentLine++;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])}xAdvance=0;yAdvance+=lineHeight;lastGlyph=null;continue}glyph=chars[charCode];if(!glyph){continue}glyphX=textureX+glyph.x;glyphY=textureY+glyph.y;glyphW=glyph.width;glyphH=glyph.height;x=glyph.xOffset+xAdvance;y=glyph.yOffset+yAdvance;if(lastGlyph!==null){var kerningOffset=glyph.kerning[lastCharCode];x+=(kerningOffset!==undefined)?kerningOffset:0}x*=scale;y*=scale;x+=lineOffsetX;xAdvance+=glyph.xAdvance+letterSpacing;lastGlyph=glyph;lastCharCode=charCode;if(glyphW===0||glyphH===0||charCode===32){continue}if(roundPixels){x=Math.round(x);y=Math.round(y)}ctx.save();ctx.translate(x,y);ctx.scale(scale,scale);ctx.drawImage(image,glyphX,glyphY,glyphW,glyphH,0,0,glyphW,glyphH);ctx.restore()}ctx.restore()};module.exports=BitmapTextCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(951)}if(true){renderCanvas=__webpack_require__(952)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var BlitterWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var list=src.getRenderList();if(list.length===0){return}var pipeline=this.pipeline;renderer.setPipeline(pipeline,src);var cameraScrollX=camera.scrollX*src.scrollFactorX;var cameraScrollY=camera.scrollY*src.scrollFactorY;var calcMatrix=pipeline._tempMatrix1;calcMatrix.copyFrom(camera.matrix);if(parentMatrix){calcMatrix.multiplyWithOffset(parentMatrix,-cameraScrollX,-cameraScrollY);cameraScrollX=0;cameraScrollY=0}var blitterX=src.x-cameraScrollX;var blitterY=src.y-cameraScrollY;var prevTextureSourceIndex=-1;var tintEffect=false;var alpha=camera.alpha*src.alpha;var roundPixels=camera.roundPixels;for(var index=0;index<list.length;index++){var bob=list[index];var frame=bob.frame;var bobAlpha=bob.alpha*alpha;if(bobAlpha===0){continue}var width=frame.width;var height=frame.height;var x=blitterX+bob.x+frame.x;var y=blitterY+bob.y+frame.y;if(bob.flipX){width*=-1;x+=frame.width}if(bob.flipY){height*=-1;y+=frame.height}var xw=x+width;var yh=y+height;var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(xw,yh);var ty1=calcMatrix.getY(xw,yh);var tint=Utils.getTintAppendFloatAlpha(bob.tint,bobAlpha);if(frame.sourceIndex!==prevTextureSourceIndex){pipeline.setTexture2D(frame.glTexture,0);prevTextureSourceIndex=frame.sourceIndex}if(roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1)}if(pipeline.batchQuad(tx0,ty0,tx0,ty1,tx1,ty1,tx1,ty0,frame.u0,frame.v0,frame.u1,frame.v1,tint,tint,tint,tint,tintEffect,frame.glTexture,0)){prevTextureSourceIndex=-1}}};module.exports=BlitterWebGLRenderer}),(function(module,exports){var BlitterCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var list=src.getRenderList();if(list.length===0){return}var ctx=renderer.currentContext;var alpha=camera.alpha*src.alpha;if(alpha===0){return}ctx.globalCompositeOperation=renderer.blendModes[src.blendMode];ctx.imageSmoothingEnabled=!(!renderer.antialias||src.frame.source.scaleMode);var cameraScrollX=src.x-camera.scrollX*src.scrollFactorX;var cameraScrollY=src.y-camera.scrollY*src.scrollFactorY;ctx.save();if(parentMatrix){parentMatrix.copyToContext(ctx)}var roundPixels=camera.roundPixels;for(var i=0;i<list.length;i++){var bob=list[i];var flip=(bob.flipX||bob.flipY);var frame=bob.frame;var cd=frame.canvasData;var dx=frame.x;var dy=frame.y;var fx=1;var fy=1;var bobAlpha=bob.alpha*alpha;if(bobAlpha===0){continue}ctx.globalAlpha=bobAlpha;if(!flip){if(roundPixels){dx=Math.round(dx);dy=Math.round(dy)}ctx.drawImage(frame.source.image,cd.x,cd.y,cd.width,cd.height,dx+bob.x+cameraScrollX,dy+bob.y+cameraScrollY,cd.width,cd.height)}else{if(bob.flipX){fx=-1;dx-=cd.width}if(bob.flipY){fy=-1;dy-=cd.height}ctx.save();ctx.translate(bob.x+cameraScrollX,bob.y+cameraScrollY);ctx.scale(fx,fy);ctx.drawImage(frame.source.image,cd.x,cd.y,cd.width,cd.height,dx,dy,cd.width,cd.height);ctx.restore()}}ctx.restore()};module.exports=BlitterCanvasRenderer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Frame=__webpack_require__(94);var Bob=new Class({initialize:function Bob(blitter,x,y,frame,visible){this.parent=blitter;this.x=x;this.y=y;this.frame=frame;this.data={};this.tint=0xffffff;this._visible=visible;this._alpha=1;this.flipX=false;this.flipY=false},setFrame:function(frame){if(frame===undefined){this.frame=this.parent.frame}else if(frame instanceof Frame&&frame.texture===this.parent.texture){this.frame=frame}else{this.frame=this.parent.texture.get(frame)}return this},resetFlip:function(){this.flipX=false;this.flipY=false;return this},reset:function(x,y,frame){this.x=x;this.y=y;this.flipX=false;this.flipY=false;this._alpha=1;this._visible=true;this.parent.dirty=true;if(frame){this.setFrame(frame)}return this},setPosition:function(x,y){this.x=x;this.y=y;return this},setFlipX:function(value){this.flipX=value;return this},setFlipY:function(value){this.flipY=value;return this},setFlip:function(x,y){this.flipX=x;this.flipY=y;return this},setVisible:function(value){this.visible=value;return this},setAlpha:function(value){this.alpha=value;return this},setTint:function(value){this.tint=value;return this},destroy:function(){this.parent.dirty=true;this.parent.children.remove(this);this.parent=undefined;this.frame=undefined;this.data=undefined},visible:{get:function(){return this._visible},set:function(value){this.parent.dirty|=(this._visible!==value);this._visible=value}},alpha:{get:function(){return this._alpha},set:function(value){this.parent.dirty|=((this._alpha>0)!==(value>0));this._alpha=value}}});module.exports=Bob}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(955)}if(true){renderCanvas=__webpack_require__(956)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var ContainerWebGLRenderer=function(renderer,container,interpolationPercentage,camera,parentMatrix){var children=container.list;if(children.length===0){return}var transformMatrix=container.localTransform;if(parentMatrix){transformMatrix.loadIdentity();transformMatrix.multiply(parentMatrix);transformMatrix.translate(container.x,container.y);transformMatrix.rotate(container.rotation);transformMatrix.scale(container.scaleX,container.scaleY)}else{transformMatrix.applyITRS(container.x,container.y,container.rotation,container.scaleX,container.scaleY)}var containerHasBlendMode=(container.blendMode!==-1);if(!containerHasBlendMode){renderer.setBlendMode(0)}var alpha=container.alpha;var scrollFactorX=container.scrollFactorX;var scrollFactorY=container.scrollFactorY;var list=children;var childCount=children.length;for(var i=0;i<childCount;i++){var child=children[i];if(!child.willRender(camera)){continue}var childAlphaTopLeft;var childAlphaTopRight;var childAlphaBottomLeft;var childAlphaBottomRight;if(child.alphaTopLeft!==undefined){childAlphaTopLeft=child.alphaTopLeft;childAlphaTopRight=child.alphaTopRight;childAlphaBottomLeft=child.alphaBottomLeft;childAlphaBottomRight=child.alphaBottomRight}else{var childAlpha=child.alpha;childAlphaTopLeft=childAlpha;childAlphaTopRight=childAlpha;childAlphaBottomLeft=childAlpha;childAlphaBottomRight=childAlpha}var childScrollFactorX=child.scrollFactorX;var childScrollFactorY=child.scrollFactorY;if(!containerHasBlendMode&&child.blendMode!==renderer.currentBlendMode){renderer.setBlendMode(child.blendMode)}var mask=child.mask;if(mask){mask.preRenderWebGL(renderer,child,camera)}var type=child.type;if(type!==renderer.currentType){renderer.newType=true;renderer.currentType=type}renderer.nextTypeMatch=(i<childCount-1)?(list[i+1].type===renderer.currentType):false;child.setScrollFactor(childScrollFactorX*scrollFactorX,childScrollFactorY*scrollFactorY);child.setAlpha(childAlphaTopLeft*alpha,childAlphaTopRight*alpha,childAlphaBottomLeft*alpha,childAlphaBottomRight*alpha);child.renderWebGL(renderer,child,interpolationPercentage,camera,transformMatrix);child.setAlpha(childAlphaTopLeft,childAlphaTopRight,childAlphaBottomLeft,childAlphaBottomRight);child.setScrollFactor(childScrollFactorX,childScrollFactorY);if(mask){mask.postRenderWebGL(renderer,camera)}renderer.newType=false}};module.exports=ContainerWebGLRenderer}),(function(module,exports){var ContainerCanvasRenderer=function(renderer,container,interpolationPercentage,camera,parentMatrix){var children=container.list;if(children.length===0){return}var transformMatrix=container.localTransform;if(parentMatrix){transformMatrix.loadIdentity();transformMatrix.multiply(parentMatrix);transformMatrix.translate(container.x,container.y);transformMatrix.rotate(container.rotation);transformMatrix.scale(container.scaleX,container.scaleY)}else{transformMatrix.applyITRS(container.x,container.y,container.rotation,container.scaleX,container.scaleY)}var containerHasBlendMode=(container.blendMode!==-1);if(!containerHasBlendMode){renderer.setBlendMode(0)}var alpha=container._alpha;var scrollFactorX=container.scrollFactorX;var scrollFactorY=container.scrollFactorY;if(container.mask){container.mask.preRenderCanvas(renderer,null,camera)}for(var i=0;i<children.length;i++){var child=children[i];if(!child.willRender(camera)){continue}var childAlpha=child.alpha;var childScrollFactorX=child.scrollFactorX;var childScrollFactorY=child.scrollFactorY;if(!containerHasBlendMode&&child.blendMode!==renderer.currentBlendMode){renderer.setBlendMode(child.blendMode)}child.setScrollFactor(childScrollFactorX*scrollFactorX,childScrollFactorY*scrollFactorY);child.setAlpha(childAlpha*alpha);child.renderCanvas(renderer,child,interpolationPercentage,camera,transformMatrix);child.setAlpha(childAlpha);child.setScrollFactor(childScrollFactorX,childScrollFactorY)}if(container.mask){container.mask.postRenderCanvas(renderer)}};module.exports=ContainerCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(396)}if(true){renderCanvas=__webpack_require__(396)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){module.exports=['normal','multiply','multiply','screen','overlay','darken','lighten','color-dodge','color-burn','hard-light','soft-light','difference','exclusion','hue','saturation','color','luminosity']}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(960)}if(true){renderCanvas=__webpack_require__(961)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var DynamicBitmapTextWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var text=src.text;var textLength=text.length;if(textLength===0){return}var pipeline=this.pipeline;renderer.setPipeline(pipeline,src);var crop=(src.cropWidth>0||src.cropHeight>0);if(crop){pipeline.flush();renderer.pushScissor(src.x,src.y,src.cropWidth*src.scaleX,src.cropHeight*src.scaleY)}var camMatrix=pipeline._tempMatrix1;var spriteMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;var fontMatrix=pipeline._tempMatrix4;spriteMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);spriteMatrix.e=src.x;spriteMatrix.f=src.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*src.scrollFactorX;spriteMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var frame=src.frame;var texture=frame.glTexture;var textureX=frame.cutX;var textureY=frame.cutY;var textureWidth=texture.width;var textureHeight=texture.height;var tintEffect=(src._isTinted&&src.tintFill);var tintTL=Utils.getTintAppendFloatAlpha(src._tintTL,camera.alpha*src._alphaTL);var tintTR=Utils.getTintAppendFloatAlpha(src._tintTR,camera.alpha*src._alphaTR);var tintBL=Utils.getTintAppendFloatAlpha(src._tintBL,camera.alpha*src._alphaBL);var tintBR=Utils.getTintAppendFloatAlpha(src._tintBR,camera.alpha*src._alphaBR);pipeline.setTexture2D(texture,0);var xAdvance=0;var yAdvance=0;var charCode=0;var lastCharCode=0;var letterSpacing=src.letterSpacing;var glyph;var glyphX=0;var glyphY=0;var glyphW=0;var glyphH=0;var lastGlyph;var scrollX=src.scrollX;var scrollY=src.scrollY;var fontData=src.fontData;var chars=fontData.chars;var lineHeight=fontData.lineHeight;var scale=(src.fontSize/fontData.size);var rotation=0;var align=src._align;var currentLine=0;var lineOffsetX=0;src.getTextBounds(false);var lineData=src._bounds.lines;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[0])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[0])}var roundPixels=camera.roundPixels;var displayCallback=src.displayCallback;var callbackData=src.callbackData;for(var i=0;i<textLength;i++){charCode=text.charCodeAt(i);if(charCode===10){currentLine++;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])}xAdvance=0;yAdvance+=lineHeight;lastGlyph=null;continue}glyph=chars[charCode];if(!glyph){continue}glyphX=textureX+glyph.x;glyphY=textureY+glyph.y;glyphW=glyph.width;glyphH=glyph.height;var x=(glyph.xOffset+xAdvance)-scrollX;var y=(glyph.yOffset+yAdvance)-scrollY;if(lastGlyph!==null){var kerningOffset=glyph.kerning[lastCharCode];x+=(kerningOffset!==undefined)?kerningOffset:0}xAdvance+=glyph.xAdvance+letterSpacing;lastGlyph=glyph;lastCharCode=charCode;if(glyphW===0||glyphH===0||charCode===32){continue}scale=(src.fontSize/src.fontData.size);rotation=0;if(displayCallback){callbackData.color=0;callbackData.tint.topLeft=tintTL;callbackData.tint.topRight=tintTR;callbackData.tint.bottomLeft=tintBL;callbackData.tint.bottomRight=tintBR;callbackData.index=i;callbackData.charCode=charCode;callbackData.x=x;callbackData.y=y;callbackData.scale=scale;callbackData.rotation=rotation;callbackData.data=glyph.data;var output=displayCallback(callbackData);x=output.x;y=output.y;scale=output.scale;rotation=output.rotation;if(output.color){tintTL=output.color;tintTR=output.color;tintBL=output.color;tintBR=output.color}else{tintTL=output.tint.topLeft;tintTR=output.tint.topRight;tintBL=output.tint.bottomLeft;tintBR=output.tint.bottomRight}tintTL=Utils.getTintAppendFloatAlpha(tintTL,camera.alpha*src._alphaTL);tintTR=Utils.getTintAppendFloatAlpha(tintTR,camera.alpha*src._alphaTR);tintBL=Utils.getTintAppendFloatAlpha(tintBL,camera.alpha*src._alphaBL);tintBR=Utils.getTintAppendFloatAlpha(tintBR,camera.alpha*src._alphaBR)}x*=scale;y*=scale;x-=src.displayOriginX;y-=src.displayOriginY;x+=lineOffsetX;fontMatrix.applyITRS(x,y,rotation,scale,scale);calcMatrix.multiply(fontMatrix,spriteMatrix);var u0=glyphX/textureWidth;var v0=glyphY/textureHeight;var u1=(glyphX+glyphW)/textureWidth;var v1=(glyphY+glyphH)/textureHeight;var xw=glyphW;var yh=glyphH;var tx0=spriteMatrix.e;var ty0=spriteMatrix.f;var tx1=yh*spriteMatrix.c+spriteMatrix.e;var ty1=yh*spriteMatrix.d+spriteMatrix.f;var tx2=xw*spriteMatrix.a+yh*spriteMatrix.c+spriteMatrix.e;var ty2=xw*spriteMatrix.b+yh*spriteMatrix.d+spriteMatrix.f;var tx3=xw*spriteMatrix.a+spriteMatrix.e;var ty3=xw*spriteMatrix.b+spriteMatrix.f;if(roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}pipeline.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,u0,v0,u1,v1,tintTL,tintTR,tintBL,tintBR,tintEffect,texture,0)}if(crop){pipeline.flush();renderer.popScissor()}};module.exports=DynamicBitmapTextWebGLRenderer}),(function(module,exports,__webpack_require__){var SetTransform=__webpack_require__(28);var DynamicBitmapTextCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var text=src._text;var textLength=text.length;var ctx=renderer.currentContext;if(textLength===0||!SetTransform(renderer,ctx,src,camera,parentMatrix)){return}var textureFrame=src.frame;var displayCallback=src.displayCallback;var callbackData=src.callbackData;var chars=src.fontData.chars;var lineHeight=src.fontData.lineHeight;var letterSpacing=src._letterSpacing;var xAdvance=0;var yAdvance=0;var charCode=0;var glyph=null;var glyphX=0;var glyphY=0;var glyphW=0;var glyphH=0;var x=0;var y=0;var lastGlyph=null;var lastCharCode=0;var image=src.frame.source.image;var textureX=textureFrame.cutX;var textureY=textureFrame.cutY;var rotation=0;var scale=0;var baseScale=(src._fontSize/src.fontData.size);var align=src._align;var currentLine=0;var lineOffsetX=0;src.getTextBounds(false);var lineData=src._bounds.lines;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[0])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[0])}ctx.translate(-src.displayOriginX,-src.displayOriginY);var roundPixels=camera.roundPixels;if(src.cropWidth>0&&src.cropHeight>0){ctx.beginPath();ctx.rect(0,0,src.cropWidth,src.cropHeight);ctx.clip()}for(var i=0;i<textLength;i++){scale=baseScale;rotation=0;charCode=text.charCodeAt(i);if(charCode===10){currentLine++;if(align===1){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])/2}else if(align===2){lineOffsetX=(lineData.longest-lineData.lengths[currentLine])}xAdvance=0;yAdvance+=lineHeight;lastGlyph=null;continue}glyph=chars[charCode];if(!glyph){continue}glyphX=textureX+glyph.x;glyphY=textureY+glyph.y;glyphW=glyph.width;glyphH=glyph.height;x=(glyph.xOffset+xAdvance)-src.scrollX;y=(glyph.yOffset+yAdvance)-src.scrollY;if(lastGlyph!==null){var kerningOffset=glyph.kerning[lastCharCode];x+=(kerningOffset!==undefined)?kerningOffset:0}if(displayCallback){callbackData.index=i;callbackData.charCode=charCode;callbackData.x=x;callbackData.y=y;callbackData.scale=scale;callbackData.rotation=rotation;callbackData.data=glyph.data;var output=displayCallback(callbackData);x=output.x;y=output.y;scale=output.scale;rotation=output.rotation}x*=scale;y*=scale;x+=lineOffsetX;xAdvance+=glyph.xAdvance+letterSpacing;lastGlyph=glyph;lastCharCode=charCode;if(glyphW===0||glyphH===0||charCode===32){continue}if(roundPixels){x=Math.round(x);y=Math.round(y)}ctx.save();ctx.translate(x,y);ctx.rotate(rotation);ctx.scale(scale,scale);ctx.drawImage(image,glyphX,glyphY,glyphW,glyphH,0,0,glyphW,glyphH);ctx.restore()}ctx.restore()};module.exports=DynamicBitmapTextCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(963)}if(true){renderCanvas=__webpack_require__(964)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var ExternWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=renderer.currentPipeline;renderer.clearPipeline();var camMatrix=renderer._tempMatrix1;var spriteMatrix=renderer._tempMatrix2;var calcMatrix=renderer._tempMatrix3;spriteMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);spriteMatrix.e=src.x;spriteMatrix.f=src.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*src.scrollFactorX;spriteMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}src.render.call(src,renderer,camera,calcMatrix);renderer.rebindPipeline(pipeline)};module.exports=ExternWebGLRenderer}),(function(module,exports){}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(966);renderCanvas=__webpack_require__(401)}if(true){renderCanvas=__webpack_require__(401)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Commands=__webpack_require__(192);var Utils=__webpack_require__(9);var Point=function(x,y,width){this.x=x;this.y=y;this.width=width};var Path=function(x,y,width){this.points=[];this.pointsLength=1;this.points[0]=new Point(x,y,width)};var matrixStack=[];var GraphicsWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){if(src.commandBuffer.length===0){return}var pipeline=this.pipeline;renderer.setPipeline(pipeline,src);var camMatrix=src._tempMatrix1;var graphicsMatrix=src._tempMatrix2;var currentMatrix=src._tempMatrix3;currentMatrix.loadIdentity();graphicsMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);graphicsMatrix.e=src.x;graphicsMatrix.f=src.y;camMatrix.multiply(graphicsMatrix)}else{graphicsMatrix.e-=camera.scrollX*src.scrollFactorX;graphicsMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(graphicsMatrix)}var commands=src.commandBuffer;var alpha=camera.alpha*src.alpha;var lineWidth=1;var fillTint=pipeline.fillTint;var strokeTint=pipeline.strokeTint;var tx=0;var ty=0;var ta=0;var iterStep=0.01;var PI2=Math.PI*2;var cmd;var path=[];var pathIndex=0;var pathOpen=false;var lastPath=null;var getTint=Utils.getTintAppendFloatAlphaAndSwap;var currentTexture=renderer.blankTexture.glTexture;for(var cmdIndex=0;cmdIndex<commands.length;cmdIndex++){cmd=commands[cmdIndex];switch(cmd){case Commands.BEGIN_PATH:path.length=0;lastPath=null;pathOpen=true;break;case Commands.CLOSE_PATH:pathOpen=false;if(lastPath&&lastPath.points.length){lastPath.points.push(lastPath.points[0])}break;case Commands.FILL_PATH:for(pathIndex=0;pathIndex<path.length;pathIndex++){pipeline.setTexture2D(currentTexture);pipeline.batchFillPath(path[pathIndex].points,currentMatrix,camMatrix)}break;case Commands.STROKE_PATH:for(pathIndex=0;pathIndex<path.length;pathIndex++){pipeline.setTexture2D(currentTexture);pipeline.batchStrokePath(path[pathIndex].points,lineWidth,pathOpen,currentMatrix,camMatrix)}break;case Commands.LINE_STYLE:lineWidth=commands[++cmdIndex];var strokeColor=commands[++cmdIndex];var strokeAlpha=commands[++cmdIndex]*alpha;var strokeTintColor=getTint(strokeColor,strokeAlpha);strokeTint.TL=strokeTintColor;strokeTint.TR=strokeTintColor;strokeTint.BL=strokeTintColor;strokeTint.BR=strokeTintColor;break;case Commands.FILL_STYLE:var fillColor=commands[++cmdIndex];var fillAlpha=commands[++cmdIndex]*alpha;var fillTintColor=getTint(fillColor,fillAlpha);fillTint.TL=fillTintColor;fillTint.TR=fillTintColor;fillTint.BL=fillTintColor;fillTint.BR=fillTintColor;break;case Commands.GRADIENT_FILL_STYLE:var gradientFillAlpha=commands[++cmdIndex]*alpha;fillTint.TL=getTint(commands[++cmdIndex],gradientFillAlpha);fillTint.TR=getTint(commands[++cmdIndex],gradientFillAlpha);fillTint.BL=getTint(commands[++cmdIndex],gradientFillAlpha);fillTint.BR=getTint(commands[++cmdIndex],gradientFillAlpha);break;case Commands.GRADIENT_LINE_STYLE:lineWidth=commands[++cmdIndex];var gradientLineAlpha=commands[++cmdIndex]*alpha;strokeTint.TL=getTint(commands[++cmdIndex],gradientLineAlpha);strokeTint.TR=getTint(commands[++cmdIndex],gradientLineAlpha);strokeTint.BL=getTint(commands[++cmdIndex],gradientLineAlpha);strokeTint.BR=getTint(commands[++cmdIndex],gradientLineAlpha);break;case Commands.ARC:var iteration=0;var x=commands[++cmdIndex];var y=commands[++cmdIndex];var radius=commands[++cmdIndex];var startAngle=commands[++cmdIndex];var endAngle=commands[++cmdIndex];var anticlockwise=commands[++cmdIndex];var overshoot=commands[++cmdIndex];endAngle-=startAngle;if(anticlockwise){if(endAngle<-PI2){endAngle=-PI2}else if(endAngle>0){endAngle=-PI2+endAngle%PI2}}else if(endAngle>PI2){endAngle=PI2}else if(endAngle<0){endAngle=PI2+endAngle%PI2}if(lastPath===null){lastPath=new Path(x+Math.cos(startAngle)*radius,y+Math.sin(startAngle)*radius,lineWidth);path.push(lastPath);iteration+=iterStep}while(iteration<1+overshoot){ta=endAngle*iteration+startAngle;tx=x+Math.cos(ta)*radius;ty=y+Math.sin(ta)*radius;lastPath.points.push(new Point(tx,ty,lineWidth));iteration+=iterStep}ta=endAngle+startAngle;tx=x+Math.cos(ta)*radius;ty=y+Math.sin(ta)*radius;lastPath.points.push(new Point(tx,ty,lineWidth));break;case Commands.FILL_RECT:pipeline.setTexture2D(currentTexture);pipeline.batchFillRect(commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],currentMatrix,camMatrix);break;case Commands.FILL_TRIANGLE:pipeline.setTexture2D(currentTexture);pipeline.batchFillTriangle(commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],currentMatrix,camMatrix);break;case Commands.STROKE_TRIANGLE:pipeline.setTexture2D(currentTexture);pipeline.batchStrokeTriangle(commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],commands[++cmdIndex],lineWidth,currentMatrix,camMatrix);break;case Commands.LINE_TO:if(lastPath!==null){lastPath.points.push(new Point(commands[++cmdIndex],commands[++cmdIndex],lineWidth))}else{lastPath=new Path(commands[++cmdIndex],commands[++cmdIndex],lineWidth);path.push(lastPath)}break;case Commands.MOVE_TO:lastPath=new Path(commands[++cmdIndex],commands[++cmdIndex],lineWidth);path.push(lastPath);break;case Commands.SAVE:matrixStack.push(currentMatrix.copyToArray());break;case Commands.RESTORE:currentMatrix.copyFromArray(matrixStack.pop());break;case Commands.TRANSLATE:x=commands[++cmdIndex];y=commands[++cmdIndex];currentMatrix.translate(x,y);break;case Commands.SCALE:x=commands[++cmdIndex];y=commands[++cmdIndex];currentMatrix.scale(x,y);break;case Commands.ROTATE:currentMatrix.rotate(commands[++cmdIndex]);break;case Commands.SET_TEXTURE:var frame=commands[++cmdIndex];var mode=commands[++cmdIndex];pipeline.currentFrame=frame;pipeline.setTexture2D(frame.glTexture,0);pipeline.tintEffect=mode;currentTexture=frame.glTexture;break;case Commands.CLEAR_TEXTURE:pipeline.currentFrame=renderer.blankTexture;pipeline.tintEffect=2;currentTexture=renderer.blankTexture.glTexture;break}}};module.exports=GraphicsWebGLRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(968)}if(true){renderCanvas=__webpack_require__(969)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var SpriteWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){this.pipeline.batchSprite(src,camera,parentMatrix)};module.exports=SpriteWebGLRenderer}),(function(module,exports){var SpriteCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){renderer.batchSprite(src,src.frame,camera,parentMatrix)};module.exports=SpriteCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(971)}if(true){renderCanvas=__webpack_require__(972)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var ImageWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){this.pipeline.batchSprite(src,camera,parentMatrix)};module.exports=ImageWebGLRenderer}),(function(module,exports){var ImageCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){renderer.batchSprite(src,src.frame,camera,parentMatrix)};module.exports=ImageCanvasRenderer}),(function(module,exports,__webpack_require__){module.exports={GravityWell:__webpack_require__(402),Particle:__webpack_require__(403),ParticleEmitter:__webpack_require__(404),ParticleEmitterManager:__webpack_require__(194),Zones:__webpack_require__(978)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FloatBetween=__webpack_require__(119);var GetEaseFunction=__webpack_require__(69);var GetFastValue=__webpack_require__(2);var Wrap=__webpack_require__(58);var EmitterOp=new Class({initialize:function EmitterOp(config,key,defaultValue,emitOnly){if(emitOnly===undefined){emitOnly=false}this.propertyKey=key;this.propertyValue=defaultValue;this.defaultValue=defaultValue;this.steps=0;this.counter=0;this.start=0;this.end=0;this.ease;this.emitOnly=emitOnly;this.onEmit=this.defaultEmit;this.onUpdate=this.defaultUpdate;this.loadConfig(config)},loadConfig:function(config,newKey){if(config===undefined){config={}}if(newKey){this.propertyKey=newKey}this.propertyValue=GetFastValue(config,this.propertyKey,this.defaultValue);this.setMethods();if(this.emitOnly){this.onUpdate=this.defaultUpdate}},toJSON:function(){return this.propertyValue},onChange:function(value){this.propertyValue=value;return this.setMethods()},setMethods:function(){var value=this.propertyValue;var t=typeof value;if(t==='number'){this.onEmit=this.staticValueEmit;this.onUpdate=this.staticValueUpdate}else if(Array.isArray(value)){this.onEmit=this.randomStaticValueEmit}else if(t==='function'){if(this.emitOnly){this.onEmit=value}else{this.onUpdate=value}}else if(t==='object'&&(this.has(value,'random')||this.hasBoth(value,'start','end')||this.hasBoth(value,'min','max'))){this.start=this.has(value,'start')?value.start:value.min;this.end=this.has(value,'end')?value.end:value.max;var isRandom=(this.hasBoth(value,'min','max')||!!value.random);if(isRandom){var rnd=value.random;if(Array.isArray(rnd)){this.start=rnd[0];this.end=rnd[1]}this.onEmit=this.randomRangedValueEmit}if(this.has(value,'steps')){this.steps=value.steps;this.counter=this.start;this.onEmit=this.steppedEmit}else{var easeType=this.has(value,'ease')?value.ease:'Linear';this.ease=GetEaseFunction(easeType);if(!isRandom){this.onEmit=this.easedValueEmit}this.onUpdate=this.easeValueUpdate}}else if(t==='object'&&this.hasEither(value,'onEmit','onUpdate')){if(this.has(value,'onEmit')){this.onEmit=value.onEmit}if(this.has(value,'onUpdate')){this.onUpdate=value.onUpdate}}return this},has:function(object,key){return object.hasOwnProperty(key)},hasBoth:function(object,key1,key2){return object.hasOwnProperty(key1)&&object.hasOwnProperty(key2)},hasEither:function(object,key1,key2){return object.hasOwnProperty(key1)||object.hasOwnProperty(key2)},defaultEmit:function(particle,key,value){return value},defaultUpdate:function(particle,key,t,value){return value},staticValueEmit:function(){return this.propertyValue},staticValueUpdate:function(){return this.propertyValue},randomStaticValueEmit:function(){var randomIndex=Math.floor(Math.random()*this.propertyValue.length);return this.propertyValue[randomIndex]},randomRangedValueEmit:function(particle,key){var value=FloatBetween(this.start,this.end);if(particle&&particle.data[key]){particle.data[key].min=value}return value},steppedEmit:function(){var current=this.counter;var next=this.counter+(this.end-this.start)/this.steps;this.counter=Wrap(next,this.start,this.end);return current},easedValueEmit:function(particle,key){if(particle&&particle.data[key]){var data=particle.data[key];data.min=this.start;data.max=this.end}return this.start},easeValueUpdate:function(particle,key,t){var data=particle.data[key];return(data.max-data.min)*this.ease(t)+data.min}});module.exports=EmitterOp}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(976)}if(true){renderCanvas=__webpack_require__(977)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var ParticleManagerWebGLRenderer=function(renderer,emitterManager,interpolationPercentage,camera,parentMatrix){var emitters=emitterManager.emitters.list;var emittersLength=emitters.length;if(emittersLength===0){return}var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1.copyFrom(camera.matrix);var calcMatrix=pipeline._tempMatrix2;var particleMatrix=pipeline._tempMatrix3;var managerMatrix=pipeline._tempMatrix4.applyITRS(emitterManager.x,emitterManager.y,emitterManager.rotation,emitterManager.scaleX,emitterManager.scaleY);camMatrix.multiply(managerMatrix);renderer.setPipeline(pipeline);var roundPixels=camera.roundPixels;var texture=emitterManager.defaultFrame.glTexture;var getTint=Utils.getTintAppendFloatAlphaAndSwap;pipeline.setTexture2D(texture,0);for(var e=0;e<emittersLength;e++){var emitter=emitters[e];var particles=emitter.alive;var particleCount=particles.length;if(!emitter.visible||particleCount===0){continue}var scrollX=camera.scrollX*emitter.scrollFactorX;var scrollY=camera.scrollY*emitter.scrollFactorY;if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-scrollX,-scrollY);scrollX=0;scrollY=0}if(renderer.setBlendMode(emitter.blendMode)){pipeline.setTexture2D(texture,0)}if(emitter.mask){emitter.mask.preRenderWebGL(renderer,emitter,camera);pipeline.setTexture2D(texture,0)}var tintEffect=0;for(var i=0;i<particleCount;i++){var particle=particles[i];var alpha=particle.alpha*camera.alpha;if(alpha<=0){continue}var frame=particle.frame;var x=-(frame.halfWidth);var y=-(frame.halfHeight);var xw=x+frame.width;var yh=y+frame.height;particleMatrix.applyITRS(0,0,particle.rotation,particle.scaleX,particle.scaleY);particleMatrix.e=particle.x-scrollX;particleMatrix.f=particle.y-scrollY;camMatrix.multiply(particleMatrix,calcMatrix);var tx0=calcMatrix.getX(x,y);var ty0=calcMatrix.getY(x,y);var tx1=calcMatrix.getX(x,yh);var ty1=calcMatrix.getY(x,yh);var tx2=calcMatrix.getX(xw,yh);var ty2=calcMatrix.getY(xw,yh);var tx3=calcMatrix.getX(xw,y);var ty3=calcMatrix.getY(xw,y);if(roundPixels){tx0=Math.round(tx0);ty0=Math.round(ty0);tx1=Math.round(tx1);ty1=Math.round(ty1);tx2=Math.round(tx2);ty2=Math.round(ty2);tx3=Math.round(tx3);ty3=Math.round(ty3)}var tint=getTint(particle.tint,alpha);pipeline.batchQuad(tx0,ty0,tx1,ty1,tx2,ty2,tx3,ty3,frame.u0,frame.v0,frame.u1,frame.v1,tint,tint,tint,tint,tintEffect,texture,0)}if(emitter.mask){emitter.mask.postRenderWebGL(renderer,camera);pipeline.setTexture2D(texture,0)}}};module.exports=ParticleManagerWebGLRenderer}),(function(module,exports){var ParticleManagerCanvasRenderer=function(renderer,emitterManager,interpolationPercentage,camera,parentMatrix){var emitters=emitterManager.emitters.list;var emittersLength=emitters.length;if(emittersLength===0){return}var camMatrix=renderer._tempMatrix1.copyFrom(camera.matrix);var calcMatrix=renderer._tempMatrix2;var particleMatrix=renderer._tempMatrix3;var managerMatrix=renderer._tempMatrix4.applyITRS(emitterManager.x,emitterManager.y,emitterManager.rotation,emitterManager.scaleX,emitterManager.scaleY);camMatrix.multiply(managerMatrix);var roundPixels=camera.roundPixels;var ctx=renderer.currentContext;ctx.save();for(var e=0;e<emittersLength;e++){var emitter=emitters[e];var particles=emitter.alive;var particleCount=particles.length;if(!emitter.visible||particleCount===0){continue}var scrollX=camera.scrollX*emitter.scrollFactorX;var scrollY=camera.scrollY*emitter.scrollFactorY;if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-scrollX,-scrollY);scrollX=0;scrollY=0}ctx.globalCompositeOperation=renderer.blendModes[emitter.blendMode];for(var i=0;i<particleCount;i++){var particle=particles[i];var alpha=particle.alpha*camera.alpha;if(alpha<=0){continue}var frame=particle.frame;var cd=frame.canvasData;var x=-(frame.halfWidth);var y=-(frame.halfHeight);particleMatrix.applyITRS(0,0,particle.rotation,particle.scaleX,particle.scaleY);particleMatrix.e=particle.x-scrollX;particleMatrix.f=particle.y-scrollY;camMatrix.multiply(particleMatrix,calcMatrix);ctx.globalAlpha=alpha;ctx.save();calcMatrix.copyToContext(ctx);if(roundPixels){x=Math.round(x);y=Math.round(y)}ctx.imageSmoothingEnabled=!(!renderer.antialias||frame.source.scaleMode);ctx.drawImage(frame.source.image,cd.x,cd.y,cd.width,cd.height,x,y,cd.width,cd.height);ctx.restore()}}ctx.restore()};module.exports=ParticleManagerCanvasRenderer}),(function(module,exports,__webpack_require__){module.exports={DeathZone:__webpack_require__(405),EdgeZone:__webpack_require__(406),RandomZone:__webpack_require__(408)}}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(980)}if(true){renderCanvas=__webpack_require__(981)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var RenderTextureWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var frame=src.frame;var width=frame.width;var height=frame.height;var getTint=Utils.getTintAppendFloatAlpha;this.pipeline.batchTexture(src,frame.glTexture,width,height,src.x,src.y,width,height,src.scaleX,src.scaleY,src.rotation,src.flipX,!src.flipY,src.scrollFactorX,src.scrollFactorY,src.displayOriginX,src.displayOriginY,0,0,width,height,getTint(src._tintTL,camera.alpha*src._alphaTL),getTint(src._tintTR,camera.alpha*src._alphaTR),getTint(src._tintBL,camera.alpha*src._alphaBL),getTint(src._tintBR,camera.alpha*src._alphaBR),(src._isTinted&&src.tintFill),0,0,camera,parentMatrix);renderer.setBlankTexture(true)};module.exports=RenderTextureWebGLRenderer}),(function(module,exports){var RenderTextureCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){renderer.batchSprite(src,src.frame,camera,parentMatrix)};module.exports=RenderTextureCanvasRenderer}),(function(module,exports,__webpack_require__){var RETRO_FONT_CONST=__webpack_require__(983);var Extend=__webpack_require__(18);var RetroFont={Parse:__webpack_require__(984)};RetroFont=Extend(false,RetroFont,RETRO_FONT_CONST);module.exports=RetroFont}),(function(module,exports){var RETRO_FONT_CONST={TEXT_SET1:' !"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\r]^_`abcdefghijklmnopqrstuvwxyz{|}~',TEXT_SET2:' !"#$%&\n()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ',TEXT_SET3:'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ',TEXT_SET4:'ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789',TEXT_SET5:'ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() \r!?-*:0123456789',TEXT_SET6:'ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789"(),-.\n ',TEXT_SET7:'AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW")28FLRX-\r39',TEXT_SET8:'0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ',TEXT_SET9:'ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,\n"?!',TEXT_SET10:'ABCDEFGHIJKLMNOPQRSTUVWXYZ',TEXT_SET11:'ABCDEFGHIJKLMNOPQRSTUVWXYZ.,"-+!?()\r:;0123456789'};module.exports=RETRO_FONT_CONST}),(function(module,exports,__webpack_require__){var GetValue=__webpack_require__(6);var ParseRetroFont=function(scene,config){var w=config.width;var h=config.height;var cx=Math.floor(w/2);var cy=Math.floor(h/2);var letters=GetValue(config,'chars','');if(letters===''){return}var key=GetValue(config,'image','');var offsetX=GetValue(config,'offset.x',0);var offsetY=GetValue(config,'offset.y',0);var spacingX=GetValue(config,'spacing.x',0);var spacingY=GetValue(config,'spacing.y',0);var lineSpacing=GetValue(config,'lineSpacing',0);var charsPerRow=GetValue(config,'charsPerRow',null);if(charsPerRow===null){charsPerRow=scene.sys.textures.getFrame(key).width/w;if(charsPerRow>letters.length){charsPerRow=letters.length}}var x=offsetX;var y=offsetY;var data={retroFont:true,font:key,size:w,lineHeight:h+lineSpacing,chars:{}};var r=0;for(var i=0;i<letters.length;i++){var charCode=letters.charCodeAt(i);data.chars[charCode]={x:x,y:y,width:w,height:h,centerX:cx,centerY:cy,xOffset:0,yOffset:0,xAdvance:w,data:{},kerning:{}};r++;if(r===charsPerRow){r=0;x=offsetX;y+=h+spacingY}else{x+=w+spacingX}}var entry={data:data,frame:null,texture:key};return entry};module.exports=ParseRetroFont}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(986)}if(true){renderCanvas=__webpack_require__(987)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var RopeWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=src.pipeline;renderer.setPipeline(pipeline,src);var camMatrix=pipeline._tempMatrix1;var spriteMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;spriteMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);spriteMatrix.e=src.x;spriteMatrix.f=src.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*src.scrollFactorX;spriteMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var frame=src.frame;var texture=frame.glTexture;var vertices=src.vertices;var uvs=src.uv;var colors=src.colors;var alphas=src.alphas;var alpha=src.alpha;var getTint=Utils.getTintAppendFloatAlphaAndSwap;var roundPixels=camera.roundPixels;var meshVerticesLength=vertices.length;var vertexCount=Math.floor(meshVerticesLength*0.5);pipeline.flush();pipeline.setTexture2D(texture,0);var vertexViewF32=pipeline.vertexViewF32;var vertexViewU32=pipeline.vertexViewU32;var vertexOffset=(pipeline.vertexCount*pipeline.vertexComponentCount)-1;var colorIndex=0;var tintEffect=src.tintFill;if(src.dirty){src.updateVertices()}var debugCallback=src.debugCallback;var debugVerts=[];for(var i=0;i<meshVerticesLength;i+=2){var x=vertices[i+0];var y=vertices[i+1];var tx=x*calcMatrix.a+y*calcMatrix.c+calcMatrix.e;var ty=x*calcMatrix.b+y*calcMatrix.d+calcMatrix.f;if(roundPixels){tx=Math.round(tx);ty=Math.round(ty)}vertexViewF32[++vertexOffset]=tx;vertexViewF32[++vertexOffset]=ty;vertexViewF32[++vertexOffset]=uvs[i+0];vertexViewF32[++vertexOffset]=uvs[i+1];vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=getTint(colors[colorIndex],camera.alpha*(alphas[colorIndex]*alpha));colorIndex++;if(debugCallback){debugVerts[i+0]=tx;debugVerts[i+1]=ty}}if(debugCallback){debugCallback.call(src,src,meshVerticesLength,debugVerts)}pipeline.vertexCount+=vertexCount};module.exports=RopeWebGLRenderer}),(function(module,exports){var RopeCanvasRenderer=function(){};module.exports=RopeCanvasRenderer}),(function(module,exports){var GetTextSize=function(text,size,lines){var canvas=text.canvas;var context=text.context;var style=text.style;var lineWidths=[];var maxLineWidth=0;var drawnLines=lines.length;if(style.maxLines>0&&style.maxLines<lines.length){drawnLines=style.maxLines}style.syncFont(canvas,context);for(var i=0;i<drawnLines;i++){var lineWidth=style.strokeThickness;lineWidth+=context.measureText(lines[i]).width;if(style.wordWrap){lineWidth-=context.measureText(' ').width}lineWidths[i]=Math.ceil(lineWidth);maxLineWidth=Math.max(maxLineWidth,lineWidths[i])}var lineHeight=size.fontSize+style.strokeThickness;var height=lineHeight*drawnLines;var lineSpacing=text.lineSpacing;if(drawnLines>1){height+=lineSpacing*(drawnLines-1)}return{width:maxLineWidth,height:height,lines:drawnLines,lineWidths:lineWidths,lineSpacing:lineSpacing,lineHeight:lineHeight}};module.exports=GetTextSize}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(990)}if(true){renderCanvas=__webpack_require__(991)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var TextWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){if((src.width===0)||(src.height===0)){return}var frame=src.frame;var width=frame.width;var height=frame.height;var getTint=Utils.getTintAppendFloatAlpha;this.pipeline.batchTexture(src,frame.glTexture,width,height,src.x,src.y,width/src.style.resolution,height/src.style.resolution,src.scaleX,src.scaleY,src.rotation,src.flipX,src.flipY,src.scrollFactorX,src.scrollFactorY,src.displayOriginX,src.displayOriginY,0,0,width,height,getTint(src._tintTL,camera.alpha*src._alphaTL),getTint(src._tintTR,camera.alpha*src._alphaTR),getTint(src._tintBL,camera.alpha*src._alphaBL),getTint(src._tintBR,camera.alpha*src._alphaBR),(src._isTinted&&src.tintFill),0,0,camera,parentMatrix)};module.exports=TextWebGLRenderer}),(function(module,exports){var TextCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){if((src.width===0)||(src.height===0)){return}renderer.batchSprite(src,src.frame,camera,parentMatrix)};module.exports=TextCanvasRenderer}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var GetAdvancedValue=__webpack_require__(15);var GetValue=__webpack_require__(6);var MeasureText=__webpack_require__(993);var propertyMap={fontFamily:['fontFamily','Courier'],fontSize:['fontSize','16px'],fontStyle:['fontStyle',''],backgroundColor:['backgroundColor',null],color:['color','#fff'],stroke:['stroke','#fff'],strokeThickness:['strokeThickness',0],shadowOffsetX:['shadow.offsetX',0],shadowOffsetY:['shadow.offsetY',0],shadowColor:['shadow.color','#000'],shadowBlur:['shadow.blur',0],shadowStroke:['shadow.stroke',false],shadowFill:['shadow.fill',false],align:['align','left'],maxLines:['maxLines',0],fixedWidth:['fixedWidth',0],fixedHeight:['fixedHeight',0],resolution:['resolution',0],rtl:['rtl',false],testString:['testString','|M?qgy'],baselineX:['baselineX',1.2],baselineY:['baselineY',1.4],wordWrapWidth:['wordWrap.width',null],wordWrapCallback:['wordWrap.callback',null],wordWrapCallbackScope:['wordWrap.callbackScope',null],wordWrapUseAdvanced:['wordWrap.useAdvancedWrap',false]};var TextStyle=new Class({initialize:function TextStyle(text,style){this.parent=text;this.fontFamily;this.fontSize;this.fontStyle;this.backgroundColor;this.color;this.stroke;this.strokeThickness;this.shadowOffsetX;this.shadowOffsetY;this.shadowColor;this.shadowBlur;this.shadowStroke;this.shadowFill;this.align;this.maxLines;this.fixedWidth;this.fixedHeight;this.resolution;this.rtl;this.testString;this.baselineX;this.baselineY;this.wordWrapWidth;this.wordWrapCallback;this.wordWrapCallbackScope;this.wordWrapUseAdvanced;this._font;this.setStyle(style,false,true);var metrics=GetValue(style,'metrics',false);if(metrics){this.metrics={ascent:GetValue(metrics,'ascent',0),descent:GetValue(metrics,'descent',0),fontSize:GetValue(metrics,'fontSize',0)}}else{this.metrics=MeasureText(this)}},setStyle:function(style,updateText,setDefaults){if(updateText===undefined){updateText=true}if(setDefaults===undefined){setDefaults=false}if(style&&style.hasOwnProperty('fontSize')&&typeof style.fontSize==='number'){style.fontSize=style.fontSize.toString()+'px'}for(var key in propertyMap){var value=(setDefaults)?propertyMap[key][1]:this[key];if(key==='wordWrapCallback'||key==='wordWrapCallbackScope'){this[key]=GetValue(style,propertyMap[key][0],value)}else{this[key]=GetAdvancedValue(style,propertyMap[key][0],value)}}var font=GetValue(style,'font',null);if(font!==null){this.setFont(font,false)}this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(' ').trim();var fill=GetValue(style,'fill',null);if(fill!==null){this.color=fill}if(updateText){return this.update(true)}else{return this.parent}},syncFont:function(canvas,context){context.font=this._font},syncStyle:function(canvas,context){context.textBaseline='alphabetic';context.fillStyle=this.color;context.strokeStyle=this.stroke;context.lineWidth=this.strokeThickness;context.lineCap='round';context.lineJoin='round'},syncShadow:function(context,enabled){if(enabled){context.shadowOffsetX=this.shadowOffsetX;context.shadowOffsetY=this.shadowOffsetY;context.shadowColor=this.shadowColor;context.shadowBlur=this.shadowBlur}else{context.shadowOffsetX=0;context.shadowOffsetY=0;context.shadowColor=0;context.shadowBlur=0}},update:function(recalculateMetrics){if(recalculateMetrics){this._font=[this.fontStyle,this.fontSize,this.fontFamily].join(' ').trim();this.metrics=MeasureText(this)}return this.parent.updateText()},setFont:function(font,updateText){if(updateText===undefined){updateText=true}var fontFamily=font;var fontSize='';var fontStyle='';if(typeof font!=='string'){fontFamily=GetValue(font,'fontFamily','Courier');fontSize=GetValue(font,'fontSize','16px');fontStyle=GetValue(font,'fontStyle','')}else{var fontSplit=font.split(' ');var i=0;fontStyle=(fontSplit.length>2)?fontSplit[i++]:'';fontSize=fontSplit[i++]||'16px';fontFamily=fontSplit[i++]||'Courier'}if(fontFamily!==this.fontFamily||fontSize!==this.fontSize||fontStyle!==this.fontStyle){this.fontFamily=fontFamily;this.fontSize=fontSize;this.fontStyle=fontStyle;if(updateText){this.update(true)}}return this.parent},setFontFamily:function(family){if(this.fontFamily!==family){this.fontFamily=family;this.update(true)}return this.parent},setFontStyle:function(style){if(this.fontStyle!==style){this.fontStyle=style;this.update(true)}return this.parent},setFontSize:function(size){if(typeof size==='number'){size=size.toString()+'px'}if(this.fontSize!==size){this.fontSize=size;this.update(true)}return this.parent},setTestString:function(string){this.testString=string;return this.update(true)},setFixedSize:function(width,height){this.fixedWidth=width;this.fixedHeight=height;if(width){this.parent.width=width}if(height){this.parent.height=height}return this.update(false)},setBackgroundColor:function(color){this.backgroundColor=color;return this.update(false)},setFill:function(color){this.color=color;return this.update(false)},setColor:function(color){this.color=color;return this.update(false)},setResolution:function(value){this.resolution=value;return this.update(false)},setStroke:function(color,thickness){if(thickness===undefined){thickness=this.strokeThickness}if(color===undefined&&this.strokeThickness!==0){this.strokeThickness=0;this.update(true)}else if(this.stroke!==color||this.strokeThickness!==thickness){this.stroke=color;this.strokeThickness=thickness;this.update(true)}return this.parent},setShadow:function(x,y,color,blur,shadowStroke,shadowFill){if(x===undefined){x=0}if(y===undefined){y=0}if(color===undefined){color='#000'}if(blur===undefined){blur=0}if(shadowStroke===undefined){shadowStroke=false}if(shadowFill===undefined){shadowFill=true}this.shadowOffsetX=x;this.shadowOffsetY=y;this.shadowColor=color;this.shadowBlur=blur;this.shadowStroke=shadowStroke;this.shadowFill=shadowFill;return this.update(false)},setShadowOffset:function(x,y){if(x===undefined){x=0}if(y===undefined){y=x}this.shadowOffsetX=x;this.shadowOffsetY=y;return this.update(false)},setShadowColor:function(color){if(color===undefined){color='#000'}this.shadowColor=color;return this.update(false)},setShadowBlur:function(blur){if(blur===undefined){blur=0}this.shadowBlur=blur;return this.update(false)},setShadowStroke:function(enabled){this.shadowStroke=enabled;return this.update(false)},setShadowFill:function(enabled){this.shadowFill=enabled;return this.update(false)},setWordWrapWidth:function(width,useAdvancedWrap){if(useAdvancedWrap===undefined){useAdvancedWrap=false}this.wordWrapWidth=width;this.wordWrapUseAdvanced=useAdvancedWrap;return this.update(false)},setWordWrapCallback:function(callback,scope){if(scope===undefined){scope=null}this.wordWrapCallback=callback;this.wordWrapCallbackScope=scope;return this.update(false)},setAlign:function(align){if(align===undefined){align='left'}this.align=align;return this.update(false)},setMaxLines:function(max){if(max===undefined){max=0}this.maxLines=max;return this.update(false)},getTextMetrics:function(){var metrics=this.metrics;return{ascent:metrics.ascent,descent:metrics.descent,fontSize:metrics.fontSize}},toJSON:function(){var output={};for(var key in propertyMap){output[key]=this[key]}output.metrics=this.getTextMetrics();return output},destroy:function(){this.parent=undefined}});module.exports=TextStyle}),(function(module,exports,__webpack_require__){var CanvasPool=__webpack_require__(26);var MeasureText=function(textStyle){var canvas=CanvasPool.create(this);var context=canvas.getContext('2d');textStyle.syncFont(canvas,context);var width=Math.ceil(context.measureText(textStyle.testString).width*textStyle.baselineX);var baseline=width;var height=2*baseline;baseline=baseline*textStyle.baselineY|0;canvas.width=width;canvas.height=height;context.fillStyle='#f00';context.fillRect(0,0,width,height);context.font=textStyle._font;context.textBaseline='alphabetic';context.fillStyle='#000';context.fillText(textStyle.testString,0,baseline);var output={ascent:0,descent:0,fontSize:0};if(!context.getImageData(0,0,width,height)){output.ascent=baseline;output.descent=baseline+6;output.fontSize=output.ascent+output.descent;CanvasPool.remove(canvas);return output}var imagedata=context.getImageData(0,0,width,height).data;var pixels=imagedata.length;var line=width*4;var i;var j;var idx=0;var stop=false;for(i=0;i<baseline;i++){for(j=0;j<line;j+=4){if(imagedata[idx+j]!==255){stop=true;break}}if(!stop){idx+=line}else{break}}output.ascent=baseline-i;idx=pixels-line;stop=false;for(i=height;i>baseline;i--){for(j=0;j<line;j+=4){if(imagedata[idx+j]!==255){stop=true;break}}if(!stop){idx-=line}else{break}}output.descent=(i-baseline);output.fontSize=output.ascent+output.descent;CanvasPool.remove(canvas);return output};module.exports=MeasureText}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(995)}if(true){renderCanvas=__webpack_require__(996)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var TileSpriteWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){src.updateCanvas();var getTint=Utils.getTintAppendFloatAlpha;this.pipeline.batchTexture(src,src.fillPattern,src.displayFrame.width*src.tileScaleX,src.displayFrame.height*src.tileScaleY,src.x,src.y,src.width,src.height,src.scaleX,src.scaleY,src.rotation,src.flipX,src.flipY,src.scrollFactorX,src.scrollFactorY,src.originX*src.width,src.originY*src.height,0,0,src.width,src.height,getTint(src._tintTL,camera.alpha*src._alphaTL),getTint(src._tintTR,camera.alpha*src._alphaTR),getTint(src._tintBL,camera.alpha*src._alphaBL),getTint(src._tintBR,camera.alpha*src._alphaBR),(src._isTinted&&src.tintFill),(src.tilePositionX%src.displayFrame.width)/src.displayFrame.width,(src.tilePositionY%src.displayFrame.height)/src.displayFrame.height,camera,parentMatrix)};module.exports=TileSpriteWebGLRenderer}),(function(module,exports){var TileSpriteCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){src.updateCanvas();renderer.batchSprite(src,src.frame,camera,parentMatrix)};module.exports=TileSpriteCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(998)}if(true){renderCanvas=__webpack_require__(999)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var VideoWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){if(src.videoTexture){this.pipeline.batchSprite(src,camera,parentMatrix)}};module.exports=VideoWebGLRenderer}),(function(module,exports){var VideoCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){if(src.videoTexture){renderer.batchSprite(src,src.frame,camera,parentMatrix)}};module.exports=VideoCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1001)}if(true){renderCanvas=__webpack_require__(1002)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var FillPathWebGL=__webpack_require__(98);var StrokePathWebGL=__webpack_require__(70);var ArcWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isFilled){FillPathWebGL(pipeline,calcMatrix,src,alpha,dx,dy)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=ArcWebGLRenderer}),(function(module,exports,__webpack_require__){var DegToRad=__webpack_require__(39);var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var ArcCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var radius=src.radius;ctx.beginPath();ctx.arc((radius)-src.originX*(radius*2),(radius)-src.originY*(radius*2),radius,DegToRad(src._startAngle),DegToRad(src._endAngle),src.anticlockwise);if(src.closePath){ctx.closePath()}if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fill()}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.stroke()}ctx.restore()}};module.exports=ArcCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1004)}if(true){renderCanvas=__webpack_require__(1005)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var FillPathWebGL=__webpack_require__(98);var StrokePathWebGL=__webpack_require__(70);var CurveWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX+src._curveBounds.x;var dy=src._displayOriginY+src._curveBounds.y;var alpha=camera.alpha*src.alpha;if(src.isFilled){FillPathWebGL(pipeline,calcMatrix,src,alpha,dx,dy)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=CurveWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var CurveCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX+src._curveBounds.x;var dy=src._displayOriginY+src._curveBounds.y;var path=src.pathData;var pathLength=path.length-1;var px1=path[0]-dx;var py1=path[1]-dy;ctx.beginPath();ctx.moveTo(px1,py1);if(!src.closePath){pathLength-=2}for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx;var py2=path[i+1]-dy;ctx.lineTo(px2,py2)}if(src.closePath){ctx.closePath()}if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fill()}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.stroke()}ctx.restore()}};module.exports=CurveCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1007)}if(true){renderCanvas=__webpack_require__(1008)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var FillPathWebGL=__webpack_require__(98);var StrokePathWebGL=__webpack_require__(70);var EllipseWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isFilled){FillPathWebGL(pipeline,calcMatrix,src,alpha,dx,dy)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=EllipseWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var EllipseCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX;var dy=src._displayOriginY;var path=src.pathData;var pathLength=path.length-1;var px1=path[0]-dx;var py1=path[1]-dy;ctx.beginPath();ctx.moveTo(px1,py1);if(!src.closePath){pathLength-=2}for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx;var py2=path[i+1]-dy;ctx.lineTo(px2,py2)}ctx.closePath();if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fill()}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.stroke()}ctx.restore()}};module.exports=EllipseCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1010)}if(true){renderCanvas=__webpack_require__(1011)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var GridWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);calcMatrix.translate(-src._displayOriginX,-src._displayOriginY);var alpha=camera.alpha*src.alpha;var width=src.width;var height=src.height;var cellWidth=src.cellWidth;var cellHeight=src.cellHeight;var gridWidth=Math.ceil(width/cellWidth);var gridHeight=Math.ceil(height/cellHeight);var cellWidthA=cellWidth;var cellHeightA=cellHeight;var cellWidthB=cellWidth-((gridWidth*cellWidth)-width);var cellHeightB=cellHeight-((gridHeight*cellHeight)-height);var fillTint;var fillTintColor;var showCells=src.showCells;var showAltCells=src.showAltCells;var showOutline=src.showOutline;var x=0;var y=0;var r=0;var cw=0;var ch=0;if(showOutline){cellWidthA--;cellHeightA--;if(cellWidthB===cellWidth){cellWidthB--}if(cellHeightB===cellHeight){cellHeightB--}}if(showCells&&src.fillAlpha>0){fillTint=pipeline.fillTint;fillTintColor=Utils.getTintAppendFloatAlphaAndSwap(src.fillColor,src.fillAlpha*alpha);fillTint.TL=fillTintColor;fillTint.TR=fillTintColor;fillTint.BL=fillTintColor;fillTint.BR=fillTintColor;for(y=0;y<gridHeight;y++){if(showAltCells){r=y%2}for(x=0;x<gridWidth;x++){if(showAltCells&&r){r=0;continue}r++;cw=(x<gridWidth-1)?cellWidthA:cellWidthB;ch=(y<gridHeight-1)?cellHeightA:cellHeightB;pipeline.setTexture2D();pipeline.batchFillRect(x*cellWidth,y*cellHeight,cw,ch)}}}if(showAltCells&&src.altFillAlpha>0){fillTint=pipeline.fillTint;fillTintColor=Utils.getTintAppendFloatAlphaAndSwap(src.altFillColor,src.altFillAlpha*alpha);fillTint.TL=fillTintColor;fillTint.TR=fillTintColor;fillTint.BL=fillTintColor;fillTint.BR=fillTintColor;for(y=0;y<gridHeight;y++){if(showAltCells){r=y%2}for(x=0;x<gridWidth;x++){if(showAltCells&&!r){r=1;continue}r=0;cw=(x<gridWidth-1)?cellWidthA:cellWidthB;ch=(y<gridHeight-1)?cellHeightA:cellHeightB;pipeline.setTexture2D();pipeline.batchFillRect(x*cellWidth,y*cellHeight,cw,ch)}}}if(showOutline&&src.outlineFillAlpha>0){var strokeTint=pipeline.strokeTint;var color=Utils.getTintAppendFloatAlphaAndSwap(src.outlineFillColor,src.outlineFillAlpha*alpha);strokeTint.TL=color;strokeTint.TR=color;strokeTint.BL=color;strokeTint.BR=color;for(x=1;x<gridWidth;x++){var x1=x*cellWidth;pipeline.setTexture2D();pipeline.batchLine(x1,0,x1,height,1,1,1,0,false)}for(y=1;y<gridHeight;y++){var y1=y*cellHeight;pipeline.setTexture2D();pipeline.batchLine(0,y1,width,y1,1,1,1,0,false)}}};module.exports=GridWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var GridCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=-src._displayOriginX;var dy=-src._displayOriginY;var alpha=camera.alpha*src.alpha;var width=src.width;var height=src.height;var cellWidth=src.cellWidth;var cellHeight=src.cellHeight;var gridWidth=Math.ceil(width/cellWidth);var gridHeight=Math.ceil(height/cellHeight);var cellWidthA=cellWidth;var cellHeightA=cellHeight;var cellWidthB=cellWidth-((gridWidth*cellWidth)-width);var cellHeightB=cellHeight-((gridHeight*cellHeight)-height);var showCells=src.showCells;var showAltCells=src.showAltCells;var showOutline=src.showOutline;var x=0;var y=0;var r=0;var cw=0;var ch=0;if(showOutline){cellWidthA--;cellHeightA--;if(cellWidthB===cellWidth){cellWidthB--}if(cellHeightB===cellHeight){cellHeightB--}}if(showCells&&src.fillAlpha>0){FillStyleCanvas(ctx,src);for(y=0;y<gridHeight;y++){if(showAltCells){r=y%2}for(x=0;x<gridWidth;x++){if(showAltCells&&r){r=0;continue}r++;cw=(x<gridWidth-1)?cellWidthA:cellWidthB;ch=(y<gridHeight-1)?cellHeightA:cellHeightB;ctx.fillRect(dx+x*cellWidth,dy+y*cellHeight,cw,ch)}}}if(showAltCells&&src.altFillAlpha>0){FillStyleCanvas(ctx,src,src.altFillColor,src.altFillAlpha*alpha);for(y=0;y<gridHeight;y++){if(showAltCells){r=y%2}for(x=0;x<gridWidth;x++){if(showAltCells&&!r){r=1;continue}r=0;cw=(x<gridWidth-1)?cellWidthA:cellWidthB;ch=(y<gridHeight-1)?cellHeightA:cellHeightB;ctx.fillRect(dx+x*cellWidth,dy+y*cellHeight,cw,ch)}}}if(showOutline&&src.outlineFillAlpha>0){LineStyleCanvas(ctx,src,src.outlineFillColor,src.outlineFillAlpha*alpha);for(x=1;x<gridWidth;x++){var x1=x*cellWidth;ctx.beginPath();ctx.moveTo(x1+dx,dy);ctx.lineTo(x1+dx,height+dy);ctx.stroke()}for(y=1;y<gridHeight;y++){var y1=y*cellHeight;ctx.beginPath();ctx.moveTo(dx,y1+dy);ctx.lineTo(dx+width,y1+dy);ctx.stroke()}}ctx.restore()}};module.exports=GridCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1013)}if(true){renderCanvas=__webpack_require__(1014)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var IsoBoxWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var size=src.width;var height=src.height;var sizeA=size/2;var sizeB=size/src.projection;var alpha=camera.alpha*src.alpha;if(!src.isFilled){return}var tint;var x0;var y0;var x1;var y1;var x2;var y2;var x3;var y3;if(src.showTop){tint=Utils.getTintAppendFloatAlphaAndSwap(src.fillTop,alpha);x0=calcMatrix.getX(-sizeA,-height);y0=calcMatrix.getY(-sizeA,-height);x1=calcMatrix.getX(0,-sizeB-height);y1=calcMatrix.getY(0,-sizeB-height);x2=calcMatrix.getX(sizeA,-height);y2=calcMatrix.getY(sizeA,-height);x3=calcMatrix.getX(0,sizeB-height);y3=calcMatrix.getY(0,sizeB-height);pipeline.setTexture2D();pipeline.batchQuad(x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)}if(src.showLeft){tint=Utils.getTintAppendFloatAlphaAndSwap(src.fillLeft,alpha);x0=calcMatrix.getX(-sizeA,0);y0=calcMatrix.getY(-sizeA,0);x1=calcMatrix.getX(0,sizeB);y1=calcMatrix.getY(0,sizeB);x2=calcMatrix.getX(0,sizeB-height);y2=calcMatrix.getY(0,sizeB-height);x3=calcMatrix.getX(-sizeA,-height);y3=calcMatrix.getY(-sizeA,-height);pipeline.setTexture2D();pipeline.batchQuad(x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)}if(src.showRight){tint=Utils.getTintAppendFloatAlphaAndSwap(src.fillRight,alpha);x0=calcMatrix.getX(sizeA,0);y0=calcMatrix.getY(sizeA,0);x1=calcMatrix.getX(0,sizeB);y1=calcMatrix.getY(0,sizeB);x2=calcMatrix.getX(0,sizeB-height);y2=calcMatrix.getY(0,sizeB-height);x3=calcMatrix.getX(sizeA,-height);y3=calcMatrix.getY(sizeA,-height);pipeline.setTexture2D();pipeline.batchQuad(x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)}};module.exports=IsoBoxWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var SetTransform=__webpack_require__(28);var IsoBoxCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)&&src.isFilled){var size=src.width;var height=src.height;var sizeA=size/2;var sizeB=size/src.projection;if(src.showTop){FillStyleCanvas(ctx,src,src.fillTop);ctx.beginPath();ctx.moveTo(-sizeA,-height);ctx.lineTo(0,-sizeB-height);ctx.lineTo(sizeA,-height);ctx.lineTo(sizeA,-1);ctx.lineTo(0,sizeB-1);ctx.lineTo(-sizeA,-1);ctx.lineTo(-sizeA,-height);ctx.fill()}if(src.showLeft){FillStyleCanvas(ctx,src,src.fillLeft);ctx.beginPath();ctx.moveTo(-sizeA,0);ctx.lineTo(0,sizeB);ctx.lineTo(0,sizeB-height);ctx.lineTo(-sizeA,-height);ctx.lineTo(-sizeA,0);ctx.fill()}if(src.showRight){FillStyleCanvas(ctx,src,src.fillRight);ctx.beginPath();ctx.moveTo(sizeA,0);ctx.lineTo(0,sizeB);ctx.lineTo(0,sizeB-height);ctx.lineTo(sizeA,-height);ctx.lineTo(sizeA,0);ctx.fill()}ctx.restore()}};module.exports=IsoBoxCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1016)}if(true){renderCanvas=__webpack_require__(1017)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var IsoTriangleWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var size=src.width;var height=src.height;var sizeA=size/2;var sizeB=size/src.projection;var reversed=src.isReversed;var alpha=camera.alpha*src.alpha;if(!src.isFilled){return}var tint;var x0;var y0;var x1;var y1;var x2;var y2;if(src.showTop&&reversed){tint=Utils.getTintAppendFloatAlphaAndSwap(src.fillTop,alpha);x0=calcMatrix.getX(-sizeA,-height);y0=calcMatrix.getY(-sizeA,-height);x1=calcMatrix.getX(0,-sizeB-height);y1=calcMatrix.getY(0,-sizeB-height);x2=calcMatrix.getX(sizeA,-height);y2=calcMatrix.getY(sizeA,-height);var x3=calcMatrix.getX(0,sizeB-height);var y3=calcMatrix.getY(0,sizeB-height);pipeline.setTexture2D();pipeline.batchQuad(x0,y0,x1,y1,x2,y2,x3,y3,0,0,1,1,tint,tint,tint,tint,2)}if(src.showLeft){tint=Utils.getTintAppendFloatAlphaAndSwap(src.fillLeft,alpha);if(reversed){x0=calcMatrix.getX(-sizeA,-height);y0=calcMatrix.getY(-sizeA,-height);x1=calcMatrix.getX(0,sizeB);y1=calcMatrix.getY(0,sizeB);x2=calcMatrix.getX(0,sizeB-height);y2=calcMatrix.getY(0,sizeB-height)}else{x0=calcMatrix.getX(-sizeA,0);y0=calcMatrix.getY(-sizeA,0);x1=calcMatrix.getX(0,sizeB);y1=calcMatrix.getY(0,sizeB);x2=calcMatrix.getX(0,sizeB-height);y2=calcMatrix.getY(0,sizeB-height)}pipeline.setTexture2D();pipeline.batchTri(x0,y0,x1,y1,x2,y2,0,0,1,1,tint,tint,tint,2)}if(src.showRight){tint=Utils.getTintAppendFloatAlphaAndSwap(src.fillRight,alpha);if(reversed){x0=calcMatrix.getX(sizeA,-height);y0=calcMatrix.getY(sizeA,-height);x1=calcMatrix.getX(0,sizeB);y1=calcMatrix.getY(0,sizeB);x2=calcMatrix.getX(0,sizeB-height);y2=calcMatrix.getY(0,sizeB-height)}else{x0=calcMatrix.getX(sizeA,0);y0=calcMatrix.getY(sizeA,0);x1=calcMatrix.getX(0,sizeB);y1=calcMatrix.getY(0,sizeB);x2=calcMatrix.getX(0,sizeB-height);y2=calcMatrix.getY(0,sizeB-height)}pipeline.setTexture2D();pipeline.batchTri(x0,y0,x1,y1,x2,y2,0,0,1,1,tint,tint,tint,2)}};module.exports=IsoTriangleWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var SetTransform=__webpack_require__(28);var IsoTriangleCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)&&src.isFilled){var size=src.width;var height=src.height;var sizeA=size/2;var sizeB=size/src.projection;var reversed=src.isReversed;if(src.showTop&&reversed){FillStyleCanvas(ctx,src,src.fillTop);ctx.beginPath();ctx.moveTo(-sizeA,-height);ctx.lineTo(0,-sizeB-height);ctx.lineTo(sizeA,-height);ctx.lineTo(0,sizeB-height);ctx.fill()}if(src.showLeft){FillStyleCanvas(ctx,src,src.fillLeft);ctx.beginPath();if(reversed){ctx.moveTo(-sizeA,-height);ctx.lineTo(0,sizeB);ctx.lineTo(0,sizeB-height)}else{ctx.moveTo(-sizeA,0);ctx.lineTo(0,sizeB);ctx.lineTo(0,sizeB-height)}ctx.fill()}if(src.showRight){FillStyleCanvas(ctx,src,src.fillRight);ctx.beginPath();if(reversed){ctx.moveTo(sizeA,-height);ctx.lineTo(0,sizeB);ctx.lineTo(0,sizeB-height)}else{ctx.moveTo(sizeA,0);ctx.lineTo(0,sizeB);ctx.lineTo(0,sizeB-height)}ctx.fill()}ctx.restore()}};module.exports=IsoTriangleCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1019)}if(true){renderCanvas=__webpack_require__(1020)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var LineWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isStroked){var strokeTint=pipeline.strokeTint;var color=Utils.getTintAppendFloatAlphaAndSwap(src.strokeColor,src.strokeAlpha*alpha);strokeTint.TL=color;strokeTint.TR=color;strokeTint.BL=color;strokeTint.BR=color;var startWidth=src._startWidth;var endWidth=src._endWidth;pipeline.setTexture2D();pipeline.batchLine(src.geom.x1-dx,src.geom.y1-dy,src.geom.x2-dx,src.geom.y2-dy,startWidth,endWidth,1,0,false,shapeMatrix,camMatrix)}};module.exports=LineWebGLRenderer}),(function(module,exports,__webpack_require__){var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var LineCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX;var dy=src._displayOriginY;if(src.isStroked){LineStyleCanvas(ctx,src);ctx.beginPath();ctx.moveTo(src.geom.x1-dx,src.geom.y1-dy);ctx.lineTo(src.geom.x2-dx,src.geom.y2-dy);ctx.stroke()}ctx.restore()}};module.exports=LineCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1022)}if(true){renderCanvas=__webpack_require__(1023)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var FillPathWebGL=__webpack_require__(98);var StrokePathWebGL=__webpack_require__(70);var PolygonWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isFilled){FillPathWebGL(pipeline,calcMatrix,src,alpha,dx,dy)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=PolygonWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var PolygonCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX;var dy=src._displayOriginY;var path=src.pathData;var pathLength=path.length-1;var px1=path[0]-dx;var py1=path[1]-dy;ctx.beginPath();ctx.moveTo(px1,py1);if(!src.closePath){pathLength-=2}for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx;var py2=path[i+1]-dy;ctx.lineTo(px2,py2)}ctx.closePath();if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fill()}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.stroke()}ctx.restore()}};module.exports=PolygonCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1025)}if(true){renderCanvas=__webpack_require__(1026)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var StrokePathWebGL=__webpack_require__(70);var Utils=__webpack_require__(9);var RectangleWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isFilled){var fillTint=pipeline.fillTint;var fillTintColor=Utils.getTintAppendFloatAlphaAndSwap(src.fillColor,src.fillAlpha*alpha);fillTint.TL=fillTintColor;fillTint.TR=fillTintColor;fillTint.BL=fillTintColor;fillTint.BR=fillTintColor;pipeline.setTexture2D();pipeline.batchFillRect(-dx,-dy,src.width,src.height)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=RectangleWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var RectangleCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX;var dy=src._displayOriginY;if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fillRect(-dx,-dy,src.width,src.height)}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.beginPath();ctx.rect(-dx,-dy,src.width,src.height);ctx.stroke()}ctx.restore()}};module.exports=RectangleCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1028)}if(true){renderCanvas=__webpack_require__(1029)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var FillPathWebGL=__webpack_require__(98);var StrokePathWebGL=__webpack_require__(70);var StarWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isFilled){FillPathWebGL(pipeline,calcMatrix,src,alpha,dx,dy)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=StarWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var StarCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX;var dy=src._displayOriginY;var path=src.pathData;var pathLength=path.length-1;var px1=path[0]-dx;var py1=path[1]-dy;ctx.beginPath();ctx.moveTo(px1,py1);if(!src.closePath){pathLength-=2}for(var i=2;i<pathLength;i+=2){var px2=path[i]-dx;var py2=path[i+1]-dy;ctx.lineTo(px2,py2)}ctx.closePath();if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fill()}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.stroke()}ctx.restore()}};module.exports=StarCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1031)}if(true){renderCanvas=__webpack_require__(1032)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var StrokePathWebGL=__webpack_require__(70);var Utils=__webpack_require__(9);var TriangleWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;var camMatrix=pipeline._tempMatrix1;var shapeMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;renderer.setPipeline(pipeline);shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);var dx=src._displayOriginX;var dy=src._displayOriginY;var alpha=camera.alpha*src.alpha;if(src.isFilled){var fillTint=pipeline.fillTint;var fillTintColor=Utils.getTintAppendFloatAlphaAndSwap(src.fillColor,src.fillAlpha*alpha);fillTint.TL=fillTintColor;fillTint.TR=fillTintColor;fillTint.BL=fillTintColor;fillTint.BR=fillTintColor;var x1=src.geom.x1-dx;var y1=src.geom.y1-dy;var x2=src.geom.x2-dx;var y2=src.geom.y2-dy;var x3=src.geom.x3-dx;var y3=src.geom.y3-dy;pipeline.setTexture2D();pipeline.batchFillTriangle(x1,y1,x2,y2,x3,y3,shapeMatrix,camMatrix)}if(src.isStroked){StrokePathWebGL(pipeline,src,alpha,dx,dy)}};module.exports=TriangleWebGLRenderer}),(function(module,exports,__webpack_require__){var FillStyleCanvas=__webpack_require__(41);var LineStyleCanvas=__webpack_require__(49);var SetTransform=__webpack_require__(28);var TriangleCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var ctx=renderer.currentContext;if(SetTransform(renderer,ctx,src,camera,parentMatrix)){var dx=src._displayOriginX;var dy=src._displayOriginY;var x1=src.geom.x1-dx;var y1=src.geom.y1-dy;var x2=src.geom.x2-dx;var y2=src.geom.y2-dy;var x3=src.geom.x3-dx;var y3=src.geom.y3-dy;ctx.beginPath();ctx.moveTo(x1,y1);ctx.lineTo(x2,y2);ctx.lineTo(x3,y3);ctx.closePath();if(src.isFilled){FillStyleCanvas(ctx,src);ctx.fill()}if(src.isStroked){LineStyleCanvas(ctx,src);ctx.stroke()}ctx.restore()}};module.exports=TriangleCanvasRenderer}),(function(module,exports,__webpack_require__){var Blitter=__webpack_require__(188);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('blitter',function(x,y,key,frame){return this.displayList.add(new Blitter(this.scene,x,y,key,frame))})}),(function(module,exports,__webpack_require__){var Container=__webpack_require__(189);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('container',function(x,y,children){return this.displayList.add(new Container(this.scene,x,y,children))})}),(function(module,exports,__webpack_require__){var DOMElement=__webpack_require__(395);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('dom',function(x,y,element,style,innerText){var gameObject=new DOMElement(this.scene,x,y,element,style,innerText);this.displayList.add(gameObject);this.updateList.add(gameObject);return gameObject})}),(function(module,exports,__webpack_require__){var DynamicBitmapText=__webpack_require__(190);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('dynamicBitmapText',function(x,y,font,text,size){return this.displayList.add(new DynamicBitmapText(this.scene,x,y,font,text,size))})}),(function(module,exports,__webpack_require__){var Extern=__webpack_require__(397);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('extern',function(){var extern=new Extern(this.scene);this.displayList.add(extern);this.updateList.add(extern);return extern})}),(function(module,exports,__webpack_require__){var Graphics=__webpack_require__(191);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('graphics',function(config){return this.displayList.add(new Graphics(this.scene,config))})}),(function(module,exports,__webpack_require__){var Group=__webpack_require__(97);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('group',function(children,config){return this.updateList.add(new Group(this.scene,children,config))})}),(function(module,exports,__webpack_require__){var Image=__webpack_require__(107);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('image',function(x,y,key,frame){return this.displayList.add(new Image(this.scene,x,y,key,frame))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var ParticleEmitterManager=__webpack_require__(194);GameObjectFactory.register('particles',function(key,frame,emitters){var manager=new ParticleEmitterManager(this.scene,key,frame,emitters);this.displayList.add(manager);this.updateList.add(manager);return manager})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var PathFollower=__webpack_require__(409);GameObjectFactory.register('follower',function(path,x,y,key,frame){var sprite=new PathFollower(this.scene,path,x,y,key,frame);this.displayList.add(sprite);this.updateList.add(sprite);return sprite})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var RenderTexture=__webpack_require__(195);GameObjectFactory.register('renderTexture',function(x,y,width,height,key,frame){return this.displayList.add(new RenderTexture(this.scene,x,y,width,height,key,frame))})}),(function(module,exports,__webpack_require__){var Rope=__webpack_require__(197);var GameObjectFactory=__webpack_require__(5);if(true){GameObjectFactory.register('rope',function(x,y,texture,frame,points,horizontal,colors,alphas){var rope=new Rope(this.scene,x,y,texture,frame,points,horizontal,colors,alphas);this.displayList.add(rope);return this.updateList.add(rope)})}}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Sprite=__webpack_require__(75);GameObjectFactory.register('sprite',function(x,y,key,frame){var sprite=new Sprite(this.scene,x,y,key,frame);this.displayList.add(sprite);this.updateList.add(sprite);return sprite})}),(function(module,exports,__webpack_require__){var BitmapText=__webpack_require__(132);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('bitmapText',function(x,y,font,text,size,align){return this.displayList.add(new BitmapText(this.scene,x,y,font,text,size,align))})}),(function(module,exports,__webpack_require__){var Text=__webpack_require__(198);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('text',function(x,y,text,style){return this.displayList.add(new Text(this.scene,x,y,text,style))})}),(function(module,exports,__webpack_require__){var TileSprite=__webpack_require__(199);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('tileSprite',function(x,y,width,height,key,frame){return this.displayList.add(new TileSprite(this.scene,x,y,width,height,key,frame))})}),(function(module,exports,__webpack_require__){var Zone=__webpack_require__(110);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('zone',function(x,y,width,height){return this.displayList.add(new Zone(this.scene,x,y,width,height))})}),(function(module,exports,__webpack_require__){var Video=__webpack_require__(200);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('video',function(x,y,key){var video=new Video(this.scene,x,y,key);this.displayList.add(video);this.updateList.add(video);return video})}),(function(module,exports,__webpack_require__){var Arc=__webpack_require__(410);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('arc',function(x,y,radius,startAngle,endAngle,anticlockwise,fillColor,fillAlpha){return this.displayList.add(new Arc(this.scene,x,y,radius,startAngle,endAngle,anticlockwise,fillColor,fillAlpha))});GameObjectFactory.register('circle',function(x,y,radius,fillColor,fillAlpha){return this.displayList.add(new Arc(this.scene,x,y,radius,0,360,false,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Curve=__webpack_require__(411);GameObjectFactory.register('curve',function(x,y,curve,fillColor,fillAlpha){return this.displayList.add(new Curve(this.scene,x,y,curve,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var Ellipse=__webpack_require__(412);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('ellipse',function(x,y,width,height,fillColor,fillAlpha){return this.displayList.add(new Ellipse(this.scene,x,y,width,height,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Grid=__webpack_require__(413);GameObjectFactory.register('grid',function(x,y,width,height,cellWidth,cellHeight,fillColor,fillAlpha,outlineFillColor,outlineFillAlpha){return this.displayList.add(new Grid(this.scene,x,y,width,height,cellWidth,cellHeight,fillColor,fillAlpha,outlineFillColor,outlineFillAlpha))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var IsoBox=__webpack_require__(414);GameObjectFactory.register('isobox',function(x,y,size,height,fillTop,fillLeft,fillRight){return this.displayList.add(new IsoBox(this.scene,x,y,size,height,fillTop,fillLeft,fillRight))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var IsoTriangle=__webpack_require__(415);GameObjectFactory.register('isotriangle',function(x,y,size,height,reversed,fillTop,fillLeft,fillRight){return this.displayList.add(new IsoTriangle(this.scene,x,y,size,height,reversed,fillTop,fillLeft,fillRight))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Line=__webpack_require__(416);GameObjectFactory.register('line',function(x,y,x1,y1,x2,y2,strokeColor,strokeAlpha){return this.displayList.add(new Line(this.scene,x,y,x1,y1,x2,y2,strokeColor,strokeAlpha))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Polygon=__webpack_require__(417);GameObjectFactory.register('polygon',function(x,y,points,fillColor,fillAlpha){return this.displayList.add(new Polygon(this.scene,x,y,points,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Rectangle=__webpack_require__(422);GameObjectFactory.register('rectangle',function(x,y,width,height,fillColor,fillAlpha){return this.displayList.add(new Rectangle(this.scene,x,y,width,height,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var Star=__webpack_require__(423);var GameObjectFactory=__webpack_require__(5);GameObjectFactory.register('star',function(x,y,points,innerRadius,outerRadius,fillColor,fillAlpha){return this.displayList.add(new Star(this.scene,x,y,points,innerRadius,outerRadius,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var Triangle=__webpack_require__(424);GameObjectFactory.register('triangle',function(x,y,x1,y1,x2,y2,x3,y3,fillColor,fillAlpha){return this.displayList.add(new Triangle(this.scene,x,y,x1,y1,x2,y2,x3,y3,fillColor,fillAlpha))})}),(function(module,exports,__webpack_require__){var Blitter=__webpack_require__(188);var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);GameObjectCreator.register('blitter',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var blitter=new Blitter(this.scene,0,0,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,blitter,config);return blitter})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var Container=__webpack_require__(189);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);GameObjectCreator.register('container',function(config,addToScene){if(config===undefined){config={}}var x=GetAdvancedValue(config,'x',0);var y=GetAdvancedValue(config,'y',0);var container=new Container(this.scene,x,y);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,container,config);return container})}),(function(module,exports,__webpack_require__){var BitmapText=__webpack_require__(190);var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);GameObjectCreator.register('dynamicBitmapText',function(config,addToScene){if(config===undefined){config={}}var font=GetAdvancedValue(config,'font','');var text=GetAdvancedValue(config,'text','');var size=GetAdvancedValue(config,'size',false);var bitmapText=new BitmapText(this.scene,0,0,font,text,size);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,bitmapText,config);return bitmapText})}),(function(module,exports,__webpack_require__){var GameObjectCreator=__webpack_require__(16);var Graphics=__webpack_require__(191);GameObjectCreator.register('graphics',function(config,addToScene){if(config===undefined){config={}}if(addToScene!==undefined){config.add=addToScene}var graphics=new Graphics(this.scene,config);if(config.add){this.scene.sys.displayList.add(graphics)}return graphics})}),(function(module,exports,__webpack_require__){var GameObjectCreator=__webpack_require__(16);var Group=__webpack_require__(97);GameObjectCreator.register('group',function(config){return new Group(this.scene,null,config)})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Image=__webpack_require__(107);GameObjectCreator.register('image',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var image=new Image(this.scene,0,0,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,image,config);return image})}),(function(module,exports,__webpack_require__){var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var GetFastValue=__webpack_require__(2);var ParticleEmitterManager=__webpack_require__(194);GameObjectCreator.register('particles',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var emitters=GetFastValue(config,'emitters',null);var manager=new ParticleEmitterManager(this.scene,key,frame,emitters);if(addToScene!==undefined){config.add=addToScene}var add=GetFastValue(config,'add',false);if(add){this.displayList.add(manager)}this.updateList.add(manager);return manager})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var RenderTexture=__webpack_require__(195);GameObjectCreator.register('renderTexture',function(config,addToScene){if(config===undefined){config={}}var x=GetAdvancedValue(config,'x',0);var y=GetAdvancedValue(config,'y',0);var width=GetAdvancedValue(config,'width',32);var height=GetAdvancedValue(config,'height',32);var key=GetAdvancedValue(config,'key',undefined);var frame=GetAdvancedValue(config,'frame',undefined);var renderTexture=new RenderTexture(this.scene,x,y,width,height,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,renderTexture,config);return renderTexture})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var GetValue=__webpack_require__(6);var Rope=__webpack_require__(197);GameObjectCreator.register('rope',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var horizontal=GetAdvancedValue(config,'horizontal',true);var points=GetValue(config,'points',undefined);var colors=GetValue(config,'colors',undefined);var alphas=GetValue(config,'alphas',undefined);var rope=new Rope(this.scene,0,0,key,frame,points,horizontal,colors,alphas);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,rope,config);return rope})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var BuildGameObjectAnimation=__webpack_require__(393);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Sprite=__webpack_require__(75);GameObjectCreator.register('sprite',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var sprite=new Sprite(this.scene,0,0,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,sprite,config);BuildGameObjectAnimation(sprite,config);return sprite})}),(function(module,exports,__webpack_require__){var BitmapText=__webpack_require__(132);var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var GetValue=__webpack_require__(6);GameObjectCreator.register('bitmapText',function(config,addToScene){if(config===undefined){config={}}var font=GetValue(config,'font','');var text=GetAdvancedValue(config,'text','');var size=GetAdvancedValue(config,'size',false);var align=GetValue(config,'align',0);var bitmapText=new BitmapText(this.scene,0,0,font,text,size,align);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,bitmapText,config);return bitmapText})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Text=__webpack_require__(198);GameObjectCreator.register('text',function(config,addToScene){if(config===undefined){config={}}var content=GetAdvancedValue(config,'text','');var style=GetAdvancedValue(config,'style',null);var padding=GetAdvancedValue(config,'padding',null);if(padding!==null){style.padding=padding}var text=new Text(this.scene,0,0,content,style);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,text,config);text.autoRound=GetAdvancedValue(config,'autoRound',true);text.resolution=GetAdvancedValue(config,'resolution',1);return text})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var TileSprite=__webpack_require__(199);GameObjectCreator.register('tileSprite',function(config,addToScene){if(config===undefined){config={}}var x=GetAdvancedValue(config,'x',0);var y=GetAdvancedValue(config,'y',0);var width=GetAdvancedValue(config,'width',512);var height=GetAdvancedValue(config,'height',512);var key=GetAdvancedValue(config,'key','');var frame=GetAdvancedValue(config,'frame','');var tile=new TileSprite(this.scene,x,y,width,height,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,tile,config);return tile})}),(function(module,exports,__webpack_require__){var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Zone=__webpack_require__(110);GameObjectCreator.register('zone',function(config){var x=GetAdvancedValue(config,'x',0);var y=GetAdvancedValue(config,'y',0);var width=GetAdvancedValue(config,'width',1);var height=GetAdvancedValue(config,'height',width);return new Zone(this.scene,x,y,width,height)})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Video=__webpack_require__(200);GameObjectCreator.register('video',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var video=new Video(this.scene,0,0,key);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,video,config);return video})}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1078)}if(true){renderCanvas=__webpack_require__(1079)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var MeshWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){var pipeline=this.pipeline;renderer.setPipeline(pipeline,src);var camMatrix=pipeline._tempMatrix1;var spriteMatrix=pipeline._tempMatrix2;var calcMatrix=pipeline._tempMatrix3;spriteMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);spriteMatrix.e=src.x;spriteMatrix.f=src.y;camMatrix.multiply(spriteMatrix,calcMatrix)}else{spriteMatrix.e-=camera.scrollX*src.scrollFactorX;spriteMatrix.f-=camera.scrollY*src.scrollFactorY;camMatrix.multiply(spriteMatrix,calcMatrix)}var frame=src.frame;var texture=frame.glTexture;var vertices=src.vertices;var uvs=src.uv;var colors=src.colors;var alphas=src.alphas;var meshVerticesLength=vertices.length;var vertexCount=Math.floor(meshVerticesLength*0.5);if(pipeline.vertexCount+vertexCount>pipeline.vertexCapacity){pipeline.flush()}pipeline.setTexture2D(texture,0);var vertexViewF32=pipeline.vertexViewF32;var vertexViewU32=pipeline.vertexViewU32;var vertexOffset=(pipeline.vertexCount*pipeline.vertexComponentCount)-1;var colorIndex=0;var tintEffect=src.tintFill;for(var i=0;i<meshVerticesLength;i+=2){var x=vertices[i+0];var y=vertices[i+1];var tx=x*calcMatrix.a+y*calcMatrix.c+calcMatrix.e;var ty=x*calcMatrix.b+y*calcMatrix.d+calcMatrix.f;if(camera.roundPixels){tx=Math.round(tx);ty=Math.round(ty)}vertexViewF32[++vertexOffset]=tx;vertexViewF32[++vertexOffset]=ty;vertexViewF32[++vertexOffset]=uvs[i+0];vertexViewF32[++vertexOffset]=uvs[i+1];vertexViewF32[++vertexOffset]=tintEffect;vertexViewU32[++vertexOffset]=Utils.getTintAppendFloatAlpha(colors[colorIndex],camera.alpha*alphas[colorIndex]);colorIndex++}pipeline.vertexCount+=vertexCount};module.exports=MeshWebGLRenderer}),(function(module,exports){var MeshCanvasRenderer=function(){};module.exports=MeshCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1081)}if(true){renderCanvas=__webpack_require__(1082)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var ShaderWebGLRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){if(!src.shader){return}var pipeline=renderer.currentPipeline;renderer.clearPipeline();if(src.renderToTexture){src.load();src.flush()}else{var camMatrix=src._tempMatrix1;var shapeMatrix=src._tempMatrix2;var calcMatrix=src._tempMatrix3;shapeMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);shapeMatrix.e=src.x;shapeMatrix.f=src.y}else{shapeMatrix.e-=camera.scrollX*src.scrollFactorX;shapeMatrix.f-=camera.scrollY*src.scrollFactorY}camMatrix.multiply(shapeMatrix,calcMatrix);if(renderer.width!==src._rendererWidth||renderer.height!==src._rendererHeight){src.projOrtho(0,renderer.width,renderer.height,0)}src.load(calcMatrix.matrix);src.flush()}renderer.rebindPipeline(pipeline)};module.exports=ShaderWebGLRenderer}),(function(module,exports){var ShaderCanvasRenderer=function(){};module.exports=ShaderCanvasRenderer}),(function(module,exports,__webpack_require__){var Mesh=__webpack_require__(134);var GameObjectFactory=__webpack_require__(5);if(true){GameObjectFactory.register('mesh',function(x,y,vertices,uv,colors,alphas,texture,frame){return this.displayList.add(new Mesh(this.scene,x,y,vertices,uv,colors,alphas,texture,frame))})}}),(function(module,exports,__webpack_require__){var Quad=__webpack_require__(203);var GameObjectFactory=__webpack_require__(5);if(true){GameObjectFactory.register('quad',function(x,y,key,frame){return this.displayList.add(new Quad(this.scene,x,y,key,frame))})}}),(function(module,exports,__webpack_require__){var Shader=__webpack_require__(204);var GameObjectFactory=__webpack_require__(5);if(true){GameObjectFactory.register('shader',function(key,x,y,width,height,textures,textureData){return this.displayList.add(new Shader(this.scene,key,x,y,width,height,textures,textureData))})}}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var GetValue=__webpack_require__(6);var Mesh=__webpack_require__(134);GameObjectCreator.register('mesh',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var vertices=GetValue(config,'vertices',[]);var colors=GetValue(config,'colors',[]);var alphas=GetValue(config,'alphas',[]);var uv=GetValue(config,'uv',[]);var mesh=new Mesh(this.scene,0,0,vertices,uv,colors,alphas,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,mesh,config);return mesh})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Quad=__webpack_require__(203);GameObjectCreator.register('quad',function(config,addToScene){if(config===undefined){config={}}var x=GetAdvancedValue(config,'x',0);var y=GetAdvancedValue(config,'y',0);var key=GetAdvancedValue(config,'key',null);var frame=GetAdvancedValue(config,'frame',null);var quad=new Quad(this.scene,x,y,key,frame);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,quad,config);return quad})}),(function(module,exports,__webpack_require__){var BuildGameObject=__webpack_require__(27);var GameObjectCreator=__webpack_require__(16);var GetAdvancedValue=__webpack_require__(15);var Shader=__webpack_require__(204);GameObjectCreator.register('shader',function(config,addToScene){if(config===undefined){config={}}var key=GetAdvancedValue(config,'key',null);var x=GetAdvancedValue(config,'x',0);var y=GetAdvancedValue(config,'y',0);var width=GetAdvancedValue(config,'width',128);var height=GetAdvancedValue(config,'height',128);var shader=new Shader(this.scene,key,x,y,width,height);if(addToScene!==undefined){config.add=addToScene}BuildGameObject(this.scene,shader,config);return shader})}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var LightsManager=__webpack_require__(429);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var LightsPlugin=new Class({Extends:LightsManager,initialize:function LightsPlugin(scene){this.scene=scene;this.systems=scene.sys;if(!scene.sys.settings.isBooted){scene.sys.events.once(SceneEvents.BOOT,this.boot,this)}LightsManager.call(this)},boot:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.SHUTDOWN,this.shutdown,this);eventEmitter.on(SceneEvents.DESTROY,this.destroy,this)},destroy:function(){this.shutdown();this.scene=undefined;this.systems=undefined}});PluginCache.register('LightsPlugin',LightsPlugin,'lights');module.exports=LightsPlugin}),(function(module,exports,__webpack_require__){var Circle=__webpack_require__(65);Circle.Area=__webpack_require__(1091);Circle.Circumference=__webpack_require__(268);Circle.CircumferencePoint=__webpack_require__(149);Circle.Clone=__webpack_require__(1092);Circle.Contains=__webpack_require__(55);Circle.ContainsPoint=__webpack_require__(1093);Circle.ContainsRect=__webpack_require__(1094);Circle.CopyFrom=__webpack_require__(1095);Circle.Equals=__webpack_require__(1096);Circle.GetBounds=__webpack_require__(1097);Circle.GetPoint=__webpack_require__(266);Circle.GetPoints=__webpack_require__(267);Circle.Offset=__webpack_require__(1098);Circle.OffsetPoint=__webpack_require__(1099);Circle.Random=__webpack_require__(150);module.exports=Circle}),(function(module,exports){var Area=function(circle){return(circle.radius>0)?Math.PI*circle.radius*circle.radius:0};module.exports=Area}),(function(module,exports,__webpack_require__){var Circle=__webpack_require__(65);var Clone=function(source){return new Circle(source.x,source.y,source.radius)};module.exports=Clone}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(55);var ContainsPoint=function(circle,point){return Contains(circle,point.x,point.y)};module.exports=ContainsPoint}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(55);var ContainsRect=function(circle,rect){return(Contains(circle,rect.x,rect.y)&&Contains(circle,rect.right,rect.y)&&Contains(circle,rect.x,rect.bottom)&&Contains(circle,rect.right,rect.bottom))};module.exports=ContainsRect}),(function(module,exports){var CopyFrom=function(source,dest){return dest.setTo(source.x,source.y,source.radius)};module.exports=CopyFrom}),(function(module,exports){var Equals=function(circle,toCompare){return(circle.x===toCompare.x&&circle.y===toCompare.y&&circle.radius===toCompare.radius)};module.exports=Equals}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var GetBounds=function(circle,out){if(out===undefined){out=new Rectangle()}out.x=circle.left;out.y=circle.top;out.width=circle.diameter;out.height=circle.diameter;return out};module.exports=GetBounds}),(function(module,exports){var Offset=function(circle,x,y){circle.x+=x;circle.y+=y;return circle};module.exports=Offset}),(function(module,exports){var OffsetPoint=function(circle,point){circle.x+=point.x;circle.y+=point.y;return circle};module.exports=OffsetPoint}),(function(module,exports,__webpack_require__){var Ellipse=__webpack_require__(95);Ellipse.Area=__webpack_require__(1101);Ellipse.Circumference=__webpack_require__(400);Ellipse.CircumferencePoint=__webpack_require__(193);Ellipse.Clone=__webpack_require__(1102);Ellipse.Contains=__webpack_require__(96);Ellipse.ContainsPoint=__webpack_require__(1103);Ellipse.ContainsRect=__webpack_require__(1104);Ellipse.CopyFrom=__webpack_require__(1105);Ellipse.Equals=__webpack_require__(1106);Ellipse.GetBounds=__webpack_require__(1107);Ellipse.GetPoint=__webpack_require__(398);Ellipse.GetPoints=__webpack_require__(399);Ellipse.Offset=__webpack_require__(1108);Ellipse.OffsetPoint=__webpack_require__(1109);Ellipse.Random=__webpack_require__(157);module.exports=Ellipse}),(function(module,exports){var Area=function(ellipse){if(ellipse.isEmpty()){return 0}return(ellipse.getMajorRadius()*ellipse.getMinorRadius()*Math.PI)};module.exports=Area}),(function(module,exports,__webpack_require__){var Ellipse=__webpack_require__(95);var Clone=function(source){return new Ellipse(source.x,source.y,source.width,source.height)};module.exports=Clone}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(96);var ContainsPoint=function(ellipse,point){return Contains(ellipse,point.x,point.y)};module.exports=ContainsPoint}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(96);var ContainsRect=function(ellipse,rect){return(Contains(ellipse,rect.x,rect.y)&&Contains(ellipse,rect.right,rect.y)&&Contains(ellipse,rect.x,rect.bottom)&&Contains(ellipse,rect.right,rect.bottom))};module.exports=ContainsRect}),(function(module,exports){var CopyFrom=function(source,dest){return dest.setTo(source.x,source.y,source.width,source.height)};module.exports=CopyFrom}),(function(module,exports){var Equals=function(ellipse,toCompare){return(ellipse.x===toCompare.x&&ellipse.y===toCompare.y&&ellipse.width===toCompare.width&&ellipse.height===toCompare.height)};module.exports=Equals}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var GetBounds=function(ellipse,out){if(out===undefined){out=new Rectangle()}out.x=ellipse.left;out.y=ellipse.top;out.width=ellipse.width;out.height=ellipse.height;return out};module.exports=GetBounds}),(function(module,exports){var Offset=function(ellipse,x,y){ellipse.x+=x;ellipse.y+=y;return ellipse};module.exports=Offset}),(function(module,exports){var OffsetPoint=function(ellipse,point){ellipse.x+=point.x;ellipse.y+=point.y;return ellipse};module.exports=OffsetPoint}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var CircleToCircle=__webpack_require__(205);var GetCircleToCircle=function(circleA,circleB,out){if(out===undefined){out=[]}if(CircleToCircle(circleA,circleB)){var x0=circleA.x;var y0=circleA.y;var r0=circleA.radius;var x1=circleB.x;var y1=circleB.y;var r1=circleB.radius;var coefficientA,coefficientB,coefficientC,lambda,x;if(y0===y1){x=((r1*r1)-(r0*r0)-(x1*x1)+(x0*x0))/(2*(x0-x1));coefficientA=1;coefficientB=-2*y1;coefficientC=(x1*x1)+(x*x)-(2*x1*x)+(y1*y1)-(r1*r1);lambda=(coefficientB*coefficientB)-(4*coefficientA*coefficientC);if(lambda===0){out.push(new Point(x,(-coefficientB/(2*coefficientA))))}else if(lambda>0){out.push(new Point(x,(-coefficientB+Math.sqrt(lambda))/(2*coefficientA)));out.push(new Point(x,(-coefficientB-Math.sqrt(lambda))/(2*coefficientA)))}}else{var v1=(x0-x1)/(y0-y1);var n=(r1*r1-r0*r0-x1*x1+x0*x0-y1*y1+y0*y0)/(2*(y0-y1));coefficientA=(v1*v1)+1;coefficientB=(2*y0*v1)-(2*n*v1)-(2*x0);coefficientC=(x0*x0)+(y0*y0)+(n*n)-(r0*r0)-(2*y0*n);lambda=(coefficientB*coefficientB)-(4*coefficientA*coefficientC);if(lambda===0){x=(-coefficientB/(2*coefficientA));out.push(new Point(x,(n-(x*v1))))}else if(lambda>0){x=(-coefficientB+Math.sqrt(lambda))/(2*coefficientA);out.push(new Point(x,(n-(x*v1))));x=(-coefficientB-Math.sqrt(lambda))/(2*coefficientA);out.push(new Point(x,(n-(x*v1))))}}}return out};module.exports=GetCircleToCircle}),(function(module,exports,__webpack_require__){var GetLineToCircle=__webpack_require__(207);var CircleToRectangle=__webpack_require__(206);var GetCircleToRectangle=function(circle,rect,out){if(out===undefined){out=[]}if(CircleToRectangle(circle,rect)){var lineA=rect.getLineA();var lineB=rect.getLineB();var lineC=rect.getLineC();var lineD=rect.getLineD();GetLineToCircle(lineA,circle,out);GetLineToCircle(lineB,circle,out);GetLineToCircle(lineC,circle,out);GetLineToCircle(lineD,circle,out)}return out};module.exports=GetCircleToRectangle}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var RectangleToRectangle=__webpack_require__(135);var GetRectangleIntersection=function(rectA,rectB,output){if(output===undefined){output=new Rectangle()}if(RectangleToRectangle(rectA,rectB)){output.x=Math.max(rectA.x,rectB.x);output.y=Math.max(rectA.y,rectB.y);output.width=Math.min(rectA.right,rectB.right)-output.x;output.height=Math.min(rectA.bottom,rectB.bottom)-output.y}return output};module.exports=GetRectangleIntersection}),(function(module,exports,__webpack_require__){var GetLineToRectangle=__webpack_require__(209);var RectangleToRectangle=__webpack_require__(135);var GetRectangleToRectangle=function(rectA,rectB,out){if(out===undefined){out=[]}if(RectangleToRectangle(rectA,rectB)){var lineA=rectA.getLineA();var lineB=rectA.getLineB();var lineC=rectA.getLineC();var lineD=rectA.getLineD();GetLineToRectangle(lineA,rectB,out);GetLineToRectangle(lineB,rectB,out);GetLineToRectangle(lineC,rectB,out);GetLineToRectangle(lineD,rectB,out)}return out};module.exports=GetRectangleToRectangle}),(function(module,exports,__webpack_require__){var RectangleToTriangle=__webpack_require__(433);var GetLineToRectangle=__webpack_require__(209);var GetRectangleToTriangle=function(rect,triangle,out){if(out===undefined){out=[]}if(RectangleToTriangle(rect,triangle)){var lineA=triangle.getLineA();var lineB=triangle.getLineB();var lineC=triangle.getLineC();GetLineToRectangle(lineA,rect,out);GetLineToRectangle(lineB,rect,out);GetLineToRectangle(lineC,rect,out)}return out};module.exports=GetRectangleToTriangle}),(function(module,exports,__webpack_require__){var GetLineToCircle=__webpack_require__(207);var TriangleToCircle=__webpack_require__(435);var GetTriangleToCircle=function(triangle,circle,out){if(out===undefined){out=[]}if(TriangleToCircle(triangle,circle)){var lineA=triangle.getLineA();var lineB=triangle.getLineB();var lineC=triangle.getLineC();GetLineToCircle(lineA,circle,out);GetLineToCircle(lineB,circle,out);GetLineToCircle(lineC,circle,out)}return out};module.exports=GetTriangleToCircle}),(function(module,exports,__webpack_require__){var TriangleToTriangle=__webpack_require__(438);var GetTriangleToLine=__webpack_require__(436);var GetTriangleToTriangle=function(triangleA,triangleB,out){if(out===undefined){out=[]}if(TriangleToTriangle(triangleA,triangleB)){var lineA=triangleB.getLineA();var lineB=triangleB.getLineB();var lineC=triangleB.getLineC();GetTriangleToLine(triangleA,lineA,out);GetTriangleToLine(triangleA,lineB,out);GetTriangleToLine(triangleA,lineC,out)}return out};module.exports=GetTriangleToTriangle}),(function(module,exports,__webpack_require__){var PointToLine=__webpack_require__(440);var PointToLineSegment=function(point,line){if(!PointToLine(point,line)){return false}var xMin=Math.min(line.x1,line.x2);var xMax=Math.max(line.x1,line.x2);var yMin=Math.min(line.y1,line.y2);var yMax=Math.max(line.y1,line.y2);return((point.x>=xMin&&point.x<=xMax)&&(point.y>=yMin&&point.y<=yMax))};module.exports=PointToLineSegment}),(function(module,exports){var RectangleToValues=function(rect,left,right,top,bottom,tolerance){if(tolerance===undefined){tolerance=0}return!(left>rect.right+tolerance||right<rect.left-tolerance||top>rect.bottom+tolerance||bottom<rect.top-tolerance)};module.exports=RectangleToValues}),(function(module,exports,__webpack_require__){var Line=__webpack_require__(56);Line.Angle=__webpack_require__(85);Line.BresenhamPoints=__webpack_require__(288);Line.CenterOn=__webpack_require__(1120);Line.Clone=__webpack_require__(1121);Line.CopyFrom=__webpack_require__(1122);Line.Equals=__webpack_require__(1123);Line.Extend=__webpack_require__(1124);Line.GetEasedPoints=__webpack_require__(1125);Line.GetMidPoint=__webpack_require__(1126);Line.GetNearestPoint=__webpack_require__(1127);Line.GetNormal=__webpack_require__(1128);Line.GetPoint=__webpack_require__(275);Line.GetPoints=__webpack_require__(153);Line.GetShortestDistance=__webpack_require__(1129);Line.Height=__webpack_require__(1130);Line.Length=__webpack_require__(57);Line.NormalAngle=__webpack_require__(441);Line.NormalX=__webpack_require__(1131);Line.NormalY=__webpack_require__(1132);Line.Offset=__webpack_require__(1133);Line.PerpSlope=__webpack_require__(1134);Line.Random=__webpack_require__(154);Line.ReflectAngle=__webpack_require__(1135);Line.Rotate=__webpack_require__(1136);Line.RotateAroundPoint=__webpack_require__(1137);Line.RotateAroundXY=__webpack_require__(211);Line.SetToAngle=__webpack_require__(1138);Line.Slope=__webpack_require__(1139);Line.Width=__webpack_require__(1140);module.exports=Line}),(function(module,exports){var CenterOn=function(line,x,y){var tx=x-((line.x1+line.x2)/2);var ty=y-((line.y1+line.y2)/2);line.x1+=tx;line.y1+=ty;line.x2+=tx;line.y2+=ty;return line};module.exports=CenterOn}),(function(module,exports,__webpack_require__){var Line=__webpack_require__(56);var Clone=function(source){return new Line(source.x1,source.y1,source.x2,source.y2)};module.exports=Clone}),(function(module,exports){var CopyFrom=function(source,dest){return dest.setTo(source.x1,source.y1,source.x2,source.y2)};module.exports=CopyFrom}),(function(module,exports){var Equals=function(line,toCompare){return(line.x1===toCompare.x1&&line.y1===toCompare.y1&&line.x2===toCompare.x2&&line.y2===toCompare.y2)};module.exports=Equals}),(function(module,exports,__webpack_require__){var Length=__webpack_require__(57);var Extend=function(line,left,right){if(right===undefined){right=left}var length=Length(line);var slopX=line.x2-line.x1;var slopY=line.y2-line.y1;if(left){line.x1=line.x1-slopX/length*left;line.y1=line.y1-slopY/length*left}if(right){line.x2=line.x2+slopX/length*right;line.y2=line.y2+slopY/length*right}return line};module.exports=Extend}),(function(module,exports,__webpack_require__){var DistanceBetweenPoints=__webpack_require__(320);var GetEaseFunction=__webpack_require__(69);var Point=__webpack_require__(4);var GetEasedPoints=function(line,ease,quantity,collinearThreshold,easeParams){if(collinearThreshold===undefined){collinearThreshold=0}if(easeParams===undefined){easeParams=[]}var results=[];var x1=line.x1;var y1=line.y1;var spaceX=line.x2-x1;var spaceY=line.y2-y1;var easeFunc=GetEaseFunction(ease,easeParams);var i;var v;var q=quantity-1;for(i=0;i<q;i++){v=easeFunc(i/q);results.push(new Point(x1+(spaceX*v),y1+(spaceY*v)))}v=easeFunc(1);results.push(new Point(x1+(spaceX*v),y1+(spaceY*v)));if(collinearThreshold>0){var prevPoint=results[0];var sortedResults=[prevPoint];for(i=1;i<results.length-1;i++){var point=results[i];if(DistanceBetweenPoints(prevPoint,point)>=collinearThreshold){sortedResults.push(point);prevPoint=point}}var endPoint=results[results.length-1];if(DistanceBetweenPoints(prevPoint,endPoint)<collinearThreshold){sortedResults.pop()}sortedResults.push(endPoint);return sortedResults}else{return results}};module.exports=GetEasedPoints}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetMidPoint=function(line,out){if(out===undefined){out=new Point()}out.x=(line.x1+line.x2)/2;out.y=(line.y1+line.y2)/2;return out};module.exports=GetMidPoint}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetNearestPoint=function(line,point,out){if(out===undefined){out=new Point()}var x1=line.x1;var y1=line.y1;var x2=line.x2;var y2=line.y2;var L2=(((x2-x1)*(x2-x1))+((y2-y1)*(y2-y1)));if(L2===0){return out}var r=(((point.x-x1)*(x2-x1))+((point.y-y1)*(y2-y1)))/L2;out.x=x1+(r*(x2-x1));out.y=y1+(r*(y2-y1));return out};module.exports=GetNearestPoint}),(function(module,exports,__webpack_require__){var MATH_CONST=__webpack_require__(13);var Angle=__webpack_require__(85);var Point=__webpack_require__(4);var GetNormal=function(line,out){if(out===undefined){out=new Point()}var a=Angle(line)-MATH_CONST.TAU;out.x=Math.cos(a);out.y=Math.sin(a);return out};module.exports=GetNormal}),(function(module,exports){var GetShortestDistance=function(line,point){var x1=line.x1;var y1=line.y1;var x2=line.x2;var y2=line.y2;var L2=(((x2-x1)*(x2-x1))+((y2-y1)*(y2-y1)));if(L2===0){return false}var s=(((y1-point.y)*(x2-x1))-((x1-point.x)*(y2-y1)))/L2;return Math.abs(s)*Math.sqrt(L2)};module.exports=GetShortestDistance}),(function(module,exports){var Height=function(line){return Math.abs(line.y1-line.y2)};module.exports=Height}),(function(module,exports,__webpack_require__){var MATH_CONST=__webpack_require__(13);var Angle=__webpack_require__(85);var NormalX=function(line){return Math.cos(Angle(line)-MATH_CONST.TAU)};module.exports=NormalX}),(function(module,exports,__webpack_require__){var MATH_CONST=__webpack_require__(13);var Angle=__webpack_require__(85);var NormalY=function(line){return Math.sin(Angle(line)-MATH_CONST.TAU)};module.exports=NormalY}),(function(module,exports){var Offset=function(line,x,y){line.x1+=x;line.y1+=y;line.x2+=x;line.y2+=y;return line};module.exports=Offset}),(function(module,exports){var PerpSlope=function(line){return-((line.x2-line.x1)/(line.y2-line.y1))};module.exports=PerpSlope}),(function(module,exports,__webpack_require__){var Angle=__webpack_require__(85);var NormalAngle=__webpack_require__(441);var ReflectAngle=function(lineA,lineB){return(2*NormalAngle(lineB)-Math.PI-Angle(lineA))};module.exports=ReflectAngle}),(function(module,exports,__webpack_require__){var RotateAroundXY=__webpack_require__(211);var Rotate=function(line,angle){var x=(line.x1+line.x2)/2;var y=(line.y1+line.y2)/2;return RotateAroundXY(line,x,y,angle)};module.exports=Rotate}),(function(module,exports,__webpack_require__){var RotateAroundXY=__webpack_require__(211);var RotateAroundPoint=function(line,point,angle){return RotateAroundXY(line,point.x,point.y,angle)};module.exports=RotateAroundPoint}),(function(module,exports){var SetToAngle=function(line,x,y,angle,length){line.x1=x;line.y1=y;line.x2=x+(Math.cos(angle)*length);line.y2=y+(Math.sin(angle)*length);return line};module.exports=SetToAngle}),(function(module,exports){var Slope=function(line){return(line.y2-line.y1)/(line.x2-line.x1)};module.exports=Slope}),(function(module,exports){var Width=function(line){return Math.abs(line.x1-line.x2)};module.exports=Width}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);Point.Ceil=__webpack_require__(1142);Point.Clone=__webpack_require__(1143);Point.CopyFrom=__webpack_require__(1144);Point.Equals=__webpack_require__(1145);Point.Floor=__webpack_require__(1146);Point.GetCentroid=__webpack_require__(1147);Point.GetMagnitude=__webpack_require__(442);Point.GetMagnitudeSq=__webpack_require__(443);Point.GetRectangleFromPoints=__webpack_require__(1148);Point.Interpolate=__webpack_require__(1149);Point.Invert=__webpack_require__(1150);Point.Negative=__webpack_require__(1151);Point.Project=__webpack_require__(1152);Point.ProjectUnit=__webpack_require__(1153);Point.SetMagnitude=__webpack_require__(1154);module.exports=Point}),(function(module,exports){var Ceil=function(point){return point.setTo(Math.ceil(point.x),Math.ceil(point.y))};module.exports=Ceil}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Clone=function(source){return new Point(source.x,source.y)};module.exports=Clone}),(function(module,exports){var CopyFrom=function(source,dest){return dest.setTo(source.x,source.y)};module.exports=CopyFrom}),(function(module,exports){var Equals=function(point,toCompare){return(point.x===toCompare.x&&point.y===toCompare.y)};module.exports=Equals}),(function(module,exports){var Floor=function(point){return point.setTo(Math.floor(point.x),Math.floor(point.y))};module.exports=Floor}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetCentroid=function(points,out){if(out===undefined){out=new Point()}if(!Array.isArray(points)){throw new Error('GetCentroid points argument must be an array')}var len=points.length;if(len<1){throw new Error('GetCentroid points array must not be empty')}else if(len===1){out.x=points[0].x;out.y=points[0].y}else{for(var i=0;i<len;i++){out.x+=points[i].x;out.y+=points[i].y}out.x/=len;out.y/=len}return out};module.exports=GetCentroid}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var GetRectangleFromPoints=function(points,out){if(out===undefined){out=new Rectangle()}var xMax=Number.NEGATIVE_INFINITY;var xMin=Number.POSITIVE_INFINITY;var yMax=Number.NEGATIVE_INFINITY;var yMin=Number.POSITIVE_INFINITY;for(var i=0;i<points.length;i++){var point=points[i];if(point.x>xMax){xMax=point.x}if(point.x<xMin){xMin=point.x}if(point.y>yMax){yMax=point.y}if(point.y<yMin){yMin=point.y}}out.x=xMin;out.y=yMin;out.width=xMax-xMin;out.height=yMax-yMin;return out};module.exports=GetRectangleFromPoints}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Interpolate=function(pointA,pointB,t,out){if(t===undefined){t=0}if(out===undefined){out=new Point()}out.x=pointA.x+((pointB.x-pointA.x)*t);out.y=pointA.y+((pointB.y-pointA.y)*t);return out};module.exports=Interpolate}),(function(module,exports){var Invert=function(point){return point.setTo(point.y,point.x)};module.exports=Invert}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var Negative=function(point,out){if(out===undefined){out=new Point()}return out.setTo(-point.x,-point.y)};module.exports=Negative}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetMagnitudeSq=__webpack_require__(443);var Project=function(pointA,pointB,out){if(out===undefined){out=new Point()}var dot=((pointA.x*pointB.x)+(pointA.y*pointB.y));var amt=dot/GetMagnitudeSq(pointB);if(amt!==0){out.x=amt*pointB.x;out.y=amt*pointB.y}return out};module.exports=Project}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var ProjectUnit=function(pointA,pointB,out){if(out===undefined){out=new Point()}var amt=((pointA.x*pointB.x)+(pointA.y*pointB.y));if(amt!==0){out.x=amt*pointB.x;out.y=amt*pointB.y}return out};module.exports=ProjectUnit}),(function(module,exports,__webpack_require__){var GetMagnitude=__webpack_require__(442);var SetMagnitude=function(point,magnitude){if(point.x!==0||point.y!==0){var m=GetMagnitude(point);point.x/=m;point.y/=m}point.x*=magnitude;point.y*=magnitude;return point};module.exports=SetMagnitude}),(function(module,exports,__webpack_require__){var Polygon=__webpack_require__(201);Polygon.Clone=__webpack_require__(1156);Polygon.Contains=__webpack_require__(202);Polygon.ContainsPoint=__webpack_require__(1157);Polygon.GetAABB=__webpack_require__(418);Polygon.GetNumberArray=__webpack_require__(1158);Polygon.GetPoints=__webpack_require__(419);Polygon.Perimeter=__webpack_require__(420);Polygon.Reverse=__webpack_require__(1159);Polygon.Smooth=__webpack_require__(421);module.exports=Polygon}),(function(module,exports,__webpack_require__){var Polygon=__webpack_require__(201);var Clone=function(polygon){return new Polygon(polygon.points)};module.exports=Clone}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(202);var ContainsPoint=function(polygon,point){return Contains(polygon,point.x,point.y)};module.exports=ContainsPoint}),(function(module,exports){var GetNumberArray=function(polygon,output){if(output===undefined){output=[]}for(var i=0;i<polygon.points.length;i++){output.push(polygon.points[i].x);output.push(polygon.points[i].y)}return output};module.exports=GetNumberArray}),(function(module,exports){var Reverse=function(polygon){polygon.points.reverse();return polygon};module.exports=Reverse}),(function(module,exports){var Area=function(rect){return rect.width*rect.height};module.exports=Area}),(function(module,exports){var Ceil=function(rect){rect.x=Math.ceil(rect.x);rect.y=Math.ceil(rect.y);return rect};module.exports=Ceil}),(function(module,exports){var CeilAll=function(rect){rect.x=Math.ceil(rect.x);rect.y=Math.ceil(rect.y);rect.width=Math.ceil(rect.width);rect.height=Math.ceil(rect.height);return rect};module.exports=CeilAll}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var Clone=function(source){return new Rectangle(source.x,source.y,source.width,source.height)};module.exports=Clone}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(48);var ContainsPoint=function(rect,point){return Contains(rect,point.x,point.y)};module.exports=ContainsPoint}),(function(module,exports){var CopyFrom=function(source,dest){return dest.setTo(source.x,source.y,source.width,source.height)};module.exports=CopyFrom}),(function(module,exports){var Equals=function(rect,toCompare){return(rect.x===toCompare.x&&rect.y===toCompare.y&&rect.width===toCompare.width&&rect.height===toCompare.height)};module.exports=Equals}),(function(module,exports,__webpack_require__){var GetAspectRatio=__webpack_require__(212);var FitInside=function(target,source){var ratio=GetAspectRatio(target);if(ratio<GetAspectRatio(source)){target.setSize(source.height*ratio,source.height)}else{target.setSize(source.width,source.width/ratio)}return target.setPosition(source.centerX-(target.width/2),source.centerY-(target.height/2))};module.exports=FitInside}),(function(module,exports,__webpack_require__){var GetAspectRatio=__webpack_require__(212);var FitOutside=function(target,source){var ratio=GetAspectRatio(target);if(ratio>GetAspectRatio(source)){target.setSize(source.height*ratio,source.height)}else{target.setSize(source.width,source.width/ratio)}return target.setPosition(source.centerX-target.width/2,source.centerY-target.height/2)};module.exports=FitOutside}),(function(module,exports){var Floor=function(rect){rect.x=Math.floor(rect.x);rect.y=Math.floor(rect.y);return rect};module.exports=Floor}),(function(module,exports){var FloorAll=function(rect){rect.x=Math.floor(rect.x);rect.y=Math.floor(rect.y);rect.width=Math.floor(rect.width);rect.height=Math.floor(rect.height);return rect};module.exports=FloorAll}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var FromXY=function(x1,y1,x2,y2,out){if(out===undefined){out=new Rectangle()}return out.setTo(Math.min(x1,x2),Math.min(y1,y2),Math.abs(x1-x2),Math.abs(y1-y2))};module.exports=FromXY}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetCenter=function(rect,out){if(out===undefined){out=new Point()}out.x=rect.centerX;out.y=rect.centerY;return out};module.exports=GetCenter}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var GetSize=function(rect,out){if(out===undefined){out=new Point()}out.x=rect.width;out.y=rect.height;return out};module.exports=GetSize}),(function(module,exports,__webpack_require__){var CenterOn=__webpack_require__(168);var Inflate=function(rect,x,y){var cx=rect.centerX;var cy=rect.centerY;rect.setSize(rect.width+(x*2),rect.height+(y*2));return CenterOn(rect,cx,cy)};module.exports=Inflate}),(function(module,exports,__webpack_require__){var Rectangle=__webpack_require__(11);var Intersects=__webpack_require__(135);var Intersection=function(rectA,rectB,out){if(out===undefined){out=new Rectangle()}if(Intersects(rectA,rectB)){out.x=Math.max(rectA.x,rectB.x);out.y=Math.max(rectA.y,rectB.y);out.width=Math.min(rectA.right,rectB.right)-out.x;out.height=Math.min(rectA.bottom,rectB.bottom)-out.y}else{out.setEmpty()}return out};module.exports=Intersection}),(function(module,exports){var MergePoints=function(target,points){var minX=target.x;var maxX=target.right;var minY=target.y;var maxY=target.bottom;for(var i=0;i<points.length;i++){minX=Math.min(minX,points[i].x);maxX=Math.max(maxX,points[i].x);minY=Math.min(minY,points[i].y);maxY=Math.max(maxY,points[i].y)}target.x=minX;target.y=minY;target.width=maxX-minX;target.height=maxY-minY;return target};module.exports=MergePoints}),(function(module,exports){var MergeRect=function(target,source){var minX=Math.min(target.x,source.x);var maxX=Math.max(target.right,source.right);target.x=minX;target.width=maxX-minX;var minY=Math.min(target.y,source.y);var maxY=Math.max(target.bottom,source.bottom);target.y=minY;target.height=maxY-minY;return target};module.exports=MergeRect}),(function(module,exports){var MergeXY=function(target,x,y){var minX=Math.min(target.x,x);var maxX=Math.max(target.right,x);target.x=minX;target.width=maxX-minX;var minY=Math.min(target.y,y);var maxY=Math.max(target.bottom,y);target.y=minY;target.height=maxY-minY;return target};module.exports=MergeXY}),(function(module,exports){var Offset=function(rect,x,y){rect.x+=x;rect.y+=y;return rect};module.exports=Offset}),(function(module,exports){var OffsetPoint=function(rect,point){rect.x+=point.x;rect.y+=point.y;return rect};module.exports=OffsetPoint}),(function(module,exports){var Overlaps=function(rectA,rectB){return(rectA.x<rectB.right&&rectA.right>rectB.x&&rectA.y<rectB.bottom&&rectA.bottom>rectB.y)};module.exports=Overlaps}),(function(module,exports,__webpack_require__){var Point=__webpack_require__(4);var DegToRad=__webpack_require__(39);var PerimeterPoint=function(rectangle,angle,out){if(out===undefined){out=new Point()}angle=DegToRad(angle);var s=Math.sin(angle);var c=Math.cos(angle);var dx=(c>0)?rectangle.width/2:rectangle.width/-2;var dy=(s>0)?rectangle.height/2:rectangle.height/-2;if(Math.abs(dx*s)<Math.abs(dy*c)){dy=(dx*s)/c}else{dx=(dy*c)/s}out.x=dx+rectangle.centerX;out.y=dy+rectangle.centerY;return out};module.exports=PerimeterPoint}),(function(module,exports,__webpack_require__){var Between=__webpack_require__(172);var ContainsRect=__webpack_require__(445);var Point=__webpack_require__(4);var RandomOutside=function(outer,inner,out){if(out===undefined){out=new Point()}if(ContainsRect(outer,inner)){switch(Between(0,3)){case 0:out.x=outer.x+(Math.random()*(inner.right-outer.x));out.y=outer.y+(Math.random()*(inner.top-outer.y));break;case 1:out.x=inner.x+(Math.random()*(outer.right-inner.x));out.y=inner.bottom+(Math.random()*(outer.bottom-inner.bottom));break;case 2:out.x=outer.x+(Math.random()*(inner.x-outer.x));out.y=inner.y+(Math.random()*(outer.bottom-inner.y));break;case 3:out.x=inner.right+(Math.random()*(outer.right-inner.right));out.y=outer.y+(Math.random()*(inner.bottom-outer.y));break}}return out};module.exports=RandomOutside}),(function(module,exports){var SameDimensions=function(rect,toCompare){return(rect.width===toCompare.width&&rect.height===toCompare.height)};module.exports=SameDimensions}),(function(module,exports){var Scale=function(rect,x,y){if(y===undefined){y=x}rect.width*=x;rect.height*=y;return rect};module.exports=Scale}),(function(module,exports,__webpack_require__){var Triangle=__webpack_require__(71);Triangle.Area=__webpack_require__(1187);Triangle.BuildEquilateral=__webpack_require__(1188);Triangle.BuildFromPolygon=__webpack_require__(1189);Triangle.BuildRight=__webpack_require__(1190);Triangle.CenterOn=__webpack_require__(1191);Triangle.Centroid=__webpack_require__(446);Triangle.CircumCenter=__webpack_require__(1192);Triangle.CircumCircle=__webpack_require__(1193);Triangle.Clone=__webpack_require__(1194);Triangle.Contains=__webpack_require__(83);Triangle.ContainsArray=__webpack_require__(210);Triangle.ContainsPoint=__webpack_require__(1195);Triangle.CopyFrom=__webpack_require__(1196);Triangle.Decompose=__webpack_require__(439);Triangle.Equals=__webpack_require__(1197);Triangle.GetPoint=__webpack_require__(425);Triangle.GetPoints=__webpack_require__(426);Triangle.InCenter=__webpack_require__(448);Triangle.Perimeter=__webpack_require__(1198);Triangle.Offset=__webpack_require__(447);Triangle.Random=__webpack_require__(158);Triangle.Rotate=__webpack_require__(1199);Triangle.RotateAroundPoint=__webpack_require__(1200);Triangle.RotateAroundXY=__webpack_require__(213);module.exports=Triangle}),(function(module,exports){var Area=function(triangle){var x1=triangle.x1;var y1=triangle.y1;var x2=triangle.x2;var y2=triangle.y2;var x3=triangle.x3;var y3=triangle.y3;return Math.abs(((x3-x1)*(y2-y1)-(x2-x1)*(y3-y1))/2)};module.exports=Area}),(function(module,exports,__webpack_require__){var Triangle=__webpack_require__(71);var BuildEquilateral=function(x,y,length){var height=length*(Math.sqrt(3)/2);var x1=x;var y1=y;var x2=x+(length/2);var y2=y+height;var x3=x-(length/2);var y3=y+height;return new Triangle(x1,y1,x2,y2,x3,y3)};module.exports=BuildEquilateral}),(function(module,exports,__webpack_require__){var EarCut=__webpack_require__(66);var Triangle=__webpack_require__(71);var BuildFromPolygon=function(data,holes,scaleX,scaleY,out){if(holes===undefined){holes=null}if(scaleX===undefined){scaleX=1}if(scaleY===undefined){scaleY=1}if(out===undefined){out=[]}var tris=EarCut(data,holes);var a;var b;var c;var x1;var y1;var x2;var y2;var x3;var y3;for(var i=0;i<tris.length;i+=3){a=tris[i];b=tris[i+1];c=tris[i+2];x1=data[a*2]*scaleX;y1=data[(a*2)+1]*scaleY;x2=data[b*2]*scaleX;y2=data[(b*2)+1]*scaleY;x3=data[c*2]*scaleX;y3=data[(c*2)+1]*scaleY;out.push(new Triangle(x1,y1,x2,y2,x3,y3))}return out};module.exports=BuildFromPolygon}),(function(module,exports,__webpack_require__){var Triangle=__webpack_require__(71);var BuildRight=function(x,y,width,height){if(height===undefined){height=width}var x1=x;var y1=y;var x2=x;var y2=y-height;var x3=x+width;var y3=y;return new Triangle(x1,y1,x2,y2,x3,y3)};module.exports=BuildRight}),(function(module,exports,__webpack_require__){var Centroid=__webpack_require__(446);var Offset=__webpack_require__(447);var CenterOn=function(triangle,x,y,centerFunc){if(centerFunc===undefined){centerFunc=Centroid}var center=centerFunc(triangle);var diffX=x-center.x;var diffY=y-center.y;return Offset(triangle,diffX,diffY)};module.exports=CenterOn}),(function(module,exports,__webpack_require__){var Vector2=__webpack_require__(3);function det(m00,m01,m10,m11){return(m00*m11)-(m01*m10)}var CircumCenter=function(triangle,out){if(out===undefined){out=new Vector2()}var cx=triangle.x3;var cy=triangle.y3;var ax=triangle.x1-cx;var ay=triangle.y1-cy;var bx=triangle.x2-cx;var by=triangle.y2-cy;var denom=2*det(ax,ay,bx,by);var numx=det(ay,ax*ax+ay*ay,by,bx*bx+by*by);var numy=det(ax,ax*ax+ay*ay,bx,bx*bx+by*by);out.x=cx-numx/denom;out.y=cy+numy/denom;return out};module.exports=CircumCenter}),(function(module,exports,__webpack_require__){var Circle=__webpack_require__(65);var CircumCircle=function(triangle,out){if(out===undefined){out=new Circle()}var x1=triangle.x1;var y1=triangle.y1;var x2=triangle.x2;var y2=triangle.y2;var x3=triangle.x3;var y3=triangle.y3;var A=x2-x1;var B=y2-y1;var C=x3-x1;var D=y3-y1;var E=A*(x1+x2)+B*(y1+y2);var F=C*(x1+x3)+D*(y1+y3);var G=2*(A*(y3-y2)-B*(x3-x2));var dx;var dy;if(Math.abs(G)<0.000001){var minX=Math.min(x1,x2,x3);var minY=Math.min(y1,y2,y3);dx=(Math.max(x1,x2,x3)-minX)*0.5;dy=(Math.max(y1,y2,y3)-minY)*0.5;out.x=minX+dx;out.y=minY+dy;out.radius=Math.sqrt(dx*dx+dy*dy)}else{out.x=(D*E-B*F)/G;out.y=(A*F-C*E)/G;dx=out.x-x1;dy=out.y-y1;out.radius=Math.sqrt(dx*dx+dy*dy)}return out};module.exports=CircumCircle}),(function(module,exports,__webpack_require__){var Triangle=__webpack_require__(71);var Clone=function(source){return new Triangle(source.x1,source.y1,source.x2,source.y2,source.x3,source.y3)};module.exports=Clone}),(function(module,exports,__webpack_require__){var Contains=__webpack_require__(83);var ContainsPoint=function(triangle,point){return Contains(triangle,point.x,point.y)};module.exports=ContainsPoint}),(function(module,exports){var CopyFrom=function(source,dest){return dest.setTo(source.x1,source.y1,source.x2,source.y2,source.x3,source.y3)};module.exports=CopyFrom}),(function(module,exports){var Equals=function(triangle,toCompare){return(triangle.x1===toCompare.x1&&triangle.y1===toCompare.y1&&triangle.x2===toCompare.x2&&triangle.y2===toCompare.y2&&triangle.x3===toCompare.x3&&triangle.y3===toCompare.y3)};module.exports=Equals}),(function(module,exports,__webpack_require__){var Length=__webpack_require__(57);var Perimeter=function(triangle){var line1=triangle.getLineA();var line2=triangle.getLineB();var line3=triangle.getLineC();return(Length(line1)+Length(line2)+Length(line3))};module.exports=Perimeter}),(function(module,exports,__webpack_require__){var RotateAroundXY=__webpack_require__(213);var InCenter=__webpack_require__(448);var Rotate=function(triangle,angle){var point=InCenter(triangle);return RotateAroundXY(triangle,point.x,point.y,angle)};module.exports=Rotate}),(function(module,exports,__webpack_require__){var RotateAroundXY=__webpack_require__(213);var RotateAroundPoint=function(triangle,point,angle){return RotateAroundXY(triangle,point.x,point.y,angle)};module.exports=RotateAroundPoint}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(179);var Extend=__webpack_require__(18);var Input={CreateInteractiveObject:__webpack_require__(449),Events:__webpack_require__(54),Gamepad:__webpack_require__(1202),InputManager:__webpack_require__(365),InputPlugin:__webpack_require__(1214),InputPluginCache:__webpack_require__(136),Keyboard:__webpack_require__(1216),Mouse:__webpack_require__(1233),Pointer:__webpack_require__(368),Touch:__webpack_require__(1234)};Input=Extend(false,Input,CONST);module.exports=Input}),(function(module,exports,__webpack_require__){module.exports={Axis:__webpack_require__(450),Button:__webpack_require__(451),Events:__webpack_require__(214),Gamepad:__webpack_require__(452),GamepadPlugin:__webpack_require__(1209),Configs:__webpack_require__(1210)}}),(function(module,exports){module.exports='down'}),(function(module,exports){module.exports='up'}),(function(module,exports){module.exports='connected'}),(function(module,exports){module.exports='disconnected'}),(function(module,exports){module.exports='down'}),(function(module,exports){module.exports='up'}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(214);var Gamepad=__webpack_require__(452);var GetValue=__webpack_require__(6);var InputPluginCache=__webpack_require__(136);var InputEvents=__webpack_require__(54);var GamepadPlugin=new Class({Extends:EventEmitter,initialize:function GamepadPlugin(sceneInputPlugin){EventEmitter.call(this);this.scene=sceneInputPlugin.scene;this.settings=this.scene.sys.settings;this.sceneInputPlugin=sceneInputPlugin;this.enabled=true;this.target;this.gamepads=[];this.queue=[];this.onGamepadHandler;this._pad1;this._pad2;this._pad3;this._pad4;sceneInputPlugin.pluginEvents.once(InputEvents.BOOT,this.boot,this);sceneInputPlugin.pluginEvents.on(InputEvents.START,this.start,this)},boot:function(){var game=this.scene.sys.game;var settings=this.settings.input;var config=game.config;this.enabled=GetValue(settings,'gamepad',config.inputGamepad)&&game.device.input.gamepads;this.target=GetValue(settings,'gamepad.target',config.inputGamepadEventTarget);this.sceneInputPlugin.pluginEvents.once(InputEvents.DESTROY,this.destroy,this)},start:function(){if(this.enabled){this.startListeners()}this.sceneInputPlugin.pluginEvents.once(InputEvents.SHUTDOWN,this.shutdown,this)},isActive:function(){return(this.enabled&&this.scene.sys.isActive())},startListeners:function(){var _this=this;var target=this.target;var handler=function(event){if(event.defaultPrevented||!_this.isActive()){return}_this.refreshPads();_this.queue.push(event)};this.onGamepadHandler=handler;target.addEventListener('gamepadconnected',handler,false);target.addEventListener('gamepaddisconnected',handler,false);this.sceneInputPlugin.pluginEvents.on(InputEvents.UPDATE,this.update,this)},stopListeners:function(){this.target.removeEventListener('gamepadconnected',this.onGamepadHandler);this.target.removeEventListener('gamepaddisconnected',this.onGamepadHandler);this.sceneInputPlugin.pluginEvents.off(InputEvents.UPDATE,this.update)},disconnectAll:function(){for(var i=0;i<this.gamepads.length;i++){this.gamepads.connected=false}},refreshPads:function(){var connectedPads=navigator.getGamepads();if(!connectedPads){this.disconnectAll()}else{var currentPads=this.gamepads;for(var i=0;i<connectedPads.length;i++){var livePad=connectedPads[i];if(!livePad){continue}var id=livePad.id;var index=livePad.index;var currentPad=currentPads[index];if(!currentPad){var newPad=new Gamepad(this,livePad);currentPads[index]=newPad;if(!this._pad1){this._pad1=newPad}else if(!this._pad2){this._pad2=newPad}else if(!this._pad3){this._pad3=newPad}else if(!this._pad4){this._pad4=newPad}}else if(currentPad.id!==id){currentPad.destroy();currentPads[index]=new Gamepad(this,livePad)}else{currentPad.update(livePad)}}}},getAll:function(){var out=[];var pads=this.gamepads;for(var i=0;i<pads.length;i++){if(pads[i]){out.push(pads[i])}}return out},getPad:function(index){var pads=this.gamepads;for(var i=0;i<pads.length;i++){if(pads[i]&&pads[i].index===index){return pads[i]}}},update:function(){if(!this.enabled){return}this.refreshPads();var len=this.queue.length;if(len===0){return}var queue=this.queue.splice(0,len);for(var i=0;i<len;i++){var event=queue[i];var pad=this.getPad(event.gamepad.index);if(event.type==='gamepadconnected'){this.emit(Events.CONNECTED,pad,event)}else if(event.type==='gamepaddisconnected'){this.emit(Events.DISCONNECTED,pad,event)}}},shutdown:function(){this.stopListeners();this.disconnectAll();this.removeAllListeners()},destroy:function(){this.shutdown();for(var i=0;i<this.gamepads.length;i++){if(this.gamepads[i]){this.gamepads[i].destroy()}}this.gamepads=[];this.scene=null;this.settings=null;this.sceneInputPlugin=null;this.target=null},total:{get:function(){return this.gamepads.length}},pad1:{get:function(){return this._pad1}},pad2:{get:function(){return this._pad2}},pad3:{get:function(){return this._pad3}},pad4:{get:function(){return this._pad4}}});InputPluginCache.register('GamepadPlugin',GamepadPlugin,'gamepad','gamepad','inputGamepad');module.exports=GamepadPlugin}),(function(module,exports,__webpack_require__){module.exports={DUALSHOCK_4:__webpack_require__(1211),SNES_USB:__webpack_require__(1212),XBOX_360:__webpack_require__(1213)}}),(function(module,exports){module.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SHARE:8,OPTIONS:9,PS:16,TOUCHBAR:17,X:0,CIRCLE:1,SQUARE:2,TRIANGLE:3,L1:4,R1:5,L2:6,R2:7,L3:10,R3:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}}),(function(module,exports){module.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,SELECT:8,START:9,B:0,A:1,Y:2,X:3,LEFT_SHOULDER:4,RIGHT_SHOULDER:5}}),(function(module,exports){module.exports={UP:12,DOWN:13,LEFT:14,RIGHT:15,MENU:16,A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,BACK:8,START:9,LS:10,RS:11,LEFT_STICK_H:0,LEFT_STICK_V:1,RIGHT_STICK_H:2,RIGHT_STICK_V:3}}),(function(module,exports,__webpack_require__){var Circle=__webpack_require__(65);var CircleContains=__webpack_require__(55);var Class=__webpack_require__(0);var CONST=__webpack_require__(179);var CreateInteractiveObject=__webpack_require__(449);var CreatePixelPerfectHandler=__webpack_require__(1215);var DistanceBetween=__webpack_require__(53);var Ellipse=__webpack_require__(95);var EllipseContains=__webpack_require__(96);var Events=__webpack_require__(54);var EventEmitter=__webpack_require__(10);var GetFastValue=__webpack_require__(2);var GEOM_CONST=__webpack_require__(47);var InputPluginCache=__webpack_require__(136);var IsPlainObject=__webpack_require__(7);var PluginCache=__webpack_require__(23);var Rectangle=__webpack_require__(11);var RectangleContains=__webpack_require__(48);var SceneEvents=__webpack_require__(22);var Triangle=__webpack_require__(71);var TriangleContains=__webpack_require__(83);var InputPlugin=new Class({Extends:EventEmitter,initialize:function InputPlugin(scene){EventEmitter.call(this);this.scene=scene;this.systems=scene.sys;this.settings=scene.sys.settings;this.manager=scene.sys.game.input;this.pluginEvents=new EventEmitter();this.enabled=true;this.displayList;this.cameras;InputPluginCache.install(this);this.mouse=this.manager.mouse;this.topOnly=true;this.pollRate=-1;this._pollTimer=0;var _eventData={cancelled:false};this._eventContainer={stopPropagation:function(){_eventData.cancelled=true}};this._eventData=_eventData;this.dragDistanceThreshold=0;this.dragTimeThreshold=0;this._temp=[];this._tempZones=[];this._list=[];this._pendingInsertion=[];this._pendingRemoval=[];this._draggable=[];this._drag={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]};this._dragState=[];this._over={0:[],1:[],2:[],3:[],4:[],5:[],6:[],7:[],8:[],9:[],10:[]};this._validTypes=['onDown','onUp','onOver','onOut','onMove','onDragStart','onDrag','onDragEnd','onDragEnter','onDragLeave','onDragOver','onDrop'];this._updatedThisFrame=false;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.cameras=this.systems.cameras;this.displayList=this.systems.displayList;this.systems.events.once(SceneEvents.DESTROY,this.destroy,this);this.pluginEvents.emit(Events.BOOT)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.TRANSITION_START,this.transitionIn,this);eventEmitter.on(SceneEvents.TRANSITION_OUT,this.transitionOut,this);eventEmitter.on(SceneEvents.TRANSITION_COMPLETE,this.transitionComplete,this);eventEmitter.on(SceneEvents.PRE_UPDATE,this.preUpdate,this);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this);this.manager.events.on(Events.GAME_OUT,this.onGameOut,this);this.manager.events.on(Events.GAME_OVER,this.onGameOver,this);this.enabled=true;this._dragState=[0,0,0,0,0,0,0,0,0,0];this.pluginEvents.emit(Events.START)},onGameOver:function(event){if(this.isActive()){this.emit(Events.GAME_OVER,event.timeStamp,event)}},onGameOut:function(event){if(this.isActive()){this.emit(Events.GAME_OUT,event.timeStamp,event)}},preUpdate:function(){this.pluginEvents.emit(Events.PRE_UPDATE);var removeList=this._pendingRemoval;var insertList=this._pendingInsertion;var toRemove=removeList.length;var toInsert=insertList.length;if(toRemove===0&&toInsert===0){return}var current=this._list;for(var i=0;i<toRemove;i++){var gameObject=removeList[i];var index=current.indexOf(gameObject);if(index>-1){current.splice(index,1);this.clear(gameObject,true)}}removeList.length=0;this._pendingRemoval.length=0;this._list=current.concat(insertList.splice(0))},isActive:function(){return(this.enabled&&this.scene.sys.isActive())},updatePoll:function(time,delta){if(!this.isActive()){return false}this.pluginEvents.emit(Events.UPDATE,time,delta);if(this._updatedThisFrame){this._updatedThisFrame=false;return false}var i;var manager=this.manager;var pointers=manager.pointers;var pointersTotal=manager.pointersTotal;for(i=0;i<pointersTotal;i++){pointers[i].updateMotion()}if(this._list.length===0){return false}var rate=this.pollRate;if(rate===-1){return false}else if(rate>0){this._pollTimer-=delta;if(this._pollTimer<0){this._pollTimer=this.pollRate}else{return false}}var captured=false;for(i=0;i<pointersTotal;i++){var total=0;var pointer=pointers[i];this._tempZones=[];this._temp=this.hitTestPointer(pointer);this.sortGameObjects(this._temp);this.sortGameObjects(this._tempZones);if(this.topOnly){if(this._temp.length){this._temp.splice(1)}if(this._tempZones.length){this._tempZones.splice(1)}}total+=this.processOverOutEvents(pointer);if(this.getDragState(pointer)===2){this.processDragThresholdEvent(pointer,time)}if(total>0){captured=true}}return captured},update:function(type,pointers){if(!this.isActive()){return false}var pointersTotal=pointers.length;var captured=false;for(var i=0;i<pointersTotal;i++){var total=0;var pointer=pointers[i];this._tempZones=[];this._temp=this.hitTestPointer(pointer);this.sortGameObjects(this._temp);this.sortGameObjects(this._tempZones);if(this.topOnly){if(this._temp.length){this._temp.splice(1)}if(this._tempZones.length){this._tempZones.splice(1)}}switch(type){case CONST.MOUSE_DOWN:total+=this.processDragDownEvent(pointer);total+=this.processDownEvents(pointer);total+=this.processOverOutEvents(pointer);break;case CONST.MOUSE_UP:total+=this.processDragUpEvent(pointer);total+=this.processUpEvents(pointer);total+=this.processOverOutEvents(pointer);break;case CONST.TOUCH_START:total+=this.processDragDownEvent(pointer);total+=this.processDownEvents(pointer);total+=this.processOverEvents(pointer);break;case CONST.TOUCH_END:case CONST.TOUCH_CANCEL:total+=this.processDragUpEvent(pointer);total+=this.processUpEvents(pointer);total+=this.processOutEvents(pointer);break;case CONST.MOUSE_MOVE:case CONST.TOUCH_MOVE:total+=this.processDragMoveEvent(pointer);total+=this.processMoveEvents(pointer);total+=this.processOverOutEvents(pointer);break;case CONST.MOUSE_WHEEL:total+=this.processWheelEvent(pointer);break}if(total>0){captured=true}}this._updatedThisFrame=true;return captured},clear:function(gameObject,skipQueue){if(skipQueue===undefined){skipQueue=false}var input=gameObject.input;if(!input){return}if(!skipQueue){this.queueForRemoval(gameObject)}input.gameObject=undefined;input.target=undefined;input.hitArea=undefined;input.hitAreaCallback=undefined;input.callbackContext=undefined;this.manager.resetCursor(input);gameObject.input=null;var index=this._draggable.indexOf(gameObject);if(index>-1){this._draggable.splice(index,1)}index=this._drag[0].indexOf(gameObject);if(index>-1){this._drag[0].splice(index,1)}index=this._over[0].indexOf(gameObject);if(index>-1){this._over[0].splice(index,1)}return gameObject},disable:function(gameObject){gameObject.input.enabled=false},enable:function(gameObject,shape,callback,dropZone){if(dropZone===undefined){dropZone=false}if(gameObject.input){gameObject.input.enabled=true}else{this.setHitArea(gameObject,shape,callback)}if(gameObject.input&&dropZone&&!gameObject.input.dropZone){gameObject.input.dropZone=dropZone}return this},hitTestPointer:function(pointer){var cameras=this.cameras.getCamerasBelowPointer(pointer);for(var c=0;c<cameras.length;c++){var camera=cameras[c];var over=this.manager.hitTest(pointer,this._list,camera);for(var i=0;i<over.length;i++){var obj=over[i];if(obj.input.dropZone){this._tempZones.push(obj)}}if(over.length>0){pointer.camera=camera;return over}}pointer.camera=cameras[0];return[]},processDownEvents:function(pointer){var total=0;var currentlyOver=this._temp;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;for(var i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(!gameObject.input){continue}total++;gameObject.emit(Events.GAMEOBJECT_POINTER_DOWN,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_DOWN,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted&&this.manager){if(pointer.downElement===this.manager.game.canvas){this.emit(Events.POINTER_DOWN,pointer,currentlyOver)}else{this.emit(Events.POINTER_DOWN_OUTSIDE,pointer)}}return total},getDragState:function(pointer){return this._dragState[pointer.id]},setDragState:function(pointer,state){this._dragState[pointer.id]=state},processDragThresholdEvent:function(pointer,time){var passed=false;var timeThreshold=this.dragTimeThreshold;var distanceThreshold=this.dragDistanceThreshold;if(distanceThreshold>0&&DistanceBetween(pointer.x,pointer.y,pointer.downX,pointer.downY)>=distanceThreshold){passed=true}else if(timeThreshold>0&&(time>=pointer.downTime+timeThreshold)){passed=true}if(passed){this.setDragState(pointer,3);return this.processDragStartList(pointer)}},processDragStartList:function(pointer){if(this.getDragState(pointer)!==3){return 0}var list=this._drag[pointer.id];for(var i=0;i<list.length;i++){var gameObject=list[i];var input=gameObject.input;input.dragState=2;input.dragStartX=gameObject.x;input.dragStartY=gameObject.y;input.dragStartXGlobal=pointer.worldX;input.dragStartYGlobal=pointer.worldY;input.dragX=input.dragStartXGlobal-input.dragStartX;input.dragY=input.dragStartYGlobal-input.dragStartY;gameObject.emit(Events.GAMEOBJECT_DRAG_START,pointer,input.dragX,input.dragY);this.emit(Events.DRAG_START,pointer,gameObject)}this.setDragState(pointer,4);return list.length},processDragDownEvent:function(pointer){var currentlyOver=this._temp;if(this._draggable.length===0||currentlyOver.length===0||!pointer.primaryDown||this.getDragState(pointer)!==0){return 0}this.setDragState(pointer,1);var draglist=[];for(var i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(gameObject.input.draggable&&(gameObject.input.dragState===0)){draglist.push(gameObject)}}if(draglist.length===0){this.setDragState(pointer,0);return 0}else if(draglist.length>1){this.sortGameObjects(draglist);if(this.topOnly){draglist.splice(1)}}this._drag[pointer.id]=draglist;if(this.dragDistanceThreshold===0&&this.dragTimeThreshold===0){this.setDragState(pointer,3);return this.processDragStartList(pointer)}else{this.setDragState(pointer,2);return 0}},processDragMoveEvent:function(pointer){if(this.getDragState(pointer)===2){this.processDragThresholdEvent(pointer,this.manager.game.loop.now)}if(this.getDragState(pointer)!==4){return 0}var dropZones=this._tempZones;var list=this._drag[pointer.id];for(var i=0;i<list.length;i++){var gameObject=list[i];var input=gameObject.input;var target=input.target;if(target){var index=dropZones.indexOf(target);if(index===0){gameObject.emit(Events.GAMEOBJECT_DRAG_OVER,pointer,target);this.emit(Events.DRAG_OVER,pointer,gameObject,target)}else if(index>0){gameObject.emit(Events.GAMEOBJECT_DRAG_LEAVE,pointer,target);this.emit(Events.DRAG_LEAVE,pointer,gameObject,target);input.target=dropZones[0];target=input.target;gameObject.emit(Events.GAMEOBJECT_DRAG_ENTER,pointer,target);this.emit(Events.DRAG_ENTER,pointer,gameObject,target)}else{gameObject.emit(Events.GAMEOBJECT_DRAG_LEAVE,pointer,target);this.emit(Events.DRAG_LEAVE,pointer,gameObject,target);if(dropZones[0]){input.target=dropZones[0];target=input.target;gameObject.emit(Events.GAMEOBJECT_DRAG_ENTER,pointer,target);this.emit(Events.DRAG_ENTER,pointer,gameObject,target)}else{input.target=null}}}else if(!target&&dropZones[0]){input.target=dropZones[0];target=input.target;gameObject.emit(Events.GAMEOBJECT_DRAG_ENTER,pointer,target);this.emit(Events.DRAG_ENTER,pointer,gameObject,target)}var dragX;var dragY;if(!gameObject.parentContainer){dragX=pointer.worldX-input.dragX;dragY=pointer.worldY-input.dragY}else{var dx=pointer.worldX-input.dragStartXGlobal;var dy=pointer.worldY-input.dragStartYGlobal;var rotation=gameObject.getParentRotation();var dxRotated=dx*Math.cos(rotation)+dy*Math.sin(rotation);var dyRotated=dy*Math.cos(rotation)-dx*Math.sin(rotation);dxRotated*=(1/gameObject.parentContainer.scaleX);dyRotated*=(1/gameObject.parentContainer.scaleY);dragX=dxRotated+input.dragStartX;dragY=dyRotated+input.dragStartY}gameObject.emit(Events.GAMEOBJECT_DRAG,pointer,dragX,dragY);this.emit(Events.DRAG,pointer,gameObject,dragX,dragY)}return list.length},processDragUpEvent:function(pointer){var list=this._drag[pointer.id];for(var i=0;i<list.length;i++){var gameObject=list[i];var input=gameObject.input;if(input&&input.dragState===2){input.dragState=0;input.dragX=input.localX-gameObject.displayOriginX;input.dragY=input.localY-gameObject.displayOriginY;var dropped=false;var target=input.target;if(target){gameObject.emit(Events.GAMEOBJECT_DROP,pointer,target);this.emit(Events.DROP,pointer,gameObject,target);input.target=null;dropped=true}if(gameObject.input){gameObject.emit(Events.GAMEOBJECT_DRAG_END,pointer,input.dragX,input.dragY,dropped);this.emit(Events.DRAG_END,pointer,gameObject,dropped)}}}this.setDragState(pointer,0);list.splice(0);return 0},processMoveEvents:function(pointer){var total=0;var currentlyOver=this._temp;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;for(var i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(!gameObject.input){continue}total++;gameObject.emit(Events.GAMEOBJECT_POINTER_MOVE,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_MOVE,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}if(this.topOnly){break}}if(!aborted){this.emit(Events.POINTER_MOVE,pointer,currentlyOver)}return total},processWheelEvent:function(pointer){var total=0;var currentlyOver=this._temp;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;var dx=pointer.deltaX;var dy=pointer.deltaY;var dz=pointer.deltaZ;for(var i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(!gameObject.input){continue}total++;gameObject.emit(Events.GAMEOBJECT_POINTER_WHEEL,pointer,dx,dy,dz,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_WHEEL,pointer,gameObject,dx,dy,dz,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted){this.emit(Events.POINTER_WHEEL,pointer,currentlyOver,dx,dy,dz)}return total},processOverEvents:function(pointer){var currentlyOver=this._temp;var totalInteracted=0;var total=currentlyOver.length;var justOver=[];if(total>0){var manager=this.manager;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;for(var i=0;i<total;i++){var gameObject=currentlyOver[i];if(!gameObject.input){continue}justOver.push(gameObject);manager.setCursor(gameObject.input);gameObject.emit(Events.GAMEOBJECT_POINTER_OVER,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer);totalInteracted++;if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_OVER,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted){this.emit(Events.POINTER_OVER,pointer,justOver)}}this._over[pointer.id]=justOver;return totalInteracted},processOutEvents:function(pointer){var previouslyOver=this._over[pointer.id];var totalInteracted=0;var total=previouslyOver.length;if(total>0){var manager=this.manager;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;this.sortGameObjects(previouslyOver);for(var i=0;i<total;i++){var gameObject=previouslyOver[i];for(i=0;i<total;i++){gameObject=previouslyOver[i];if(!gameObject.input){continue}manager.resetCursor(gameObject.input);gameObject.emit(Events.GAMEOBJECT_POINTER_OUT,pointer,_eventContainer);totalInteracted++;if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_OUT,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted){this.emit(Events.POINTER_OUT,pointer,previouslyOver)}}this._over[pointer.id]=[]}return totalInteracted},processOverOutEvents:function(pointer){var currentlyOver=this._temp;var i;var gameObject;var justOut=[];var justOver=[];var stillOver=[];var previouslyOver=this._over[pointer.id];var currentlyDragging=this._drag[pointer.id];var manager=this.manager;for(i=0;i<previouslyOver.length;i++){gameObject=previouslyOver[i];if(currentlyOver.indexOf(gameObject)===-1&&currentlyDragging.indexOf(gameObject)===-1){justOut.push(gameObject)}else{stillOver.push(gameObject)}}for(i=0;i<currentlyOver.length;i++){gameObject=currentlyOver[i];if(previouslyOver.indexOf(gameObject)===-1){justOver.push(gameObject)}}var total=justOut.length;var totalInteracted=0;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;if(total>0){this.sortGameObjects(justOut);for(i=0;i<total;i++){gameObject=justOut[i];if(!gameObject.input){continue}manager.resetCursor(gameObject.input);gameObject.emit(Events.GAMEOBJECT_POINTER_OUT,pointer,_eventContainer);totalInteracted++;if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_OUT,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted){this.emit(Events.POINTER_OUT,pointer,justOut)}}total=justOver.length;_eventData.cancelled=false;aborted=false;if(total>0){this.sortGameObjects(justOver);for(i=0;i<total;i++){gameObject=justOver[i];if(!gameObject.input){continue}manager.setCursor(gameObject.input);gameObject.emit(Events.GAMEOBJECT_POINTER_OVER,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer);totalInteracted++;if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_OVER,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted){this.emit(Events.POINTER_OVER,pointer,justOver)}}previouslyOver=stillOver.concat(justOver);this._over[pointer.id]=this.sortGameObjects(previouslyOver);return totalInteracted},processUpEvents:function(pointer){var currentlyOver=this._temp;var _eventData=this._eventData;var _eventContainer=this._eventContainer;_eventData.cancelled=false;var aborted=false;for(var i=0;i<currentlyOver.length;i++){var gameObject=currentlyOver[i];if(!gameObject.input){continue}gameObject.emit(Events.GAMEOBJECT_POINTER_UP,pointer,gameObject.input.localX,gameObject.input.localY,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}this.emit(Events.GAMEOBJECT_UP,pointer,gameObject,_eventContainer);if(_eventData.cancelled||!gameObject.input){aborted=true;break}}if(!aborted&&this.manager){if(pointer.upElement===this.manager.game.canvas){this.emit(Events.POINTER_UP,pointer,currentlyOver)}else{this.emit(Events.POINTER_UP_OUTSIDE,pointer)}}return currentlyOver.length},queueForInsertion:function(child){if(this._pendingInsertion.indexOf(child)===-1&&this._list.indexOf(child)===-1){this._pendingInsertion.push(child)}return this},queueForRemoval:function(child){this._pendingRemoval.push(child);return this},setDraggable:function(gameObjects,value){if(value===undefined){value=true}if(!Array.isArray(gameObjects)){gameObjects=[gameObjects]}for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i];gameObject.input.draggable=value;var index=this._draggable.indexOf(gameObject);if(value&&index===-1){this._draggable.push(gameObject)}else if(!value&&index>-1){this._draggable.splice(index,1)}}return this},makePixelPerfect:function(alphaTolerance){if(alphaTolerance===undefined){alphaTolerance=1}var textureManager=this.systems.textures;return CreatePixelPerfectHandler(textureManager,alphaTolerance)},setHitArea:function(gameObjects,shape,callback){if(shape===undefined){return this.setHitAreaFromTexture(gameObjects)}if(!Array.isArray(gameObjects)){gameObjects=[gameObjects]}var draggable=false;var dropZone=false;var cursor=false;var useHandCursor=false;var pixelPerfect=false;var customHitArea=true;if(IsPlainObject(shape)){var config=shape;shape=GetFastValue(config,'hitArea',null);callback=GetFastValue(config,'hitAreaCallback',null);draggable=GetFastValue(config,'draggable',false);dropZone=GetFastValue(config,'dropZone',false);cursor=GetFastValue(config,'cursor',false);useHandCursor=GetFastValue(config,'useHandCursor',false);pixelPerfect=GetFastValue(config,'pixelPerfect',false);var alphaTolerance=GetFastValue(config,'alphaTolerance',1);if(pixelPerfect){shape={};callback=this.makePixelPerfect(alphaTolerance)}if(!shape||!callback){this.setHitAreaFromTexture(gameObjects);customHitArea=false}}else if(typeof shape==='function'&&!callback){callback=shape;shape={}}for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i];if(pixelPerfect&&gameObject.type==='Container'){console.warn('Cannot pixelPerfect test a Container. Use a custom callback.');continue}var io=(!gameObject.input)?CreateInteractiveObject(gameObject,shape,callback):gameObject.input;io.customHitArea=customHitArea;io.dropZone=dropZone;io.cursor=(useHandCursor)?'pointer':cursor;gameObject.input=io;if(draggable){this.setDraggable(gameObject)}this.queueForInsertion(gameObject)}return this},setHitAreaCircle:function(gameObjects,x,y,radius,callback){if(callback===undefined){callback=CircleContains}var shape=new Circle(x,y,radius);return this.setHitArea(gameObjects,shape,callback)},setHitAreaEllipse:function(gameObjects,x,y,width,height,callback){if(callback===undefined){callback=EllipseContains}var shape=new Ellipse(x,y,width,height);return this.setHitArea(gameObjects,shape,callback)},setHitAreaFromTexture:function(gameObjects,callback){if(callback===undefined){callback=RectangleContains}if(!Array.isArray(gameObjects)){gameObjects=[gameObjects]}for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i];var frame=gameObject.frame;var width=0;var height=0;if(gameObject.width){width=gameObject.width;height=gameObject.height}else if(frame){width=frame.realWidth;height=frame.realHeight}if(gameObject.type==='Container'&&(width===0||height===0)){console.warn('Container.setInteractive must specify a Shape or call setSize() first');continue}if(width!==0&&height!==0){gameObject.input=CreateInteractiveObject(gameObject,new Rectangle(0,0,width,height),callback);this.queueForInsertion(gameObject)}}return this},setHitAreaRectangle:function(gameObjects,x,y,width,height,callback){if(callback===undefined){callback=RectangleContains}var shape=new Rectangle(x,y,width,height);return this.setHitArea(gameObjects,shape,callback)},setHitAreaTriangle:function(gameObjects,x1,y1,x2,y2,x3,y3,callback){if(callback===undefined){callback=TriangleContains}var shape=new Triangle(x1,y1,x2,y2,x3,y3);return this.setHitArea(gameObjects,shape,callback)},enableDebug:function(gameObject,color){if(color===undefined){color=0x00ff00}var input=gameObject.input;if(!input||!input.hitArea){return this}var shape=input.hitArea;var shapeType=shape.type;var debug=input.hitAreaDebug;var factory=this.systems.add;var updateList=this.systems.updateList;if(debug){updateList.remove(debug);debug.destroy();debug=null}var offsetx=0;var offsety=0;switch(shapeType){case GEOM_CONST.CIRCLE:debug=factory.arc(0,0,shape.radius);offsetx=shape.x-shape.radius;offsety=shape.y-shape.radius;break;case GEOM_CONST.ELLIPSE:debug=factory.ellipse(0,0,shape.width,shape.height);offsetx=shape.x-shape.width/2;offsety=shape.y-shape.height/2;break;case GEOM_CONST.LINE:debug=factory.line(0,0,shape.x1,shape.y1,shape.x2,shape.y2);break;case GEOM_CONST.POLYGON:debug=factory.polygon(0,0,shape.points);break;case GEOM_CONST.RECTANGLE:debug=factory.rectangle(0,0,shape.width,shape.height);offsetx=shape.x;offsety=shape.y;break;case GEOM_CONST.TRIANGLE:debug=factory.triangle(0,0,shape.x1,shape.y1,shape.x2,shape.y2,shape.x3,shape.y3);break}if(debug){debug.isFilled=false;debug.preUpdate=function(){debug.setStrokeStyle(1/gameObject.scale,color);debug.setDisplayOrigin(gameObject.displayOriginX,gameObject.displayOriginY);var x=gameObject.x;var y=gameObject.y;var rotation=gameObject.rotation;var scaleX=gameObject.scaleX;var scaleY=gameObject.scaleY;if(gameObject.parentContainer){var matrix=gameObject.getWorldTransformMatrix();x=matrix.tx;y=matrix.ty;rotation=matrix.rotation;scaleX=matrix.scaleX;scaleY=matrix.scaleY}debug.setRotation(rotation);debug.setScale(scaleX,scaleY);debug.setPosition(x+offsetx,y+offsety);debug.setScrollFactor(gameObject.scrollFactorX,gameObject.scrollFactorY);debug.setDepth(gameObject.depth)};updateList.add(debug);input.hitAreaDebug=debug}return this},removeDebug:function(gameObject){var input=gameObject.input;if(input&&input.hitAreaDebug){var debug=input.hitAreaDebug;this.systems.updateList.remove(debug);debug.destroy();input.hitAreaDebug=null}return this},setPollAlways:function(){return this.setPollRate(0)},setPollOnMove:function(){return this.setPollRate(-1)},setPollRate:function(value){this.pollRate=value;this._pollTimer=0;return this},setGlobalTopOnly:function(value){this.manager.globalTopOnly=value;return this},setTopOnly:function(value){this.topOnly=value;return this},sortGameObjects:function(gameObjects){if(gameObjects.length<2){return gameObjects}this.scene.sys.depthSort();return gameObjects.sort(this.sortHandlerGO.bind(this))},sortHandlerGO:function(childA,childB){if(!childA.parentContainer&&!childB.parentContainer){return this.displayList.getIndex(childB)-this.displayList.getIndex(childA)}else if(childA.parentContainer===childB.parentContainer){return childB.parentContainer.getIndex(childB)-childA.parentContainer.getIndex(childA)}else if(childA.parentContainer===childB){return-1}else if(childB.parentContainer===childA){return 1}else{var listA=childA.getIndexList();var listB=childB.getIndexList();var len=Math.min(listA.length,listB.length);for(var i=0;i<len;i++){var indexA=listA[i];var indexB=listB[i];if(indexA===indexB){continue}else{return indexB-indexA}}return listB.length-listA.length}return 0},stopPropagation:function(){this.manager._tempSkip=true;return this},addPointer:function(quantity){return this.manager.addPointer(quantity)},setDefaultCursor:function(cursor){this.manager.setDefaultCursor(cursor);return this},transitionIn:function(){this.enabled=this.settings.transitionAllowInput},transitionComplete:function(){if(!this.settings.transitionAllowInput){this.enabled=true}},transitionOut:function(){this.enabled=this.settings.transitionAllowInput},shutdown:function(){this.pluginEvents.emit(Events.SHUTDOWN);this._temp.length=0;this._list.length=0;this._draggable.length=0;this._pendingRemoval.length=0;this._pendingInsertion.length=0;this._dragState.length=0;for(var i=0;i<10;i++){this._drag[i]=[];this._over[i]=[]}this.removeAllListeners();var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.TRANSITION_START,this.transitionIn,this);eventEmitter.off(SceneEvents.TRANSITION_OUT,this.transitionOut,this);eventEmitter.off(SceneEvents.TRANSITION_COMPLETE,this.transitionComplete,this);eventEmitter.off(SceneEvents.PRE_UPDATE,this.preUpdate,this);this.manager.events.off(Events.GAME_OUT,this.onGameOut,this);this.manager.events.off(Events.GAME_OVER,this.onGameOver,this);eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.pluginEvents.emit(Events.DESTROY);this.pluginEvents.removeAllListeners();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.cameras=null;this.manager=null;this.events=null;this.mouse=null},x:{get:function(){return this.manager.activePointer.x}},y:{get:function(){return this.manager.activePointer.y}},isOver:{get:function(){return this.manager.isOver}},mousePointer:{get:function(){return this.manager.mousePointer}},activePointer:{get:function(){return this.manager.activePointer}},pointer1:{get:function(){return this.manager.pointers[1]}},pointer2:{get:function(){return this.manager.pointers[2]}},pointer3:{get:function(){return this.manager.pointers[3]}},pointer4:{get:function(){return this.manager.pointers[4]}},pointer5:{get:function(){return this.manager.pointers[5]}},pointer6:{get:function(){return this.manager.pointers[6]}},pointer7:{get:function(){return this.manager.pointers[7]}},pointer8:{get:function(){return this.manager.pointers[8]}},pointer9:{get:function(){return this.manager.pointers[9]}},pointer10:{get:function(){return this.manager.pointers[10]}}});PluginCache.register('InputPlugin',InputPlugin,'input');module.exports=InputPlugin}),(function(module,exports){var CreatePixelPerfectHandler=function(textureManager,alphaTolerance){return function(hitArea,x,y,gameObject){var alpha=textureManager.getPixelAlpha(x,y,gameObject.texture.key,gameObject.frame.name);return(alpha&&alpha>=alphaTolerance)}};module.exports=CreatePixelPerfectHandler}),(function(module,exports,__webpack_require__){module.exports={Events:__webpack_require__(137),KeyboardManager:__webpack_require__(366),KeyboardPlugin:__webpack_require__(1224),Key:__webpack_require__(453),KeyCodes:__webpack_require__(124),KeyCombo:__webpack_require__(454),JustDown:__webpack_require__(1229),JustUp:__webpack_require__(1230),DownDuration:__webpack_require__(1231),UpDuration:__webpack_require__(1232)}}),(function(module,exports){module.exports='keydown'}),(function(module,exports){module.exports='keyup'}),(function(module,exports){module.exports='keycombomatch'}),(function(module,exports){module.exports='down'}),(function(module,exports){module.exports='keydown-'}),(function(module,exports){module.exports='keyup-'}),(function(module,exports){module.exports='up'}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(137);var GameEvents=__webpack_require__(20);var GetValue=__webpack_require__(6);var InputEvents=__webpack_require__(54);var InputPluginCache=__webpack_require__(136);var Key=__webpack_require__(453);var KeyCodes=__webpack_require__(124);var KeyCombo=__webpack_require__(454);var KeyMap=__webpack_require__(1228);var SnapFloor=__webpack_require__(93);var KeyboardPlugin=new Class({Extends:EventEmitter,initialize:function KeyboardPlugin(sceneInputPlugin){EventEmitter.call(this);this.game=sceneInputPlugin.systems.game;this.scene=sceneInputPlugin.scene;this.settings=this.scene.sys.settings;this.sceneInputPlugin=sceneInputPlugin;this.manager=sceneInputPlugin.manager.keyboard;this.enabled=true;this.keys=[];this.combos=[];sceneInputPlugin.pluginEvents.once(InputEvents.BOOT,this.boot,this);sceneInputPlugin.pluginEvents.on(InputEvents.START,this.start,this)},boot:function(){var settings=this.settings.input;this.enabled=GetValue(settings,'keyboard',true);var captures=GetValue(settings,'keyboard.capture',null);if(captures){this.addCaptures(captures)}this.sceneInputPlugin.pluginEvents.once(InputEvents.DESTROY,this.destroy,this)},start:function(){if(this.sceneInputPlugin.manager.useQueue){this.sceneInputPlugin.pluginEvents.on(InputEvents.UPDATE,this.update,this)}else{this.sceneInputPlugin.manager.events.on(InputEvents.MANAGER_PROCESS,this.update,this)}this.sceneInputPlugin.pluginEvents.once(InputEvents.SHUTDOWN,this.shutdown,this);this.game.events.on(GameEvents.BLUR,this.resetKeys,this)},isActive:function(){return(this.enabled&&this.scene.sys.isActive())},addCapture:function(keycode){this.manager.addCapture(keycode);return this},removeCapture:function(keycode){this.manager.removeCapture(keycode);return this},getCaptures:function(){return this.manager.captures},enableGlobalCapture:function(){this.manager.preventDefault=true;return this},disableGlobalCapture:function(){this.manager.preventDefault=false;return this},clearCaptures:function(){this.manager.clearCaptures();return this},createCursorKeys:function(){return this.addKeys({up:KeyCodes.UP,down:KeyCodes.DOWN,left:KeyCodes.LEFT,right:KeyCodes.RIGHT,space:KeyCodes.SPACE,shift:KeyCodes.SHIFT})},addKeys:function(keys,enableCapture,emitOnRepeat){if(enableCapture===undefined){enableCapture=true}if(emitOnRepeat===undefined){emitOnRepeat=false}var output={};if(typeof keys==='string'){keys=keys.split(',');for(var i=0;i<keys.length;i++){var currentKey=keys[i].trim();if(currentKey){output[currentKey]=this.addKey(currentKey,enableCapture,emitOnRepeat)}}}else{for(var key in keys){output[key]=this.addKey(keys[key],enableCapture,emitOnRepeat)}}return output},addKey:function(key,enableCapture,emitOnRepeat){if(enableCapture===undefined){enableCapture=true}if(emitOnRepeat===undefined){emitOnRepeat=false}var keys=this.keys;if(key instanceof Key){var idx=keys.indexOf(key);if(idx>-1){keys[idx]=key}else{keys[key.keyCode]=key}if(enableCapture){this.addCapture(key.keyCode)}key.setEmitOnRepeat(emitOnRepeat);return key}if(typeof key==='string'){key=KeyCodes[key.toUpperCase()]}if(!keys[key]){keys[key]=new Key(this,key);if(enableCapture){this.addCapture(key)}keys[key].setEmitOnRepeat(emitOnRepeat)}return keys[key]},removeKey:function(key,destroy){if(destroy===undefined){destroy=false}var keys=this.keys;var ref;if(key instanceof Key){var idx=keys.indexOf(key);if(idx>-1){ref=this.keys[idx];this.keys[idx]=undefined}}else if(typeof key==='string'){key=KeyCodes[key.toUpperCase()]}if(keys[key]){ref=keys[key];keys[key]=undefined}if(ref){ref.plugin=null;if(destroy){ref.destroy()}}return this},removeAllKeys:function(destroy){var keys=this.keys;for(var i=0;i<keys.length;i++){var key=keys[i];if(key){keys[i]=undefined;if(destroy){key.destroy()}}}return this},createCombo:function(keys,config){return new KeyCombo(this,keys,config)},checkDown:function(key,duration){if(duration===undefined){duration=0}if(this.enabled&&key.isDown){var t=SnapFloor(this.time-key.timeDown,duration);if(t>key._tick){key._tick=t;return true}}return false},update:function(){var queue=this.manager.queue;var len=queue.length;if(!this.isActive()||len===0){return}var keys=this.keys;for(var i=0;i<len;i++){var event=queue[i];var code=event.keyCode;var key=keys[code];var repeat=false;if(event.cancelled===undefined){event.cancelled=0;event.stopImmediatePropagation=function(){event.cancelled=1};event.stopPropagation=function(){event.cancelled=-1}}if(event.cancelled===-1){continue}if(event.type==='keydown'){if(key){repeat=key.isDown;key.onDown(event)}if(!event.cancelled&&(!key||!repeat)){if(KeyMap[code]){this.emit(Events.KEY_DOWN+KeyMap[code],event);this.emit('keydown_'+KeyMap[code],event)}if(!event.cancelled){this.emit(Events.ANY_KEY_DOWN,event)}}}else{if(key){key.onUp(event)}if(!event.cancelled){if(KeyMap[code]){this.emit(Events.KEY_UP+KeyMap[code],event);this.emit('keyup_'+KeyMap[code],event)}if(!event.cancelled){this.emit(Events.ANY_KEY_UP,event)}}}if(event.cancelled===1){event.cancelled=0}}},resetKeys:function(){var keys=this.keys;for(var i=0;i<keys.length;i++){if(keys[i]){keys[i].reset()}}return this},shutdown:function(){this.resetKeys();if(this.sceneInputPlugin.manager.useQueue){this.sceneInputPlugin.pluginEvents.off(InputEvents.UPDATE,this.update,this)}else{this.sceneInputPlugin.manager.events.off(InputEvents.MANAGER_PROCESS,this.update,this)}this.game.events.off(GameEvents.BLUR,this.resetKeys);this.removeAllListeners();this.queue=[]},destroy:function(){this.shutdown();var keys=this.keys;for(var i=0;i<keys.length;i++){if(keys[i]){keys[i].destroy()}}this.keys=[];this.combos=[];this.queue=[];this.scene=null;this.settings=null;this.sceneInputPlugin=null;this.manager=null},time:{get:function(){return this.sceneInputPlugin.manager.time}}});InputPluginCache.register('KeyboardPlugin',KeyboardPlugin,'keyboard','keyboard','inputKeyboard');module.exports=KeyboardPlugin}),(function(module,exports,__webpack_require__){var AdvanceKeyCombo=__webpack_require__(1226);var ProcessKeyCombo=function(event,combo){if(combo.matched){return true}var comboMatched=false;var keyMatched=false;if(event.keyCode===combo.current){if(combo.index>0&&combo.maxKeyDelay>0){var timeLimit=combo.timeLastMatched+combo.maxKeyDelay;if(event.timeStamp<=timeLimit){keyMatched=true;comboMatched=AdvanceKeyCombo(event,combo)}}else{keyMatched=true;comboMatched=AdvanceKeyCombo(event,combo)}}if(!keyMatched&&combo.resetOnWrongKey){combo.index=0;combo.current=combo.keyCodes[0]}if(comboMatched){combo.timeLastMatched=event.timeStamp;combo.matched=true;combo.timeMatched=event.timeStamp}return comboMatched};module.exports=ProcessKeyCombo}),(function(module,exports){var AdvanceKeyCombo=function(event,combo){combo.timeLastMatched=event.timeStamp;combo.index++;if(combo.index===combo.size){return true}else{combo.current=combo.keyCodes[combo.index];return false}};module.exports=AdvanceKeyCombo}),(function(module,exports){var ResetKeyCombo=function(combo){combo.current=combo.keyCodes[0];combo.index=0;combo.timeLastMatched=0;combo.matched=false;combo.timeMatched=0;return combo};module.exports=ResetKeyCombo}),(function(module,exports,__webpack_require__){var KeyCodes=__webpack_require__(124);var KeyMap={};for(var key in KeyCodes){KeyMap[KeyCodes[key]]=key}module.exports=KeyMap}),(function(module,exports){var JustDown=function(key){if(key._justDown){key._justDown=false;return true}else{return false}};module.exports=JustDown}),(function(module,exports){var JustUp=function(key){if(key._justUp){key._justUp=false;return true}else{return false}};module.exports=JustUp}),(function(module,exports){var DownDuration=function(key,duration){if(duration===undefined){duration=50}var current=key.plugin.game.loop.time-key.timeDown;return(key.isDown&&current<duration)};module.exports=DownDuration}),(function(module,exports){var UpDuration=function(key,duration){if(duration===undefined){duration=50}var current=key.plugin.game.loop.time-key.timeUp;return(key.isUp&&current<duration)};module.exports=UpDuration}),(function(module,exports,__webpack_require__){module.exports={MouseManager:__webpack_require__(367)}}),(function(module,exports,__webpack_require__){module.exports={TouchManager:__webpack_require__(369)}}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(17);var Extend=__webpack_require__(18);var Loader={Events:__webpack_require__(82),FileTypes:__webpack_require__(1236),File:__webpack_require__(21),FileTypesManager:__webpack_require__(8),GetURL:__webpack_require__(138),LoaderPlugin:__webpack_require__(1260),MergeXHRSettings:__webpack_require__(215),MultiFile:__webpack_require__(61),XHRLoader:__webpack_require__(455),XHRSettings:__webpack_require__(139)};Loader=Extend(false,Loader,CONST);module.exports=Loader}),(function(module,exports,__webpack_require__){module.exports={AnimationJSONFile:__webpack_require__(1237),AtlasJSONFile:__webpack_require__(1238),AtlasXMLFile:__webpack_require__(1239),AudioFile:__webpack_require__(456),AudioSpriteFile:__webpack_require__(1240),BinaryFile:__webpack_require__(1241),BitmapFontFile:__webpack_require__(1242),CSSFile:__webpack_require__(1243),GLSLFile:__webpack_require__(1244),HTML5AudioFile:__webpack_require__(457),HTMLFile:__webpack_require__(1245),HTMLTextureFile:__webpack_require__(1246),ImageFile:__webpack_require__(72),JSONFile:__webpack_require__(60),MultiAtlasFile:__webpack_require__(1247),MultiScriptFile:__webpack_require__(1248),PackFile:__webpack_require__(1249),PluginFile:__webpack_require__(1250),SceneFile:__webpack_require__(1251),ScenePluginFile:__webpack_require__(1252),ScriptFile:__webpack_require__(458),SpriteSheetFile:__webpack_require__(1253),SVGFile:__webpack_require__(1254),TextFile:__webpack_require__(459),TilemapCSVFile:__webpack_require__(1255),TilemapImpactFile:__webpack_require__(1256),TilemapJSONFile:__webpack_require__(1257),UnityAtlasFile:__webpack_require__(1258),VideoFile:__webpack_require__(1259),XMLFile:__webpack_require__(216)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var JSONFile=__webpack_require__(60);var LoaderEvents=__webpack_require__(82);var AnimationJSONFile=new Class({Extends:JSONFile,initialize:function AnimationJSONFile(loader,key,url,xhrSettings,dataKey){JSONFile.call(this,loader,key,url,xhrSettings,dataKey);this.type='animationJSON'},onProcess:function(){this.loader.once(LoaderEvents.POST_PROCESS,this.onLoadComplete,this);JSONFile.prototype.onProcess.call(this)},onLoadComplete:function(){this.loader.systems.anims.fromJSON(this.data)}});FileTypesManager.register('animation',function(key,url,dataKey,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new AnimationJSONFile(this,key[i]))}}else{this.addFile(new AnimationJSONFile(this,key,url,xhrSettings,dataKey))}return this});module.exports=AnimationJSONFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var ImageFile=__webpack_require__(72);var IsPlainObject=__webpack_require__(7);var JSONFile=__webpack_require__(60);var MultiFile=__webpack_require__(61);var AtlasJSONFile=new Class({Extends:MultiFile,initialize:function AtlasJSONFile(loader,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var image;var data;if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');image=new ImageFile(loader,{key:key,url:GetFastValue(config,'textureURL'),extension:GetFastValue(config,'textureExtension','png'),normalMap:GetFastValue(config,'normalMap'),xhrSettings:GetFastValue(config,'textureXhrSettings')});data=new JSONFile(loader,{key:key,url:GetFastValue(config,'atlasURL'),extension:GetFastValue(config,'atlasExtension','json'),xhrSettings:GetFastValue(config,'atlasXhrSettings')})}else{image=new ImageFile(loader,key,textureURL,textureXhrSettings);data=new JSONFile(loader,key,atlasURL,atlasXhrSettings)}if(image.linkFile){MultiFile.call(this,loader,'atlasjson',key,[image,data,image.linkFile])}else{MultiFile.call(this,loader,'atlasjson',key,[image,data])}},addToCache:function(){if(this.isReadyToProcess()){var image=this.files[0];var json=this.files[1];var normalMap=(this.files[2])?this.files[2].data:null;this.loader.textureManager.addAtlas(image.key,image.data,json.data,normalMap);json.addToCache();this.complete=true}}});FileTypesManager.register('atlas',function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new AtlasJSONFile(this,key[i]);this.addFile(multifile.files)}}else{multifile=new AtlasJSONFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings);this.addFile(multifile.files)}return this});module.exports=AtlasJSONFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var ImageFile=__webpack_require__(72);var IsPlainObject=__webpack_require__(7);var MultiFile=__webpack_require__(61);var XMLFile=__webpack_require__(216);var AtlasXMLFile=new Class({Extends:MultiFile,initialize:function AtlasXMLFile(loader,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var image;var data;if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');image=new ImageFile(loader,{key:key,url:GetFastValue(config,'textureURL'),extension:GetFastValue(config,'textureExtension','png'),normalMap:GetFastValue(config,'normalMap'),xhrSettings:GetFastValue(config,'textureXhrSettings')});data=new XMLFile(loader,{key:key,url:GetFastValue(config,'atlasURL'),extension:GetFastValue(config,'atlasExtension','xml'),xhrSettings:GetFastValue(config,'atlasXhrSettings')})}else{image=new ImageFile(loader,key,textureURL,textureXhrSettings);data=new XMLFile(loader,key,atlasURL,atlasXhrSettings)}if(image.linkFile){MultiFile.call(this,loader,'atlasxml',key,[image,data,image.linkFile])}else{MultiFile.call(this,loader,'atlasxml',key,[image,data])}},addToCache:function(){if(this.isReadyToProcess()){var image=this.files[0];var xml=this.files[1];var normalMap=(this.files[2])?this.files[2].data:null;this.loader.textureManager.addAtlasXML(image.key,image.data,xml.data,normalMap);xml.addToCache();this.complete=true}}});FileTypesManager.register('atlasXML',function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new AtlasXMLFile(this,key[i]);this.addFile(multifile.files)}}else{multifile=new AtlasXMLFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings);this.addFile(multifile.files)}return this});module.exports=AtlasXMLFile}),(function(module,exports,__webpack_require__){var AudioFile=__webpack_require__(456);var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var JSONFile=__webpack_require__(60);var MultiFile=__webpack_require__(61);var AudioSpriteFile=new Class({Extends:MultiFile,initialize:function AudioSpriteFile(loader,key,jsonURL,audioURL,audioConfig,audioXhrSettings,jsonXhrSettings){if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');jsonURL=GetFastValue(config,'jsonURL');audioURL=GetFastValue(config,'audioURL');audioConfig=GetFastValue(config,'audioConfig');audioXhrSettings=GetFastValue(config,'audioXhrSettings');jsonXhrSettings=GetFastValue(config,'jsonXhrSettings')}var data;if(!audioURL){data=new JSONFile(loader,key,jsonURL,jsonXhrSettings);MultiFile.call(this,loader,'audiosprite',key,[data]);this.config.resourceLoad=true;this.config.audioConfig=audioConfig;this.config.audioXhrSettings=audioXhrSettings}else{var audio=AudioFile.create(loader,key,audioURL,audioConfig,audioXhrSettings);if(audio){data=new JSONFile(loader,key,jsonURL,jsonXhrSettings);MultiFile.call(this,loader,'audiosprite',key,[audio,data]);this.config.resourceLoad=false}}},onFileComplete:function(file){var index=this.files.indexOf(file);if(index!==-1){this.pending--;if(this.config.resourceLoad&&file.type==='json'&&file.data.hasOwnProperty('resources')){var urls=file.data.resources;var audioConfig=GetFastValue(this.config,'audioConfig');var audioXhrSettings=GetFastValue(this.config,'audioXhrSettings');var audio=AudioFile.create(this.loader,file.key,urls,audioConfig,audioXhrSettings);if(audio){this.addToMultiFile(audio);this.loader.addFile(audio)}}}},addToCache:function(){if(this.isReadyToProcess()){var fileA=this.files[0];var fileB=this.files[1];fileA.addToCache();fileB.addToCache();this.complete=true}}});FileTypesManager.register('audioSprite',function(key,jsonURL,audioURL,audioConfig,audioXhrSettings,jsonXhrSettings){var game=this.systems.game;var gameAudioConfig=game.config.audio;var deviceAudio=game.device.audio;if((gameAudioConfig&&gameAudioConfig.noAudio)||(!deviceAudio.webAudio&&!deviceAudio.audioData)){return this}var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new AudioSpriteFile(this,key[i]);if(multifile.files){this.addFile(multifile.files)}}}else{multifile=new AudioSpriteFile(this,key,jsonURL,audioURL,audioConfig,audioXhrSettings,jsonXhrSettings);if(multifile.files){this.addFile(multifile.files)}}return this})}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var BinaryFile=new Class({Extends:File,initialize:function BinaryFile(loader,key,url,xhrSettings,dataType){var extension='bin';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension);dataType=GetFastValue(config,'dataType',dataType)}var fileConfig={type:'binary',cache:loader.cacheManager.binary,extension:extension,responseType:'arraybuffer',key:key,url:url,xhrSettings:xhrSettings,config:{dataType:dataType}};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;var ctor=this.config.dataType;this.data=(ctor)?new ctor(this.xhrLoader.response):this.xhrLoader.response;this.onProcessComplete()}});FileTypesManager.register('binary',function(key,url,dataType,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new BinaryFile(this,key[i]))}}else{this.addFile(new BinaryFile(this,key,url,xhrSettings,dataType))}return this});module.exports=BinaryFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var ImageFile=__webpack_require__(72);var IsPlainObject=__webpack_require__(7);var MultiFile=__webpack_require__(61);var ParseXMLBitmapFont=__webpack_require__(187);var XMLFile=__webpack_require__(216);var BitmapFontFile=new Class({Extends:MultiFile,initialize:function BitmapFontFile(loader,key,textureURL,fontDataURL,textureXhrSettings,fontDataXhrSettings){var image;var data;if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');image=new ImageFile(loader,{key:key,url:GetFastValue(config,'textureURL'),extension:GetFastValue(config,'textureExtension','png'),normalMap:GetFastValue(config,'normalMap'),xhrSettings:GetFastValue(config,'textureXhrSettings')});data=new XMLFile(loader,{key:key,url:GetFastValue(config,'fontDataURL'),extension:GetFastValue(config,'fontDataExtension','xml'),xhrSettings:GetFastValue(config,'fontDataXhrSettings')})}else{image=new ImageFile(loader,key,textureURL,textureXhrSettings);data=new XMLFile(loader,key,fontDataURL,fontDataXhrSettings)}if(image.linkFile){MultiFile.call(this,loader,'bitmapfont',key,[image,data,image.linkFile])}else{MultiFile.call(this,loader,'bitmapfont',key,[image,data])}},addToCache:function(){if(this.isReadyToProcess()){var image=this.files[0];var xml=this.files[1];image.addToCache();xml.addToCache();this.loader.cacheManager.bitmapFont.add(image.key,{data:ParseXMLBitmapFont(xml.data),texture:image.key,frame:null});this.complete=true}}});FileTypesManager.register('bitmapFont',function(key,textureURL,fontDataURL,textureXhrSettings,fontDataXhrSettings){var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new BitmapFontFile(this,key[i]);this.addFile(multifile.files)}}else{multifile=new BitmapFontFile(this,key,textureURL,fontDataURL,textureXhrSettings,fontDataXhrSettings);this.addFile(multifile.files)}return this});module.exports=BitmapFontFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var CSSFile=new Class({Extends:File,initialize:function CSSFile(loader,key,url,xhrSettings){var extension='css';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'script',cache:false,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=document.createElement('style');this.data.defer=false;this.data.innerHTML=this.xhrLoader.responseText;document.head.appendChild(this.data);this.onProcessComplete()}});FileTypesManager.register('css',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new CSSFile(this,key[i]))}}else{this.addFile(new CSSFile(this,key,url,xhrSettings))}return this});module.exports=CSSFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var Shader=__webpack_require__(353);var GLSLFile=new Class({Extends:File,initialize:function GLSLFile(loader,key,url,shaderType,xhrSettings){var extension='glsl';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');shaderType=GetFastValue(config,'shaderType','fragment');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}else if(shaderType===undefined){shaderType='fragment'}var fileConfig={type:'glsl',cache:loader.cacheManager.shader,extension:extension,responseType:'text',key:key,url:url,config:{shaderType:shaderType},xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=this.xhrLoader.responseText;this.onProcessComplete()},addToCache:function(){var data=this.data.split('\.');var block=this.extractBlock(data,0);if(block){while(block){var key=this.getShaderName(block.header);var shaderType=this.getShaderType(block.header);var uniforms=this.getShaderUniforms(block.header);var shaderSrc=block.shader;if(this.cache.has(key)){var shader=this.cache.get(key);if(shaderType==='fragment'){shader.fragmentSrc=shaderSrc}else{shader.vertexSrc=shaderSrc}if(!shader.uniforms){shader.uniforms=uniforms}}else if(shaderType==='fragment'){this.cache.add(key,new Shader(key,shaderSrc,'',uniforms))}else{this.cache.add(key,new Shader(key,'',shaderSrc,uniforms))}block=this.extractBlock(data,block.offset)}}else if(this.config.shaderType==='fragment'){this.cache.add(this.key,new Shader(this.key,this.data))}else{this.cache.add(this.key,new Shader(this.key,'',this.data))}this.pendingDestroy()},getShaderName:function(headerSource){for(var i=0;i<headerSource.length;i++){var line=headerSource[i].trim();if(line.substring(0,5)==='name:'){return line.substring(5).trim()}}return this.key},getShaderType:function(headerSource){for(var i=0;i<headerSource.length;i++){var line=headerSource[i].trim();if(line.substring(0,5)==='type:'){return line.substring(5).trim()}}return this.config.shaderType},getShaderUniforms:function(headerSource){var uniforms={};for(var i=0;i<headerSource.length;i++){var line=headerSource[i].trim();if(line.substring(0,8)==='uniform.'){var pos=line.indexOf(':');if(pos){var key=line.substring(8,pos);try{uniforms[key]=JSON.parse(line.substring(pos+1))}catch(e){console.warn('Invalid uniform JSON: '+key)}}}}return uniforms},extractBlock:function(data,offset){var headerStart=-1;var headerEnd=-1;var blockEnd=-1;var headerOpen=false;var captureSource=false;var headerSource=[];var shaderSource=[];for(var i=offset;i<data.length;i++){var line=data[i].trim();if(line==='---'){if(headerStart===-1){headerStart=i;headerOpen=true}else if(headerOpen){headerEnd=i;headerOpen=false;captureSource=true}else{captureSource=false;break}}else if(headerOpen){headerSource.push(line)}else if(captureSource){shaderSource.push(line);blockEnd=i}}if(!headerOpen&&headerEnd!==-1){return{header:headerSource,shader:shaderSource.join('\?'),offset:blockEnd}}else{return null}}});FileTypesManager.register('glsl',function(key,url,shaderType,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new GLSLFile(this,key[i]))}}else{this.addFile(new GLSLFile(this,key,url,shaderType,xhrSettings))}return this});module.exports=GLSLFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var HTMLFile=new Class({Extends:File,initialize:function HTMLFile(loader,key,url,xhrSettings){var extension='html';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'text',cache:loader.cacheManager.html,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=this.xhrLoader.responseText;this.onProcessComplete()}});FileTypesManager.register('html',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new HTMLFile(this,key[i]))}}else{this.addFile(new HTMLFile(this,key,url,xhrSettings))}return this});module.exports=HTMLFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var HTMLTextureFile=new Class({Extends:File,initialize:function HTMLTextureFile(loader,key,url,width,height,xhrSettings){if(width===undefined){width=512}if(height===undefined){height=512}var extension='html';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension);width=GetFastValue(config,'width',width);height=GetFastValue(config,'height',height)}var fileConfig={type:'html',cache:loader.textureManager,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings,config:{width:width,height:height}};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;var w=this.config.width;var h=this.config.height;var data=[];data.push('<svg width="'+w+'px" height="'+h+'px" viewBox="0 0 '+w+' '+h+'" xmlns="http://www.w3.org/2000/svg">');data.push('<foreignObject width="100%" height="100%">');data.push('<body xmlns="http://www.w3.org/1999/xhtml">');data.push(this.xhrLoader.responseText);data.push('</body>');data.push('</foreignObject>');data.push('</svg>');var svg=[data.join('\w')];var _this=this;try{var blob=new window.Blob(svg,{type:'image/svg+xml;charset=utf-8'})}catch(e){_this.state=CONST.FILE_ERRORED;_this.onProcessComplete();return}this.data=new Image();this.data.crossOrigin=this.crossOrigin;this.data.onload=function(){File.revokeObjectURL(_this.data);_this.onProcessComplete()};this.data.onerror=function(){File.revokeObjectURL(_this.data);_this.onProcessError()};File.createObjectURL(this.data,blob,'image/svg+xml')},addToCache:function(){var texture=this.cache.addImage(this.key,this.data);this.pendingDestroy(texture)}});FileTypesManager.register('htmlTexture',function(key,url,width,height,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new HTMLTextureFile(this,key[i]))}}else{this.addFile(new HTMLTextureFile(this,key,url,width,height,xhrSettings))}return this});module.exports=HTMLTextureFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var ImageFile=__webpack_require__(72);var IsPlainObject=__webpack_require__(7);var JSONFile=__webpack_require__(60);var MultiFile=__webpack_require__(61);var MultiAtlasFile=new Class({Extends:MultiFile,initialize:function MultiAtlasFile(loader,key,atlasURL,path,baseURL,atlasXhrSettings,textureXhrSettings){if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');if(GetFastValue(config,'url',false)){atlasURL=GetFastValue(config,'url')}else{atlasURL=GetFastValue(config,'atlasURL')}atlasXhrSettings=GetFastValue(config,'xhrSettings');path=GetFastValue(config,'path');baseURL=GetFastValue(config,'baseURL');textureXhrSettings=GetFastValue(config,'textureXhrSettings')}var data=new JSONFile(loader,key,atlasURL,atlasXhrSettings);MultiFile.call(this,loader,'multiatlas',key,[data]);this.config.path=path;this.config.baseURL=baseURL;this.config.textureXhrSettings=textureXhrSettings},onFileComplete:function(file){var index=this.files.indexOf(file);if(index!==-1){this.pending--;if(file.type==='json'&&file.data.hasOwnProperty('textures')){var textures=file.data.textures;var config=this.config;var loader=this.loader;var currentBaseURL=loader.baseURL;var currentPath=loader.path;var currentPrefix=loader.prefix;var baseURL=GetFastValue(config,'baseURL',this.baseURL);var path=GetFastValue(config,'path',this.path);var prefix=GetFastValue(config,'prefix',this.prefix);var textureXhrSettings=GetFastValue(config,'textureXhrSettings');loader.setBaseURL(baseURL);loader.setPath(path);loader.setPrefix(prefix);for(var i=0;i<textures.length;i++){var textureURL=textures[i].image;var key='MA'+this.multiKeyIndex+'_'+textureURL;var image=new ImageFile(loader,key,textureURL,textureXhrSettings);this.addToMultiFile(image);loader.addFile(image);if(textures[i].normalMap){var normalMap=new ImageFile(loader,key,textures[i].normalMap,textureXhrSettings);normalMap.type='normalMap';image.setLink(normalMap);this.addToMultiFile(normalMap);loader.addFile(normalMap)}}loader.setBaseURL(currentBaseURL);loader.setPath(currentPath);loader.setPrefix(currentPrefix)}}},addToCache:function(){if(this.isReadyToProcess()){var fileJSON=this.files[0];var data=[];var images=[];var normalMaps=[];for(var i=1;i<this.files.length;i++){var file=this.files[i];if(file.type==='normalMap'){continue}var pos=file.key.indexOf('_');var key=file.key.substr(pos+1);var image=file.data;for(var t=0;t<fileJSON.data.textures.length;t++){var item=fileJSON.data.textures[t];if(item.image===key){images.push(image);data.push(item);if(file.linkFile){normalMaps.push(file.linkFile.data)}break}}}if(normalMaps.length===0){normalMaps=undefined}this.loader.textureManager.addAtlasJSONArray(this.key,images,data,normalMaps);this.complete=true;for(i=0;i<this.files.length;i++){this.files[i].pendingDestroy()}}}});FileTypesManager.register('multiatlas',function(key,atlasURL,path,baseURL,atlasXhrSettings){var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new MultiAtlasFile(this,key[i]);this.addFile(multifile.files)}}else{multifile=new MultiAtlasFile(this,key,atlasURL,path,baseURL,atlasXhrSettings);this.addFile(multifile.files)}return this});module.exports=MultiAtlasFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var MultiFile=__webpack_require__(61);var ScriptFile=__webpack_require__(458);var MultiScriptFile=new Class({Extends:MultiFile,initialize:function MultiScriptFile(loader,key,url,xhrSettings){var extension='js';var files=[];if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}if(!Array.isArray(url)){url=[url]}for(var i=0;i<url.length;i++){var scriptFile=new ScriptFile(loader,{key:key+'_'+i.toString(),url:url[i],extension:extension,xhrSettings:xhrSettings});scriptFile.onProcess=function(){this.onProcessComplete()};files.push(scriptFile)}MultiFile.call(this,loader,'scripts',key,files)},addToCache:function(){if(this.isReadyToProcess()){for(var i=0;i<this.files.length;i++){var file=this.files[i];file.data=document.createElement('script');file.data.language='javascript';file.data.type='text/javascript';file.data.defer=false;file.data.text=file.xhrLoader.responseText;document.head.appendChild(file.data)}this.complete=true}}});FileTypesManager.register('scripts',function(key,url,xhrSettings){var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new MultiScriptFile(this,key[i]);this.addFile(multifile.files)}}else{multifile=new MultiScriptFile(this,key,url,xhrSettings);this.addFile(multifile.files)}return this});module.exports=MultiScriptFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var FileTypesManager=__webpack_require__(8);var JSONFile=__webpack_require__(60);var PackFile=new Class({Extends:JSONFile,initialize:function PackFile(loader,key,url,xhrSettings,dataKey){JSONFile.call(this,loader,key,url,xhrSettings,dataKey);this.type='packfile'},onProcess:function(){if(this.state!==CONST.FILE_POPULATED){this.state=CONST.FILE_PROCESSING;this.data=JSON.parse(this.xhrLoader.responseText)}this.loader.addPack(this.data,this.config);this.onProcessComplete()}});FileTypesManager.register('pack',function(key,url,packKey,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new PackFile(this,key[i]))}}else{this.addFile(new PackFile(this,key,url,xhrSettings,packKey))}return this});module.exports=PackFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var PluginFile=new Class({Extends:File,initialize:function PluginFile(loader,key,url,start,mapping,xhrSettings){var extension='js';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension);start=GetFastValue(config,'start');mapping=GetFastValue(config,'mapping')}var fileConfig={type:'plugin',cache:false,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings,config:{start:start,mapping:mapping}};File.call(this,loader,fileConfig);if(typeof url==='function'){this.data=url;this.state=CONST.FILE_POPULATED}},onProcess:function(){var pluginManager=this.loader.systems.plugins;var config=this.config;var start=GetFastValue(config,'start',false);var mapping=GetFastValue(config,'mapping',null);if(this.state===CONST.FILE_POPULATED){pluginManager.install(this.key,this.data,start,mapping)}else{this.state=CONST.FILE_PROCESSING;this.data=document.createElement('script');this.data.language='javascript';this.data.type='text/javascript';this.data.defer=false;this.data.text=this.xhrLoader.responseText;document.head.appendChild(this.data);var plugin=pluginManager.install(this.key,window[this.key],start,mapping);if(start||mapping){this.loader.systems[mapping]=plugin;this.loader.scene[mapping]=plugin}}this.onProcessComplete()}});FileTypesManager.register('plugin',function(key,url,start,mapping,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new PluginFile(this,key[i]))}}else{this.addFile(new PluginFile(this,key,url,start,mapping,xhrSettings))}return this});module.exports=PluginFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var SceneFile=new Class({Extends:File,initialize:function SceneFile(loader,key,url,xhrSettings){var extension='js';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'text',cache:loader.cacheManager.text,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=this.xhrLoader.responseText;this.onProcessComplete()},addToCache:function(){var code=this.data.concat('(function(){\*'+'return new '+this.key+'();\^'+'}).call(this);');var eval2=eval;this.loader.sceneManager.add(this.key,eval2(code));this.complete=true}});FileTypesManager.register('sceneFile',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new SceneFile(this,key[i]))}}else{this.addFile(new SceneFile(this,key,url,xhrSettings))}return this});module.exports=SceneFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var ScenePluginFile=new Class({Extends:File,initialize:function ScenePluginFile(loader,key,url,systemKey,sceneKey,xhrSettings){var extension='js';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension);systemKey=GetFastValue(config,'systemKey');sceneKey=GetFastValue(config,'sceneKey')}var fileConfig={type:'scenePlugin',cache:false,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings,config:{systemKey:systemKey,sceneKey:sceneKey}};File.call(this,loader,fileConfig);if(typeof url==='function'){this.data=url;this.state=CONST.FILE_POPULATED}},onProcess:function(){var pluginManager=this.loader.systems.plugins;var config=this.config;var key=this.key;var systemKey=GetFastValue(config,'systemKey',key);var sceneKey=GetFastValue(config,'sceneKey',key);if(this.state===CONST.FILE_POPULATED){pluginManager.installScenePlugin(systemKey,this.data,sceneKey,this.loader.scene,true)}else{this.state=CONST.FILE_PROCESSING;this.data=document.createElement('script');this.data.language='javascript';this.data.type='text/javascript';this.data.defer=false;this.data.text=this.xhrLoader.responseText;document.head.appendChild(this.data);pluginManager.installScenePlugin(systemKey,window[this.key],sceneKey,this.loader.scene,true)}this.onProcessComplete()}});FileTypesManager.register('scenePlugin',function(key,url,systemKey,sceneKey,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new ScenePluginFile(this,key[i]))}}else{this.addFile(new ScenePluginFile(this,key,url,systemKey,sceneKey,xhrSettings))}return this});module.exports=ScenePluginFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var ImageFile=__webpack_require__(72);var SpriteSheetFile=new Class({Extends:ImageFile,initialize:function SpriteSheetFile(loader,key,url,frameConfig,xhrSettings){ImageFile.call(this,loader,key,url,xhrSettings,frameConfig);this.type='spritesheet'},addToCache:function(){var texture=this.cache.addSpriteSheet(this.key,this.data,this.config);this.pendingDestroy(texture)}});FileTypesManager.register('spritesheet',function(key,url,frameConfig,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new SpriteSheetFile(this,key[i]))}}else{this.addFile(new SpriteSheetFile(this,key,url,frameConfig,xhrSettings))}return this});module.exports=SpriteSheetFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var SVGFile=new Class({Extends:File,initialize:function SVGFile(loader,key,url,svgConfig,xhrSettings){var extension='svg';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');svgConfig=GetFastValue(config,'svgConfig',{});xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'svg',cache:loader.textureManager,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings,config:{width:GetFastValue(svgConfig,'width'),height:GetFastValue(svgConfig,'height'),scale:GetFastValue(svgConfig,'scale')}};File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;var text=this.xhrLoader.responseText;var svg=[text];var width=this.config.width;var height=this.config.height;var scale=this.config.scale;resize:if(width&&height||scale){var xml=null;var parser=new DOMParser();xml=parser.parseFromString(text,'text/xml');var svgXML=xml.getElementsByTagName('svg')[0];var hasViewBox=svgXML.hasAttribute('viewBox');var svgWidth=parseFloat(svgXML.getAttribute('width'));var svgHeight=parseFloat(svgXML.getAttribute('height'));if(!hasViewBox&&svgWidth&&svgHeight){svgXML.setAttribute('viewBox','0  0 '+svgWidth+' '+svgHeight)}else if(hasViewBox&&!svgWidth&&!svgHeight){var viewBox=svgXML.getAttribute('viewBox').split(/\d+|,/);svgWidth=viewBox[2];svgHeight=viewBox[3]}if(scale){if(svgWidth&&svgHeight){width=svgWidth*scale;height=svgHeight*scale}else{break resize}}svgXML.setAttribute('width',width.toString()+'px');svgXML.setAttribute('height',height.toString()+'px');svg=[(new XMLSerializer()).serializeToString(svgXML)]}try{var blob=new window.Blob(svg,{type:'image/svg+xml;charset=utf-8'})}catch(e){this.onProcessError();return}this.data=new Image();this.data.crossOrigin=this.crossOrigin;var _this=this;var retry=false;this.data.onload=function(){if(!retry){File.revokeObjectURL(_this.data)}_this.onProcessComplete()};this.data.onerror=function(){if(!retry){retry=true;File.revokeObjectURL(_this.data);_this.data.src='data:image/svg+xml,'+encodeURIComponent(svg.join(''))}else{_this.onProcessError()}};File.createObjectURL(this.data,blob,'image/svg+xml')},addToCache:function(){var texture=this.cache.addImage(this.key,this.data);this.pendingDestroy(texture)}});FileTypesManager.register('svg',function(key,url,svgConfig,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new SVGFile(this,key[i]))}}else{this.addFile(new SVGFile(this,key,url,svgConfig,xhrSettings))}return this});module.exports=SVGFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var TILEMAP_FORMATS=__webpack_require__(32);var TilemapCSVFile=new Class({Extends:File,initialize:function TilemapCSVFile(loader,key,url,xhrSettings){var extension='csv';if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');url=GetFastValue(config,'url');xhrSettings=GetFastValue(config,'xhrSettings');extension=GetFastValue(config,'extension',extension)}var fileConfig={type:'tilemapCSV',cache:loader.cacheManager.tilemap,extension:extension,responseType:'text',key:key,url:url,xhrSettings:xhrSettings};File.call(this,loader,fileConfig);this.tilemapFormat=TILEMAP_FORMATS.CSV},onProcess:function(){this.state=CONST.FILE_PROCESSING;this.data=this.xhrLoader.responseText;this.onProcessComplete()},addToCache:function(){var tiledata={format:this.tilemapFormat,data:this.data};this.cache.add(this.key,tiledata);this.pendingDestroy(tiledata)}});FileTypesManager.register('tilemapCSV',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new TilemapCSVFile(this,key[i]))}}else{this.addFile(new TilemapCSVFile(this,key,url,xhrSettings))}return this});module.exports=TilemapCSVFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var JSONFile=__webpack_require__(60);var TILEMAP_FORMATS=__webpack_require__(32);var TilemapImpactFile=new Class({Extends:JSONFile,initialize:function TilemapImpactFile(loader,key,url,xhrSettings){JSONFile.call(this,loader,key,url,xhrSettings);this.type='tilemapJSON';this.cache=loader.cacheManager.tilemap},addToCache:function(){var tiledata={format:TILEMAP_FORMATS.WELTMEISTER,data:this.data};this.cache.add(this.key,tiledata);this.pendingDestroy(tiledata)}});FileTypesManager.register('tilemapImpact',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new TilemapImpactFile(this,key[i]))}}else{this.addFile(new TilemapImpactFile(this,key,url,xhrSettings))}return this});module.exports=TilemapImpactFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var JSONFile=__webpack_require__(60);var TILEMAP_FORMATS=__webpack_require__(32);var TilemapJSONFile=new Class({Extends:JSONFile,initialize:function TilemapJSONFile(loader,key,url,xhrSettings){JSONFile.call(this,loader,key,url,xhrSettings);this.type='tilemapJSON';this.cache=loader.cacheManager.tilemap},addToCache:function(){var tiledata={format:TILEMAP_FORMATS.TILED_JSON,data:this.data};this.cache.add(this.key,tiledata);this.pendingDestroy(tiledata)}});FileTypesManager.register('tilemapTiledJSON',function(key,url,xhrSettings){if(Array.isArray(key)){for(var i=0;i<key.length;i++){this.addFile(new TilemapJSONFile(this,key[i]))}}else{this.addFile(new TilemapJSONFile(this,key,url,xhrSettings))}return this});module.exports=TilemapJSONFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var ImageFile=__webpack_require__(72);var IsPlainObject=__webpack_require__(7);var MultiFile=__webpack_require__(61);var TextFile=__webpack_require__(459);var UnityAtlasFile=new Class({Extends:MultiFile,initialize:function UnityAtlasFile(loader,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var image;var data;if(IsPlainObject(key)){var config=key;key=GetFastValue(config,'key');image=new ImageFile(loader,{key:key,url:GetFastValue(config,'textureURL'),extension:GetFastValue(config,'textureExtension','png'),normalMap:GetFastValue(config,'normalMap'),xhrSettings:GetFastValue(config,'textureXhrSettings')});data=new TextFile(loader,{key:key,url:GetFastValue(config,'atlasURL'),extension:GetFastValue(config,'atlasExtension','txt'),xhrSettings:GetFastValue(config,'atlasXhrSettings')})}else{image=new ImageFile(loader,key,textureURL,textureXhrSettings);data=new TextFile(loader,key,atlasURL,atlasXhrSettings)}if(image.linkFile){MultiFile.call(this,loader,'unityatlas',key,[image,data,image.linkFile])}else{MultiFile.call(this,loader,'unityatlas',key,[image,data])}},addToCache:function(){if(this.isReadyToProcess()){var image=this.files[0];var text=this.files[1];var normalMap=(this.files[2])?this.files[2].data:null;this.loader.textureManager.addUnityAtlas(image.key,image.data,text.data,normalMap);text.addToCache();this.complete=true}}});FileTypesManager.register('unityAtlas',function(key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings){var multifile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){multifile=new UnityAtlasFile(this,key[i]);this.addFile(multifile.files)}}else{multifile=new UnityAtlasFile(this,key,textureURL,atlasURL,textureXhrSettings,atlasXhrSettings);this.addFile(multifile.files)}return this});module.exports=UnityAtlasFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var File=__webpack_require__(21);var FileTypesManager=__webpack_require__(8);var GetURL=__webpack_require__(138);var GetFastValue=__webpack_require__(2);var IsPlainObject=__webpack_require__(7);var VideoFile=new Class({Extends:File,initialize:function VideoFile(loader,key,urlConfig,loadEvent,asBlob,noAudio,xhrSettings){if(loadEvent===undefined){loadEvent='loadeddata'}if(asBlob===undefined){asBlob=false}if(noAudio===undefined){noAudio=false}if(loadEvent!=='loadeddata'&&loadEvent!=='canplay'&&loadEvent!=='canplaythrough'){loadEvent='loadeddata'}var fileConfig={type:'video',cache:loader.cacheManager.video,extension:urlConfig.type,responseType:'blob',key:key,url:urlConfig.url,xhrSettings:xhrSettings,config:{loadEvent:loadEvent,asBlob:asBlob,noAudio:noAudio}};this.onLoadCallback=this.onVideoLoadHandler.bind(this);this.onErrorCallback=this.onVideoErrorHandler.bind(this);File.call(this,loader,fileConfig)},onProcess:function(){this.state=CONST.FILE_PROCESSING;if(!this.config.asBlob){this.onProcessComplete();return}var video=this.createVideoElement();this.data=video;var _this=this;this.data.onloadeddata=function(){_this.onProcessComplete()};this.data.onerror=function(){File.revokeObjectURL(_this.data);_this.onProcessError()};File.createObjectURL(video,this.xhrLoader.response,'');video.load()},createVideoElement:function(){var video=document.createElement('video');video.controls=false;video.crossOrigin=this.loader.crossOrigin;if(this.config.noAudio){video.muted=true;video.defaultMuted=true;video.setAttribute('autoplay','autoplay')}video.setAttribute('playsinline','playsinline');video.setAttribute('preload','auto');return video},onVideoLoadHandler:function(event){var video=event.target;video.removeEventListener(this.config.loadEvent,this.onLoadCallback,true);video.removeEventListener('error',this.onErrorCallback,true);this.data=video;this.resetXHR();this.loader.nextFile(this,true)},onVideoErrorHandler:function(event){var video=event.target;if(video){video.removeEventListener(this.config.loadEvent,this.onLoadCallback,true);video.removeEventListener('error',this.onErrorCallback,true)}this.resetXHR();this.loader.nextFile(this,false)},load:function(){var loadEvent=this.config.loadEvent;if(this.config.asBlob){File.prototype.load.call(this)}else{this.percentComplete=0;var video=this.createVideoElement();video.addEventListener(loadEvent,this.onLoadCallback,true);video.addEventListener('error',this.onErrorCallback,true);video.src=GetURL(this,this.loader.baseURL);video.load()}}});VideoFile.create=function(loader,key,urls,loadEvent,asBlob,noAudio,xhrSettings){var game=loader.systems.game;if(IsPlainObject(key)){urls=GetFastValue(key,'url',[]);loadEvent=GetFastValue(key,'loadEvent','loadeddata');asBlob=GetFastValue(key,'asBlob',false);noAudio=GetFastValue(key,'noAudio',false);xhrSettings=GetFastValue(key,'xhrSettings')}var urlConfig=VideoFile.getVideoURL(game,urls);if(urlConfig){return new VideoFile(loader,key,urlConfig,loadEvent,asBlob,noAudio,xhrSettings)}};VideoFile.getVideoURL=function(game,urls){if(!Array.isArray(urls)){urls=[urls]}for(var i=0;i<urls.length;i++){var url=GetFastValue(urls[i],'url',urls[i]);if(url.indexOf('blob:')===0){return{url:url,type:''}}var videoType;if(url.indexOf('data:')===0){videoType=url.split(',')[0].match(/\.(.*?);/)}else{videoType=url.match(/\d([a-zA-Z0-9]+)($|\.)/)}videoType=GetFastValue(urls[i],'type',(videoType)?videoType[1]:'').toLowerCase();if(game.device.video[videoType]){return{url:url,type:videoType}}}return null};FileTypesManager.register('video',function(key,urls,loadEvent,asBlob,noAudio,xhrSettings){var videoFile;if(Array.isArray(key)){for(var i=0;i<key.length;i++){videoFile=VideoFile.create(this,key[i]);if(videoFile){this.addFile(videoFile)}}}else{videoFile=VideoFile.create(this,key,urls,loadEvent,asBlob,noAudio,xhrSettings);if(videoFile){this.addFile(videoFile)}}return this});module.exports=VideoFile}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var CONST=__webpack_require__(17);var CustomSet=__webpack_require__(133);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(82);var FileTypesManager=__webpack_require__(8);var GetFastValue=__webpack_require__(2);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var XHRSettings=__webpack_require__(139);var LoaderPlugin=new Class({Extends:EventEmitter,initialize:function LoaderPlugin(scene){EventEmitter.call(this);var gameConfig=scene.sys.game.config;var sceneConfig=scene.sys.settings.loader;this.scene=scene;this.systems=scene.sys;this.cacheManager=scene.sys.cache;this.textureManager=scene.sys.textures;this.sceneManager=scene.sys.game.scene;FileTypesManager.install(this);this.prefix='';this.path='';this.baseURL='';this.setBaseURL(GetFastValue(sceneConfig,'baseURL',gameConfig.loaderBaseURL));this.setPath(GetFastValue(sceneConfig,'path',gameConfig.loaderPath));this.setPrefix(GetFastValue(sceneConfig,'prefix',gameConfig.loaderPrefix));this.maxParallelDownloads=GetFastValue(sceneConfig,'maxParallelDownloads',gameConfig.loaderMaxParallelDownloads);this.xhr=XHRSettings(GetFastValue(sceneConfig,'responseType',gameConfig.loaderResponseType),GetFastValue(sceneConfig,'async',gameConfig.loaderAsync),GetFastValue(sceneConfig,'user',gameConfig.loaderUser),GetFastValue(sceneConfig,'password',gameConfig.loaderPassword),GetFastValue(sceneConfig,'timeout',gameConfig.loaderTimeout),GetFastValue(sceneConfig,'withCredentials',gameConfig.loaderWithCredentials));this.crossOrigin=GetFastValue(sceneConfig,'crossOrigin',gameConfig.loaderCrossOrigin);this.totalToLoad=0;this.progress=0;this.list=new CustomSet();this.inflight=new CustomSet();this.queue=new CustomSet();this._deleteQueue=new CustomSet();this.totalFailed=0;this.totalComplete=0;this.state=CONST.LOADER_IDLE;this.multiKeyIndex=0;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.pluginStart,this)},boot:function(){this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},pluginStart:function(){this.systems.events.once(SceneEvents.SHUTDOWN,this.shutdown,this)},setBaseURL:function(url){if(url===undefined){url=''}if(url!==''&&url.substr(-1)!=='/'){url=url.concat('/')}this.baseURL=url;return this},setPath:function(path){if(path===undefined){path=''}if(path!==''&&path.substr(-1)!=='/'){path=path.concat('/')}this.path=path;return this},setPrefix:function(prefix){if(prefix===undefined){prefix=''}this.prefix=prefix;return this},setCORS:function(crossOrigin){this.crossOrigin=crossOrigin;return this},addFile:function(file){if(!Array.isArray(file)){file=[file]}for(var i=0;i<file.length;i++){var item=file[i];if(!this.keyExists(item)){this.list.set(item);this.emit(Events.ADD,item.key,item.type,this,item);if(this.isLoading()){this.totalToLoad++;this.updateProgress()}}}},keyExists:function(file){var keyConflict=file.hasCacheConflict();if(!keyConflict){this.list.iterate(function(item){if(item.type===file.type&&item.key===file.key){keyConflict=true;return false}})}if(!keyConflict&&this.isLoading()){this.inflight.iterate(function(item){if(item.type===file.type&&item.key===file.key){keyConflict=true;return false}});this.queue.iterate(function(item){if(item.type===file.type&&item.key===file.key){keyConflict=true;return false}})}return keyConflict},addPack:function(pack,packKey){if(packKey&&pack.hasOwnProperty(packKey)){pack={packKey:pack[packKey]}}var total=0;var currentBaseURL=this.baseURL;var currentPath=this.path;var currentPrefix=this.prefix;for(var key in pack){if(!Object.prototype.hasOwnProperty.call(pack,key)){continue}var config=pack[key];var baseURL=GetFastValue(config,'baseURL',currentBaseURL);var path=GetFastValue(config,'path',currentPath);var prefix=GetFastValue(config,'prefix',currentPrefix);var files=GetFastValue(config,'files',null);var defaultType=GetFastValue(config,'defaultType','void');if(Array.isArray(files)){this.setBaseURL(baseURL);this.setPath(path);this.setPrefix(prefix);for(var i=0;i<files.length;i++){var file=files[i];var type=(file.hasOwnProperty('type'))?file.type:defaultType;if(this[type]){this[type](file);total++}}}}this.setBaseURL(currentBaseURL);this.setPath(currentPath);this.setPrefix(currentPrefix);return(total>0)},isLoading:function(){return(this.state===CONST.LOADER_LOADING||this.state===CONST.LOADER_PROCESSING)},isReady:function(){return(this.state===CONST.LOADER_IDLE||this.state===CONST.LOADER_COMPLETE)},start:function(){if(!this.isReady()){return}this.progress=0;this.totalFailed=0;this.totalComplete=0;this.totalToLoad=this.list.size;this.emit(Events.START,this);if(this.list.size===0){this.loadComplete()}else{this.state=CONST.LOADER_LOADING;this.inflight.clear();this.queue.clear();this.updateProgress();this.checkLoadQueue();this.systems.events.on(SceneEvents.UPDATE,this.update,this)}},updateProgress:function(){this.progress=1-((this.list.size+this.inflight.size)/this.totalToLoad);this.emit(Events.PROGRESS,this.progress)},update:function(){if(this.state===CONST.LOADER_LOADING&&this.list.size>0&&this.inflight.size<this.maxParallelDownloads){this.checkLoadQueue()}},checkLoadQueue:function(){this.list.each(function(file){if(file.state===CONST.FILE_POPULATED||(file.state===CONST.FILE_PENDING&&this.inflight.size<this.maxParallelDownloads)){this.inflight.set(file);this.list.delete(file);if(!file.crossOrigin){file.crossOrigin=this.crossOrigin}file.load()}if(this.inflight.size===this.maxParallelDownloads){return false}},this)},nextFile:function(file,success){if(!this.inflight){return}this.inflight.delete(file);this.updateProgress();if(success){this.totalComplete++;this.queue.set(file);this.emit(Events.FILE_LOAD,file);file.onProcess()}else{this.totalFailed++;this._deleteQueue.set(file);this.emit(Events.FILE_LOAD_ERROR,file);this.fileProcessComplete(file)}},fileProcessComplete:function(file){if(!this.scene||!this.systems||!this.systems.game||this.systems.game.pendingDestroy){return}if(file.state===CONST.FILE_ERRORED){if(file.multiFile){file.multiFile.onFileFailed(file)}}else if(file.state===CONST.FILE_COMPLETE){if(file.multiFile){if(file.multiFile.isReadyToProcess()){file.multiFile.addToCache()}}else{file.addToCache()}}this.queue.delete(file);if(this.list.size===0&&this.inflight.size===0&&this.queue.size===0){this.loadComplete()}},loadComplete:function(){this.emit(Events.POST_PROCESS,this);this.list.clear();this.inflight.clear();this.queue.clear();this.progress=1;this.state=CONST.LOADER_COMPLETE;this.systems.events.off(SceneEvents.UPDATE,this.update,this);this._deleteQueue.iterateLocal('destroy');this._deleteQueue.clear();this.emit(Events.COMPLETE,this,this.totalComplete,this.totalFailed)},flagForRemoval:function(file){this._deleteQueue.set(file)},saveJSON:function(data,filename){return this.save(JSON.stringify(data),filename)},save:function(data,filename,filetype){if(filename===undefined){filename='file.json'}if(filetype===undefined){filetype='application/json'}var blob=new Blob([data],{type:filetype});var url=URL.createObjectURL(blob);var a=document.createElement('a');a.download=filename;a.textContent='Download '+filename;a.href=url;a.click();return this},reset:function(){this.list.clear();this.inflight.clear();this.queue.clear();var gameConfig=this.systems.game.config;var sceneConfig=this.systems.settings.loader;this.setBaseURL(GetFastValue(sceneConfig,'baseURL',gameConfig.loaderBaseURL));this.setPath(GetFastValue(sceneConfig,'path',gameConfig.loaderPath));this.setPrefix(GetFastValue(sceneConfig,'prefix',gameConfig.loaderPrefix));this.state=CONST.LOADER_IDLE},shutdown:function(){this.reset();this.state=CONST.LOADER_SHUTDOWN;this.systems.events.off(SceneEvents.UPDATE,this.update,this);this.systems.events.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.state=CONST.LOADER_DESTROYED;this.systems.events.off(SceneEvents.UPDATE,this.update,this);this.systems.events.off(SceneEvents.START,this.pluginStart,this);this.list=null;this.inflight=null;this.queue=null;this.scene=null;this.systems=null;this.textureManager=null;this.cacheManager=null;this.sceneManager=null}});PluginCache.register('Loader',LoaderPlugin,'load');module.exports=LoaderPlugin}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(50);var Extend=__webpack_require__(18);var Arcade={ArcadePhysics:__webpack_require__(1262),Body:__webpack_require__(466),Collider:__webpack_require__(467),Components:__webpack_require__(217),Events:__webpack_require__(218),Factory:__webpack_require__(460),Group:__webpack_require__(462),Image:__webpack_require__(461),Sprite:__webpack_require__(140),StaticBody:__webpack_require__(472),StaticGroup:__webpack_require__(463),World:__webpack_require__(465)};Arcade=Extend(false,Arcade,CONST);module.exports=Arcade}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var DegToRad=__webpack_require__(39);var DistanceBetween=__webpack_require__(53);var DistanceSquared=__webpack_require__(321);var Factory=__webpack_require__(460);var GetFastValue=__webpack_require__(2);var Merge=__webpack_require__(126);var OverlapCirc=__webpack_require__(1275);var OverlapRect=__webpack_require__(464);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var Vector2=__webpack_require__(3);var World=__webpack_require__(465);var ArcadePhysics=new Class({initialize:function ArcadePhysics(scene){this.scene=scene;this.systems=scene.sys;this.config=this.getConfig();this.world;this.add;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.world=new World(this.scene,this.config);this.add=new Factory(this.world);this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){if(!this.world){this.world=new World(this.scene,this.config);this.add=new Factory(this.world)}var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.UPDATE,this.world.update,this.world);eventEmitter.on(SceneEvents.POST_UPDATE,this.world.postUpdate,this.world);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this)},getConfig:function(){var gameConfig=this.systems.game.config.physics;var sceneConfig=this.systems.settings.physics;var config=Merge(GetFastValue(sceneConfig,'arcade',{}),GetFastValue(gameConfig,'arcade',{}));return config},overlap:function(object1,object2,overlapCallback,processCallback,callbackContext){if(overlapCallback===undefined){overlapCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=overlapCallback}return this.world.collideObjects(object1,object2,overlapCallback,processCallback,callbackContext,true)},collide:function(object1,object2,collideCallback,processCallback,callbackContext){if(collideCallback===undefined){collideCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=collideCallback}return this.world.collideObjects(object1,object2,collideCallback,processCallback,callbackContext,false)},collideTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){return this.world.collideTiles(sprite,tiles,collideCallback,processCallback,callbackContext)},overlapTiles:function(sprite,tiles,collideCallback,processCallback,callbackContext){return this.world.overlapTiles(sprite,tiles,collideCallback,processCallback,callbackContext)},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},accelerateTo:function(gameObject,x,y,speed,xSpeedMax,ySpeedMax){if(speed===undefined){speed=60}var angle=Math.atan2(y-gameObject.y,x-gameObject.x);gameObject.body.acceleration.setToPolar(angle,speed);if(xSpeedMax!==undefined&&ySpeedMax!==undefined){gameObject.body.maxVelocity.set(xSpeedMax,ySpeedMax)}return angle},accelerateToObject:function(gameObject,destination,speed,xSpeedMax,ySpeedMax){return this.accelerateTo(gameObject,destination.x,destination.y,speed,xSpeedMax,ySpeedMax)},closest:function(source,targets){if(!targets){targets=this.world.bodies.entries}var min=Number.MAX_VALUE;var closest=null;var x=source.x;var y=source.y;var len=targets.length;for(var i=0;i<len;i++){var target=targets[i];var body=target.body||target;if(source===target||source===body||source===body.gameObject||source===body.center){continue}var distance=DistanceSquared(x,y,body.center.x,body.center.y);if(distance<min){closest=target;min=distance}}return closest},furthest:function(source,targets){if(!targets){targets=this.world.bodies.entries}var max=-1;var farthest=null;var x=source.x;var y=source.y;var len=targets.length;for(var i=0;i<len;i++){var target=targets[i];var body=target.body||target;if(source===target||source===body||source===body.gameObject||source===body.center){continue}var distance=DistanceSquared(x,y,body.center.x,body.center.y);if(distance>max){farthest=target;max=distance}}return farthest},moveTo:function(gameObject,x,y,speed,maxTime){if(speed===undefined){speed=60}if(maxTime===undefined){maxTime=0}var angle=Math.atan2(y-gameObject.y,x-gameObject.x);if(maxTime>0){speed=DistanceBetween(gameObject.x,gameObject.y,x,y)/(maxTime/1000)}gameObject.body.velocity.setToPolar(angle,speed);return angle},moveToObject:function(gameObject,destination,speed,maxTime){return this.moveTo(gameObject,destination.x,destination.y,speed,maxTime)},velocityFromAngle:function(angle,speed,vec2){if(speed===undefined){speed=60}if(vec2===undefined){vec2=new Vector2()}return vec2.setToPolar(DegToRad(angle),speed)},velocityFromRotation:function(rotation,speed,vec2){if(speed===undefined){speed=60}if(vec2===undefined){vec2=new Vector2()}return vec2.setToPolar(rotation,speed)},overlapRect:function(x,y,width,height,includeDynamic,includeStatic){return OverlapRect(this.world,x,y,width,height,includeDynamic,includeStatic)},overlapCirc:function(x,y,radius,includeDynamic,includeStatic){return OverlapCirc(this.world,x,y,radius,includeDynamic,includeStatic)},shutdown:function(){if(!this.world){return}var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.UPDATE,this.world.update,this.world);eventEmitter.off(SceneEvents.POST_UPDATE,this.world.postUpdate,this.world);eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this);this.add.destroy();this.world.destroy();this.add=null;this.world=null},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('ArcadePhysics',ArcadePhysics,'arcadePhysics');module.exports=ArcadePhysics}),(function(module,exports){var Acceleration={setAcceleration:function(x,y){this.body.acceleration.set(x,y);return this},setAccelerationX:function(value){this.body.acceleration.x=value;return this},setAccelerationY:function(value){this.body.acceleration.y=value;return this}};module.exports=Acceleration}),(function(module,exports){var Angular={setAngularVelocity:function(value){this.body.angularVelocity=value;return this},setAngularAcceleration:function(value){this.body.angularAcceleration=value;return this},setAngularDrag:function(value){this.body.angularDrag=value;return this}};module.exports=Angular}),(function(module,exports){var Bounce={setBounce:function(x,y){this.body.bounce.set(x,y);return this},setBounceX:function(value){this.body.bounce.x=value;return this},setBounceY:function(value){this.body.bounce.y=value;return this},setCollideWorldBounds:function(value,bounceX,bounceY){this.body.setCollideWorldBounds(value,bounceX,bounceY);return this}};module.exports=Bounce}),(function(module,exports){var Debug={setDebug:function(showBody,showVelocity,bodyColor){this.debugShowBody=showBody;this.debugShowVelocity=showVelocity;this.debugBodyColor=bodyColor;return this},setDebugBodyColor:function(value){this.body.debugBodyColor=value;return this},debugShowBody:{get:function(){return this.body.debugShowBody},set:function(value){this.body.debugShowBody=value}},debugShowVelocity:{get:function(){return this.body.debugShowVelocity},set:function(value){this.body.debugShowVelocity=value}},debugBodyColor:{get:function(){return this.body.debugBodyColor},set:function(value){this.body.debugBodyColor=value}}};module.exports=Debug}),(function(module,exports){var Drag={setDrag:function(x,y){this.body.drag.set(x,y);return this},setDragX:function(value){this.body.drag.x=value;return this},setDragY:function(value){this.body.drag.y=value;return this},setDamping:function(value){this.body.useDamping=value;return this}};module.exports=Drag}),(function(module,exports){var Enable={enableBody:function(reset,x,y,enableGameObject,showGameObject){if(reset){this.body.reset(x,y)}if(enableGameObject){this.body.gameObject.active=true}if(showGameObject){this.body.gameObject.visible=true}this.body.enable=true;return this},disableBody:function(disableGameObject,hideGameObject){if(disableGameObject===undefined){disableGameObject=false}if(hideGameObject===undefined){hideGameObject=false}this.body.stop();this.body.enable=false;if(disableGameObject){this.body.gameObject.active=false}if(hideGameObject){this.body.gameObject.visible=false}return this},refreshBody:function(){this.body.updateFromGameObject();return this}};module.exports=Enable}),(function(module,exports){var Friction={setFriction:function(x,y){this.body.friction.set(x,y);return this},setFrictionX:function(x){this.body.friction.x=x;return this},setFrictionY:function(y){this.body.friction.y=y;return this}};module.exports=Friction}),(function(module,exports){var Gravity={setGravity:function(x,y){this.body.gravity.set(x,y);return this},setGravityX:function(x){this.body.gravity.x=x;return this},setGravityY:function(y){this.body.gravity.y=y;return this}};module.exports=Gravity}),(function(module,exports){var Immovable={setImmovable:function(value){if(value===undefined){value=true}this.body.immovable=value;return this}};module.exports=Immovable}),(function(module,exports){var Mass={setMass:function(value){this.body.mass=value;return this}};module.exports=Mass}),(function(module,exports){var Size={setOffset:function(x,y){this.body.setOffset(x,y);return this},setSize:function(width,height,center){this.body.setSize(width,height,center);return this},setBodySize:function(width,height,center){this.body.setSize(width,height,center);return this},setCircle:function(radius,offsetX,offsetY){this.body.setCircle(radius,offsetX,offsetY);return this}};module.exports=Size}),(function(module,exports){var Velocity={setVelocity:function(x,y){this.body.setVelocity(x,y);return this},setVelocityX:function(x){this.body.setVelocityX(x);return this},setVelocityY:function(y){this.body.setVelocityY(y);return this},setMaxVelocity:function(x,y){this.body.maxVelocity.set(x,y);return this}};module.exports=Velocity}),(function(module,exports,__webpack_require__){var OverlapRect=__webpack_require__(464);var Circle=__webpack_require__(65);var CircleToCircle=__webpack_require__(205);var CircleToRectangle=__webpack_require__(206);var OverlapCirc=function(world,x,y,radius,includeDynamic,includeStatic){var bodiesInRect=OverlapRect(world,x-radius,y-radius,2*radius,2*radius,includeDynamic,includeStatic);if(bodiesInRect.length===0){return bodiesInRect}var area=new Circle(x,y,radius);var circFromBody=new Circle();var bodiesInArea=[];for(var i=0;i<bodiesInRect.length;i++){var body=bodiesInRect[i];if(body.isCircle){circFromBody.setTo(body.center.x,body.center.y,body.halfWidth);if(CircleToCircle(area,circFromBody)){bodiesInArea.push(body)}}else if(CircleToRectangle(area,body)){bodiesInArea.push(body)}}return bodiesInArea};module.exports=OverlapCirc}),(function(module,exports){module.exports='collide'}),(function(module,exports){module.exports='overlap'}),(function(module,exports){module.exports='pause'}),(function(module,exports){module.exports='resume'}),(function(module,exports){module.exports='tilecollide'}),(function(module,exports){module.exports='tileoverlap'}),(function(module,exports){module.exports='worldbounds'}),(function(module,exports){module.exports='worldstep'}),(function(module,exports){var ProcessTileCallbacks=function(tile,sprite){if(tile.collisionCallback){return!tile.collisionCallback.call(tile.collisionCallbackContext,sprite,tile)}else if(tile.layer.callbacks[tile.index]){return!tile.layer.callbacks[tile.index].callback.call(tile.layer.callbacks[tile.index].callbackContext,sprite,tile)}return true};module.exports=ProcessTileCallbacks}),(function(module,exports,__webpack_require__){var TileCheckX=__webpack_require__(1286);var TileCheckY=__webpack_require__(1288);var TileIntersectsBody=__webpack_require__(471);var SeparateTile=function(i,body,tile,tileWorldRect,tilemapLayer,tileBias,isLayer){var tileLeft=tileWorldRect.left;var tileTop=tileWorldRect.top;var tileRight=tileWorldRect.right;var tileBottom=tileWorldRect.bottom;var faceHorizontal=tile.faceLeft||tile.faceRight;var faceVertical=tile.faceTop||tile.faceBottom;if(!isLayer){faceHorizontal=true;faceVertical=true}if(!faceHorizontal&&!faceVertical){return false}var ox=0;var oy=0;var minX=0;var minY=1;if(body.deltaAbsX()>body.deltaAbsY()){minX=-1}else if(body.deltaAbsX()<body.deltaAbsY()){minY=-1}if(body.deltaX()!==0&&body.deltaY()!==0&&faceHorizontal&&faceVertical){minX=Math.min(Math.abs(body.position.x-tileRight),Math.abs(body.right-tileLeft));minY=Math.min(Math.abs(body.position.y-tileBottom),Math.abs(body.bottom-tileTop))}if(minX<minY){if(faceHorizontal){ox=TileCheckX(body,tile,tileLeft,tileRight,tileBias,isLayer);if(ox!==0&&!TileIntersectsBody(tileWorldRect,body)){return true}}if(faceVertical){oy=TileCheckY(body,tile,tileTop,tileBottom,tileBias,isLayer)}}else{if(faceVertical){oy=TileCheckY(body,tile,tileTop,tileBottom,tileBias,isLayer);if(oy!==0&&!TileIntersectsBody(tileWorldRect,body)){return true}}if(faceHorizontal){ox=TileCheckX(body,tile,tileLeft,tileRight,tileBias,isLayer)}}return(ox!==0||oy!==0)};module.exports=SeparateTile}),(function(module,exports,__webpack_require__){var ProcessTileSeparationX=__webpack_require__(1287);var TileCheckX=function(body,tile,tileLeft,tileRight,tileBias,isLayer){var ox=0;var faceLeft=tile.faceLeft;var faceRight=tile.faceRight;var collideLeft=tile.collideLeft;var collideRight=tile.collideRight;if(!isLayer){faceLeft=true;faceRight=true;collideLeft=true;collideRight=true}if(body.deltaX()<0&&collideRight&&body.checkCollision.left){if(faceRight&&body.x<tileRight){ox=body.x-tileRight;if(ox<-tileBias){ox=0}}}else if(body.deltaX()>0&&collideLeft&&body.checkCollision.right){if(faceLeft&&body.right>tileLeft){ox=body.right-tileLeft;if(ox>tileBias){ox=0}}}if(ox!==0){if(body.customSeparateX){body.overlapX=ox}else{ProcessTileSeparationX(body,ox)}}return ox};module.exports=TileCheckX}),(function(module,exports){var ProcessTileSeparationX=function(body,x){if(x<0){body.blocked.none=false;body.blocked.left=true}else if(x>0){body.blocked.none=false;body.blocked.right=true}body.position.x-=x;if(body.bounce.x===0){body.velocity.x=0}else{body.velocity.x=-body.velocity.x*body.bounce.x}};module.exports=ProcessTileSeparationX}),(function(module,exports,__webpack_require__){var ProcessTileSeparationY=__webpack_require__(1289);var TileCheckY=function(body,tile,tileTop,tileBottom,tileBias,isLayer){var oy=0;var faceTop=tile.faceTop;var faceBottom=tile.faceBottom;var collideUp=tile.collideUp;var collideDown=tile.collideDown;if(!isLayer){faceTop=true;faceBottom=true;collideUp=true;collideDown=true}if(body.deltaY()<0&&collideDown&&body.checkCollision.up){if(faceBottom&&body.y<tileBottom){oy=body.y-tileBottom;if(oy<-tileBias){oy=0}}}else if(body.deltaY()>0&&collideUp&&body.checkCollision.down){if(faceTop&&body.bottom>tileTop){oy=body.bottom-tileTop;if(oy>tileBias){oy=0}}}if(oy!==0){if(body.customSeparateY){body.overlapY=oy}else{ProcessTileSeparationY(body,oy)}}return oy};module.exports=TileCheckY}),(function(module,exports){var ProcessTileSeparationY=function(body,y){if(y<0){body.blocked.none=false;body.blocked.up=true}else if(y>0){body.blocked.none=false;body.blocked.down=true}body.position.y-=y;if(body.bounce.y===0){body.velocity.y=0}else{body.velocity.y=-body.velocity.y*body.bounce.y}};module.exports=ProcessTileSeparationY}),(function(module,exports,__webpack_require__){var GetOverlapX=__webpack_require__(468);var SeparateX=function(body1,body2,overlapOnly,bias){var overlap=GetOverlapX(body1,body2,overlapOnly,bias);if(overlapOnly||overlap===0||(body1.immovable&&body2.immovable)||body1.customSeparateX||body2.customSeparateX){return(overlap!==0)||(body1.embedded&&body2.embedded)}var v1=body1.velocity.x;var v2=body2.velocity.x;if(!body1.immovable&&!body2.immovable){overlap*=0.5;body1.x-=overlap;body2.x+=overlap;var nv1=Math.sqrt((v2*v2*body2.mass)/body1.mass)*((v2>0)?1:-1);var nv2=Math.sqrt((v1*v1*body1.mass)/body2.mass)*((v1>0)?1:-1);var avg=(nv1+nv2)*0.5;nv1-=avg;nv2-=avg;body1.velocity.x=avg+nv1*body1.bounce.x;body2.velocity.x=avg+nv2*body2.bounce.x}else if(!body1.immovable){body1.x-=overlap;body1.velocity.x=v2-v1*body1.bounce.x;if(body2.moves){body1.y+=(body2.y-body2.prev.y)*body2.friction.y}}else{body2.x+=overlap;body2.velocity.x=v1-v2*body2.bounce.x;if(body1.moves){body2.y+=(body1.y-body1.prev.y)*body1.friction.y}}return true};module.exports=SeparateX}),(function(module,exports,__webpack_require__){var GetOverlapY=__webpack_require__(469);var SeparateY=function(body1,body2,overlapOnly,bias){var overlap=GetOverlapY(body1,body2,overlapOnly,bias);if(overlapOnly||overlap===0||(body1.immovable&&body2.immovable)||body1.customSeparateY||body2.customSeparateY){return(overlap!==0)||(body1.embedded&&body2.embedded)}var v1=body1.velocity.y;var v2=body2.velocity.y;if(!body1.immovable&&!body2.immovable){overlap*=0.5;body1.y-=overlap;body2.y+=overlap;var nv1=Math.sqrt((v2*v2*body2.mass)/body1.mass)*((v2>0)?1:-1);var nv2=Math.sqrt((v1*v1*body1.mass)/body2.mass)*((v1>0)?1:-1);var avg=(nv1+nv2)*0.5;nv1-=avg;nv2-=avg;body1.velocity.y=avg+nv1*body1.bounce.y;body2.velocity.y=avg+nv2*body2.bounce.y}else if(!body1.immovable){body1.y-=overlap;body1.velocity.y=v2-v1*body1.bounce.y;if(body2.moves){body1.x+=(body2.x-body2.prev.x)*body2.friction.x}}else{body2.y+=overlap;body2.velocity.y=v1-v2*body2.bounce.y;if(body1.moves){body2.x+=(body1.x-body1.prev.x)*body1.friction.x}}return true};module.exports=SeparateY}),(function(module,exports,__webpack_require__){var Composites={};module.exports=Composites;var Composite=__webpack_require__(148);var Constraint=__webpack_require__(219);var Common=__webpack_require__(42);var Body=__webpack_require__(62);var Bodies=__webpack_require__(109);(function(){Composites.stack=function(xx,yy,columns,rows,columnGap,rowGap,callback){var stack=Composite.create({label:'Stack'}),x=xx,y=yy,lastBody,i=0;for(var row=0;row<rows;row++){var maxHeight=0;for(var column=0;column<columns;column++){var body=callback(x,y,column,row,lastBody,i);if(body){var bodyHeight=body.bounds.max.y-body.bounds.min.y,bodyWidth=body.bounds.max.x-body.bounds.min.x;if(bodyHeight>maxHeight)maxHeight=bodyHeight;Body.translate(body,{x:bodyWidth*0.5,y:bodyHeight*0.5});x=body.bounds.max.x+columnGap;Composite.addBody(stack,body);lastBody=body;i+=1}else{x+=columnGap}}y+=maxHeight+rowGap;x=xx}return stack};Composites.chain=function(composite,xOffsetA,yOffsetA,xOffsetB,yOffsetB,options){var bodies=composite.bodies;for(var i=1;i<bodies.length;i++){var bodyA=bodies[i-1],bodyB=bodies[i],bodyAHeight=bodyA.bounds.max.y-bodyA.bounds.min.y,bodyAWidth=bodyA.bounds.max.x-bodyA.bounds.min.x,bodyBHeight=bodyB.bounds.max.y-bodyB.bounds.min.y,bodyBWidth=bodyB.bounds.max.x-bodyB.bounds.min.x;var defaults={bodyA:bodyA,pointA:{x:bodyAWidth*xOffsetA,y:bodyAHeight*yOffsetA},bodyB:bodyB,pointB:{x:bodyBWidth*xOffsetB,y:bodyBHeight*yOffsetB}};var constraint=Common.extend(defaults,options);Composite.addConstraint(composite,Constraint.create(constraint))}composite.label+=' Chain';return composite};Composites.mesh=function(composite,columns,rows,crossBrace,options){var bodies=composite.bodies,row,col,bodyA,bodyB,bodyC;for(row=0;row<rows;row++){for(col=1;col<columns;col++){bodyA=bodies[(col-1)+(row*columns)];bodyB=bodies[col+(row*columns)];Composite.addConstraint(composite,Constraint.create(Common.extend({bodyA:bodyA,bodyB:bodyB},options)))}if(row>0){for(col=0;col<columns;col++){bodyA=bodies[col+((row-1)*columns)];bodyB=bodies[col+(row*columns)];Composite.addConstraint(composite,Constraint.create(Common.extend({bodyA:bodyA,bodyB:bodyB},options)));if(crossBrace&&col>0){bodyC=bodies[(col-1)+((row-1)*columns)];Composite.addConstraint(composite,Constraint.create(Common.extend({bodyA:bodyC,bodyB:bodyB},options)))}if(crossBrace&&col<columns-1){bodyC=bodies[(col+1)+((row-1)*columns)];Composite.addConstraint(composite,Constraint.create(Common.extend({bodyA:bodyC,bodyB:bodyB},options)))}}}}composite.label+=' Mesh';return composite};Composites.pyramid=function(xx,yy,columns,rows,columnGap,rowGap,callback){return Composites.stack(xx,yy,columns,rows,columnGap,rowGap,function(x,y,column,row,lastBody,i){var actualRows=Math.min(rows,Math.ceil(columns/2)),lastBodyWidth=lastBody?lastBody.bounds.max.x-lastBody.bounds.min.x:0;if(row>actualRows)return;row=actualRows-row;var start=row,end=columns-1-row;if(column<start||column>end)return;if(i===1){Body.translate(lastBody,{x:(column+(columns%2===1?1:-1))*lastBodyWidth,y:0})}var xOffset=lastBody?column*lastBodyWidth:0;return callback(xx+xOffset+column*columnGap,y,column,row,lastBody,i)})};Composites.newtonsCradle=function(xx,yy,number,size,length){var newtonsCradle=Composite.create({label:'Newtons Cradle'});for(var i=0;i<number;i++){var separation=1.9,circle=Bodies.circle(xx+i*(size*separation),yy+length,size,{inertia:Infinity,restitution:1,friction:0,frictionAir:0.0001,slop:1}),constraint=Constraint.create({pointA:{x:xx+i*(size*separation),y:yy},bodyB:circle});Composite.addBody(newtonsCradle,circle);Composite.addConstraint(newtonsCradle,constraint)}return newtonsCradle};Composites.car=function(xx,yy,width,height,wheelSize){var group=Body.nextGroup(true),wheelBase=20,wheelAOffset=-width*0.5+wheelBase,wheelBOffset=width*0.5-wheelBase,wheelYOffset=0;var car=Composite.create({label:'Car'}),body=Bodies.rectangle(xx,yy,width,height,{collisionFilter:{group:group},chamfer:{radius:height*0.5},density:0.0002});var wheelA=Bodies.circle(xx+wheelAOffset,yy+wheelYOffset,wheelSize,{collisionFilter:{group:group},friction:0.8});var wheelB=Bodies.circle(xx+wheelBOffset,yy+wheelYOffset,wheelSize,{collisionFilter:{group:group},friction:0.8});var axelA=Constraint.create({bodyB:body,pointB:{x:wheelAOffset,y:wheelYOffset},bodyA:wheelA,stiffness:1,length:0});var axelB=Constraint.create({bodyB:body,pointB:{x:wheelBOffset,y:wheelYOffset},bodyA:wheelB,stiffness:1,length:0});Composite.addBody(car,body);Composite.addBody(car,wheelA);Composite.addBody(car,wheelB);Composite.addConstraint(car,axelA);Composite.addConstraint(car,axelB);return car};Composites.softBody=function(xx,yy,columns,rows,columnGap,rowGap,crossBrace,particleRadius,particleOptions,constraintOptions){particleOptions=Common.extend({inertia:Infinity},particleOptions);constraintOptions=Common.extend({stiffness:0.2,render:{type:'line',anchors:false}},constraintOptions);var softBody=Composites.stack(xx,yy,columns,rows,columnGap,rowGap,function(x,y){return Bodies.circle(x,y,particleRadius,particleOptions)});Composites.mesh(softBody,columns,rows,crossBrace,constraintOptions);softBody.label='Soft Body';return softBody}})()}),(function(module,exports,__webpack_require__){var Svg={};module.exports=Svg;var Bounds=__webpack_require__(100);var Common=__webpack_require__(42);(function(){Svg.pathToVertices=function(path,sampleLength){if(typeof window!=='undefined'&&!('SVGPathSeg'in window)){Common.warn('Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.')}var i,il,total,point,segment,segments,segmentsQueue,lastSegment,lastPoint,segmentIndex,points=[],lx,ly,length=0,x=0,y=0;sampleLength=sampleLength||15;var addPoint=function(px,py,pathSegType){var isRelative=pathSegType%2===1&&pathSegType>1;if(!lastPoint||px!=lastPoint.x||py!=lastPoint.y){if(lastPoint&&isRelative){lx=lastPoint.x;ly=lastPoint.y}else{lx=0;ly=0}var point={x:lx+px,y:ly+py};if(isRelative||!lastPoint){lastPoint=point}points.push(point);x=lx+px;y=ly+py}};var addSegmentPoint=function(segment){var segType=segment.pathSegTypeAsLetter.toUpperCase();if(segType==='Z')return;switch(segType){case'M':case'L':case'T':case'C':case'S':case'Q':x=segment.x;y=segment.y;break;case'H':x=segment.x;break;case'V':y=segment.y;break}addPoint(x,y,segment.pathSegType)};Svg._svgPathToAbsolute(path);total=path.getTotalLength();segments=[];for(i=0;i<path.pathSegList.numberOfItems;i+=1)segments.push(path.pathSegList.getItem(i));segmentsQueue=segments.concat();while(length<total){segmentIndex=path.getPathSegAtLength(length);segment=segments[segmentIndex];if(segment!=lastSegment){while(segmentsQueue.length&&segmentsQueue[0]!=segment)addSegmentPoint(segmentsQueue.shift());lastSegment=segment}switch(segment.pathSegTypeAsLetter.toUpperCase()){case'C':case'T':case'S':case'Q':case'A':point=path.getPointAtLength(length);addPoint(point.x,point.y,0);break}length+=sampleLength}for(i=0,il=segmentsQueue.length;i<il;++i)addSegmentPoint(segmentsQueue[i]);return points};Svg._svgPathToAbsolute=function(path){var x0,y0,x1,y1,x2,y2,segs=path.pathSegList,x=0,y=0,len=segs.numberOfItems;for(var i=0;i<len;++i){var seg=segs.getItem(i),segType=seg.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(segType)){if('x'in seg)x=seg.x;if('y'in seg)y=seg.y}else{if('x1'in seg)x1=x+seg.x1;if('x2'in seg)x2=x+seg.x2;if('y1'in seg)y1=y+seg.y1;if('y2'in seg)y2=y+seg.y2;if('x'in seg)x+=seg.x;if('y'in seg)y+=seg.y;switch(segType){case'm':segs.replaceItem(path.createSVGPathSegMovetoAbs(x,y),i);break;case'l':segs.replaceItem(path.createSVGPathSegLinetoAbs(x,y),i);break;case'h':segs.replaceItem(path.createSVGPathSegLinetoHorizontalAbs(x),i);break;case'v':segs.replaceItem(path.createSVGPathSegLinetoVerticalAbs(y),i);break;case'c':segs.replaceItem(path.createSVGPathSegCurvetoCubicAbs(x,y,x1,y1,x2,y2),i);break;case's':segs.replaceItem(path.createSVGPathSegCurvetoCubicSmoothAbs(x,y,x2,y2),i);break;case'q':segs.replaceItem(path.createSVGPathSegCurvetoQuadraticAbs(x,y,x1,y1),i);break;case't':segs.replaceItem(path.createSVGPathSegCurvetoQuadraticSmoothAbs(x,y),i);break;case'a':segs.replaceItem(path.createSVGPathSegArcAbs(x,y,seg.r1,seg.r2,seg.angle,seg.largeArcFlag,seg.sweepFlag),i);break;case'z':case'Z':x=x0;y=y0;break}}if(segType=='M'||segType=='m'){x0=x;y0=y}}}})()}),(function(module,exports,__webpack_require__){var Bodies=__webpack_require__(109);var Body=__webpack_require__(62);var Common=__webpack_require__(42);var GetFastValue=__webpack_require__(2);var Vertices=__webpack_require__(86);var PhysicsEditorParser={parseBody:function(x,y,config,options){if(options===undefined){options={}}var fixtureConfigs=GetFastValue(config,'fixtures',[]);var fixtures=[];for(var fc=0;fc<fixtureConfigs.length;fc++){var fixtureParts=this.parseFixture(fixtureConfigs[fc]);for(var i=0;i<fixtureParts.length;i++){fixtures.push(fixtureParts[i])}}var matterConfig=Common.clone(config,true);Common.extend(matterConfig,options,true);delete matterConfig.fixtures;delete matterConfig.type;var body=Body.create(matterConfig);Body.setParts(body,fixtures);Body.setPosition(body,{x:x,y:y});return body},parseFixture:function(fixtureConfig){var matterConfig=Common.extend({},false,fixtureConfig);delete matterConfig.circle;delete matterConfig.vertices;var fixtures;if(fixtureConfig.circle){var x=GetFastValue(fixtureConfig.circle,'x');var y=GetFastValue(fixtureConfig.circle,'y');var r=GetFastValue(fixtureConfig.circle,'radius');fixtures=[Bodies.circle(x,y,r,matterConfig)]}else if(fixtureConfig.vertices){fixtures=this.parseVertices(fixtureConfig.vertices,matterConfig)}return fixtures},parseVertices:function(vertexSets,options){if(options===undefined){options={}}var parts=[];for(var v=0;v<vertexSets.length;v++){Vertices.clockwiseSort(vertexSets[v]);parts.push(Body.create(Common.extend({position:Vertices.centre(vertexSets[v]),vertices:vertexSets[v]},options)))}return Bodies.flagCoincidentParts(parts)}};module.exports=PhysicsEditorParser}),(function(module,exports,__webpack_require__){var Bodies=__webpack_require__(109);var Body=__webpack_require__(62);var PhysicsJSONParser={parseBody:function(x,y,config,options){if(options===undefined){options={}}var body;var vertexSets=config.vertices;if(vertexSets.length===1){options.vertices=vertexSets[0];body=Body.create(options);Bodies.flagCoincidentParts(body.parts)}else{var parts=[];for(var i=0;i<vertexSets.length;i++){var part=Body.create({vertices:vertexSets[i]});parts.push(part)}Bodies.flagCoincidentParts(parts);options.parts=parts;body=Body.create(options)}body.label=config.label;Body.setPosition(body,{x:x,y:y});return body}};module.exports=PhysicsJSONParser}),(function(module,exports,__webpack_require__){module.exports={AFTER_ADD:__webpack_require__(1407),AFTER_REMOVE:__webpack_require__(1408),AFTER_UPDATE:__webpack_require__(1409),BEFORE_ADD:__webpack_require__(1410),BEFORE_REMOVE:__webpack_require__(1411),BEFORE_UPDATE:__webpack_require__(1412),COLLISION_ACTIVE:__webpack_require__(1413),COLLISION_END:__webpack_require__(1414),COLLISION_START:__webpack_require__(1415),DRAG_END:__webpack_require__(1416),DRAG:__webpack_require__(1417),DRAG_START:__webpack_require__(1418),PAUSE:__webpack_require__(1419),RESUME:__webpack_require__(1420),SLEEP_END:__webpack_require__(1421),SLEEP_START:__webpack_require__(1422)}}),(function(module,exports,__webpack_require__){var Bodies=__webpack_require__(109);var Body=__webpack_require__(62);var Class=__webpack_require__(0);var Components=__webpack_require__(514);var EventEmitter=__webpack_require__(10);var GetFastValue=__webpack_require__(2);var HasValue=__webpack_require__(108);var Vertices=__webpack_require__(86);var MatterTileBody=new Class({Extends:EventEmitter,Mixins:[Components.Bounce,Components.Collision,Components.Friction,Components.Gravity,Components.Mass,Components.Sensor,Components.Sleep,Components.Static],initialize:function MatterTileBody(world,tile,options){EventEmitter.call(this);this.tile=tile;this.world=world;if(tile.physics.matterBody){tile.physics.matterBody.destroy()}tile.physics.matterBody=this;var body=GetFastValue(options,'body',null);var addToWorld=GetFastValue(options,'addToWorld',true);if(!body){var collisionGroup=tile.getCollisionGroup();var collisionObjects=GetFastValue(collisionGroup,'objects',[]);if(collisionObjects.length>0){this.setFromTileCollision(options)}else{this.setFromTileRectangle(options)}}else{this.setBody(body,addToWorld)}},setFromTileRectangle:function(options){if(options===undefined){options={}}if(!HasValue(options,'isStatic')){options.isStatic=true}if(!HasValue(options,'addToWorld')){options.addToWorld=true}var bounds=this.tile.getBounds();var cx=bounds.x+(bounds.width/2);var cy=bounds.y+(bounds.height/2);var body=Bodies.rectangle(cx,cy,bounds.width,bounds.height,options);this.setBody(body,options.addToWorld);return this},setFromTileCollision:function(options){if(options===undefined){options={}}if(!HasValue(options,'isStatic')){options.isStatic=true}if(!HasValue(options,'addToWorld')){options.addToWorld=true}var sx=this.tile.tilemapLayer.scaleX;var sy=this.tile.tilemapLayer.scaleY;var tileX=this.tile.getLeft();var tileY=this.tile.getTop();var collisionGroup=this.tile.getCollisionGroup();var collisionObjects=GetFastValue(collisionGroup,'objects',[]);var parts=[];for(var i=0;i<collisionObjects.length;i++){var object=collisionObjects[i];var ox=tileX+(object.x*sx);var oy=tileY+(object.y*sy);var ow=object.width*sx;var oh=object.height*sy;var body=null;if(object.rectangle){body=Bodies.rectangle(ox+ow/2,oy+oh/2,ow,oh,options)}else if(object.ellipse){body=Bodies.circle(ox+ow/2,oy+oh/ 2, ow /2,options)}else if(object.polygon||object.polyline){var originalPoints=object.polygon?object.polygon:object.polyline;var points=originalPoints.map(function(p){return{x:p.x*sx,y:p.y*sy}});var vertices=Vertices.create(points);var center=Vertices.centre(vertices);ox+=center.x;oy+=center.y;body=Bodies.fromVertices(ox,oy,vertices,options)}if(body){parts.push(body)}}if(parts.length===1){this.setBody(parts[0],options.addToWorld)}else if(parts.length>1){options.parts=parts;this.setBody(Body.create(options),options.addToWorld)}return this},setBody:function(body,addToWorld){if(addToWorld===undefined){addToWorld=true}if(this.body){this.removeBody()}this.body=body;this.body.gameObject=this;if(addToWorld){this.world.add(this.body)}return this},removeBody:function(){if(this.body){this.world.remove(this.body);this.body.gameObject=undefined;this.body=undefined}return this},destroy:function(){this.removeBody();this.tile.physics.matterBody=undefined;this.removeAllListeners()}});module.exports=MatterTileBody}),(function(module,exports,__webpack_require__){var Matter=__webpack_require__(1389);Matter.Body=__webpack_require__(62);Matter.Composite=__webpack_require__(148);Matter.World=__webpack_require__(1300);Matter.Detector=__webpack_require__(515);Matter.Grid=__webpack_require__(1301);Matter.Pairs=__webpack_require__(1302);Matter.Pair=__webpack_require__(473);Matter.Query=__webpack_require__(1390);Matter.Resolver=__webpack_require__(1303);Matter.SAT=__webpack_require__(516);Matter.Constraint=__webpack_require__(219);Matter.Common=__webpack_require__(42);Matter.Engine=__webpack_require__(1391);Matter.Events=__webpack_require__(240);Matter.Sleeping=__webpack_require__(239);Matter.Plugin=__webpack_require__(1299);Matter.Bodies=__webpack_require__(109);Matter.Composites=__webpack_require__(1292);Matter.Axes=__webpack_require__(513);Matter.Bounds=__webpack_require__(100);Matter.Svg=__webpack_require__(1293);Matter.Vector=__webpack_require__(99);Matter.Vertices=__webpack_require__(86);Matter.World.add=Matter.Composite.add;Matter.World.remove=Matter.Composite.remove;Matter.World.addComposite=Matter.Composite.addComposite;Matter.World.addBody=Matter.Composite.addBody;Matter.World.addConstraint=Matter.Composite.addConstraint;Matter.World.clear=Matter.Composite.clear;module.exports=Matter}),(function(module,exports,__webpack_require__){var Plugin={};module.exports=Plugin;var Common=__webpack_require__(42);(function(){Plugin._registry={};Plugin.register=function(plugin){if(!Plugin.isPlugin(plugin)){Common.warn('Plugin.register:',Plugin.toString(plugin),'does not implement all required fields.')}if(plugin.name in Plugin._registry){var registered=Plugin._registry[plugin.name],pluginVersion=Plugin.versionParse(plugin.version).number,registeredVersion=Plugin.versionParse(registered.version).number;if(pluginVersion>registeredVersion){Common.warn('Plugin.register:',Plugin.toString(registered),'was upgraded to',Plugin.toString(plugin));Plugin._registry[plugin.name]=plugin}else if(pluginVersion<registeredVersion){Common.warn('Plugin.register:',Plugin.toString(registered),'can not be downgraded to',Plugin.toString(plugin))}else if(plugin!==registered){Common.warn('Plugin.register:',Plugin.toString(plugin),'is already registered to different plugin object')}}else{Plugin._registry[plugin.name]=plugin}return plugin};Plugin.resolve=function(dependency){return Plugin._registry[Plugin.dependencyParse(dependency).name]};Plugin.toString=function(plugin){return typeof plugin==='string'?plugin:(plugin.name||'anonymous')+'@'+(plugin.version||plugin.range||'0.0.0')};Plugin.isPlugin=function(obj){return obj&&obj.name&&obj.version&&obj.install};Plugin.isUsed=function(module,name){return module.used.indexOf(name)>-1};Plugin.isFor=function(plugin,module){var parsed=plugin.for&&Plugin.dependencyParse(plugin.for);return!plugin.for||(module.name===parsed.name&&Plugin.versionSatisfies(module.version,parsed.range))};Plugin.use=function(module,plugins){module.uses=(module.uses||[]).concat(plugins||[]);if(module.uses.length===0){Common.warn('Plugin.use:',Plugin.toString(module),'does not specify any dependencies to install.');return}var dependencies=Plugin.dependencies(module),sortedDependencies=Common.topologicalSort(dependencies),status=[];for(var i=0;i<sortedDependencies.length;i+=1){if(sortedDependencies[i]===module.name){continue}var plugin=Plugin.resolve(sortedDependencies[i]);if(!plugin){status.push('? '+sortedDependencies[i]);continue}if(Plugin.isUsed(module,plugin.name)){continue}if(!Plugin.isFor(plugin,module)){Common.warn('Plugin.use:',Plugin.toString(plugin),'is for',plugin.for,'but installed on',Plugin.toString(module)+'.');plugin._warned=true}if(plugin.install){plugin.install(module)}else{Common.warn('Plugin.use:',Plugin.toString(plugin),'does not specify an install function.');plugin._warned=true}if(plugin._warned){status.push('?? '+Plugin.toString(plugin));delete plugin._warned}else{status.push('? '+Plugin.toString(plugin))}module.used.push(plugin.name)}if(status.length>0&&!plugin.silent){Common.info(status.join('  '))}};Plugin.dependencies=function(module,tracked){var parsedBase=Plugin.dependencyParse(module),name=parsedBase.name;tracked=tracked||{};if(name in tracked){return}module=Plugin.resolve(module)||module;tracked[name]=Common.map(module.uses||[],function(dependency){if(Plugin.isPlugin(dependency)){Plugin.register(dependency)}var parsed=Plugin.dependencyParse(dependency),resolved=Plugin.resolve(dependency);if(resolved&&!Plugin.versionSatisfies(resolved.version,parsed.range)){Common.warn('Plugin.dependencies:',Plugin.toString(resolved),'does not satisfy',Plugin.toString(parsed),'used by',Plugin.toString(parsedBase)+'.');resolved._warned=true;module._warned=true}else if(!resolved){Common.warn('Plugin.dependencies:',Plugin.toString(dependency),'used by',Plugin.toString(parsedBase),'could not be resolved.');module._warned=true}return parsed.name});for(var i=0;i<tracked[name].length;i+=1){Plugin.dependencies(tracked[name][i],tracked)}return tracked};Plugin.dependencyParse=function(dependency){if(Common.isString(dependency)){var pattern=/^[\d-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-]+)?))?$/;if(!pattern.test(dependency)){Common.warn('Plugin.dependencyParse:',dependency,'is not a valid dependency string.')}return{name:dependency.split('@')[0],range:dependency.split('@')[1]||'*'}}return{name:dependency.name,range:dependency.range||dependency.version}};Plugin.versionParse=function(range){var pattern=/^\n|[\n~]?\t+\n\t+\n\t+(-[0-9A-Za-z-]+)?$/;if(!pattern.test(range)){Common.warn('Plugin.versionParse:',range,'is not a valid version or range.')}var identifiers=range.split('-');range=identifiers[0];var isRange=isNaN(Number(range[0])),version=isRange?range.substr(1):range,parts=Common.map(version.split('.'),function(part){return Number(part)});return{isRange:isRange,version:version,range:range,operator:isRange?range[0]:'',parts:parts,prerelease:identifiers[1],number:parts[0]*1e8+parts[1]*1e4+parts[2]}};Plugin.versionSatisfies=function(version,range){range=range||'*';var rangeParsed=Plugin.versionParse(range),rangeParts=rangeParsed.parts,versionParsed=Plugin.versionParse(version),versionParts=versionParsed.parts;if(rangeParsed.isRange){if(rangeParsed.operator==='*'||version==='*'){return true}if(rangeParsed.operator==='~'){return versionParts[0]===rangeParts[0]&&versionParts[1]===rangeParts[1]&&versionParts[2]>=rangeParts[2]}if(rangeParsed.operator==='^'){if(rangeParts[0]>0){return versionParts[0]===rangeParts[0]&&versionParsed.number>=rangeParsed.number}if(rangeParts[1]>0){return versionParts[1]===rangeParts[1]&&versionParts[2]>=rangeParts[2]}return versionParts[2]===rangeParts[2]}}return version===range||version==='*'}})()}),(function(module,exports,__webpack_require__){var World={};module.exports=World;var Composite=__webpack_require__(148);var Constraint=__webpack_require__(219);var Common=__webpack_require__(42);(function(){World.create=function(options){var composite=Composite.create();var defaults={label:'World',gravity:{x:0,y:1,scale:0.001},bounds:{min:{x:-Infinity,y:-Infinity},max:{x:Infinity,y:Infinity}}};return Common.extend(composite,defaults,options)}})()}),(function(module,exports,__webpack_require__){var Grid={};module.exports=Grid;var Pair=__webpack_require__(473);var Detector=__webpack_require__(515);var Common=__webpack_require__(42);(function(){Grid.create=function(options){var defaults={controller:Grid,detector:Detector.collisions,buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return Common.extend(defaults,options)};Grid.update=function(grid,bodies,engine,forceUpdate){var i,col,row,world=engine.world,buckets=grid.buckets,bucket,bucketId,gridChanged=false;var metrics=engine.metrics;metrics.broadphaseTests=0;for(i=0;i<bodies.length;i++){var body=bodies[i];if(body.isSleeping&&!forceUpdate)continue;if(body.bounds.max.x<world.bounds.min.x||body.bounds.min.x>world.bounds.max.x||body.bounds.max.y<world.bounds.min.y||body.bounds.min.y>world.bounds.max.y)continue;var newRegion=Grid._getRegion(grid,body);if(!body.region||newRegion.id!==body.region.id||forceUpdate){metrics.broadphaseTests+=1;if(!body.region||forceUpdate)body.region=newRegion;var union=Grid._regionUnion(newRegion,body.region);for(col=union.startCol;col<=union.endCol;col++){for(row=union.startRow;row<=union.endRow;row++){bucketId=Grid._getBucketId(col,row);bucket=buckets[bucketId];var isInsideNewRegion=(col>=newRegion.startCol&&col<=newRegion.endCol&&row>=newRegion.startRow&&row<=newRegion.endRow);var isInsideOldRegion=(col>=body.region.startCol&&col<=body.region.endCol&&row>=body.region.startRow&&row<=body.region.endRow);if(!isInsideNewRegion&&isInsideOldRegion){if(isInsideOldRegion){if(bucket)Grid._bucketRemoveBody(grid,bucket,body)}}if(body.region===newRegion||(isInsideNewRegion&&!isInsideOldRegion)||forceUpdate){if(!bucket)bucket=Grid._createBucket(buckets,bucketId);Grid._bucketAddBody(grid,bucket,body)}}}body.region=newRegion;gridChanged=true}}if(gridChanged)grid.pairsList=Grid._createActivePairsList(grid)};Grid.clear=function(grid){grid.buckets={};grid.pairs={};grid.pairsList=[]};Grid._regionUnion=function(regionA,regionB){var startCol=Math.min(regionA.startCol,regionB.startCol),endCol=Math.max(regionA.endCol,regionB.endCol),startRow=Math.min(regionA.startRow,regionB.startRow),endRow=Math.max(regionA.endRow,regionB.endRow);return Grid._createRegion(startCol,endCol,startRow,endRow)};Grid._getRegion=function(grid,body){var bounds=body.bounds,startCol=Math.floor(bounds.min.x/grid.bucketWidth),endCol=Math.floor(bounds.max.x/grid.bucketWidth),startRow=Math.floor(bounds.min.y/grid.bucketHeight),endRow=Math.floor(bounds.max.y/grid.bucketHeight);return Grid._createRegion(startCol,endCol,startRow,endRow)};Grid._createRegion=function(startCol,endCol,startRow,endRow){return{id:startCol+','+endCol+','+startRow+','+endRow,startCol:startCol,endCol:endCol,startRow:startRow,endRow:endRow}};Grid._getBucketId=function(column,row){return'C'+column+'R'+row};Grid._createBucket=function(buckets,bucketId){var bucket=buckets[bucketId]=[];return bucket};Grid._bucketAddBody=function(grid,bucket,body){for(var i=0;i<bucket.length;i++){var bodyB=bucket[i];if(body.id===bodyB.id||(body.isStatic&&bodyB.isStatic))continue;var pairId=Pair.id(body,bodyB),pair=grid.pairs[pairId];if(pair){pair[2]+=1}else{grid.pairs[pairId]=[body,bodyB,1]}}bucket.push(body)};Grid._bucketRemoveBody=function(grid,bucket,body){bucket.splice(bucket.indexOf(body),1);for(var i=0;i<bucket.length;i++){var bodyB=bucket[i],pairId=Pair.id(body,bodyB),pair=grid.pairs[pairId];if(pair)pair[2]-=1}};Grid._createActivePairsList=function(grid){var pairKeys,pair,pairs=[];pairKeys=Common.keys(grid.pairs);for(var k=0;k<pairKeys.length;k++){pair=grid.pairs[pairKeys[k]];if(pair[2]>0){pairs.push(pair)}else{delete grid.pairs[pairKeys[k]]}}return pairs}})()}),(function(module,exports,__webpack_require__){var Pairs={};module.exports=Pairs;var Pair=__webpack_require__(473);var Common=__webpack_require__(42);(function(){Pairs._pairMaxIdleLife=1000;Pairs.create=function(options){return Common.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},options)};Pairs.update=function(pairs,collisions,timestamp){var pairsList=pairs.list,pairsTable=pairs.table,collisionStart=pairs.collisionStart,collisionEnd=pairs.collisionEnd,collisionActive=pairs.collisionActive,collision,pairId,pair,i;collisionStart.length=0;collisionEnd.length=0;collisionActive.length=0;for(i=0;i<pairsList.length;i++){pairsList[i].confirmedActive=false}for(i=0;i<collisions.length;i++){collision=collisions[i];if(collision.collided){pairId=Pair.id(collision.bodyA,collision.bodyB);pair=pairsTable[pairId];if(pair){if(pair.isActive){collisionActive.push(pair)}else{collisionStart.push(pair)}Pair.update(pair,collision,timestamp);pair.confirmedActive=true}else{pair=Pair.create(collision,timestamp);pairsTable[pairId]=pair;collisionStart.push(pair);pairsList.push(pair)}}}for(i=0;i<pairsList.length;i++){pair=pairsList[i];if(pair.isActive&&!pair.confirmedActive){Pair.setActive(pair,false,timestamp);collisionEnd.push(pair)}}};Pairs.removeOld=function(pairs,timestamp){var pairsList=pairs.list,pairsTable=pairs.table,indexesToRemove=[],pair,collision,pairIndex,i;for(i=0;i<pairsList.length;i++){pair=pairsList[i];collision=pair.collision;if(collision.bodyA.isSleeping||collision.bodyB.isSleeping){pair.timeUpdated=timestamp;continue}if(timestamp-pair.timeUpdated>Pairs._pairMaxIdleLife){indexesToRemove.push(i)}}for(i=0;i<indexesToRemove.length;i++){pairIndex=indexesToRemove[i]-i;pair=pairsList[pairIndex];delete pairsTable[pair.id];pairsList.splice(pairIndex,1)}};Pairs.clear=function(pairs){pairs.table={};pairs.list.length=0;pairs.collisionStart.length=0;pairs.collisionActive.length=0;pairs.collisionEnd.length=0;return pairs}})()}),(function(module,exports,__webpack_require__){var Resolver={};module.exports=Resolver;var Vertices=__webpack_require__(86);var Vector=__webpack_require__(99);var Common=__webpack_require__(42);var Bounds=__webpack_require__(100);(function(){Resolver._restingThresh=4;Resolver._restingThreshTangent=6;Resolver._positionDampen=0.9;Resolver._positionWarming=0.8;Resolver._frictionNormalMultiplier=5;Resolver.preSolvePosition=function(pairs){var i,pair,activeCount;for(i=0;i<pairs.length;i++){pair=pairs[i];if(!pair.isActive)continue;activeCount=pair.activeContacts.length;pair.collision.parentA.totalContacts+=activeCount;pair.collision.parentB.totalContacts+=activeCount}};Resolver.solvePosition=function(pairs,bodies,timeScale){var i,normalX,normalY,pair,collision,bodyA,bodyB,normal,separation,penetration,positionImpulseA,positionImpulseB,contactShare,bodyBtoAX,bodyBtoAY,positionImpulse,impulseCoefficient=timeScale*Resolver._positionDampen;for(i=0;i<bodies.length;i++){var body=bodies[i];body.previousPositionImpulse.x=body.positionImpulse.x;body.previousPositionImpulse.y=body.positionImpulse.y}for(i=0;i<pairs.length;i++){pair=pairs[i];if(!pair.isActive||pair.isSensor)continue;collision=pair.collision;bodyA=collision.parentA;bodyB=collision.parentB;normal=collision.normal;positionImpulseA=bodyA.previousPositionImpulse;positionImpulseB=bodyB.previousPositionImpulse;penetration=collision.penetration;bodyBtoAX=positionImpulseB.x-positionImpulseA.x+penetration.x;bodyBtoAY=positionImpulseB.y-positionImpulseA.y+penetration.y;normalX=normal.x;normalY=normal.y;separation=normalX*bodyBtoAX+normalY*bodyBtoAY;pair.separation=separation;positionImpulse=(separation-pair.slop)*impulseCoefficient;if(bodyA.isStatic||bodyB.isStatic)positionImpulse*=2;if(!(bodyA.isStatic||bodyA.isSleeping)){contactShare=positionImpulse/bodyA.totalContacts;bodyA.positionImpulse.x+=normalX*contactShare;bodyA.positionImpulse.y+=normalY*contactShare}if(!(bodyB.isStatic||bodyB.isSleeping)){contactShare=positionImpulse/bodyB.totalContacts;bodyB.positionImpulse.x-=normalX*contactShare;bodyB.positionImpulse.y-=normalY*contactShare}}};Resolver.postSolvePosition=function(bodies){for(var i=0;i<bodies.length;i++){var body=bodies[i];body.totalContacts=0;if(body.positionImpulse.x!==0||body.positionImpulse.y!==0){for(var j=0;j<body.parts.length;j++){var part=body.parts[j];Vertices.translate(part.vertices,body.positionImpulse);Bounds.update(part.bounds,part.vertices,body.velocity);part.position.x+=body.positionImpulse.x;part.position.y+=body.positionImpulse.y}body.positionPrev.x+=body.positionImpulse.x;body.positionPrev.y+=body.positionImpulse.y;if(Vector.dot(body.positionImpulse,body.velocity)<0){body.positionImpulse.x=0;body.positionImpulse.y=0}else{body.positionImpulse.x*=Resolver._positionWarming;body.positionImpulse.y*=Resolver._positionWarming}}}};Resolver.preSolveVelocity=function(pairs){var i,j,pair,contacts,collision,bodyA,bodyB,normal,tangent,contact,contactVertex,normalImpulse,tangentImpulse,offset,impulse=Vector._temp[0],tempA=Vector._temp[1];for(i=0;i<pairs.length;i++){pair=pairs[i];if(!pair.isActive||pair.isSensor)continue;contacts=pair.activeContacts;collision=pair.collision;bodyA=collision.parentA;bodyB=collision.parentB;normal=collision.normal;tangent=collision.tangent;for(j=0;j<contacts.length;j++){contact=contacts[j];contactVertex=contact.vertex;normalImpulse=contact.normalImpulse;tangentImpulse=contact.tangentImpulse;if(normalImpulse!==0||tangentImpulse!==0){impulse.x=(normal.x*normalImpulse)+(tangent.x*tangentImpulse);impulse.y=(normal.y*normalImpulse)+(tangent.y*tangentImpulse);if(!(bodyA.isStatic||bodyA.isSleeping)){offset=Vector.sub(contactVertex,bodyA.position,tempA);bodyA.positionPrev.x+=impulse.x*bodyA.inverseMass;bodyA.positionPrev.y+=impulse.y*bodyA.inverseMass;bodyA.anglePrev+=Vector.cross(offset,impulse)*bodyA.inverseInertia}if(!(bodyB.isStatic||bodyB.isSleeping)){offset=Vector.sub(contactVertex,bodyB.position,tempA);bodyB.positionPrev.x-=impulse.x*bodyB.inverseMass;bodyB.positionPrev.y-=impulse.y*bodyB.inverseMass;bodyB.anglePrev-=Vector.cross(offset,impulse)*bodyB.inverseInertia}}}}};Resolver.solveVelocity=function(pairs,timeScale){var timeScaleSquared=timeScale*timeScale,impulse=Vector._temp[0],tempA=Vector._temp[1],tempB=Vector._temp[2],tempC=Vector._temp[3],tempD=Vector._temp[4],tempE=Vector._temp[5];for(var i=0;i<pairs.length;i++){var pair=pairs[i];if(!pair.isActive||pair.isSensor)continue;var collision=pair.collision,bodyA=collision.parentA,bodyB=collision.parentB,normal=collision.normal,tangent=collision.tangent,contacts=pair.activeContacts,contactShare=1/contacts.length;bodyA.velocity.x=bodyA.position.x-bodyA.positionPrev.x;bodyA.velocity.y=bodyA.position.y-bodyA.positionPrev.y;bodyB.velocity.x=bodyB.position.x-bodyB.positionPrev.x;bodyB.velocity.y=bodyB.position.y-bodyB.positionPrev.y;bodyA.angularVelocity=bodyA.angle-bodyA.anglePrev;bodyB.angularVelocity=bodyB.angle-bodyB.anglePrev;for(var j=0;j<contacts.length;j++){var contact=contacts[j],contactVertex=contact.vertex,offsetA=Vector.sub(contactVertex,bodyA.position,tempA),offsetB=Vector.sub(contactVertex,bodyB.position,tempB),velocityPointA=Vector.add(bodyA.velocity,Vector.mult(Vector.perp(offsetA),bodyA.angularVelocity),tempC),velocityPointB=Vector.add(bodyB.velocity,Vector.mult(Vector.perp(offsetB),bodyB.angularVelocity),tempD),relativeVelocity=Vector.sub(velocityPointA,velocityPointB,tempE),normalVelocity=Vector.dot(normal,relativeVelocity);var tangentVelocity=Vector.dot(tangent,relativeVelocity),tangentSpeed=Math.abs(tangentVelocity),tangentVelocityDirection=Common.sign(tangentVelocity);var normalImpulse=(1+pair.restitution)*normalVelocity,normalForce=Common.clamp(pair.separation+normalVelocity,0,1)*Resolver._frictionNormalMultiplier;var tangentImpulse=tangentVelocity,maxFriction=Infinity;if(tangentSpeed>pair.friction*pair.frictionStatic*normalForce*timeScaleSquared){maxFriction=tangentSpeed;tangentImpulse=Common.clamp(pair.friction*tangentVelocityDirection*timeScaleSquared,-maxFriction,maxFriction)}var oAcN=Vector.cross(offsetA,normal),oBcN=Vector.cross(offsetB,normal),share=contactShare/(bodyA.inverseMass+bodyB.inverseMass+bodyA.inverseInertia*oAcN*oAcN+bodyB.inverseInertia*oBcN*oBcN);normalImpulse*=share;tangentImpulse*=share;if(normalVelocity<0&&normalVelocity*normalVelocity>Resolver._restingThresh*timeScaleSquared){contact.normalImpulse=0}else{var contactNormalImpulse=contact.normalImpulse;contact.normalImpulse=Math.min(contact.normalImpulse+normalImpulse,0);normalImpulse=contact.normalImpulse-contactNormalImpulse}if(tangentVelocity*tangentVelocity>Resolver._restingThreshTangent*timeScaleSquared){contact.tangentImpulse=0}else{var contactTangentImpulse=contact.tangentImpulse;contact.tangentImpulse=Common.clamp(contact.tangentImpulse+tangentImpulse,-maxFriction,maxFriction);tangentImpulse=contact.tangentImpulse-contactTangentImpulse}impulse.x=(normal.x*normalImpulse)+(tangent.x*tangentImpulse);impulse.y=(normal.y*normalImpulse)+(tangent.y*tangentImpulse);if(!(bodyA.isStatic||bodyA.isSleeping)){bodyA.positionPrev.x+=impulse.x*bodyA.inverseMass;bodyA.positionPrev.y+=impulse.y*bodyA.inverseMass;bodyA.anglePrev+=Vector.cross(offsetA,impulse)*bodyA.inverseInertia}if(!(bodyB.isStatic||bodyB.isSleeping)){bodyB.positionPrev.x-=impulse.x*bodyB.inverseMass;bodyB.positionPrev.y-=impulse.y*bodyB.inverseMass;bodyB.anglePrev-=Vector.cross(offsetB,impulse)*bodyB.inverseInertia}}}}})()}),(function(module,exports,__webpack_require__){module.exports={BasePlugin:__webpack_require__(474),DefaultPlugins:__webpack_require__(175),PluginCache:__webpack_require__(23),PluginManager:__webpack_require__(370),ScenePlugin:__webpack_require__(1305)}}),(function(module,exports,__webpack_require__){var BasePlugin=__webpack_require__(474);var Class=__webpack_require__(0);var SceneEvents=__webpack_require__(22);var ScenePlugin=new Class({Extends:BasePlugin,initialize:function ScenePlugin(scene,pluginManager){BasePlugin.call(this,pluginManager);this.scene=scene;this.systems=scene.sys;scene.sys.events.once(SceneEvents.BOOT,this.boot,this)},boot:function(){},destroy:function(){this.pluginManager=null;this.game=null;this.scene=null;this.systems=null}});module.exports=ScenePlugin}),(function(module,exports,__webpack_require__){var Extend=__webpack_require__(18);var CONST=__webpack_require__(177);var Scale={Center:__webpack_require__(359),Events:__webpack_require__(92),Orientation:__webpack_require__(360),ScaleManager:__webpack_require__(371),ScaleModes:__webpack_require__(361),Zoom:__webpack_require__(362)};Scale=Extend(false,Scale,CONST.CENTER);Scale=Extend(false,Scale,CONST.ORIENTATION);Scale=Extend(false,Scale,CONST.SCALE_MODE);Scale=Extend(false,Scale,CONST.ZOOM);module.exports=Scale}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(125);var Extend=__webpack_require__(18);var Scene={Events:__webpack_require__(22),SceneManager:__webpack_require__(373),ScenePlugin:__webpack_require__(1308),Settings:__webpack_require__(375),Systems:__webpack_require__(180)};Scene=Extend(false,Scene,CONST);module.exports=Scene}),(function(module,exports,__webpack_require__){var Clamp=__webpack_require__(19);var Class=__webpack_require__(0);var Events=__webpack_require__(22);var GetFastValue=__webpack_require__(2);var PluginCache=__webpack_require__(23);var ScenePlugin=new Class({initialize:function ScenePlugin(scene){this.scene=scene;this.systems=scene.sys;this.settings=scene.sys.settings;this.key=scene.sys.settings.key;this.manager=scene.sys.game.scene;this.transitionProgress=0;this._elapsed=0;this._target=null;this._duration=0;this._onUpdate;this._onUpdateScope;this._willSleep=false;this._willRemove=false;scene.sys.events.once(Events.BOOT,this.boot,this);scene.sys.events.on(Events.START,this.pluginStart,this)},boot:function(){this.systems.events.once(Events.DESTROY,this.destroy,this)},pluginStart:function(){this._target=null;this.systems.events.once(Events.SHUTDOWN,this.shutdown,this)},start:function(key,data){if(key===undefined){key=this.key}this.manager.queueOp('stop',this.key);this.manager.queueOp('start',key,data);return this},restart:function(data){var key=this.key;this.manager.queueOp('stop',key);this.manager.queueOp('start',key,data);return this},transition:function(config){if(config===undefined){config={}}var key=GetFastValue(config,'target',false);var target=this.manager.getScene(key);if(!key||!this.checkValidTransition(target)){return false}var duration=GetFastValue(config,'duration',1000);this._elapsed=0;this._target=target;this._duration=duration;this._willSleep=GetFastValue(config,'sleep',false);this._willRemove=GetFastValue(config,'remove',false);var callback=GetFastValue(config,'onUpdate',null);if(callback){this._onUpdate=callback;this._onUpdateScope=GetFastValue(config,'onUpdateScope',this.scene)}var allowInput=GetFastValue(config,'allowInput',false);this.settings.transitionAllowInput=allowInput;var targetSettings=target.sys.settings;targetSettings.isTransition=true;targetSettings.transitionFrom=this.scene;targetSettings.transitionDuration=duration;targetSettings.transitionAllowInput=allowInput;if(GetFastValue(config,'moveAbove',false)){this.manager.moveAbove(this.key,key)}else if(GetFastValue(config,'moveBelow',false)){this.manager.moveBelow(this.key,key)}if(target.sys.isSleeping()){target.sys.wake(GetFastValue(config,'data'))}else{this.manager.start(key,GetFastValue(config,'data'))}this.systems.events.emit(Events.TRANSITION_OUT,target,duration);this.systems.events.on(Events.UPDATE,this.step,this);return true},checkValidTransition:function(target){if(!target||target.sys.isActive()||target.sys.isTransitioning()||target===this.scene||this.systems.isTransitioning()){return false}return true},step:function(time,delta){this._elapsed+=delta;this.transitionProgress=Clamp(this._elapsed/this._duration,0,1);if(this._onUpdate){this._onUpdate.call(this._onUpdateScope,this.transitionProgress)}if(this._elapsed>=this._duration){this.transitionComplete()}},transitionComplete:function(){var targetSys=this._target.sys;var targetSettings=this._target.sys.settings;this.systems.events.off(Events.UPDATE,this.step,this);targetSys.events.emit(Events.TRANSITION_COMPLETE,this.scene);targetSettings.isTransition=false;targetSettings.transitionFrom=null;this._duration=0;this._target=null;this._onUpdate=null;this._onUpdateScope=null;if(this._willRemove){this.manager.remove(this.key)}else if(this._willSleep){this.systems.sleep()}else{this.manager.stop(this.key)}},add:function(key,sceneConfig,autoStart,data){return this.manager.add(key,sceneConfig,autoStart,data)},launch:function(key,data){if(key&&key!==this.key){this.manager.queueOp('start',key,data)}return this},run:function(key,data){if(key&&key!==this.key){this.manager.queueOp('run',key,data)}return this},pause:function(key,data){if(key===undefined){key=this.key}this.manager.queueOp('pause',key,data);return this},resume:function(key,data){if(key===undefined){key=this.key}this.manager.queueOp('resume',key,data);return this},sleep:function(key,data){if(key===undefined){key=this.key}this.manager.queueOp('sleep',key,data);return this},wake:function(key,data){if(key===undefined){key=this.key}this.manager.queueOp('wake',key,data);return this},switch:function(key){if(key!==this.key){this.manager.queueOp('switch',this.key,key)}return this},stop:function(key,data){if(key===undefined){key=this.key}this.manager.queueOp('stop',key,data);return this},setActive:function(value,key,data){if(key===undefined){key=this.key}var scene=this.manager.getScene(key);if(scene){scene.sys.setActive(value,data)}return this},setVisible:function(value,key){if(key===undefined){key=this.key}var scene=this.manager.getScene(key);if(scene){scene.sys.setVisible(value)}return this},isSleeping:function(key){if(key===undefined){key=this.key}return this.manager.isSleeping(key)},isActive:function(key){if(key===undefined){key=this.key}return this.manager.isActive(key)},isPaused:function(key){if(key===undefined){key=this.key}return this.manager.isPaused(key)},isVisible:function(key){if(key===undefined){key=this.key}return this.manager.isVisible(key)},swapPosition:function(keyA,keyB){if(keyB===undefined){keyB=this.key}if(keyA!==keyB){this.manager.swapPosition(keyA,keyB)}return this},moveAbove:function(keyA,keyB){if(keyB===undefined){keyB=this.key}if(keyA!==keyB){this.manager.moveAbove(keyA,keyB)}return this},moveBelow:function(keyA,keyB){if(keyB===undefined){keyB=this.key}if(keyA!==keyB){this.manager.moveBelow(keyA,keyB)}return this},remove:function(key){if(key===undefined){key=this.key}this.manager.remove(key);return this},moveUp:function(key){if(key===undefined){key=this.key}this.manager.moveUp(key);return this},moveDown:function(key){if(key===undefined){key=this.key}this.manager.moveDown(key);return this},bringToTop:function(key){if(key===undefined){key=this.key}this.manager.bringToTop(key);return this},sendToBack:function(key){if(key===undefined){key=this.key}this.manager.sendToBack(key);return this},get:function(key){return this.manager.getScene(key)},getIndex:function(key){if(key===undefined){key=this.key}return this.manager.getIndex(key)},shutdown:function(){var eventEmitter=this.systems.events;eventEmitter.off(Events.SHUTDOWN,this.shutdown,this);eventEmitter.off(Events.POST_UPDATE,this.step,this);eventEmitter.off(Events.TRANSITION_OUT)},destroy:function(){this.shutdown();this.scene.sys.events.off(Events.START,this.start,this);this.scene=null;this.systems=null;this.settings=null;this.manager=null}});PluginCache.register('ScenePlugin',ScenePlugin,'scenePlugin');module.exports=ScenePlugin}),(function(module,exports,__webpack_require__){module.exports={List:__webpack_require__(129),Map:__webpack_require__(162),ProcessQueue:__webpack_require__(186),RTree:__webpack_require__(470),Set:__webpack_require__(133),Size:__webpack_require__(372)}}),(function(module,exports,__webpack_require__){var Extend=__webpack_require__(18);var FilterMode=__webpack_require__(1311);var Textures={CanvasTexture:__webpack_require__(377),Events:__webpack_require__(121),FilterMode:FilterMode,Frame:__webpack_require__(94),Parsers:__webpack_require__(379),Texture:__webpack_require__(182),TextureManager:__webpack_require__(376),TextureSource:__webpack_require__(378)};Textures=Extend(false,Textures,FilterMode);module.exports=Textures}),(function(module,exports){var CONST={LINEAR:0,NEAREST:1};module.exports=CONST}),(function(module,exports,__webpack_require__){module.exports={Components:__webpack_require__(141),Parsers:__webpack_require__(1342),Formats:__webpack_require__(32),ImageCollection:__webpack_require__(485),ParseToTilemap:__webpack_require__(227),Tile:__webpack_require__(74),Tilemap:__webpack_require__(494),TilemapCreator:__webpack_require__(1351),TilemapFactory:__webpack_require__(1352),Tileset:__webpack_require__(104),LayerData:__webpack_require__(102),MapData:__webpack_require__(103),ObjectLayer:__webpack_require__(488),DynamicTilemapLayer:__webpack_require__(495),StaticTilemapLayer:__webpack_require__(496)}}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var CalculateFacesWithin=__webpack_require__(51);var Copy=function(srcTileX,srcTileY,width,height,destTileX,destTileY,recalculateFaces,layer){if(srcTileX<0){srcTileX=0}if(srcTileY<0){srcTileY=0}if(recalculateFaces===undefined){recalculateFaces=true}var srcTiles=GetTilesWithin(srcTileX,srcTileY,width,height,null,layer);var offsetX=destTileX-srcTileX;var offsetY=destTileY-srcTileY;for(var i=0;i<srcTiles.length;i++){var tileX=srcTiles[i].x+offsetX;var tileY=srcTiles[i].y+offsetY;if(tileX>=0&&tileX<layer.width&&tileY>=0&&tileY<layer.height){if(layer.data[tileY][tileX]){layer.data[tileY][tileX].copy(srcTiles[i])}}}if(recalculateFaces){CalculateFacesWithin(destTileX-1,destTileY-1,width+2,height+2,layer)}};module.exports=Copy}),(function(module,exports,__webpack_require__){var TileToWorldX=__webpack_require__(143);var TileToWorldY=__webpack_require__(144);var GetTilesWithin=__webpack_require__(24);var ReplaceByIndex=__webpack_require__(475);var CreateFromTiles=function(indexes,replacements,spriteConfig,scene,camera,layer){if(spriteConfig===undefined){spriteConfig={}}if(!Array.isArray(indexes)){indexes=[indexes]}var tilemapLayer=layer.tilemapLayer;if(scene===undefined){scene=tilemapLayer.scene}if(camera===undefined){camera=scene.cameras.main}var tiles=GetTilesWithin(0,0,layer.width,layer.height,null,layer);var sprites=[];var i;for(i=0;i<tiles.length;i++){var tile=tiles[i];if(indexes.indexOf(tile.index)!==-1){spriteConfig.x=TileToWorldX(tile.x,camera,layer);spriteConfig.y=TileToWorldY(tile.y,camera,layer);var sprite=scene.make.sprite(spriteConfig);sprites.push(sprite)}}if(typeof replacements==='number'){for(i=0;i<indexes.length;i++){ReplaceByIndex(indexes[i],replacements,0,0,layer.width,layer.height,layer)}}else if(Array.isArray(replacements)){for(i=0;i<indexes.length;i++){ReplaceByIndex(indexes[i],replacements[i],0,0,layer.width,layer.height,layer)}}return sprites};module.exports=CreateFromTiles}),(function(module,exports,__webpack_require__){var SnapFloor=__webpack_require__(93);var SnapCeil=__webpack_require__(330);var CullTiles=function(layer,camera,outputArray,renderOrder){if(outputArray===undefined){outputArray=[]}if(renderOrder===undefined){renderOrder=0}outputArray.length=0;var tilemap=layer.tilemapLayer.tilemap;var tilemapLayer=layer.tilemapLayer;var mapData=layer.data;var mapWidth=layer.width;var mapHeight=layer.height;var tileW=Math.floor(tilemap.tileWidth*tilemapLayer.scaleX);var tileH=Math.floor(tilemap.tileHeight*tilemapLayer.scaleY);var drawLeft=0;var drawRight=mapWidth;var drawTop=0;var drawBottom=mapHeight;if(!tilemapLayer.skipCull&&tilemapLayer.scrollFactorX===1&&tilemapLayer.scrollFactorY===1){var boundsLeft=SnapFloor(camera.worldView.x-tilemapLayer.x,tileW,0,true)-tilemapLayer.cullPaddingX;var boundsRight=SnapCeil(camera.worldView.right-tilemapLayer.x,tileW,0,true)+tilemapLayer.cullPaddingX;var boundsTop=SnapFloor(camera.worldView.y-tilemapLayer.y,tileH,0,true)-tilemapLayer.cullPaddingY;var boundsBottom=SnapCeil(camera.worldView.bottom-tilemapLayer.y,tileH,0,true)+tilemapLayer.cullPaddingY;drawLeft=Math.max(0,boundsLeft);drawRight=Math.min(mapWidth,boundsRight);drawTop=Math.max(0,boundsTop);drawBottom=Math.min(mapHeight,boundsBottom)}var x;var y;var tile;if(renderOrder===0){for(y=drawTop;y<drawBottom;y++){for(x=drawLeft;mapData[y]&&x<drawRight;x++){tile=mapData[y][x];if(!tile||tile.index===-1||!tile.visible||tile.alpha===0){continue}outputArray.push(tile)}}}else if(renderOrder===1){for(y=drawTop;y<drawBottom;y++){for(x=drawRight;mapData[y]&&x>=drawLeft;x--){tile=mapData[y][x];if(!tile||tile.index===-1||!tile.visible||tile.alpha===0){continue}outputArray.push(tile)}}}else if(renderOrder===2){for(y=drawBottom;y>=drawTop;y--){for(x=drawLeft;mapData[y]&&x<drawRight;x++){tile=mapData[y][x];if(!tile||tile.index===-1||!tile.visible||tile.alpha===0){continue}outputArray.push(tile)}}}else if(renderOrder===3){for(y=drawBottom;y>=drawTop;y--){for(x=drawRight;mapData[y]&&x>=drawLeft;x--){tile=mapData[y][x];if(!tile||tile.index===-1||!tile.visible||tile.alpha===0){continue}outputArray.push(tile)}}}tilemapLayer.tilesDrawn=outputArray.length;tilemapLayer.tilesTotal=mapWidth*mapHeight;return outputArray};module.exports=CullTiles}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var CalculateFacesWithin=__webpack_require__(51);var SetTileCollision=__webpack_require__(73);var Fill=function(index,tileX,tileY,width,height,recalculateFaces,layer){var doesIndexCollide=(layer.collideIndexes.indexOf(index)!==-1);var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);for(var i=0;i<tiles.length;i++){tiles[i].index=index;SetTileCollision(tiles[i],doesIndexCollide)}if(recalculateFaces){CalculateFacesWithin(tileX-1,tileY-1,width+2,height+2,layer)}};module.exports=Fill}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var FilterTiles=function(callback,context,tileX,tileY,width,height,filteringOptions,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,filteringOptions,layer);return tiles.filter(callback,context)};module.exports=FilterTiles}),(function(module,exports){var FindByIndex=function(findIndex,skip,reverse,layer){if(skip===undefined){skip=0}if(reverse===undefined){reverse=false}var count=0;var tx;var ty;var tile;if(reverse){for(ty=layer.height-1;ty>=0;ty--){for(tx=layer.width-1;tx>=0;tx--){tile=layer.data[ty][tx];if(tile&&tile.index===findIndex){if(count===skip){return tile}else{count+=1}}}}}else{for(ty=0;ty<layer.height;ty++){for(tx=0;tx<layer.width;tx++){tile=layer.data[ty][tx];if(tile&&tile.index===findIndex){if(count===skip){return tile}else{count+=1}}}}}return null};module.exports=FindByIndex}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var FindTile=function(callback,context,tileX,tileY,width,height,filteringOptions,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,filteringOptions,layer);return tiles.find(callback,context)||null};module.exports=FindTile}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var ForEachTile=function(callback,context,tileX,tileY,width,height,filteringOptions,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,filteringOptions,layer);tiles.forEach(callback,context)};module.exports=ForEachTile}),(function(module,exports,__webpack_require__){var GetTileAt=__webpack_require__(142);var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var GetTileAtWorldXY=function(worldX,worldY,nonNull,camera,layer){var tileX=WorldToTileX(worldX,true,camera,layer);var tileY=WorldToTileY(worldY,true,camera,layer);return GetTileAt(tileX,tileY,nonNull,layer)};module.exports=GetTileAtWorldXY}),(function(module,exports,__webpack_require__){var Geom=__webpack_require__(430);var GetTilesWithin=__webpack_require__(24);var Intersects=__webpack_require__(431);var NOOP=__webpack_require__(1);var TileToWorldX=__webpack_require__(143);var TileToWorldY=__webpack_require__(144);var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var TriangleToRectangle=function(triangle,rect){return Intersects.RectangleToTriangle(rect,triangle)};var GetTilesWithinShape=function(shape,filteringOptions,camera,layer){if(shape===undefined){return[]}var intersectTest=NOOP;if(shape instanceof Geom.Circle){intersectTest=Intersects.CircleToRectangle}else if(shape instanceof Geom.Rectangle){intersectTest=Intersects.RectangleToRectangle}else if(shape instanceof Geom.Triangle){intersectTest=TriangleToRectangle}else if(shape instanceof Geom.Line){intersectTest=Intersects.LineToRectangle}var xStart=WorldToTileX(shape.left,true,camera,layer);var yStart=WorldToTileY(shape.top,true,camera,layer);var xEnd=Math.ceil(WorldToTileX(shape.right,false,camera,layer));var yEnd=Math.ceil(WorldToTileY(shape.bottom,false,camera,layer));var width=Math.max(xEnd-xStart,1);var height=Math.max(yEnd-yStart,1);var tiles=GetTilesWithin(xStart,yStart,width,height,filteringOptions,layer);var tileWidth=layer.tileWidth;var tileHeight=layer.tileHeight;if(layer.tilemapLayer){tileWidth*=layer.tilemapLayer.scaleX;tileHeight*=layer.tilemapLayer.scaleY}var results=[];var tileRect=new Geom.Rectangle(0,0,tileWidth,tileHeight);for(var i=0;i<tiles.length;i++){var tile=tiles[i];tileRect.x=TileToWorldX(tile.x,camera,layer);tileRect.y=TileToWorldY(tile.y,camera,layer);if(intersectTest(shape,tileRect)){results.push(tile)}}return results};module.exports=GetTilesWithinShape}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var GetTilesWithinWorldXY=function(worldX,worldY,width,height,filteringOptions,camera,layer){var xStart=WorldToTileX(worldX,true,camera,layer);var yStart=WorldToTileY(worldY,true,camera,layer);var xEnd=Math.ceil(WorldToTileX(worldX+width,false,camera,layer));var yEnd=Math.ceil(WorldToTileY(worldY+height,false,camera,layer));return GetTilesWithin(xStart,yStart,xEnd-xStart,yEnd-yStart,filteringOptions,layer)};module.exports=GetTilesWithinWorldXY}),(function(module,exports,__webpack_require__){var HasTileAt=__webpack_require__(476);var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var HasTileAtWorldXY=function(worldX,worldY,camera,layer){var tileX=WorldToTileX(worldX,true,camera,layer);var tileY=WorldToTileY(worldY,true,camera,layer);return HasTileAt(tileX,tileY,layer)};module.exports=HasTileAtWorldXY}),(function(module,exports,__webpack_require__){var PutTileAt=__webpack_require__(221);var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var PutTileAtWorldXY=function(tile,worldX,worldY,recalculateFaces,camera,layer){var tileX=WorldToTileX(worldX,true,camera,layer);var tileY=WorldToTileY(worldY,true,camera,layer);return PutTileAt(tile,tileX,tileY,recalculateFaces,layer)};module.exports=PutTileAtWorldXY}),(function(module,exports,__webpack_require__){var CalculateFacesWithin=__webpack_require__(51);var PutTileAt=__webpack_require__(221);var PutTilesAt=function(tilesArray,tileX,tileY,recalculateFaces,layer){if(!Array.isArray(tilesArray)){return null}if(recalculateFaces===undefined){recalculateFaces=true}if(!Array.isArray(tilesArray[0])){tilesArray=[tilesArray]}var height=tilesArray.length;var width=tilesArray[0].length;for(var ty=0;ty<height;ty++){for(var tx=0;tx<width;tx++){var tile=tilesArray[ty][tx];PutTileAt(tile,tileX+tx,tileY+ty,false,layer)}}if(recalculateFaces){CalculateFacesWithin(tileX-1,tileY-1,width+2,height+2,layer)}};module.exports=PutTilesAt}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var GetRandom=__webpack_require__(185);var Randomize=function(tileX,tileY,width,height,indexes,layer){var i;var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);if(indexes===undefined){indexes=[];for(i=0;i<tiles.length;i++){if(indexes.indexOf(tiles[i].index)===-1){indexes.push(tiles[i].index)}}}for(i=0;i<tiles.length;i++){tiles[i].index=GetRandom(indexes)}};module.exports=Randomize}),(function(module,exports,__webpack_require__){var RemoveTileAt=__webpack_require__(477);var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var RemoveTileAtWorldXY=function(worldX,worldY,replaceWithNull,recalculateFaces,camera,layer){var tileX=WorldToTileX(worldX,true,camera,layer);var tileY=WorldToTileY(worldY,true,camera,layer);return RemoveTileAt(tileX,tileY,replaceWithNull,recalculateFaces,layer)};module.exports=RemoveTileAtWorldXY}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var Color=__webpack_require__(354);var defaultTileColor=new Color(105,210,231,150);var defaultCollidingTileColor=new Color(243,134,48,200);var defaultFaceColor=new Color(40,39,37,150);var RenderDebug=function(graphics,styleConfig,layer){if(styleConfig===undefined){styleConfig={}}var tileColor=(styleConfig.tileColor!==undefined)?styleConfig.tileColor:defaultTileColor;var collidingTileColor=(styleConfig.collidingTileColor!==undefined)?styleConfig.collidingTileColor:defaultCollidingTileColor;var faceColor=(styleConfig.faceColor!==undefined)?styleConfig.faceColor:defaultFaceColor;var tiles=GetTilesWithin(0,0,layer.width,layer.height,null,layer);graphics.translateCanvas(layer.tilemapLayer.x,layer.tilemapLayer.y);graphics.scaleCanvas(layer.tilemapLayer.scaleX,layer.tilemapLayer.scaleY);for(var i=0;i<tiles.length;i++){var tile=tiles[i];var tw=tile.width;var th=tile.height;var x=tile.pixelX;var y=tile.pixelY;var color=tile.collides?collidingTileColor:tileColor;if(color!==null){graphics.fillStyle(color.color,color.alpha/255);graphics.fillRect(x,y,tw,th)}x+=1;y+=1;tw-=2;th-=2;if(faceColor!==null){graphics.lineStyle(1,faceColor.color,faceColor.alpha/255);if(tile.faceTop){graphics.lineBetween(x,y,x+tw,y)}if(tile.faceRight){graphics.lineBetween(x+tw,y,x+tw,y+th)}if(tile.faceBottom){graphics.lineBetween(x,y+th,x+tw,y+th)}if(tile.faceLeft){graphics.lineBetween(x,y,x,y+th)}}}};module.exports=RenderDebug}),(function(module,exports,__webpack_require__){var SetTileCollision=__webpack_require__(73);var CalculateFacesWithin=__webpack_require__(51);var SetLayerCollisionIndex=__webpack_require__(222);var SetCollision=function(indexes,collides,recalculateFaces,layer,updateLayer){if(collides===undefined){collides=true}if(recalculateFaces===undefined){recalculateFaces=true}if(!Array.isArray(indexes)){indexes=[indexes]}if(updateLayer===undefined){updateLayer=true}for(var i=0;i<indexes.length;i++){SetLayerCollisionIndex(indexes[i],collides,layer)}if(updateLayer){for(var ty=0;ty<layer.height;ty++){for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];if(tile&&indexes.indexOf(tile.index)!==-1){SetTileCollision(tile,collides)}}}}if(recalculateFaces){CalculateFacesWithin(0,0,layer.width,layer.height,layer)}};module.exports=SetCollision}),(function(module,exports,__webpack_require__){var SetTileCollision=__webpack_require__(73);var CalculateFacesWithin=__webpack_require__(51);var SetLayerCollisionIndex=__webpack_require__(222);var SetCollisionBetween=function(start,stop,collides,recalculateFaces,layer,updateLayer){if(collides===undefined){collides=true}if(recalculateFaces===undefined){recalculateFaces=true}if(updateLayer===undefined){updateLayer=true}if(start>stop){return}for(var index=start;index<=stop;index++){SetLayerCollisionIndex(index,collides,layer)}if(updateLayer){for(var ty=0;ty<layer.height;ty++){for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];if(tile){if(tile.index>=start&&tile.index<=stop){SetTileCollision(tile,collides)}}}}}if(recalculateFaces){CalculateFacesWithin(0,0,layer.width,layer.height,layer)}};module.exports=SetCollisionBetween}),(function(module,exports,__webpack_require__){var SetTileCollision=__webpack_require__(73);var CalculateFacesWithin=__webpack_require__(51);var SetLayerCollisionIndex=__webpack_require__(222);var SetCollisionByExclusion=function(indexes,collides,recalculateFaces,layer){if(collides===undefined){collides=true}if(recalculateFaces===undefined){recalculateFaces=true}if(!Array.isArray(indexes)){indexes=[indexes]}for(var ty=0;ty<layer.height;ty++){for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];if(tile&&indexes.indexOf(tile.index)===-1){SetTileCollision(tile,collides);SetLayerCollisionIndex(tile.index,collides,layer)}}}if(recalculateFaces){CalculateFacesWithin(0,0,layer.width,layer.height,layer)}};module.exports=SetCollisionByExclusion}),(function(module,exports,__webpack_require__){var SetTileCollision=__webpack_require__(73);var CalculateFacesWithin=__webpack_require__(51);var HasValue=__webpack_require__(108);var SetCollisionByProperty=function(properties,collides,recalculateFaces,layer){if(collides===undefined){collides=true}if(recalculateFaces===undefined){recalculateFaces=true}for(var ty=0;ty<layer.height;ty++){for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];if(!tile){continue}for(var property in properties){if(!HasValue(tile.properties,property)){continue}var values=properties[property];if(!Array.isArray(values)){values=[values]}for(var i=0;i<values.length;i++){if(tile.properties[property]===values[i]){SetTileCollision(tile,collides)}}}}}if(recalculateFaces){CalculateFacesWithin(0,0,layer.width,layer.height,layer)}};module.exports=SetCollisionByProperty}),(function(module,exports,__webpack_require__){var SetTileCollision=__webpack_require__(73);var CalculateFacesWithin=__webpack_require__(51);var SetCollisionFromCollisionGroup=function(collides,recalculateFaces,layer){if(collides===undefined){collides=true}if(recalculateFaces===undefined){recalculateFaces=true}for(var ty=0;ty<layer.height;ty++){for(var tx=0;tx<layer.width;tx++){var tile=layer.data[ty][tx];if(!tile){continue}var collisionGroup=tile.getCollisionGroup();if(collisionGroup&&collisionGroup.objects&&collisionGroup.objects.length>0){SetTileCollision(tile,collides)}}}if(recalculateFaces){CalculateFacesWithin(0,0,layer.width,layer.height,layer)}};module.exports=SetCollisionFromCollisionGroup}),(function(module,exports){var SetTileIndexCallback=function(indexes,callback,callbackContext,layer){if(typeof indexes==='number'){layer.callbacks[indexes]=(callback!==null)?{callback:callback,callbackContext:callbackContext}:undefined}else{for(var i=0,len=indexes.length;i<len;i++){layer.callbacks[indexes[i]]=(callback!==null)?{callback:callback,callbackContext:callbackContext}:undefined}}};module.exports=SetTileIndexCallback}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var SetTileLocationCallback=function(tileX,tileY,width,height,callback,callbackContext,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);for(var i=0;i<tiles.length;i++){tiles[i].setCollisionCallback(callback,callbackContext)}};module.exports=SetTileLocationCallback}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var ShuffleArray=__webpack_require__(114);var Shuffle=function(tileX,tileY,width,height,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);var indexes=tiles.map(function(tile){return tile.index});ShuffleArray(indexes);for(var i=0;i<tiles.length;i++){tiles[i].index=indexes[i]}};module.exports=Shuffle}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var SwapByIndex=function(indexA,indexB,tileX,tileY,width,height,layer){var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);for(var i=0;i<tiles.length;i++){if(tiles[i]){if(tiles[i].index===indexA){tiles[i].index=indexB}else if(tiles[i].index===indexB){tiles[i].index=indexA}}}};module.exports=SwapByIndex}),(function(module,exports,__webpack_require__){var TileToWorldX=__webpack_require__(143);var TileToWorldY=__webpack_require__(144);var Vector2=__webpack_require__(3);var TileToWorldXY=function(tileX,tileY,point,camera,layer){if(point===undefined){point=new Vector2(0,0)}point.x=TileToWorldX(tileX,camera,layer);point.y=TileToWorldY(tileY,camera,layer);return point};module.exports=TileToWorldXY}),(function(module,exports,__webpack_require__){var GetTilesWithin=__webpack_require__(24);var WeightedRandomize=function(tileX,tileY,width,height,weightedIndexes,layer){if(weightedIndexes===undefined){return}var i;var tiles=GetTilesWithin(tileX,tileY,width,height,null,layer);var weightTotal=0;for(i=0;i<weightedIndexes.length;i++){weightTotal+=weightedIndexes[i].weight}if(weightTotal<=0){return}for(i=0;i<tiles.length;i++){var rand=Math.random()*weightTotal;var sum=0;var randomIndex=-1;for(var j=0;j<weightedIndexes.length;j++){sum+=weightedIndexes[j].weight;if(rand<=sum){var chosen=weightedIndexes[j].index;randomIndex=Array.isArray(chosen)?chosen[Math.floor(Math.random()*chosen.length)]:chosen;break}}tiles[i].index=randomIndex}};module.exports=WeightedRandomize}),(function(module,exports,__webpack_require__){var WorldToTileX=__webpack_require__(63);var WorldToTileY=__webpack_require__(64);var Vector2=__webpack_require__(3);var WorldToTileXY=function(worldX,worldY,snapToFloor,point,camera,layer){if(point===undefined){point=new Vector2(0,0)}point.x=WorldToTileX(worldX,snapToFloor,camera,layer);point.y=WorldToTileY(worldY,snapToFloor,camera,layer);return point};module.exports=WorldToTileXY}),(function(module,exports,__webpack_require__){module.exports={Parse:__webpack_require__(478),Parse2DArray:__webpack_require__(223),ParseCSV:__webpack_require__(479),Impact:__webpack_require__(1343),Tiled:__webpack_require__(1344)}}),(function(module,exports,__webpack_require__){module.exports={ParseTileLayers:__webpack_require__(492),ParseTilesets:__webpack_require__(493),ParseWeltmeister:__webpack_require__(491)}}),(function(module,exports,__webpack_require__){module.exports={AssignTileProperties:__webpack_require__(490),Base64Decode:__webpack_require__(482),BuildTilesetIndex:__webpack_require__(489),ParseGID:__webpack_require__(224),ParseImageLayers:__webpack_require__(483),ParseJSONTiled:__webpack_require__(480),ParseObject:__webpack_require__(226),ParseObjectLayers:__webpack_require__(487),ParseTileLayers:__webpack_require__(481),ParseTilesets:__webpack_require__(484)}}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1346)}if(true){renderCanvas=__webpack_require__(1347)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports,__webpack_require__){var Utils=__webpack_require__(9);var DynamicTilemapLayerWebGLRenderer=function(renderer,src,interpolationPercentage,camera){src.cull(camera);var renderTiles=src.culledTiles;var tileCount=renderTiles.length;var alpha=camera.alpha*src.alpha;if(tileCount===0||alpha<=0){return}var gidMap=src.gidMap;var pipeline=src.pipeline;var getTint=Utils.getTintAppendFloatAlphaAndSwap;var scrollFactorX=src.scrollFactorX;var scrollFactorY=src.scrollFactorY;var x=src.x;var y=src.y;var sx=src.scaleX;var sy=src.scaleY;var tilesets=src.tileset;for(var c=0;c<tilesets.length;c++){var currentSet=tilesets[c];var texture=currentSet.glTexture;for(var i=0;i<tileCount;i++){var tile=renderTiles[i];var tileset=gidMap[tile.index];if(tileset!==currentSet){continue}var tileTexCoords=tileset.getTileTextureCoordinates(tile.index);if(tileTexCoords===null){continue}var frameWidth=tile.width;var frameHeight=tile.height;var frameX=tileTexCoords.x;var frameY=tileTexCoords.y;var tw=tile.width*0.5;var th=tile.height*0.5;var tint=getTint(tile.tint,alpha*tile.alpha);pipeline.batchTexture(src,texture,texture.width,texture.height,x+((tw+tile.pixelX)*sx),y+((th+tile.pixelY)*sy),tile.width,tile.height,sx,sy,tile.rotation,tile.flipX,tile.flipY,scrollFactorX,scrollFactorY,tw,th,frameX,frameY,frameWidth,frameHeight,tint,tint,tint,tint,false,0,0,camera,null,true)}}};module.exports=DynamicTilemapLayerWebGLRenderer}),(function(module,exports){var DynamicTilemapLayerCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){src.cull(camera);var renderTiles=src.culledTiles;var tileCount=renderTiles.length;if(tileCount===0){return}var camMatrix=renderer._tempMatrix1;var layerMatrix=renderer._tempMatrix2;var calcMatrix=renderer._tempMatrix3;layerMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);var ctx=renderer.currentContext;var gidMap=src.gidMap;ctx.save();if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);layerMatrix.e=src.x;layerMatrix.f=src.y;camMatrix.multiply(layerMatrix,calcMatrix);calcMatrix.copyToContext(ctx)}else{layerMatrix.e-=camera.scrollX*src.scrollFactorX;layerMatrix.f-=camera.scrollY*src.scrollFactorY;layerMatrix.copyToContext(ctx)}var alpha=camera.alpha*src.alpha;if(!renderer.antialias||src.scaleX>1||src.scaleY>1){ctx.imageSmoothingEnabled=false}for(var i=0;i<tileCount;i++){var tile=renderTiles[i];var tileset=gidMap[tile.index];if(!tileset){continue}var image=tileset.image.getSourceImage();var tileTexCoords=tileset.getTileTextureCoordinates(tile.index);if(tileTexCoords){var halfWidth=tile.width/2;var halfHeight=tile.height/2;ctx.save();ctx.translate(tile.pixelX+halfWidth,tile.pixelY+halfHeight);if(tile.rotation!==0){ctx.rotate(tile.rotation)}if(tile.flipX||tile.flipY){ctx.scale((tile.flipX)?-1:1,(tile.flipY)?-1:1)}ctx.globalAlpha=alpha*tile.alpha;ctx.drawImage(image,tileTexCoords.x,tileTexCoords.y,tile.width,tile.height,-halfWidth,-halfHeight,tile.width,tile.height);ctx.restore()}}ctx.restore()};module.exports=DynamicTilemapLayerCanvasRenderer}),(function(module,exports,__webpack_require__){var renderWebGL=__webpack_require__(1);var renderCanvas=__webpack_require__(1);if(true){renderWebGL=__webpack_require__(1349)}if(true){renderCanvas=__webpack_require__(1350)}module.exports={renderWebGL:renderWebGL,renderCanvas:renderCanvas}}),(function(module,exports){var StaticTilemapLayerWebGLRenderer=function(renderer,src,interpolationPercentage,camera){var tilesets=src.tileset;var pipeline=src.pipeline;var pipelineVertexBuffer=pipeline.vertexBuffer;renderer.setPipeline(pipeline);pipeline.modelIdentity();pipeline.modelTranslate(src.x-(camera.scrollX*src.scrollFactorX),src.y-(camera.scrollY*src.scrollFactorY),0);pipeline.modelScale(src.scaleX,src.scaleY,1);pipeline.viewLoad2D(camera.matrix.matrix);for(var i=0;i<tilesets.length;i++){src.upload(camera,i);if(src.vertexCount[i]>0){if(renderer.currentPipeline&&renderer.currentPipeline.vertexCount>0){renderer.flush()}pipeline.vertexBuffer=src.vertexBuffer[i];renderer.setPipeline(pipeline);renderer.setTexture2D(tilesets[i].glTexture,0);renderer.gl.drawArrays(pipeline.topology,0,src.vertexCount[i])}}pipeline.vertexBuffer=pipelineVertexBuffer;pipeline.viewIdentity();pipeline.modelIdentity()};module.exports=StaticTilemapLayerWebGLRenderer}),(function(module,exports){var StaticTilemapLayerCanvasRenderer=function(renderer,src,interpolationPercentage,camera,parentMatrix){src.cull(camera);var renderTiles=src.culledTiles;var tileCount=renderTiles.length;if(tileCount===0){return}var camMatrix=renderer._tempMatrix1;var layerMatrix=renderer._tempMatrix2;var calcMatrix=renderer._tempMatrix3;layerMatrix.applyITRS(src.x,src.y,src.rotation,src.scaleX,src.scaleY);camMatrix.copyFrom(camera.matrix);var ctx=renderer.currentContext;var gidMap=src.gidMap;ctx.save();if(parentMatrix){camMatrix.multiplyWithOffset(parentMatrix,-camera.scrollX*src.scrollFactorX,-camera.scrollY*src.scrollFactorY);layerMatrix.e=src.x;layerMatrix.f=src.y;camMatrix.multiply(layerMatrix,calcMatrix);calcMatrix.copyToContext(ctx)}else{layerMatrix.e-=camera.scrollX*src.scrollFactorX;layerMatrix.f-=camera.scrollY*src.scrollFactorY;layerMatrix.copyToContext(ctx)}var alpha=camera.alpha*src.alpha;if(!renderer.antialias||src.scaleX>1||src.scaleY>1){ctx.imageSmoothingEnabled=false}for(var i=0;i<tileCount;i++){var tile=renderTiles[i];var tileset=gidMap[tile.index];if(!tileset){continue}var image=tileset.image.getSourceImage();var tileTexCoords=tileset.getTileTextureCoordinates(tile.index);if(tileTexCoords){var tileWidth=tileset.tileWidth;var tileHeight=tileset.tileHeight;var halfWidth=tileWidth/2;var halfHeight=tileHeight/2;ctx.save();ctx.translate(tile.pixelX+halfWidth,tile.pixelY+halfHeight);if(tile.rotation!==0){ctx.rotate(tile.rotation)}if(tile.flipX||tile.flipY){ctx.scale((tile.flipX)?-1:1,(tile.flipY)?-1:1)}ctx.globalAlpha=alpha*tile.alpha;ctx.drawImage(image,tileTexCoords.x,tileTexCoords.y,tileWidth,tileHeight,-halfWidth,-halfHeight,tileWidth,tileHeight);ctx.restore()}}ctx.restore()};module.exports=StaticTilemapLayerCanvasRenderer}),(function(module,exports,__webpack_require__){var GameObjectCreator=__webpack_require__(16);var ParseToTilemap=__webpack_require__(227);GameObjectCreator.register('tilemap',function(config){var c=(config!==undefined)?config:{};return ParseToTilemap(this.scene,c.key,c.tileWidth,c.tileHeight,c.width,c.height,c.data,c.insertNull)})}),(function(module,exports,__webpack_require__){var GameObjectFactory=__webpack_require__(5);var ParseToTilemap=__webpack_require__(227);GameObjectFactory.register('tilemap',function(key,tileWidth,tileHeight,width,height,data,insertNull){if(key===null){key=undefined}if(tileWidth===null){tileWidth=undefined}if(tileHeight===null){tileHeight=undefined}if(width===null){width=undefined}if(height===null){height=undefined}return ParseToTilemap(this.scene,key,tileWidth,tileHeight,width,height,data,insertNull)})}),(function(module,exports,__webpack_require__){module.exports={Clock:__webpack_require__(1354),TimerEvent:__webpack_require__(497)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var TimerEvent=__webpack_require__(497);var Clock=new Class({initialize:function Clock(scene){this.scene=scene;this.systems=scene.sys;this.now=0;this.timeScale=1;this.paused=false;this._active=[];this._pendingInsertion=[];this._pendingRemoval=[];scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.now=this.systems.game.loop.time;this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.PRE_UPDATE,this.preUpdate,this);eventEmitter.on(SceneEvents.UPDATE,this.update,this);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this)},addEvent:function(config){var event=new TimerEvent(config);this._pendingInsertion.push(event);return event},delayedCall:function(delay,callback,args,callbackScope){return this.addEvent({delay:delay,callback:callback,args:args,callbackScope:callbackScope})},clearPendingEvents:function(){this._pendingInsertion=[];return this},removeAllEvents:function(){this._pendingRemoval=this._pendingRemoval.concat(this._active);return this},preUpdate:function(){var toRemove=this._pendingRemoval.length;var toInsert=this._pendingInsertion.length;if(toRemove===0&&toInsert===0){return}var i;var event;for(i=0;i<toRemove;i++){event=this._pendingRemoval[i];var index=this._active.indexOf(event);if(index>-1){this._active.splice(index,1)}event.destroy()}for(i=0;i<toInsert;i++){event=this._pendingInsertion[i];this._active.push(event)}this._pendingRemoval.length=0;this._pendingInsertion.length=0},update:function(time,delta){this.now=time;if(this.paused){return}delta*=this.timeScale;for(var i=0;i<this._active.length;i++){var event=this._active[i];if(event.paused){continue}event.elapsed+=delta*event.timeScale;if(event.elapsed>=event.delay){var remainder=event.elapsed-event.delay;event.elapsed=event.delay;if(!event.hasDispatched&&event.callback){event.hasDispatched=true;event.callback.apply(event.callbackScope,event.args)}if(event.repeatCount>0){event.repeatCount--;event.elapsed=remainder;event.hasDispatched=false}else{this._pendingRemoval.push(event)}}}},shutdown:function(){var i;for(i=0;i<this._pendingInsertion.length;i++){this._pendingInsertion[i].destroy()}for(i=0;i<this._active.length;i++){this._active[i].destroy()}for(i=0;i<this._pendingRemoval.length;i++){this._pendingRemoval[i].destroy()}this._active.length=0;this._pendingRemoval.length=0;this._pendingInsertion.length=0;var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.PRE_UPDATE,this.preUpdate,this);eventEmitter.off(SceneEvents.UPDATE,this.update,this);eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('Clock',Clock,'time');module.exports=Clock}),(function(module,exports,__webpack_require__){var CONST=__webpack_require__(89);var Extend=__webpack_require__(18);var Tweens={Builders:__webpack_require__(1356),Events:__webpack_require__(232),TweenManager:__webpack_require__(1372),Tween:__webpack_require__(231),TweenData:__webpack_require__(233),Timeline:__webpack_require__(503)};Tweens=Extend(false,Tweens,CONST);module.exports=Tweens}),(function(module,exports,__webpack_require__){module.exports={GetBoolean:__webpack_require__(88),GetEaseFunction:__webpack_require__(69),GetNewValue:__webpack_require__(145),GetProps:__webpack_require__(498),GetTargets:__webpack_require__(228),GetTweens:__webpack_require__(499),GetValueOp:__webpack_require__(229),NumberTweenBuilder:__webpack_require__(500),StaggerBuilder:__webpack_require__(501),TimelineBuilder:__webpack_require__(502),TweenBuilder:__webpack_require__(146)}}),(function(module,exports){module.exports=['callbackScope','completeDelay','delay','duration','ease','easeParams','flipX','flipY','hold','loop','loopDelay','offset','onActive','onActiveParams','onActiveScope','onComplete','onCompleteParams','onCompleteScope','onLoop','onLoopParams','onLoopScope','onRepeat','onRepeatParams','onRepeatScope','onStart','onStartParams','onStartScope','onStop','onStopParams','onStopScope','onUpdate','onUpdateParams','onUpdateScope','onYoyo','onYoyoParams','onYoyoScope','paused','props','repeat','repeatDelay','targets','useFrames','yoyo']}),(function(module,exports){module.exports='complete'}),(function(module,exports){module.exports='loop'}),(function(module,exports){module.exports='pause'}),(function(module,exports){module.exports='resume'}),(function(module,exports){module.exports='start'}),(function(module,exports){module.exports='update'}),(function(module,exports){module.exports='active'}),(function(module,exports){module.exports='complete'}),(function(module,exports){module.exports='loop'}),(function(module,exports){module.exports='repeat'}),(function(module,exports){module.exports='start'}),(function(module,exports){module.exports='stop'}),(function(module,exports){module.exports='update'}),(function(module,exports){module.exports='yoyo'}),(function(module,exports,__webpack_require__){var ArrayRemove=__webpack_require__(123);var Class=__webpack_require__(0);var NumberTweenBuilder=__webpack_require__(500);var PluginCache=__webpack_require__(23);var SceneEvents=__webpack_require__(22);var StaggerBuilder=__webpack_require__(501);var TimelineBuilder=__webpack_require__(502);var TWEEN_CONST=__webpack_require__(89);var TweenBuilder=__webpack_require__(146);var TweenManager=new Class({initialize:function TweenManager(scene){this.scene=scene;this.systems=scene.sys;this.timeScale=1;this._add=[];this._pending=[];this._active=[];this._destroy=[];this._toProcess=0;scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.PRE_UPDATE,this.preUpdate,this);eventEmitter.on(SceneEvents.UPDATE,this.update,this);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this);this.timeScale=1},createTimeline:function(config){return TimelineBuilder(this,config)},timeline:function(config){var timeline=TimelineBuilder(this,config);if(!timeline.paused){this._add.push(timeline);this._toProcess++}return timeline},create:function(config){return TweenBuilder(this,config)},add:function(config){var tween=TweenBuilder(this,config);this._add.push(tween);this._toProcess++;return tween},existing:function(tween){this._add.push(tween);this._toProcess++;return this},addCounter:function(config){var tween=NumberTweenBuilder(this,config);this._add.push(tween);this._toProcess++;return tween},stagger:function(value,options){return StaggerBuilder(value,options)},preUpdate:function(){if(this._toProcess===0){return}var list=this._destroy;var active=this._active;var pending=this._pending;var i;var tween;for(i=0;i<list.length;i++){tween=list[i];var idx=active.indexOf(tween);if(idx===-1){idx=pending.indexOf(tween);if(idx>-1){tween.state=TWEEN_CONST.REMOVED;pending.splice(idx,1)}}else{tween.state=TWEEN_CONST.REMOVED;active.splice(idx,1)}}list.length=0;list=this._add;for(i=0;i<list.length;i++){tween=list[i];if(tween.state===TWEEN_CONST.PENDING_ADD){if(tween.init()){tween.play();this._active.push(tween)}else{this._pending.push(tween)}}}list.length=0;this._toProcess=0},update:function(timestamp,delta){var list=this._active;var tween;delta*=this.timeScale;for(var i=0;i<list.length;i++){tween=list[i];if(tween.update(timestamp,delta)){this._destroy.push(tween);this._toProcess++}}},remove:function(tween){ArrayRemove(this._add,tween);ArrayRemove(this._pending,tween);ArrayRemove(this._active,tween);ArrayRemove(this._destroy,tween);tween.state=TWEEN_CONST.REMOVED;return this},makeActive:function(tween){if(this._add.indexOf(tween)!==-1||this._active.indexOf(tween)!==-1){return this}var idx=this._pending.indexOf(tween);if(idx!==-1){this._pending.splice(idx,1)}this._add.push(tween);tween.state=TWEEN_CONST.PENDING_ADD;this._toProcess++;return this},each:function(callback,scope){var args=[null];for(var i=1;i<arguments.length;i++){args.push(arguments[i])}for(var texture in this.list){args[0]=this.list[texture];callback.apply(scope,args)}},getAllTweens:function(){var list=this._active;var output=[];for(var i=0;i<list.length;i++){output.push(list[i])}return output},getGlobalTimeScale:function(){return this.timeScale},getTweensOf:function(target){var list=this._active;var tween;var output=[];var i;if(Array.isArray(target)){for(i=0;i<list.length;i++){tween=list[i];for(var t=0;t<target.length;t++){if(tween.hasTarget(target[t])){output.push(tween)}}}}else{for(i=0;i<list.length;i++){tween=list[i];if(tween.hasTarget(target)){output.push(tween)}}}return output},isTweening:function(target){var list=this._active;var tween;for(var i=0;i<list.length;i++){tween=list[i];if(tween.hasTarget(target)&&tween.isPlaying()){return true}}return false},killAll:function(){var tweens=this.getAllTweens();for(var i=0;i<tweens.length;i++){tweens[i].stop()}return this},killTweensOf:function(target){var tweens=this.getTweensOf(target);for(var i=0;i<tweens.length;i++){tweens[i].stop()}return this},pauseAll:function(){var list=this._active;for(var i=0;i<list.length;i++){list[i].pause()}return this},resumeAll:function(){var list=this._active;for(var i=0;i<list.length;i++){list[i].resume()}return this},setGlobalTimeScale:function(value){this.timeScale=value;return this},shutdown:function(){this.killAll();this._add=[];this._pending=[];this._active=[];this._destroy=[];this._toProcess=0;var eventEmitter=this.systems.events;eventEmitter.off(SceneEvents.PRE_UPDATE,this.preUpdate,this);eventEmitter.off(SceneEvents.UPDATE,this.update,this);eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this)},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('TweenManager',TweenManager,'tweens');module.exports=TweenManager}),(function(module,exports,__webpack_require__){module.exports={Array:__webpack_require__(183),Base64:__webpack_require__(1374),Objects:__webpack_require__(1376),String:__webpack_require__(1380)}}),(function(module,exports,__webpack_require__){module.exports={ArrayBufferToBase64:__webpack_require__(1375),Base64ToArrayBuffer:__webpack_require__(388)}}),(function(module,exports){var chars='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';var ArrayBufferToBase64=function(arrayBuffer,mediaType){var bytes=new Uint8Array(arrayBuffer);var len=bytes.length;var base64=(mediaType)?'data:'+mediaType+';base64,':'';for(var i=0;i<len;i+=3){base64+=chars[bytes[i]>>2];base64+=chars[((bytes[i]&3)<<4)|(bytes[i+1]>>4)];base64+=chars[((bytes[i+1]&15)<<2)|(bytes[i+2]>>6)];base64+=chars[bytes[i+2]&63]}if((len%3)===2){base64=base64.substring(0,base64.length-1)+'='}else if(len%3===1){base64=base64.substring(0,base64.length-2)+'=='}return base64};module.exports=ArrayBufferToBase64}),(function(module,exports,__webpack_require__){module.exports={Clone:__webpack_require__(67),Extend:__webpack_require__(18),GetAdvancedValue:__webpack_require__(15),GetFastValue:__webpack_require__(2),GetMinMaxValue:__webpack_require__(1377),GetValue:__webpack_require__(6),HasAll:__webpack_require__(1378),HasAny:__webpack_require__(407),HasValue:__webpack_require__(108),IsPlainObject:__webpack_require__(7),Merge:__webpack_require__(126),MergeRight:__webpack_require__(1379),Pick:__webpack_require__(486),SetValue:__webpack_require__(427)}}),(function(module,exports,__webpack_require__){var GetValue=__webpack_require__(6);var Clamp=__webpack_require__(19);var GetMinMaxValue=function(source,key,min,max,defaultValue){if(defaultValue===undefined){defaultValue=min}var value=GetValue(source,key,defaultValue);return Clamp(value,min,max)};module.exports=GetMinMaxValue}),(function(module,exports){var HasAll=function(source,keys){for(var i=0;i<keys.length;i++){if(!source.hasOwnProperty(keys[i])){return false}}return true};module.exports=HasAll}),(function(module,exports,__webpack_require__){var Clone=__webpack_require__(67);var MergeRight=function(obj1,obj2){var clone=Clone(obj1);for(var key in obj2){if(clone.hasOwnProperty(key)){clone[key]=obj2[key]}}return clone};module.exports=MergeRight}),(function(module,exports,__webpack_require__){module.exports={Format:__webpack_require__(1381),Pad:__webpack_require__(163),Reverse:__webpack_require__(1382),UppercaseFirst:__webpack_require__(181),UUID:__webpack_require__(196)}}),(function(module,exports){var Format=function(string,values){return string.replace(/%([0-9]+)/g,function(s,n){return values[Number(n)-1]})};module.exports=Format}),(function(module,exports){var Reverse=function(string){return string.split('').reverse().join('')};module.exports=Reverse}),(function(module,exports,__webpack_require__){module.exports={SoundManagerCreator:__webpack_require__(380),Events:__webpack_require__(59),BaseSound:__webpack_require__(128),BaseSoundManager:__webpack_require__(127),WebAudioSound:__webpack_require__(389),WebAudioSoundManager:__webpack_require__(387),HTML5AudioSound:__webpack_require__(384),HTML5AudioSoundManager:__webpack_require__(381),NoAudioSound:__webpack_require__(386),NoAudioSoundManager:__webpack_require__(385)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Vector2=__webpack_require__(3);var BodyBounds=new Class({initialize:function BodyBounds(){this.boundsCenter=new Vector2();this.centerDiff=new Vector2()},parseBody:function(body){body=(body.hasOwnProperty('body'))?body.body:body;if(!body.hasOwnProperty('bounds')||!body.hasOwnProperty('centerOfMass')){return false}var boundsCenter=this.boundsCenter;var centerDiff=this.centerDiff;var boundsWidth=body.bounds.max.x-body.bounds.min.x;var boundsHeight=body.bounds.max.y-body.bounds.min.y;var bodyCenterX=boundsWidth*body.centerOfMass.x;var bodyCenterY=boundsHeight*body.centerOfMass.y;boundsCenter.set(boundsWidth/2,boundsHeight/2);centerDiff.set(bodyCenterX-boundsCenter.x,bodyCenterY-boundsCenter.y);return true},getTopLeft:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x+center.x+diff.x,y+center.y+diff.y)}return false},getTopCenter:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x+diff.x,y+center.y+diff.y)}return false},getTopRight:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x-(center.x-diff.x),y+center.y+diff.y)}return false},getLeftCenter:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x+center.x+diff.x,y+diff.y)}return false},getCenter:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var diff=this.centerDiff;return new Vector2(x+diff.x,y+diff.y)}return false},getRightCenter:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x-(center.x-diff.x),y+diff.y)}return false},getBottomLeft:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x+center.x+diff.x,y-(center.y-diff.y))}return false},getBottomCenter:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x+diff.x,y-(center.y-diff.y))}return false},getBottomRight:function(body,x,y){if(x===undefined){x=0}if(y===undefined){y=0}if(this.parseBody(body)){var center=this.boundsCenter;var diff=this.centerDiff;return new Vector2(x-(center.x-diff.x),y-(center.y-diff.y))}return false}});module.exports=BodyBounds}),(function(module,exports,__webpack_require__){var Bodies=__webpack_require__(109);var Class=__webpack_require__(0);var Composites=__webpack_require__(1292);var Constraint=__webpack_require__(219);var Svg=__webpack_require__(1293);var MatterGameObject=__webpack_require__(1396);var MatterImage=__webpack_require__(1387);var MatterSprite=__webpack_require__(1388);var MatterTileBody=__webpack_require__(1297);var PhysicsEditorParser=__webpack_require__(1294);var PhysicsJSONParser=__webpack_require__(1295);var PointerConstraint=__webpack_require__(1425);var Vertices=__webpack_require__(86);var Factory=new Class({initialize:function Factory(world){this.world=world;this.scene=world.scene;this.sys=world.scene.sys},rectangle:function(x,y,width,height,options){var body=Bodies.rectangle(x,y,width,height,options);this.world.add(body);return body},trapezoid:function(x,y,width,height,slope,options){var body=Bodies.trapezoid(x,y,width,height,slope,options);this.world.add(body);return body},circle:function(x,y,radius,options,maxSides){var body=Bodies.circle(x,y,radius,options,maxSides);this.world.add(body);return body},polygon:function(x,y,sides,radius,options){var body=Bodies.polygon(x,y,sides,radius,options);this.world.add(body);return body},fromVertices:function(x,y,vertexSets,options,flagInternal,removeCollinear,minimumArea){if(typeof vertexSets==='string'){vertexSets=Vertices.fromPath(vertexSets)}var body=Bodies.fromVertices(x,y,vertexSets,options,flagInternal,removeCollinear,minimumArea);this.world.add(body);return body},fromPhysicsEditor:function(x,y,config,options,addToWorld){if(addToWorld===undefined){addToWorld=true}var body=PhysicsEditorParser.parseBody(x,y,config,options);if(addToWorld&&!this.world.has(body)){this.world.add(body)}return body},fromSVG:function(x,y,xml,scale,options,addToWorld){if(scale===undefined){scale=1}if(options===undefined){options={}}if(addToWorld===undefined){addToWorld=true}var path=xml.getElementsByTagName('path');var vertexSets=[];for(var i=0;i<path.length;i++){var points=Svg.pathToVertices(path[i],30);if(scale!==1){Vertices.scale(points,scale,scale)}vertexSets.push(points)}var body=Bodies.fromVertices(x,y,vertexSets,options);if(addToWorld){this.world.add(body)}return body},fromJSON:function(x,y,config,options,addToWorld){if(options===undefined){options={}}if(addToWorld===undefined){addToWorld=true}var body=PhysicsJSONParser.parseBody(x,y,config,options);if(body&&addToWorld){this.world.add(body)}return body},imageStack:function(key,frame,x,y,columns,rows,columnGap,rowGap,options){if(columnGap===undefined){columnGap=0}if(rowGap===undefined){rowGap=0}if(options===undefined){options={}}var world=this.world;var displayList=this.sys.displayList;options.addToWorld=false;var stack=Composites.stack(x,y,columns,rows,columnGap,rowGap,function(x,y){var image=new MatterImage(world,x,y,key,frame,options);displayList.add(image);return image.body});world.add(stack);return stack},stack:function(x,y,columns,rows,columnGap,rowGap,callback){var stack=Composites.stack(x,y,columns,rows,columnGap,rowGap,callback);this.world.add(stack);return stack},pyramid:function(x,y,columns,rows,columnGap,rowGap,callback){var stack=Composites.pyramid(x,y,columns,rows,columnGap,rowGap,callback);this.world.add(stack);return stack},chain:function(composite,xOffsetA,yOffsetA,xOffsetB,yOffsetB,options){return Composites.chain(composite,xOffsetA,yOffsetA,xOffsetB,yOffsetB,options)},mesh:function(composite,columns,rows,crossBrace,options){return Composites.mesh(composite,columns,rows,crossBrace,options)},newtonsCradle:function(x,y,number,size,length){var composite=Composites.newtonsCradle(x,y,number,size,length);this.world.add(composite);return composite},car:function(x,y,width,height,wheelSize){var composite=Composites.car(x,y,width,height,wheelSize);this.world.add(composite);return composite},softBody:function(x,y,columns,rows,columnGap,rowGap,crossBrace,particleRadius,particleOptions,constraintOptions){var composite=Composites.softBody(x,y,columns,rows,columnGap,rowGap,crossBrace,particleRadius,particleOptions,constraintOptions);this.world.add(composite);return composite},joint:function(bodyA,bodyB,length,stiffness,options){return this.constraint(bodyA,bodyB,length,stiffness,options)},spring:function(bodyA,bodyB,length,stiffness,options){return this.constraint(bodyA,bodyB,length,stiffness,options)},constraint:function(bodyA,bodyB,length,stiffness,options){if(stiffness===undefined){stiffness=1}if(options===undefined){options={}}options.bodyA=(bodyA.type==='body')?bodyA:bodyA.body;options.bodyB=(bodyB.type==='body')?bodyB:bodyB.body;if(!isNaN(length)){options.length=length}options.stiffness=stiffness;var constraint=Constraint.create(options);this.world.add(constraint);return constraint},worldConstraint:function(body,length,stiffness,options){if(stiffness===undefined){stiffness=1}if(options===undefined){options={}}options.bodyB=(body.type==='body')?body:body.body;if(!isNaN(length)){options.length=length}options.stiffness=stiffness;var constraint=Constraint.create(options);this.world.add(constraint);return constraint},mouseSpring:function(options){return this.pointerConstraint(options)},pointerConstraint:function(options){if(options===undefined){options={}}if(!options.hasOwnProperty('render')){options.render={visible:false}}var pointerConstraint=new PointerConstraint(this.scene,this.world,options);this.world.add(pointerConstraint.constraint);return pointerConstraint},image:function(x,y,key,frame,options){var image=new MatterImage(this.world,x,y,key,frame,options);this.sys.displayList.add(image);return image},tileBody:function(tile,options){return new MatterTileBody(this.world,tile,options)},sprite:function(x,y,key,frame,options){var sprite=new MatterSprite(this.world,x,y,key,frame,options);this.sys.displayList.add(sprite);this.sys.updateList.add(sprite);return sprite},gameObject:function(gameObject,options,addToWorld){return MatterGameObject(this.world,gameObject,options,addToWorld)},destroy:function(){this.world=null;this.scene=null;this.sys=null}});module.exports=Factory}),(function(module,exports){module.exports={decomp:polygonDecomp,quickDecomp:polygonQuickDecomp,isSimple:polygonIsSimple,removeCollinearPoints:polygonRemoveCollinearPoints,removeDuplicatePoints:polygonRemoveDuplicatePoints,makeCCW:polygonMakeCCW};function lineInt(l1,l2,precision){precision=precision||0;var i=[0,0];var a1,b1,c1,a2,b2,c2,det;a1=l1[1][1]-l1[0][1];b1=l1[0][0]-l1[1][0];c1=a1*l1[0][0]+b1*l1[0][1];a2=l2[1][1]-l2[0][1];b2=l2[0][0]-l2[1][0];c2=a2*l2[0][0]+b2*l2[0][1];det=a1*b2-a2*b1;if(!scalar_eq(det,0,precision)){i[0]=(b2*c1-b1*c2)/det;i[1]=(a1*c2-a2*c1)/det}return i}function lineSegmentsIntersect(p1,p2,q1,q2){var dx=p2[0]-p1[0];var dy=p2[1]-p1[1];var da=q2[0]-q1[0];var db=q2[1]-q1[1];if((da*dy-db*dx)===0){return false}var s=(dx*(q1[1]-p1[1])+dy*(p1[0]-q1[0]))/(da*dy-db*dx);var t=(da*(p1[1]-q1[1])+db*(q1[0]-p1[0]))/(db*dx-da*dy);return(s>=0&&s<=1&&t>=0&&t<=1)}function triangleArea(a,b,c){return(((b[0]-a[0])*(c[1]-a[1]))-((c[0]-a[0])*(b[1]-a[1])))}function isLeft(a,b,c){return triangleArea(a,b,c)>0}function isLeftOn(a,b,c){return triangleArea(a,b,c)>=0}function isRight(a,b,c){return triangleArea(a,b,c)<0}function isRightOn(a,b,c){return triangleArea(a,b,c)<=0}var tmpPoint1=[],tmpPoint2=[];function collinear(a,b,c,thresholdAngle){if(!thresholdAngle){return triangleArea(a,b,c)===0}else{var ab=tmpPoint1,bc=tmpPoint2;ab[0]=b[0]-a[0];ab[1]=b[1]-a[1];bc[0]=c[0]-b[0];bc[1]=c[1]-b[1];var dot=ab[0]*bc[0]+ab[1]*bc[1],magA=Math.sqrt(ab[0]*ab[0]+ab[1]*ab[1]),magB=Math.sqrt(bc[0]*bc[0]+bc[1]*bc[1]),angle=Math.acos(dot/(magA*magB));return angle<thresholdAngle}}function sqdist(a,b){var dx=b[0]-a[0];var dy=b[1]-a[1];return dx*dx+dy*dy}function polygonAt(polygon,i){var s=polygon.length;return polygon[i<0?i%s+s:i%s]}function polygonClear(polygon){polygon.length=0}function polygonAppend(polygon,poly,from,to){for(var i=from;i<to;i++){polygon.push(poly[i])}}function polygonMakeCCW(polygon){var br=0,v=polygon;for(var i=1;i<polygon.length;++i){if(v[i][1]<v[br][1]||(v[i][1]===v[br][1]&&v[i][0]>v[br][0])){br=i}}if(!isLeft(polygonAt(polygon,br-1),polygonAt(polygon,br),polygonAt(polygon,br+1))){polygonReverse(polygon);return true}else{return false}}function polygonReverse(polygon){var tmp=[];var N=polygon.length;for(var i=0;i!==N;i++){tmp.push(polygon.pop())}for(var i=0;i!==N;i++){polygon[i]=tmp[i]}}function polygonIsReflex(polygon,i){return isRight(polygonAt(polygon,i-1),polygonAt(polygon,i),polygonAt(polygon,i+1))}var tmpLine1=[],tmpLine2=[];function polygonCanSee(polygon,a,b){var p,dist,l1=tmpLine1,l2=tmpLine2;if(isLeftOn(polygonAt(polygon,a+1),polygonAt(polygon,a),polygonAt(polygon,b))&&isRightOn(polygonAt(polygon,a-1),polygonAt(polygon,a),polygonAt(polygon,b))){return false}dist=sqdist(polygonAt(polygon,a),polygonAt(polygon,b));for(var i=0;i!==polygon.length;++i){if((i+1)%polygon.length===a||i===a){continue}if(isLeftOn(polygonAt(polygon,a),polygonAt(polygon,b),polygonAt(polygon,i+1))&&isRightOn(polygonAt(polygon,a),polygonAt(polygon,b),polygonAt(polygon,i))){l1[0]=polygonAt(polygon,a);l1[1]=polygonAt(polygon,b);l2[0]=polygonAt(polygon,i);l2[1]=polygonAt(polygon,i+1);p=lineInt(l1,l2);if(sqdist(polygonAt(polygon,a),p)<dist){return false}}}return true}function polygonCanSee2(polygon,a,b){for(var i=0;i!==polygon.length;++i){if(i===a||i===b||(i+1)%polygon.length===a||(i+1)%polygon.length===b){continue}if(lineSegmentsIntersect(polygonAt(polygon,a),polygonAt(polygon,b),polygonAt(polygon,i),polygonAt(polygon,i+1))){return false}}return true}function polygonCopy(polygon,i,j,targetPoly){var p=targetPoly||[];polygonClear(p);if(i<j){for(var k=i;k<=j;k++){p.push(polygon[k])}}else{for(var k=0;k<=j;k++){p.push(polygon[k])}for(var k=i;k<polygon.length;k++){p.push(polygon[k])}}return p}function polygonGetCutEdges(polygon){var min=[],tmp1=[],tmp2=[],tmpPoly=[];var nDiags=Number.MAX_VALUE;for(var i=0;i<polygon.length;++i){if(polygonIsReflex(polygon,i)){for(var j=0;j<polygon.length;++j){if(polygonCanSee(polygon,i,j)){tmp1=polygonGetCutEdges(polygonCopy(polygon,i,j,tmpPoly));tmp2=polygonGetCutEdges(polygonCopy(polygon,j,i,tmpPoly));for(var k=0;k<tmp2.length;k++){tmp1.push(tmp2[k])}if(tmp1.length<nDiags){min=tmp1;nDiags=tmp1.length;min.push([polygonAt(polygon,i),polygonAt(polygon,j)])}}}}}return min}function polygonDecomp(polygon){var edges=polygonGetCutEdges(polygon);if(edges.length>0){return polygonSlice(polygon,edges)}else{return[polygon]}}function polygonSlice(polygon,cutEdges){if(cutEdges.length===0){return[polygon]}if(cutEdges instanceof Array&&cutEdges.length&&cutEdges[0]instanceof Array&&cutEdges[0].length===2&&cutEdges[0][0]instanceof Array){var polys=[polygon];for(var i=0;i<cutEdges.length;i++){var cutEdge=cutEdges[i];for(var j=0;j<polys.length;j++){var poly=polys[j];var result=polygonSlice(poly,cutEdge);if(result){polys.splice(j,1);polys.push(result[0],result[1]);break}}}return polys}else{var cutEdge=cutEdges;var i=polygon.indexOf(cutEdge[0]);var j=polygon.indexOf(cutEdge[1]);if(i!==-1&&j!==-1){return[polygonCopy(polygon,i,j),polygonCopy(polygon,j,i)]}else{return false}}}function polygonIsSimple(polygon){var path=polygon,i;for(i=0;i<path.length-1;i++){for(var j=0;j<i-1;j++){if(lineSegmentsIntersect(path[i],path[i+1],path[j],path[j+1])){return false}}}for(i=1;i<path.length-2;i++){if(lineSegmentsIntersect(path[0],path[path.length-1],path[i],path[i+1])){return false}}return true}function getIntersectionPoint(p1,p2,q1,q2,delta){delta=delta||0;var a1=p2[1]-p1[1];var b1=p1[0]-p2[0];var c1=(a1*p1[0])+(b1*p1[1]);var a2=q2[1]-q1[1];var b2=q1[0]-q2[0];var c2=(a2*q1[0])+(b2*q1[1]);var det=(a1*b2)-(a2*b1);if(!scalar_eq(det,0,delta)){return[((b2*c1)-(b1*c2))/det,((a1*c2)-(a2*c1))/det]}else{return[0,0]}}function polygonQuickDecomp(polygon,result,reflexVertices,steinerPoints,delta,maxlevel,level){maxlevel=maxlevel||100;level=level||0;delta=delta||25;result=typeof(result)!=="undefined"?result:[];reflexVertices=reflexVertices||[];steinerPoints=steinerPoints||[];var upperInt=[0,0],lowerInt=[0,0],p=[0,0];var upperDist=0,lowerDist=0,d=0,closestDist=0;var upperIndex=0,lowerIndex=0,closestIndex=0;var lowerPoly=[],upperPoly=[];var poly=polygon,v=polygon;if(v.length<3){return result}level++;if(level>maxlevel){console.warn("quickDecomp: max level ("+maxlevel+") reached.");return result}for(var i=0;i<polygon.length;++i){if(polygonIsReflex(poly,i)){reflexVertices.push(poly[i]);upperDist=lowerDist=Number.MAX_VALUE;for(var j=0;j<polygon.length;++j){if(isLeft(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j))&&isRightOn(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j-1))){p=getIntersectionPoint(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j),polygonAt(poly,j-1));if(isRight(polygonAt(poly,i+1),polygonAt(poly,i),p)){d=sqdist(poly[i],p);if(d<lowerDist){lowerDist=d;lowerInt=p;lowerIndex=j}}}if(isLeft(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j+1))&&isRightOn(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j))){p=getIntersectionPoint(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j),polygonAt(poly,j+1));if(isLeft(polygonAt(poly,i-1),polygonAt(poly,i),p)){d=sqdist(poly[i],p);if(d<upperDist){upperDist=d;upperInt=p;upperIndex=j}}}}if(lowerIndex===(upperIndex+1)%polygon.length){p[0]=(lowerInt[0]+upperInt[0])/2;p[1]=(lowerInt[1]+upperInt[1])/2;steinerPoints.push(p);if(i<upperIndex){polygonAppend(lowerPoly,poly,i,upperIndex+1);lowerPoly.push(p);upperPoly.push(p);if(lowerIndex!==0){polygonAppend(upperPoly,poly,lowerIndex,poly.length)}polygonAppend(upperPoly,poly,0,i+1)}else{if(i!==0){polygonAppend(lowerPoly,poly,i,poly.length)}polygonAppend(lowerPoly,poly,0,upperIndex+1);lowerPoly.push(p);upperPoly.push(p);polygonAppend(upperPoly,poly,lowerIndex,i+1)}}else{if(lowerIndex>upperIndex){upperIndex+=polygon.length}closestDist=Number.MAX_VALUE;if(upperIndex<lowerIndex){return result}for(var j=lowerIndex;j<=upperIndex;++j){if(isLeftOn(polygonAt(poly,i-1),polygonAt(poly,i),polygonAt(poly,j))&&isRightOn(polygonAt(poly,i+1),polygonAt(poly,i),polygonAt(poly,j))){d=sqdist(polygonAt(poly,i),polygonAt(poly,j));if(d<closestDist&&polygonCanSee2(poly,i,j)){closestDist=d;closestIndex=j%polygon.length}}}if(i<closestIndex){polygonAppend(lowerPoly,poly,i,closestIndex+1);if(closestIndex!==0){polygonAppend(upperPoly,poly,closestIndex,v.length)}polygonAppend(upperPoly,poly,0,i+1)}else{if(i!==0){polygonAppend(lowerPoly,poly,i,v.length)}polygonAppend(lowerPoly,poly,0,closestIndex+1);polygonAppend(upperPoly,poly,closestIndex,i+1)}}if(lowerPoly.length<upperPoly.length){polygonQuickDecomp(lowerPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level);polygonQuickDecomp(upperPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level)}else{polygonQuickDecomp(upperPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level);polygonQuickDecomp(lowerPoly,result,reflexVertices,steinerPoints,delta,maxlevel,level)}return result}}result.push(polygon);return result}function polygonRemoveCollinearPoints(polygon,precision){var num=0;for(var i=polygon.length-1;polygon.length>3&&i>=0;--i){if(collinear(polygonAt(polygon,i-1),polygonAt(polygon,i),polygonAt(polygon,i+1),precision)){polygon.splice(i%polygon.length,1);num++}}return num}function polygonRemoveDuplicatePoints(polygon,precision){for(var i=polygon.length-1;i>=1;--i){var pi=polygon[i];for(var j=i-1;j>=0;--j){if(points_eq(pi,polygon[j],precision)){polygon.splice(i,1);continue}}}}function scalar_eq(a,b,precision){precision=precision||0;return Math.abs(a-b)<=precision}function points_eq(a,b,precision){return scalar_eq(a[0],b[0],precision)&&scalar_eq(a[1],b[1],precision)}}),(function(module,exports,__webpack_require__){var Class=__webpack_require__(0);var Components=__webpack_require__(514);var GameObject=__webpack_require__(14);var GetFastValue=__webpack_require__(2);var Image=__webpack_require__(107);var Pipeline=__webpack_require__(156);var Vector2=__webpack_require__(3);var MatterImage=new Class({Extends:Image,Mixins:[Components.Bounce,Components.Collision,Components.Force,Components.Friction,Components.Gravity,Components.Mass,Components.Sensor,Components.SetBody,Components.Sleep,Components.Static,Components.Transform,Components.Velocity,Pipeline],initialize:function MatterImage(world,x,y,texture,frame,options){GameObject.call(this,world.scene,'Image');this._crop=this.resetCropObject();this.setTexture(texture,frame);this.setSizeToFrame();this.setOrigin();this.world=world;this._tempVec2=new Vector2(x,y);var shape=GetFastValue(options,'shape',null);if(shape){this.setBody(shape,options)}else{this.setRectangle(this.width,this.height,options)}this.setPosition(x,y);this.initPipeline('TextureTintPipeline')}});module.exports=MatterImage}),(function(module,exports,__webpack_require__){var AnimationComponent=__webpack_require__(504);var Class=__webpack_require__(0);var Components=__webpack_require__(514);var GameObject=__webpack_require__(14);var GetFastValue=__webpack_require__(2);var Pipeline=__webpack_require__(156);var Sprite=__webpack_require__(75);var Vector2=__webpack_require__(3);var MatterSprite=new Class({Extends:Sprite,Mixins:[Components.Bounce,Components.Collision,Components.Force,Components.Friction,Components.Gravity,Components.Mass,Components.Sensor,Components.SetBody,Components.Sleep,Components.Static,Components.Transform,Components.Velocity,Pipeline],initialize:function MatterSprite(world,x,y,texture,frame,options){GameObject.call(this,world.scene,'Sprite');this._crop=this.resetCropObject();this.anims=new AnimationComponent(this);this.setTexture(texture,frame);this.setSizeToFrame();this.setOrigin();this.world=world;this._tempVec2=new Vector2(x,y);var shape=GetFastValue(options,'shape',null);if(shape){this.setBody(shape,options)}else{this.setRectangle(this.width,this.height,options)}this.setPosition(x,y);this.initPipeline('TextureTintPipeline')}});module.exports=MatterSprite}),(function(module,exports,__webpack_require__){var Matter={};module.exports=Matter;var Plugin=__webpack_require__(1299);var Common=__webpack_require__(42);(function(){Matter.name='matter-js';Matter.version='0.14.2';Matter.uses=[];Matter.used=[];Matter.use=function(){Plugin.use(Matter,Array.prototype.slice.call(arguments))};Matter.before=function(path,func){path=path.replace(/^Matter./,'');return Common.chainPathBefore(Matter,path,func)};Matter.after=function(path,func){path=path.replace(/^Matter./,'');return Common.chainPathAfter(Matter,path,func)}})()}),(function(module,exports,__webpack_require__){var Query={};module.exports=Query;var Vector=__webpack_require__(99);var SAT=__webpack_require__(516);var Bounds=__webpack_require__(100);var Bodies=__webpack_require__(109);var Vertices=__webpack_require__(86);(function(){Query.collides=function(body,bodies){var collisions=[];for(var i=0;i<bodies.length;i++){var bodyA=bodies[i];if(body===bodyA){continue}if(Bounds.overlaps(bodyA.bounds,body.bounds)){for(var j=bodyA.parts.length===1?0:1;j<bodyA.parts.length;j++){var part=bodyA.parts[j];if(Bounds.overlaps(part.bounds,body.bounds)){var collision=SAT.collides(part,body);if(collision.collided){collisions.push(collision);break}}}}}return collisions};Query.ray=function(bodies,startPoint,endPoint,rayWidth){rayWidth=rayWidth||1e-100;var rayAngle=Vector.angle(startPoint,endPoint),rayLength=Vector.magnitude(Vector.sub(startPoint,endPoint)),rayX=(endPoint.x+startPoint.x)*0.5,rayY=(endPoint.y+startPoint.y)*0.5,ray=Bodies.rectangle(rayX,rayY,rayLength,rayWidth,{angle:rayAngle}),collisions=Query.collides(ray,bodies);for(var i=0;i<collisions.length;i+=1){var collision=collisions[i];collision.body=collision.bodyB=collision.bodyA}return collisions};Query.region=function(bodies,bounds,outside){var result=[];for(var i=0;i<bodies.length;i++){var body=bodies[i],overlaps=Bounds.overlaps(body.bounds,bounds);if((overlaps&&!outside)||(!overlaps&&outside))result.push(body)}return result};Query.point=function(bodies,point){var result=[];for(var i=0;i<bodies.length;i++){var body=bodies[i];if(Bounds.contains(body.bounds,point)){for(var j=body.parts.length===1?0:1;j<body.parts.length;j++){var part=body.parts[j];if(Bounds.contains(part.bounds,point)&&Vertices.contains(part.vertices,point)){result.push(body);break}}}}return result}})()}),(function(module,exports,__webpack_require__){var Engine={};module.exports=Engine;var World=__webpack_require__(1300);var Sleeping=__webpack_require__(239);var Resolver=__webpack_require__(1303);var Pairs=__webpack_require__(1302);var Metrics=__webpack_require__(1426);var Grid=__webpack_require__(1301);var Events=__webpack_require__(240);var Composite=__webpack_require__(148);var Constraint=__webpack_require__(219);var Common=__webpack_require__(42);var Body=__webpack_require__(62);(function(){Engine.create=function(element,options){options=Common.isElement(element)?options:element;element=Common.isElement(element)?element:null;options=options||{};if(element||options.render){Common.warn('Engine.create: engine.render is deprecated (see docs)')}var defaults={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:false,events:[],plugin:{},timing:{timestamp:0,timeScale:1},broadphase:{controller:Grid}};var engine=Common.extend(defaults,options);engine.world=options.world||World.create(engine.world);engine.pairs=Pairs.create();engine.broadphase=engine.broadphase.controller.create(engine.broadphase);engine.metrics=engine.metrics||{extended:false};engine.metrics=Metrics.create(engine.metrics);return engine};Engine.update=function(engine,delta,correction){delta=delta||1000/60;correction=correction||1;var world=engine.world,timing=engine.timing,broadphase=engine.broadphase,broadphasePairs=[],i;timing.timestamp+=delta*timing.timeScale;var event={timestamp:timing.timestamp};Events.trigger(engine,'beforeUpdate',event);var allBodies=Composite.allBodies(world),allConstraints=Composite.allConstraints(world);Metrics.reset(engine.metrics);if(engine.enableSleeping)Sleeping.update(allBodies,timing.timeScale);Engine._bodiesApplyGravity(allBodies,world.gravity);Engine._bodiesUpdate(allBodies,delta,timing.timeScale,correction,world.bounds);Constraint.preSolveAll(allBodies);for(i=0;i<engine.constraintIterations;i++){Constraint.solveAll(allConstraints,timing.timeScale)}Constraint.postSolveAll(allBodies);if(broadphase.controller){if(world.isModified)broadphase.controller.clear(broadphase);broadphase.controller.update(broadphase,allBodies,engine,world.isModified);broadphasePairs=broadphase.pairsList}else{broadphasePairs=allBodies}if(world.isModified){Composite.setModified(world,false,false,true)}var collisions=broadphase.detector(broadphasePairs,engine);var pairs=engine.pairs,timestamp=timing.timestamp;Pairs.update(pairs,collisions,timestamp);Pairs.removeOld(pairs,timestamp);if(engine.enableSleeping)Sleeping.afterCollisions(pairs.list,timing.timeScale);if(pairs.collisionStart.length>0)Events.trigger(engine,'collisionStart',{pairs:pairs.collisionStart});Resolver.preSolvePosition(pairs.list);for(i=0;i<engine.positionIterations;i++){Resolver.solvePosition(pairs.list,allBodies,timing.timeScale)}Resolver.postSolvePosition(allBodies);Constraint.preSolveAll(allBodies);for(i=0;i<engine.constraintIterations;i++){Constraint.solveAll(allConstraints,timing.timeScale)}Constraint.postSolveAll(allBodies);Resolver.preSolveVelocity(pairs.list);for(i=0;i<engine.velocityIterations;i++){Resolver.solveVelocity(pairs.list,timing.timeScale)}if(pairs.collisionActive.length>0)Events.trigger(engine,'collisionActive',{pairs:pairs.collisionActive});if(pairs.collisionEnd.length>0)Events.trigger(engine,'collisionEnd',{pairs:pairs.collisionEnd});Metrics.update(engine.metrics,engine);Engine._bodiesClearForces(allBodies);Events.trigger(engine,'afterUpdate',event);return engine};Engine.merge=function(engineA,engineB){Common.extend(engineA,engineB);if(engineB.world){engineA.world=engineB.world;Engine.clear(engineA);var bodies=Composite.allBodies(engineA.world);for(var i=0;i<bodies.length;i++){var body=bodies[i];Sleeping.set(body,false);body.id=Common.nextId()}}};Engine.clear=function(engine){var world=engine.world;Pairs.clear(engine.pairs);var broadphase=engine.broadphase;if(broadphase.controller){var bodies=Composite.allBodies(world);broadphase.controller.clear(broadphase);broadphase.controller.update(broadphase,bodies,engine,true)}};Engine._bodiesClearForces=function(bodies){for(var i=0;i<bodies.length;i++){var body=bodies[i];body.force.x=0;body.force.y=0;body.torque=0}};Engine._bodiesApplyGravity=function(bodies,gravity){var gravityScale=typeof gravity.scale!=='undefined'?gravity.scale:0.001;if((gravity.x===0&&gravity.y===0)||gravityScale===0){return}for(var i=0;i<bodies.length;i++){var body=bodies[i];if(body.ignoreGravity||body.isStatic||body.isSleeping)continue;body.force.x+=(body.mass*gravity.x*gravityScale)*body.gravityScale.x;body.force.y+=(body.mass*gravity.y*gravityScale)*body.gravityScale.y}};Engine._bodiesUpdate=function(bodies,deltaTime,timeScale,correction,worldBounds){for(var i=0;i<bodies.length;i++){var body=bodies[i];if(body.isStatic||body.isSleeping)continue;Body.update(body,deltaTime,timeScale,correction)}}})()}),(function(module,exports,__webpack_require__){var Bodies=__webpack_require__(109);var Body=__webpack_require__(62);var Class=__webpack_require__(0);var Common=__webpack_require__(42);var Composite=__webpack_require__(148);var Engine=__webpack_require__(1391);var EventEmitter=__webpack_require__(10);var Events=__webpack_require__(1296);var GetFastValue=__webpack_require__(2);var GetValue=__webpack_require__(6);var MatterBody=__webpack_require__(62);var MatterEvents=__webpack_require__(240);var MatterTileBody=__webpack_require__(1297);var MatterWorld=__webpack_require__(1300);var Vector=__webpack_require__(99);var World=new Class({Extends:EventEmitter,initialize:function World(scene,config){EventEmitter.call(this);this.scene=scene;this.engine=Engine.create(config);this.localWorld=this.engine.world;var gravity=GetValue(config,'gravity',null);if(gravity){this.setGravity(gravity.x,gravity.y,gravity.scale)}else if(gravity===false){this.setGravity(0,0,0)}this.walls={left:null,right:null,top:null,bottom:null};this.enabled=GetValue(config,'enabled',true);this.correction=GetValue(config,'correction',1);this.getDelta=GetValue(config,'getDelta',this.update60Hz);var runnerConfig=GetFastValue(config,'runner',{});var hasFPS=GetFastValue(runnerConfig,'fps',false);var fps=GetFastValue(runnerConfig,'fps',60);var delta=GetFastValue(runnerConfig,'delta',1000/fps);var deltaMin=GetFastValue(runnerConfig,'deltaMin',1000/fps);var deltaMax=GetFastValue(runnerConfig,'deltaMax',1000/(fps*0.5));if(!hasFPS){fps=1000/delta}this.runner={fps:fps,correction:GetFastValue(runnerConfig,'correction',1),deltaSampleSize:GetFastValue(runnerConfig,'deltaSampleSize',60),counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:GetFastValue(runnerConfig,'isFixed',false),delta:delta,deltaMin:deltaMin,deltaMax:deltaMax};this.autoUpdate=GetValue(config,'autoUpdate',true);var debugConfig=GetValue(config,'debug',false);this.drawDebug=(typeof(debugConfig)==='object')?true:debugConfig;this.debugGraphic;this.debugConfig={showAxes:GetFastValue(debugConfig,'showAxes',false),showAngleIndicator:GetFastValue(debugConfig,'showAngleIndicator',false),angleColor:GetFastValue(debugConfig,'angleColor',0xe81153),showBroadphase:GetFastValue(debugConfig,'showBroadphase',false),broadphaseColor:GetFastValue(debugConfig,'broadphaseColor',0xffb400),showBounds:GetFastValue(debugConfig,'showBounds',false),boundsColor:GetFastValue(debugConfig,'boundsColor',0xffffff),showVelocity:GetFastValue(debugConfig,'showVelocity',false),velocityColor:GetFastValue(debugConfig,'velocityColor',0x00aeef),showCollisions:GetFastValue(debugConfig,'showCollisions',false),collisionColor:GetFastValue(debugConfig,'collisionColor',0xf5950c),showSeparations:GetFastValue(debugConfig,'showSeparations',false),separationColor:GetFastValue(debugConfig,'separationColor',0xffa500),showBody:GetFastValue(debugConfig,'showBody',true),showStaticBody:GetFastValue(debugConfig,'showStaticBody',true),showInternalEdges:GetFastValue(debugConfig,'showInternalEdges',false),renderFill:GetFastValue(debugConfig,'renderFill',false),renderLine:GetFastValue(debugConfig,'renderLine',true),fillColor:GetFastValue(debugConfig,'fillColor',0x106909),fillOpacity:GetFastValue(debugConfig,'fillOpacity',1),lineColor:GetFastValue(debugConfig,'lineColor',0x28de19),lineOpacity:GetFastValue(debugConfig,'lineOpacity',1),lineThickness:GetFastValue(debugConfig,'lineThickness',1),staticFillColor:GetFastValue(debugConfig,'staticFillColor',0x0d177b),staticLineColor:GetFastValue(debugConfig,'staticLineColor',0x1327e4),showSleeping:GetFastValue(debugConfig,'showSleeping',false),staticBodySleepOpacity:GetFastValue(debugConfig,'staticBodySleepOpacity',0.7),sleepFillColor:GetFastValue(debugConfig,'sleepFillColor',0x464646),sleepLineColor:GetFastValue(debugConfig,'sleepLineColor',0x999a99),showSensors:GetFastValue(debugConfig,'showSensors',true),sensorFillColor:GetFastValue(debugConfig,'sensorFillColor',0x0d177b),sensorLineColor:GetFastValue(debugConfig,'sensorLineColor',0x1327e4),showPositions:GetFastValue(debugConfig,'showPositions',true),positionSize:GetFastValue(debugConfig,'positionSize',4),positionColor:GetFastValue(debugConfig,'positionColor',0xe042da),showJoint:GetFastValue(debugConfig,'showJoint',true),jointColor:GetFastValue(debugConfig,'jointColor',0xe0e042),jointLineOpacity:GetFastValue(debugConfig,'jointLineOpacity',1),jointLineThickness:GetFastValue(debugConfig,'jointLineThickness',2),pinSize:GetFastValue(debugConfig,'pinSize',4),pinColor:GetFastValue(debugConfig,'pinColor',0x42e0e0),springColor:GetFastValue(debugConfig,'springColor',0xe042e0),anchorColor:GetFastValue(debugConfig,'anchorColor',0xefefef),anchorSize:GetFastValue(debugConfig,'anchorSize',4),showConvexHulls:GetFastValue(debugConfig,'showConvexHulls',false),hullColor:GetFastValue(debugConfig,'hullColor',0xd703d0)};if(this.drawDebug){this.createDebugGraphic()}this.setEventsProxy();if(GetFastValue(config,'setBounds',false)){var boundsConfig=config['setBounds'];if(typeof boundsConfig==='boolean'){this.setBounds()}else{var x=GetFastValue(boundsConfig,'x',0);var y=GetFastValue(boundsConfig,'y',0);var width=GetFastValue(boundsConfig,'width',scene.sys.scale.width);var height=GetFastValue(boundsConfig,'height',scene.sys.scale.height);var thickness=GetFastValue(boundsConfig,'thickness',64);var left=GetFastValue(boundsConfig,'left',true);var right=GetFastValue(boundsConfig,'right',true);var top=GetFastValue(boundsConfig,'top',true);var bottom=GetFastValue(boundsConfig,'bottom',true);this.setBounds(x,y,width,height,thickness,left,right,top,bottom)}}},setCompositeRenderStyle:function(composite){var bodies=composite.bodies;var constraints=composite.constraints;var composites=composite.composites;var i;var obj;var render;for(i=0;i<bodies.length;i++){obj=bodies[i];render=obj.render;this.setBodyRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.fillColor,render.fillOpacity)}for(i=0;i<constraints.length;i++){obj=constraints[i];render=obj.render;this.setConstraintRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.pinSize,render.anchorColor,render.anchorSize)}for(i=0;i<composites.length;i++){obj=composites[i];this.setCompositeRenderStyle(obj)}return this},setBodyRenderStyle:function(body,lineColor,lineOpacity,lineThickness,fillColor,fillOpacity){var render=body.render;var config=this.debugConfig;if(!render){return this}if(lineColor===undefined||lineColor===null){lineColor=(body.isStatic)?config.staticLineColor:config.lineColor}if(lineOpacity===undefined||lineOpacity===null){lineOpacity=config.lineOpacity}if(lineThickness===undefined||lineThickness===null){lineThickness=config.lineThickness}if(fillColor===undefined||fillColor===null){fillColor=(body.isStatic)?config.staticFillColor:config.fillColor}if(fillOpacity===undefined||fillOpacity===null){fillOpacity=config.fillOpacity}if(lineColor!==false){render.lineColor=lineColor}if(lineOpacity!==false){render.lineOpacity=lineOpacity}if(lineThickness!==false){render.lineThickness=lineThickness}if(fillColor!==false){render.fillColor=fillColor}if(fillOpacity!==false){render.fillOpacity=fillOpacity}return this},setConstraintRenderStyle:function(constraint,lineColor,lineOpacity,lineThickness,pinSize,anchorColor,anchorSize){var render=constraint.render;var config=this.debugConfig;if(!render){return this}if(lineColor===undefined||lineColor===null){var type=render.type;if(type==='line'){lineColor=config.jointColor}else if(type==='pin'){lineColor=config.pinColor}else if(type==='spring'){lineColor=config.springColor}}if(lineOpacity===undefined||lineOpacity===null){lineOpacity=config.jointLineOpacity}if(lineThickness===undefined||lineThickness===null){lineThickness=config.jointLineThickness}if(pinSize===undefined||pinSize===null){pinSize=config.pinSize}if(anchorColor===undefined||anchorColor===null){anchorColor=config.anchorColor}if(anchorSize===undefined||anchorSize===null){anchorSize=config.anchorSize}if(lineColor!==false){render.lineColor=lineColor}if(lineOpacity!==false){render.lineOpacity=lineOpacity}if(lineThickness!==false){render.lineThickness=lineThickness}if(pinSize!==false){render.pinSize=pinSize}if(anchorColor!==false){render.anchorColor=anchorColor}if(anchorSize!==false){render.anchorSize=anchorSize}return this},setEventsProxy:function(){var _this=this;var engine=this.engine;var world=this.localWorld;if(this.drawDebug){MatterEvents.on(world,'compositeModified',function(composite){_this.setCompositeRenderStyle(composite)});MatterEvents.on(world,'beforeAdd',function(event){var objects=[].concat(event.object);for(var i=0;i<objects.length;i++){var obj=objects[i];var render=obj.render;if(obj.type==='body'){_this.setBodyRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.fillColor,render.fillOpacity)}else if(obj.type==='composite'){_this.setCompositeRenderStyle(obj)}else if(obj.type==='constraint'){_this.setConstraintRenderStyle(obj,render.lineColor,render.lineOpacity,render.lineThickness,render.pinSize,render.anchorColor,render.anchorSize)}}})}MatterEvents.on(world,'beforeAdd',function(event){_this.emit(Events.BEFORE_ADD,event)});MatterEvents.on(world,'afterAdd',function(event){_this.emit(Events.AFTER_ADD,event)});MatterEvents.on(world,'beforeRemove',function(event){_this.emit(Events.BEFORE_REMOVE,event)});MatterEvents.on(world,'afterRemove',function(event){_this.emit(Events.AFTER_REMOVE,event)});MatterEvents.on(engine,'beforeUpdate',function(event){_this.emit(Events.BEFORE_UPDATE,event)});MatterEvents.on(engine,'afterUpdate',function(event){_this.emit(Events.AFTER_UPDATE,event)});MatterEvents.on(engine,'collisionStart',function(event){var pairs=event.pairs;var bodyA;var bodyB;if(pairs.length>0){bodyA=pairs[0].bodyA;bodyB=pairs[0].bodyB}_this.emit(Events.COLLISION_START,event,bodyA,bodyB)});MatterEvents.on(engine,'collisionActive',function(event){var pairs=event.pairs;var bodyA;var bodyB;if(pairs.length>0){bodyA=pairs[0].bodyA;bodyB=pairs[0].bodyB}_this.emit(Events.COLLISION_ACTIVE,event,bodyA,bodyB)});MatterEvents.on(engine,'collisionEnd',function(event){var pairs=event.pairs;var bodyA;var bodyB;if(pairs.length>0){bodyA=pairs[0].bodyA;bodyB=pairs[0].bodyB}_this.emit(Events.COLLISION_END,event,bodyA,bodyB)})},setBounds:function(x,y,width,height,thickness,left,right,top,bottom){if(x===undefined){x=0}if(y===undefined){y=0}if(width===undefined){width=this.scene.sys.scale.width}if(height===undefined){height=this.scene.sys.scale.height}if(thickness===undefined){thickness=64}if(left===undefined){left=true}if(right===undefined){right=true}if(top===undefined){top=true}if(bottom===undefined){bottom=true}this.updateWall(left,'left',x-thickness,y-thickness,thickness,height+(thickness*2));this.updateWall(right,'right',x+width,y-thickness,thickness,height+(thickness*2));this.updateWall(top,'top',x,y-thickness,width,thickness);this.updateWall(bottom,'bottom',x,y+height,width,thickness);return this},updateWall:function(add,position,x,y,width,height){var wall=this.walls[position];if(add){if(wall){MatterWorld.remove(this.localWorld,wall)}x+=(width/2);y+=(height/2);this.walls[position]=this.create(x,y,width,height,{isStatic:true,friction:0,frictionStatic:0})}else{if(wall){MatterWorld.remove(this.localWorld,wall)}this.walls[position]=null}},createDebugGraphic:function(){var graphic=this.scene.sys.add.graphics({x:0,y:0});graphic.setDepth(Number.MAX_VALUE);this.debugGraphic=graphic;this.drawDebug=true;return graphic},disableGravity:function(){this.localWorld.gravity.x=0;this.localWorld.gravity.y=0;this.localWorld.gravity.scale=0;return this},setGravity:function(x,y,scale){if(x===undefined){x=0}if(y===undefined){y=1}this.localWorld.gravity.x=x;this.localWorld.gravity.y=y;if(scale!==undefined){this.localWorld.gravity.scale=scale}return this},create:function(x,y,width,height,options){var body=Bodies.rectangle(x,y,width,height,options);MatterWorld.add(this.localWorld,body);return body},add:function(object){MatterWorld.add(this.localWorld,object);return this},remove:function(object,deep){if(!Array.isArray(object)){object=[object]}for(var i=0;i<object.length;i++){var entity=object[i];var body=(entity.body)?entity.body:entity;Composite.remove(this.localWorld,body,deep)}return this},removeConstraint:function(constraint,deep){Composite.remove(this.localWorld,constraint,deep);return this},convertTilemapLayer:function(tilemapLayer,options){var layerData=tilemapLayer.layer;var tiles=tilemapLayer.getTilesWithin(0,0,layerData.width,layerData.height,{isColliding:true});this.convertTiles(tiles,options);return this},convertTiles:function(tiles,options){if(tiles.length===0){return this}for(var i=0;i<tiles.length;i++){new MatterTileBody(this,tiles[i],options)}return this},nextGroup:function(isNonColliding){return MatterBody.nextGroup(isNonColliding)},nextCategory:function(){return MatterBody.nextCategory()},pause:function(){this.enabled=false;this.emit(Events.PAUSE);return this},resume:function(){this.enabled=true;this.emit(Events.RESUME);return this},update:function(time,delta){if(!this.enabled||!this.autoUpdate){return}var engine=this.engine;var runner=this.runner;var timing=engine.timing;var correction=this.correction;if(runner.isFixed){delta=this.getDelta(time,delta)}else{delta=(time-runner.timePrev)||runner.delta;runner.timePrev=time;runner.deltaHistory.push(delta);runner.deltaHistory=runner.deltaHistory.slice(-runner.deltaSampleSize);delta=Math.min.apply(null,runner.deltaHistory);delta=delta<runner.deltaMin?runner.deltaMin:delta;delta=delta>runner.deltaMax?runner.deltaMax:delta;correction=delta/runner.delta;runner.delta=delta}if(runner.timeScalePrev!==0){correction*=timing.timeScale/runner.timeScalePrev}if(timing.timeScale===0){correction=0}runner.timeScalePrev=timing.timeScale;runner.correction=correction;runner.frameCounter+=1;if(time-runner.counterTimestamp>=1000){runner.fps=runner.frameCounter*((time-runner.counterTimestamp)/1000);runner.counterTimestamp=time;runner.frameCounter=0}Engine.update(engine,delta,correction)},step:function(delta,correction){Engine.update(this.engine,delta,correction)},update60Hz:function(){return 1000/60},update30Hz:function(){return 1000/30},has:function(body){var src=(body.hasOwnProperty('body'))?body.body:body;return(Composite.get(this.localWorld,src.id,src.type)!==null)},getAllBodies:function(){return Composite.allBodies(this.localWorld)},getAllConstraints:function(){return Composite.allConstraints(this.localWorld)},getAllComposites:function(){return Composite.allComposites(this.localWorld)},postUpdate:function(){if(!this.drawDebug){return}var config=this.debugConfig;var engine=this.engine;var graphics=this.debugGraphic;var bodies=Composite.allBodies(this.localWorld);this.debugGraphic.clear();if(config.showBroadphase&&engine.broadphase.controller){this.renderGrid(engine.broadphase,graphics,config.broadphaseColor,0.5)}if(config.showBounds){this.renderBodyBounds(bodies,graphics,config.boundsColor,0.5)}if(config.showBody||config.showStaticBody){this.renderBodies(bodies)}if(config.showJoint){this.renderJoints()}if(config.showAxes||config.showAngleIndicator){this.renderBodyAxes(bodies,graphics,config.showAxes,config.angleColor,0.5)}if(config.showVelocity){this.renderBodyVelocity(bodies,graphics,config.velocityColor,1,2)}if(config.showSeparations){this.renderSeparations(engine.pairs.list,graphics,config.separationColor)}if(config.showCollisions){this.renderCollisions(engine.pairs.list,graphics,config.collisionColor)}},renderGrid:function(grid,graphics,lineColor,lineOpacity){graphics.lineStyle(1,lineColor,lineOpacity);var bucketKeys=Common.keys(grid.buckets);for(var i=0;i<bucketKeys.length;i++){var bucketId=bucketKeys[i];if(grid.buckets[bucketId].length<2){continue}var region=bucketId.split(/C|R/);graphics.strokeRect(parseInt(region[1],10)*grid.bucketWidth,parseInt(region[2],10)*grid.bucketHeight,grid.bucketWidth,grid.bucketHeight)}return this},renderSeparations:function(pairs,graphics,lineColor){graphics.lineStyle(1,lineColor,1);for(var i=0;i<pairs.length;i++){var pair=pairs[i];if(!pair.isActive){continue}var collision=pair.collision;var bodyA=collision.bodyA;var bodyB=collision.bodyB;var posA=bodyA.position;var posB=bodyB.position;var penetration=collision.penetration;var k=(!bodyA.isStatic&&!bodyB.isStatic)?4:1;if(bodyB.isStatic){k=0}graphics.lineBetween(posB.x,posB.y,posB.x-(penetration.x*k),posB.y-(penetration.y*k));k=(!bodyA.isStatic&&!bodyB.isStatic)?4:1;if(bodyA.isStatic){k=0}graphics.lineBetween(posA.x,posA.y,posA.x-(penetration.x*k),posA.y-(penetration.y*k))}return this},renderCollisions:function(pairs,graphics,lineColor){graphics.lineStyle(1,lineColor,0.5);graphics.fillStyle(lineColor,1);var i;var pair;for(i=0;i<pairs.length;i++){pair=pairs[i];if(!pair.isActive){continue}for(var j=0;j<pair.activeContacts.length;j++){var contact=pair.activeContacts[j];var vertex=contact.vertex;graphics.fillRect(vertex.x-2,vertex.y-2,5,5)}}for(i=0;i<pairs.length;i++){pair=pairs[i];if(!pair.isActive){continue}var collision=pair.collision;var contacts=pair.activeContacts;if(contacts.length>0){var normalPosX=contacts[0].vertex.x;var normalPosY=contacts[0].vertex.y;if(contacts.length===2){normalPosX=(contacts[0].vertex.x+contacts[1].vertex.x)/2;normalPosY=(contacts[0].vertex.y+contacts[1].vertex.y)/2}if(collision.bodyB===collision.supports[0].body||collision.bodyA.isStatic){graphics.lineBetween(normalPosX-collision.normal.x*8,normalPosY-collision.normal.y*8,normalPosX,normalPosY)}else{graphics.lineBetween(normalPosX+collision.normal.x*8,normalPosY+collision.normal.y*8,normalPosX,normalPosY)}}}return this},renderBodyBounds:function(bodies,graphics,lineColor,lineOpacity){graphics.lineStyle(1,lineColor,lineOpacity);for(var i=0;i<bodies.length;i++){var body=bodies[i];if(!body.render.visible){continue}var bounds=body.bounds;if(bounds){graphics.strokeRect(bounds.min.x,bounds.min.y,bounds.max.x-bounds.min.x,bounds.max.y-bounds.min.y)}else{var parts=body.parts;for(var j=parts.length>1?1:0;j<parts.length;j++){var part=parts[j];graphics.strokeRect(part.bounds.min.x,part.bounds.min.y,part.bounds.max.x-part.bounds.min.x,part.bounds.max.y-part.bounds.min.y)}}}return this},renderBodyAxes:function(bodies,graphics,showAxes,lineColor,lineOpacity){graphics.lineStyle(1,lineColor,lineOpacity);for(var i=0;i<bodies.length;i++){var body=bodies[i];var parts=body.parts;if(!body.render.visible){continue}var part;var j;var k;if(showAxes){for(j=parts.length>1?1:0;j<parts.length;j++){part=parts[j];for(k=0;k<part.axes.length;k++){var axis=part.axes[k];graphics.lineBetween(part.position.x,part.position.y,part.position.x+axis.x*20,part.position.y+axis.y*20)}}}else{for(j=parts.length>1?1:0;j<parts.length;j++){part=parts[j];for(k=0;k<part.axes.length;k++){graphics.lineBetween(part.position.x,part.position.y,(part.vertices[0].x+part.vertices[part.vertices.length-1].x)/2,(part.vertices[0].y+part.vertices[part.vertices.length-1].y)/2)}}}}return this},renderBodyVelocity:function(bodies,graphics,lineColor,lineOpacity,lineThickness){graphics.lineStyle(lineThickness,lineColor,lineOpacity);for(var i=0;i<bodies.length;i++){var body=bodies[i];if(!body.render.visible){continue}graphics.lineBetween(body.position.x,body.position.y,body.position.x+(body.position.x-body.positionPrev.x)*2,body.position.y+(body.position.y-body.positionPrev.y)*2)}return this},renderBodies:function(bodies){var graphics=this.debugGraphic;var config=this.debugConfig;var showBody=config.showBody;var showStaticBody=config.showStaticBody;var showSleeping=config.showSleeping;var showInternalEdges=config.showInternalEdges;var showConvexHulls=config.showConvexHulls;var renderFill=config.renderFill;var renderLine=config.renderLine;var staticBodySleepOpacity=config.staticBodySleepOpacity;var sleepFillColor=config.sleepFillColor;var sleepLineColor=config.sleepLineColor;var hullColor=config.hullColor;for(var i=0;i<bodies.length;i++){var body=bodies[i];if(!body.render.visible){continue}if((!showStaticBody&&body.isStatic)||(!showBody&&!body.isStatic)){continue}var lineColor=body.render.lineColor;var lineOpacity=body.render.lineOpacity;var lineThickness=body.render.lineThickness;var fillColor=body.render.fillColor;var fillOpacity=body.render.fillOpacity;if(showSleeping&&body.isSleeping){if(body.isStatic){lineOpacity*=staticBodySleepOpacity;fillOpacity*=staticBodySleepOpacity}else{lineColor=sleepLineColor;fillColor=sleepFillColor}}if(!renderFill){fillColor=null}if(!renderLine){lineColor=null}this.renderBody(body,graphics,showInternalEdges,lineColor,lineOpacity,lineThickness,fillColor,fillOpacity);var partsLength=body.parts.length;if(showConvexHulls&&partsLength>1){this.renderConvexHull(body,graphics,hullColor,lineThickness)}}},renderBody:function(body,graphics,showInternalEdges,lineColor,lineOpacity,lineThickness,fillColor,fillOpacity){if(lineColor===undefined){lineColor=null}if(lineOpacity===undefined){lineOpacity=null}if(lineThickness===undefined){lineThickness=1}if(fillColor===undefined){fillColor=null}if(fillOpacity===undefined){fillOpacity=null}var config=this.debugConfig;var sensorFillColor=config.sensorFillColor;var sensorLineColor=config.sensorLineColor;var parts=body.parts;var partsLength=parts.length;for(var k=(partsLength>1)?1:0;k<partsLength;k++){var part=parts[k];var render=part.render;var opacity=render.opacity;if(!render.visible||opacity===0||(part.isSensor&&!config.showSensors)){continue}var circleRadius=part.circleRadius;graphics.beginPath();if(part.isSensor){if(fillColor!==null){graphics.fillStyle(sensorFillColor,fillOpacity*opacity)}if(lineColor!==null){graphics.lineStyle(lineThickness,sensorLineColor,lineOpacity*opacity)}}else{if(fillColor!==null){graphics.fillStyle(fillColor,fillOpacity*opacity)}if(lineColor!==null){graphics.lineStyle(lineThickness,lineColor,lineOpacity*opacity)}}if(circleRadius){graphics.arc(part.position.x,part.position.y,circleRadius,0,2*Math.PI)}else{var vertices=part.vertices;var vertLength=vertices.length;graphics.moveTo(vertices[0].x,vertices[0].y);for(var j=1;j<vertLength;j++){var vert=vertices[j];if(!vertices[j-1].isInternal||showInternalEdges){graphics.lineTo(vert.x,vert.y)}else{graphics.moveTo(vert.x,vert.y)}if(j<vertLength&&vert.isInternal&&!showInternalEdges){var nextIndex=(j+1)%vertLength;graphics.moveTo(vertices[nextIndex].x,vertices[nextIndex].y)}}graphics.closePath()}if(fillColor!==null){graphics.fillPath()}if(lineColor!==null){graphics.strokePath()}}if(config.showPositions&&!body.isStatic){var px=body.position.x;var py=body.position.y;var hs=Math.ceil(config.positionSize/2);graphics.fillStyle(config.positionColor,1);graphics.fillRect(px-hs,py-hs,config.positionSize,config.positionSize)}return this},renderConvexHull:function(body,graphics,hullColor,lineThickness){if(lineThickness===undefined){lineThickness=1}var parts=body.parts;var partsLength=parts.length;if(partsLength>1){var verts=body.vertices;graphics.lineStyle(lineThickness,hullColor);graphics.beginPath();graphics.moveTo(verts[0].x,verts[0].y);for(var v=1;v<verts.length;v++){graphics.lineTo(verts[v].x,verts[v].y)}graphics.lineTo(verts[0].x,verts[0].y);graphics.strokePath()}return this},renderJoints:function(){var graphics=this.debugGraphic;var constraints=Composite.allConstraints(this.localWorld);for(var i=0;i<constraints.length;i++){var config=constraints[i].render;var lineColor=config.lineColor;var lineOpacity=config.lineOpacity;var lineThickness=config.lineThickness;var pinSize=config.pinSize;var anchorColor=config.anchorColor;var anchorSize=config.anchorSize;this.renderConstraint(constraints[i],graphics,lineColor,lineOpacity,lineThickness,pinSize,anchorColor,anchorSize)}},renderConstraint:function(constraint,graphics,lineColor,lineOpacity,lineThickness,pinSize,anchorColor,anchorSize){var render=constraint.render;if(!render.visible||!constraint.pointA||!constraint.pointB){return this}graphics.lineStyle(lineThickness,lineColor,lineOpacity);var bodyA=constraint.bodyA;var bodyB=constraint.bodyB;var start;var end;if(bodyA){start=Vector.add(bodyA.position,constraint.pointA)}else{start=constraint.pointA}if(render.type==='pin'){graphics.strokeCircle(start.x,start.y,pinSize)}else{if(bodyB){end=Vector.add(bodyB.position,constraint.pointB)}else{end=constraint.pointB}graphics.beginPath();graphics.moveTo(start.x,start.y);if(render.type==='spring'){var delta=Vector.sub(end,start);var normal=Vector.perp(Vector.normalise(delta));var coils=Math.ceil(Common.clamp(constraint.length/5,12,20));var offset;for(var j=1;j<coils;j+=1){offset=(j%2===0)?1:-1;graphics.lineTo(start.x+delta.x*(j/coils)+normal.x*offset*4,start.y+delta.y*(j/coils)+normal.y*offset*4)}}graphics.lineTo(end.x,end.y)}graphics.strokePath();if(render.anchors&&anchorSize>0){graphics.fillStyle(anchorColor);graphics.fillCircle(start.x,start.y,anchorSize);graphics.fillCircle(end.x,end.y,anchorSize)}return this},resetCollisionIDs:function(){Body._nextCollidingGroupId=1;Body._nextNonCollidingGroupId=-1;Body._nextCategory=0x0001;return this},shutdown:function(){MatterEvents.off(this.engine);this.removeAllListeners();MatterWorld.clear(this.localWorld,false);Engine.clear(this.engine);if(this.drawDebug){this.debugGraphic.destroy()}},destroy:function(){this.shutdown()}});module.exports=World}),(function(module,exports,__webpack_require__){(function(global){__webpack_require__(518);var CONST=__webpack_require__(33);var Extend=__webpack_require__(18);var Phaser={Actions:__webpack_require__(241),Animations:__webpack_require__(638),BlendModes:__webpack_require__(52),Cache:__webpack_require__(639),Cameras:__webpack_require__(642),Core:__webpack_require__(728),Class:__webpack_require__(0),Create:__webpack_require__(789),Curves:__webpack_require__(795),Data:__webpack_require__(798),Display:__webpack_require__(800),DOM:__webpack_require__(818),Events:__webpack_require__(819),Game:__webpack_require__(821),GameObjects:__webpack_require__(914),Geom:__webpack_require__(430),Input:__webpack_require__(1201),Loader:__webpack_require__(1235),Math:__webpack_require__(170),Physics:__webpack_require__(1394),Plugins:__webpack_require__(1304),Renderer:__webpack_require__(1431),Scale:__webpack_require__(1306),ScaleModes:__webpack_require__(234),Scene:__webpack_require__(374),Scenes:__webpack_require__(1307),Structs:__webpack_require__(1309),Textures:__webpack_require__(1310),Tilemaps:__webpack_require__(1312),Time:__webpack_require__(1353),Tweens:__webpack_require__(1355),Utils:__webpack_require__(1373)};if(true){Phaser.Sound=__webpack_require__(1383)}if(false){}if(false){}Phaser=Extend(false,Phaser,CONST);module.exports=Phaser;global.Phaser=Phaser}.call(this,__webpack_require__(517)))}),(function(module,exports,__webpack_require__){module.exports={Arcade:__webpack_require__(1261),Matter:__webpack_require__(1395)}}),(function(module,exports,__webpack_require__){module.exports={BodyBounds:__webpack_require__(1384),Factory:__webpack_require__(1385),Image:__webpack_require__(1387),Matter:__webpack_require__(1298),MatterPhysics:__webpack_require__(1427),PolyDecomp:__webpack_require__(1386),Sprite:__webpack_require__(1388),TileBody:__webpack_require__(1297),PhysicsEditorParser:__webpack_require__(1294),PhysicsJSONParser:__webpack_require__(1295),World:__webpack_require__(1392)}}),(function(module,exports,__webpack_require__){var Components=__webpack_require__(514);var GetFastValue=__webpack_require__(2);var Vector2=__webpack_require__(3);function hasGetterOrSetter(def){return(!!def.get&&typeof def.get==='function')||(!!def.set&&typeof def.set==='function')}var MatterGameObject=function(world,gameObject,options,addToWorld){if(options===undefined){options={}}if(addToWorld===undefined){addToWorld=true}var x=gameObject.x;var y=gameObject.y;gameObject.body={temp:true,position:{x:x,y:y}};var mixins=[Components.Bounce,Components.Collision,Components.Force,Components.Friction,Components.Gravity,Components.Mass,Components.Sensor,Components.SetBody,Components.Sleep,Components.Static,Components.Transform,Components.Velocity];mixins.forEach(function(mixin){for(var key in mixin){if(hasGetterOrSetter(mixin[key])){Object.defineProperty(gameObject,key,{get:mixin[key].get,set:mixin[key].set})}else{Object.defineProperty(gameObject,key,{value:mixin[key]})}}});gameObject.world=world;gameObject._tempVec2=new Vector2(x,y);if(options.hasOwnProperty('type')&&options.type==='body'){gameObject.setExistingBody(options,addToWorld)}else{var shape=GetFastValue(options,'shape',null);if(!shape){shape='rectangle'}options.addToWorld=addToWorld;gameObject.setBody(shape,options)}return gameObject};module.exports=MatterGameObject}),(function(module,exports){var Bounce={setBounce:function(value){this.body.restitution=value;return this}};module.exports=Bounce}),(function(module,exports){var Collision={setCollisionCategory:function(value){this.body.collisionFilter.category=value;return this},setCollisionGroup:function(value){this.body.collisionFilter.group=value;return this},setCollidesWith:function(categories){var flags=0;if(!Array.isArray(categories)){flags=categories}else{for(var i=0;i<categories.length;i++){flags|=categories[i]}}this.body.collisionFilter.mask=flags;return this},setOnCollide:function(callback){this.body.onCollideCallback=callback;return this},setOnCollideEnd:function(callback){this.body.onCollideEndCallback=callback;return this},setOnCollideActive:function(callback){this.body.onCollideActiveCallback=callback;return this},setOnCollideWith:function(body,callback){if(!Array.isArray(body)){body=[body]}for(var i=0;i<body.length;i++){var src=(body[i].hasOwnProperty('body'))?body[i].body:body[i];this.body.setOnCollideWith(src,callback)}return this}};module.exports=Collision}),(function(module,exports,__webpack_require__){var Body=__webpack_require__(62);var Force={applyForce:function(force){this._tempVec2.set(this.body.position.x,this.body.position.y);Body.applyForce(this.body,this._tempVec2,force);return this},applyForceFrom:function(position,force){Body.applyForce(this.body,position,force);return this},thrust:function(speed){var angle=this.body.angle;this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle));Body.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2);return this},thrustLeft:function(speed){var angle=this.body.angle-Math.PI/2;this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle));Body.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2);return this},thrustRight:function(speed){var angle=this.body.angle+Math.PI/2;this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle));Body.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2);return this},thrustBack:function(speed){var angle=this.body.angle-Math.PI;this._tempVec2.set(speed*Math.cos(angle),speed*Math.sin(angle));Body.applyForce(this.body,{x:this.body.position.x,y:this.body.position.y},this._tempVec2);return this}};module.exports=Force}),(function(module,exports){var Friction={setFriction:function(value,air,fstatic){this.body.friction=value;if(air!==undefined){this.body.frictionAir=air}if(fstatic!==undefined){this.body.frictionStatic=fstatic}return this},setFrictionAir:function(value){this.body.frictionAir=value;return this},setFrictionStatic:function(value){this.body.frictionStatic=value;return this}};module.exports=Friction}),(function(module,exports){var Gravity={setIgnoreGravity:function(value){this.body.ignoreGravity=value;return this}};module.exports=Gravity}),(function(module,exports,__webpack_require__){var Body=__webpack_require__(62);var Vector2=__webpack_require__(3);var Mass={setMass:function(value){Body.setMass(this.body,value);return this},setDensity:function(value){Body.setDensity(this.body,value);return this},centerOfMass:{get:function(){return new Vector2(this.body.centerOfMass.x,this.body.centerOfMass.y)}}};module.exports=Mass}),(function(module,exports,__webpack_require__){var Body=__webpack_require__(62);var Static={setStatic:function(value){Body.setStatic(this.body,value);return this},isStatic:function(){return this.body.isStatic}};module.exports=Static}),(function(module,exports){var Sensor={setSensor:function(value){this.body.isSensor=value;return this},isSensor:function(){return this.body.isSensor}};module.exports=Sensor}),(function(module,exports,__webpack_require__){var Bodies=__webpack_require__(109);var Body=__webpack_require__(62);var FuzzyEquals=__webpack_require__(106);var GetFastValue=__webpack_require__(2);var PhysicsEditorParser=__webpack_require__(1294);var PhysicsJSONParser=__webpack_require__(1295);var Vertices=__webpack_require__(86);var SetBody={setRectangle:function(width,height,options){return this.setBody({type:'rectangle',width:width,height:height},options)},setCircle:function(radius,options){return this.setBody({type:'circle',radius:radius},options)},setPolygon:function(radius,sides,options){return this.setBody({type:'polygon',sides:sides,radius:radius},options)},setTrapezoid:function(width,height,slope,options){return this.setBody({type:'trapezoid',width:width,height:height,slope:slope},options)},setExistingBody:function(body,addToWorld){if(addToWorld===undefined){addToWorld=true}if(this.body){this.world.remove(this.body,true)}this.body=body;for(var i=0;i<body.parts.length;i++){body.parts[i].gameObject=this}var _this=this;body.destroy=function destroy(){_this.world.remove(_this.body,true);_this.body.gameObject=null};if(addToWorld){if(this.world.has(body)){this.world.remove(body,true)}this.world.add(body)}if(this._originComponent){var rx=body.render.sprite.xOffset;var ry=body.render.sprite.yOffset;var comx=body.centerOfMass.x;var comy=body.centerOfMass.y;if(FuzzyEquals(comx,0.5)&&FuzzyEquals(comy,0.5)){this.setOrigin(rx+0.5,ry+0.5)}else{var cx=body.centerOffset.x;var cy=body.centerOffset.y;this.setOrigin(rx+(cx/this.displayWidth),ry+(cy/this.displayHeight))}}return this},setBody:function(config,options){if(!config){return this}var body;if(typeof config==='string'){config={type:config}}var shapeType=GetFastValue(config,'type','rectangle');var bodyX=GetFastValue(config,'x',this._tempVec2.x);var bodyY=GetFastValue(config,'y',this._tempVec2.y);var bodyWidth=GetFastValue(config,'width',this.width);var bodyHeight=GetFastValue(config,'height',this.height);switch(shapeType){case'rectangle':body=Bodies.rectangle(bodyX,bodyY,bodyWidth,bodyHeight,options);break;case'circle':var radius=GetFastValue(config,'radius',Math.max(bodyWidth,bodyHeight)/2);var maxSides=GetFastValue(config,'maxSides',25);body=Bodies.circle(bodyX,bodyY,radius,options,maxSides);break;case'trapezoid':var slope=GetFastValue(config,'slope',0.5);body=Bodies.trapezoid(bodyX,bodyY,bodyWidth,bodyHeight,slope,options);break;case'polygon':var sides=GetFastValue(config,'sides',5);var pRadius=GetFastValue(config,'radius',Math.max(bodyWidth,bodyHeight)/2);body=Bodies.polygon(bodyX,bodyY,sides,pRadius,options);break;case'fromVertices':case'fromVerts':var verts=GetFastValue(config,'verts',null);if(verts){if(typeof verts==='string'){verts=Vertices.fromPath(verts)}if(this.body&&!this.body.hasOwnProperty('temp')){Body.setVertices(this.body,verts);body=this.body}else{var flagInternal=GetFastValue(config,'flagInternal',false);var removeCollinear=GetFastValue(config,'removeCollinear',0.01);var minimumArea=GetFastValue(config,'minimumArea',10);body=Bodies.fromVertices(bodyX,bodyY,verts,options,flagInternal,removeCollinear,minimumArea)}}break;case'fromPhysicsEditor':body=PhysicsEditorParser.parseBody(bodyX,bodyY,config,options);break;case'fromPhysicsTracer':body=PhysicsJSONParser.parseBody(bodyX,bodyY,config,options);break}if(body){this.setExistingBody(body,config.addToWorld)}return this}};module.exports=SetBody}),(function(module,exports,__webpack_require__){var Events=__webpack_require__(1296);var Sleeping=__webpack_require__(239);var MatterEvents=__webpack_require__(240);var Sleep={setToSleep:function(){Sleeping.set(this.body,true)},setAwake:function(){Sleeping.set(this.body,false)},setSleepThreshold:function(value){if(value===undefined){value=60}this.body.sleepThreshold=value;return this},setSleepEvents:function(start,end){this.setSleepStartEvent(start);this.setSleepEndEvent(end);return this},setSleepStartEvent:function(value){if(value){var world=this.world;MatterEvents.on(this.body,'sleepStart',function(event){world.emit(Events.SLEEP_START,event,this)})}else{MatterEvents.off(this.body,'sleepStart')}return this},setSleepEndEvent:function(value){if(value){var world=this.world;MatterEvents.on(this.body,'sleepEnd',function(event){world.emit(Events.SLEEP_END,event,this)})}else{MatterEvents.off(this.body,'sleepEnd')}return this}};module.exports=Sleep}),(function(module,exports){module.exports='afteradd'}),(function(module,exports){module.exports='afterremove'}),(function(module,exports){module.exports='afterupdate'}),(function(module,exports){module.exports='beforeadd'}),(function(module,exports){module.exports='beforeremove'}),(function(module,exports){module.exports='beforeupdate'}),(function(module,exports){module.exports='collisionactive'}),(function(module,exports){module.exports='collisionend'}),(function(module,exports){module.exports='collisionstart'}),(function(module,exports){module.exports='dragend'}),(function(module,exports){module.exports='drag'}),(function(module,exports){module.exports='dragstart'}),(function(module,exports){module.exports='pause'}),(function(module,exports){module.exports='resume'}),(function(module,exports){module.exports='sleepend'}),(function(module,exports){module.exports='sleepstart'}),(function(module,exports,__webpack_require__){var Body=__webpack_require__(62);var MATH_CONST=__webpack_require__(13);var WrapAngle=__webpack_require__(235);var WrapAngleDegrees=__webpack_require__(236);var _FLAG=4;var Transform={x:{get:function(){return this.body.position.x},set:function(value){this._tempVec2.set(value,this.y);Body.setPosition(this.body,this._tempVec2)}},y:{get:function(){return this.body.position.y},set:function(value){this._tempVec2.set(this.x,value);Body.setPosition(this.body,this._tempVec2)}},scaleX:{get:function(){return this._scaleX},set:function(value){var factorX=1/this._scaleX;var factorY=1/this._scaleY;this._scaleX=value;if(this._scaleX===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}Body.scale(this.body,factorX,factorY);Body.scale(this.body,value,this._scaleY)}},scaleY:{get:function(){return this._scaleY},set:function(value){var factorX=1/this._scaleX;var factorY=1/this._scaleY;this._scaleY=value;if(this._scaleY===0){this.renderFlags&=~_FLAG}else{this.renderFlags|=_FLAG}Body.scale(this.body,factorX,factorY);Body.scale(this.body,this._scaleX,value)}},angle:{get:function(){return WrapAngleDegrees(this.body.angle*MATH_CONST.RAD_TO_DEG)},set:function(value){this.rotation=WrapAngleDegrees(value)*MATH_CONST.DEG_TO_RAD}},rotation:{get:function(){return this.body.angle},set:function(value){this._rotation=WrapAngle(value);Body.setAngle(this.body,this._rotation)}},setPosition:function(x,y){if(x===undefined){x=0}if(y===undefined){y=x}this._tempVec2.set(x,y);Body.setPosition(this.body,this._tempVec2);return this},setRotation:function(radians){if(radians===undefined){radians=0}this._rotation=WrapAngle(radians);Body.setAngle(this.body,radians);return this},setFixedRotation:function(){Body.setInertia(this.body,Infinity);return this},setAngle:function(degrees){if(degrees===undefined){degrees=0}this.angle=degrees;Body.setAngle(this.body,this.rotation);return this},setScale:function(x,y,point){if(x===undefined){x=1}if(y===undefined){y=x}var factorX=1/this._scaleX;var factorY=1/this._scaleY;this._scaleX=x;this._scaleY=y;Body.scale(this.body,factorX,factorY,point);Body.scale(this.body,x,y,point);return this}};module.exports=Transform}),(function(module,exports,__webpack_require__){var Body=__webpack_require__(62);var Velocity={setAngularVelocity:function(value){Body.setAngularVelocity(this.body,value);return this},setVelocityX:function(x){this._tempVec2.set(x,this.body.velocity.y);Body.setVelocity(this.body,this._tempVec2);return this},setVelocityY:function(y){this._tempVec2.set(this.body.velocity.x,y);Body.setVelocity(this.body,this._tempVec2);return this},setVelocity:function(x,y){this._tempVec2.set(x,y);Body.setVelocity(this.body,this._tempVec2);return this}};module.exports=Velocity}),(function(module,exports,__webpack_require__){var Bounds=__webpack_require__(100);var Class=__webpack_require__(0);var Composite=__webpack_require__(148);var Constraint=__webpack_require__(219);var Detector=__webpack_require__(515);var Events=__webpack_require__(1296);var InputEvents=__webpack_require__(54);var Merge=__webpack_require__(126);var Sleeping=__webpack_require__(239);var Vector2=__webpack_require__(3);var Vertices=__webpack_require__(86);var PointerConstraint=new Class({initialize:function PointerConstraint(scene,world,options){if(options===undefined){options={}}var defaults={label:'Pointer Constraint',pointA:{x:0,y:0},pointB:{x:0,y:0},length:0.01,stiffness:0.1,angularStiffness:1,collisionFilter:{category:0x0001,mask:0xFFFFFFFF,group:0}};this.scene=scene;this.world=world;this.camera=null;this.pointer=null;this.active=true;this.position=new Vector2();this.body=null;this.part=null;this.constraint=Constraint.create(Merge(options,defaults));this.world.on(Events.BEFORE_UPDATE,this.update,this);scene.sys.input.on(InputEvents.POINTER_DOWN,this.onDown,this);scene.sys.input.on(InputEvents.POINTER_UP,this.onUp,this)},onDown:function(pointer){if(!this.pointer){this.pointer=pointer;this.camera=pointer.camera}},onUp:function(pointer){if(pointer===this.pointer){this.pointer=null}},getBody:function(pointer){var pos=this.position;var constraint=this.constraint;this.camera.getWorldPoint(pointer.x,pointer.y,pos);var bodies=Composite.allBodies(this.world.localWorld);for(var i=0;i<bodies.length;i++){var body=bodies[i];if(!body.ignorePointer&&Bounds.contains(body.bounds,pos)&&Detector.canCollide(body.collisionFilter,constraint.collisionFilter)){if(this.hitTestBody(body,pos)){this.world.emit(Events.DRAG_START,body,this.part,this);return true}}}return false},hitTestBody:function(body,position){var constraint=this.constraint;var partsLength=body.parts.length;var start=(partsLength>1)?1:0;for(var i=start;i<partsLength;i++){var part=body.parts[i];if(Vertices.contains(part.vertices,position)){constraint.pointA=position;constraint.pointB={x:position.x-body.position.x,y:position.y-body.position.y};constraint.bodyB=body;constraint.angleB=body.angle;Sleeping.set(body,false);this.part=part;this.body=body;return true}}return false},update:function(){var pointer=this.pointer;var body=this.body;if(!this.active||!pointer){if(body){this.stopDrag()}return}if(!pointer.isDown&&body){this.stopDrag();return}else if(pointer.isDown){if(!body&&!this.getBody(pointer)){return}body=this.body;var pos=this.position;var constraint=this.constraint;this.camera.getWorldPoint(pointer.x,pointer.y,pos);constraint.pointA.x=pos.x;constraint.pointA.y=pos.y;Sleeping.set(body,false);this.world.emit(Events.DRAG,body,this)}},stopDrag:function(){var body=this.body;var constraint=this.constraint;constraint.bodyB=null;constraint.pointB=null;this.pointer=null;this.body=null;this.part=null;if(body){this.world.emit(Events.DRAG_END,body,this)}},destroy:function(){this.world.removeConstraint(this.constraint);this.pointer=null;this.constraint=null;this.body=null;this.part=null;this.world.off(Events.BEFORE_UPDATE,this.update);this.scene.sys.input.off(InputEvents.POINTER_DOWN,this.onDown,this);this.scene.sys.input.off(InputEvents.POINTER_UP,this.onUp,this)}});module.exports=PointerConstraint}),(function(module,exports,__webpack_require__){var Metrics={};module.exports=Metrics;var Composite=__webpack_require__(148);var Common=__webpack_require__(42);(function(){Metrics.create=function(options){var defaults={extended:false,narrowDetections:0,narrowphaseTests:0,narrowReuse:0,narrowReuseCount:0,midphaseTests:0,broadphaseTests:0,narrowEff:0.0001,midEff:0.0001,broadEff:0.0001,collisions:0,buckets:0,bodies:0,pairs:0};return Common.extend(defaults,false,options)};Metrics.reset=function(metrics){if(metrics.extended){metrics.narrowDetections=0;metrics.narrowphaseTests=0;metrics.narrowReuse=0;metrics.narrowReuseCount=0;metrics.midphaseTests=0;metrics.broadphaseTests=0;metrics.narrowEff=0;metrics.midEff=0;metrics.broadEff=0;metrics.collisions=0;metrics.buckets=0;metrics.pairs=0;metrics.bodies=0}};Metrics.update=function(metrics,engine){if(metrics.extended){var world=engine.world,bodies=Composite.allBodies(world);metrics.collisions=metrics.narrowDetections;metrics.pairs=engine.pairs.list.length;metrics.bodies=bodies.length;metrics.midEff=(metrics.narrowDetections/(metrics.midphaseTests||1)).toFixed(2);metrics.narrowEff=(metrics.narrowDetections/(metrics.narrowphaseTests||1)).toFixed(2);metrics.broadEff=(1-(metrics.broadphaseTests/(bodies.length||1))).toFixed(2);metrics.narrowReuse=(metrics.narrowReuseCount/(metrics.narrowphaseTests||1)).toFixed(2)}}})()}),(function(module,exports,__webpack_require__){var ALIGN_CONST=__webpack_require__(105);var Axes=__webpack_require__(513);var Bodies=__webpack_require__(109);var Body=__webpack_require__(62);var BodyBounds=__webpack_require__(1384);var Bounds=__webpack_require__(100);var Class=__webpack_require__(0);var Composite=__webpack_require__(148);var Composites=__webpack_require__(1292);var Constraint=__webpack_require__(219);var Detector=__webpack_require__(515);var DistanceBetween=__webpack_require__(53);var Factory=__webpack_require__(1385);var GetFastValue=__webpack_require__(2);var GetValue=__webpack_require__(6);var Grid=__webpack_require__(1301);var MatterAttractors=__webpack_require__(1428);var MatterCollisionEvents=__webpack_require__(1429);var MatterLib=__webpack_require__(1389);var MatterWrap=__webpack_require__(1430);var Merge=__webpack_require__(126);var Pair=__webpack_require__(473);var Pairs=__webpack_require__(1302);var Plugin=__webpack_require__(1299);var PluginCache=__webpack_require__(23);var Query=__webpack_require__(1390);var Resolver=__webpack_require__(1303);var SAT=__webpack_require__(516);var SceneEvents=__webpack_require__(22);var Svg=__webpack_require__(1293);var Vector=__webpack_require__(99);var Vertices=__webpack_require__(86);var World=__webpack_require__(1392);var MatterPhysics=new Class({initialize:function MatterPhysics(scene){this.scene=scene;this.systems=scene.sys;this.config=this.getConfig();this.world;this.add;this.bodyBounds;this.body=Body;this.composite=Composite;this.detector=Detector;this.grid=Grid;this.pair=Pair;this.pairs=Pairs;this.query=Query;this.resolver=Resolver;this.sat=SAT;this.constraint=Constraint;this.bodies=Bodies;this.composites=Composites;this.axes=Axes;this.bounds=Bounds;this.svg=Svg;this.vector=Vector;this.vertices=Vertices;this.verts=Vertices;this._tempVec2=Vector.create();if(GetValue(this.config,'plugins.collisionevents',true)){this.enableCollisionEventsPlugin()}if(GetValue(this.config,'plugins.attractors',false)){this.enableAttractorPlugin()}if(GetValue(this.config,'plugins.wrap',false)){this.enableWrapPlugin()}Resolver._restingThresh=GetValue(this.config,'restingThresh',4);Resolver._restingThreshTangent=GetValue(this.config,'restingThreshTangent',6);Resolver._positionDampen=GetValue(this.config,'positionDampen',0.9);Resolver._positionWarming=GetValue(this.config,'positionWarming',0.8);Resolver._frictionNormalMultiplier=GetValue(this.config,'frictionNormalMultiplier',5);scene.sys.events.once(SceneEvents.BOOT,this.boot,this);scene.sys.events.on(SceneEvents.START,this.start,this)},boot:function(){this.world=new World(this.scene,this.config);this.add=new Factory(this.world);this.bodyBounds=new BodyBounds();this.systems.events.once(SceneEvents.DESTROY,this.destroy,this)},start:function(){if(!this.world){this.world=new World(this.scene,this.config);this.add=new Factory(this.world)}var eventEmitter=this.systems.events;eventEmitter.on(SceneEvents.UPDATE,this.world.update,this.world);eventEmitter.on(SceneEvents.POST_UPDATE,this.world.postUpdate,this.world);eventEmitter.once(SceneEvents.SHUTDOWN,this.shutdown,this)},getConfig:function(){var gameConfig=this.systems.game.config.physics;var sceneConfig=this.systems.settings.physics;var config=Merge(GetFastValue(sceneConfig,'matter',{}),GetFastValue(gameConfig,'matter',{}));return config},enableAttractorPlugin:function(){Plugin.register(MatterAttractors);Plugin.use(MatterLib,MatterAttractors);return this},enableWrapPlugin:function(){Plugin.register(MatterWrap);Plugin.use(MatterLib,MatterWrap);return this},enableCollisionEventsPlugin:function(){Plugin.register(MatterCollisionEvents);Plugin.use(MatterLib,MatterCollisionEvents);return this},pause:function(){return this.world.pause()},resume:function(){return this.world.resume()},set60Hz:function(){this.world.getDelta=this.world.update60Hz;this.world.autoUpdate=true;return this},set30Hz:function(){this.world.getDelta=this.world.update30Hz;this.world.autoUpdate=true;return this},step:function(delta,correction){this.world.step(delta,correction)},containsPoint:function(body,x,y){body=this.getMatterBodies(body);var position=Vector.create(x,y);var result=Query.point(body,position);return(result.length>0)?true:false},intersectPoint:function(x,y,bodies){bodies=this.getMatterBodies(bodies);var position=Vector.create(x,y);var output=[];var result=Query.point(bodies,position);result.forEach(function(body){if(output.indexOf(body)===-1){output.push(body)}});return output},intersectRect:function(x,y,width,height,outside,bodies){if(outside===undefined){outside=false}bodies=this.getMatterBodies(bodies);var bounds={min:{x:x,y:y},max:{x:x+width,y:y+height}};var output=[];var result=Query.region(bodies,bounds,outside);result.forEach(function(body){if(output.indexOf(body)===-1){output.push(body)}});return output},intersectRay:function(x1,y1,x2,y2,rayWidth,bodies){if(rayWidth===undefined){rayWidth=1}bodies=this.getMatterBodies(bodies);var result=[];var collisions=Query.ray(bodies,Vector.create(x1,y1),Vector.create(x2,y2),rayWidth);for(var i=0;i<collisions.length;i++){result.push(collisions[i].body)}return result},intersectBody:function(body,bodies){bodies=this.getMatterBodies(bodies);var result=[];var collisions=Query.collides(body,bodies);for(var i=0;i<collisions.length;i++){var pair=collisions[i];if(pair.bodyA===body){result.push(pair.bodyB)}else{result.push(pair.bodyA)}}return result},overlap:function(target,bodies,overlapCallback,processCallback,callbackContext){if(overlapCallback===undefined){overlapCallback=null}if(processCallback===undefined){processCallback=null}if(callbackContext===undefined){callbackContext=overlapCallback}if(!Array.isArray(target)){target=[target]}target=this.getMatterBodies(target);bodies=this.getMatterBodies(bodies);var match=false;for(var i=0;i<target.length;i++){var entry=target[i];var collisions=Query.collides(entry,bodies);for(var c=0;c<collisions.length;c++){var info=collisions[c];var bodyB=(info.bodyA.id===entry.id)?info.bodyB:info.bodyA;if(!processCallback||processCallback.call(callbackContext,entry,bodyB,info)){match=true;if(overlapCallback){overlapCallback.call(callbackContext,entry,bodyB,info)}else if(!processCallback){return true}}}}return match},setCollisionCategory:function(bodies,value){bodies=this.getMatterBodies(bodies);bodies.forEach(function(body){body.collisionFilter.category=value});return this},setCollisionGroup:function(bodies,value){bodies=this.getMatterBodies(bodies);bodies.forEach(function(body){body.collisionFilter.group=value});return this},setCollidesWith:function(bodies,categories){bodies=this.getMatterBodies(bodies);var flags=0;if(!Array.isArray(categories)){flags=categories}else{for(var i=0;i<categories.length;i++){flags|=categories[i]}}bodies.forEach(function(body){body.collisionFilter.mask=flags});return this},getMatterBodies:function(bodies){if(!bodies){return this.world.getAllBodies()}if(!Array.isArray(bodies)){bodies=[bodies]}var output=[];for(var i=0;i<bodies.length;i++){var body=(bodies[i].hasOwnProperty('body'))?bodies[i].body:bodies[i];output.push(body)}return output},setVelocity:function(bodies,x,y){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;vec2.x=x;vec2.y=y;bodies.forEach(function(body){Body.setVelocity(body,vec2)});return this},setVelocityX:function(bodies,x){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;vec2.x=x;bodies.forEach(function(body){vec2.y=body.velocity.y;Body.setVelocity(body,vec2)});return this},setVelocityY:function(bodies,y){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;vec2.y=y;bodies.forEach(function(body){vec2.x=body.velocity.x;Body.setVelocity(body,vec2)});return this},setAngularVelocity:function(bodies,value){bodies=this.getMatterBodies(bodies);bodies.forEach(function(body){Body.setAngularVelocity(body,value)});return this},applyForce:function(bodies,force){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;bodies.forEach(function(body){vec2.x=body.position.x;vec2.y=body.position.y;Body.applyForce(body,vec2,force)});return this},applyForceFromPosition:function(bodies,position,speed,angle){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;bodies.forEach(function(body){if(angle===undefined){angle=body.angle}vec2.x=speed*Math.cos(angle);vec2.y=speed*Math.sin(angle);Body.applyForce(body,position,vec2)});return this},applyForceFromAngle:function(bodies,speed,angle){bodies=this.getMatterBodies(bodies);var vec2=this._tempVec2;bodies.forEach(function(body){if(angle===undefined){angle=body.angle}vec2.x=speed*Math.cos(angle);vec2.y=speed*Math.sin(angle);Body.applyForce(body,{x:body.position.x,y:body.position.y},vec2)});return this},getConstraintLength:function(constraint){var aX=constraint.pointA.x;var aY=constraint.pointA.y;var bX=constraint.pointB.x;var bY=constraint.pointB.y;if(constraint.bodyA){aX+=constraint.bodyA.position.x;aY+=constraint.bodyA.position.y}if(constraint.bodyB){bX+=constraint.bodyB.position.x;bY+=constraint.bodyB.position.y}return DistanceBetween(aX,aY,bX,bY)},alignBody:function(body,x,y,align){body=(body.hasOwnProperty('body'))?body.body:body;var pos;switch(align){case ALIGN_CONST.TOP_LEFT:case ALIGN_CONST.LEFT_TOP:pos=this.bodyBounds.getTopLeft(body,x,y);break;case ALIGN_CONST.TOP_CENTER:pos=this.bodyBounds.getTopCenter(body,x,y);break;case ALIGN_CONST.TOP_RIGHT:case ALIGN_CONST.RIGHT_TOP:pos=this.bodyBounds.getTopRight(body,x,y);break;case ALIGN_CONST.LEFT_CENTER:pos=this.bodyBounds.getLeftCenter(body,x,y);break;case ALIGN_CONST.CENTER:pos=this.bodyBounds.getCenter(body,x,y);break;case ALIGN_CONST.RIGHT_CENTER:pos=this.bodyBounds.getRightCenter(body,x,y);break;case ALIGN_CONST.LEFT_BOTTOM:case ALIGN_CONST.BOTTOM_LEFT:pos=this.bodyBounds.getBottomLeft(body,x,y);break;case ALIGN_CONST.BOTTOM_CENTER:pos=this.bodyBounds.getBottomCenter(body,x,y);break;case ALIGN_CONST.BOTTOM_RIGHT:case ALIGN_CONST.RIGHT_BOTTOM:pos=this.bodyBounds.getBottomRight(body,x,y);break}if(pos){Body.setPosition(body,pos)}return this},shutdown:function(){var eventEmitter=this.systems.events;if(this.world){eventEmitter.off(SceneEvents.UPDATE,this.world.update,this.world);eventEmitter.off(SceneEvents.POST_UPDATE,this.world.postUpdate,this.world)}eventEmitter.off(SceneEvents.SHUTDOWN,this.shutdown,this);if(this.add){this.add.destroy()}if(this.world){this.world.destroy()}this.add=null;this.world=null},destroy:function(){this.shutdown();this.scene.sys.events.off(SceneEvents.START,this.start,this);this.scene=null;this.systems=null}});PluginCache.register('MatterPhysics',MatterPhysics,'matterPhysics');module.exports=MatterPhysics}),(function(module,exports,__webpack_require__){var Matter=__webpack_require__(1298);var MatterAttractors={name:'matter-attractors',version:'0.1.7',for:'matter-js@^0.14.2',silent:true,install:function(base){base.after('Body.create',function(){MatterAttractors.Body.init(this)});base.before('Engine.update',function(engine){MatterAttractors.Engine.update(engine)})},Body:{init:function(body){body.plugin.attractors=body.plugin.attractors||[]}},Engine:{update:function(engine){var world=engine.world,bodies=Matter.Composite.allBodies(world);for(var i=0;i<bodies.length;i+=1){var bodyA=bodies[i],attractors=bodyA.plugin.attractors;if(attractors&&attractors.length>0){for(var j=i+1;j<bodies.length;j+=1){var bodyB=bodies[j];for(var k=0;k<attractors.length;k+=1){var attractor=attractors[k],forceVector=attractor;if(Matter.Common.isFunction(attractor)){forceVector=attractor(bodyA,bodyB)}if(forceVector){Matter.Body.applyForce(bodyB,bodyB.position,forceVector)}}}}}}},Attractors:{gravityConstant:0.001,gravity:function(bodyA,bodyB){var bToA=Matter.Vector.sub(bodyB.position,bodyA.position),distanceSq=Matter.Vector.magnitudeSquared(bToA)||0.0001,normal=Matter.Vector.normalise(bToA),magnitude=-MatterAttractors.Attractors.gravityConstant*(bodyA.mass*bodyB.mass/distanceSq),force=Matter.Vector.mult(normal,magnitude);Matter.Body.applyForce(bodyA,bodyA.position,Matter.Vector.neg(force));Matter.Body.applyForce(bodyB,bodyB.position,force)}}};module.exports=MatterAttractors}),(function(module,exports){var MatterCollisionEvents={name:'matter-collision-events',version:'0.1.6',for:'matter-js@^0.14.2',silent:true,install:function(matter){matter.after('Engine.create',function(){matter.Events.on(this,'collisionStart',function(event){event.pairs.map(function(pair){var bodyA=pair.bodyA;var bodyB=pair.bodyB;if(bodyA.gameObject){bodyA.gameObject.emit('collide',bodyA,bodyB,pair)}if(bodyB.gameObject){bodyB.gameObject.emit('collide',bodyB,bodyA,pair)}matter.Events.trigger(bodyA,'onCollide',{pair:pair});matter.Events.trigger(bodyB,'onCollide',{pair:pair});if(bodyA.onCollideCallback){bodyA.onCollideCallback(pair)}if(bodyB.onCollideCallback){bodyB.onCollideCallback(pair)}if(bodyA.onCollideWith[bodyB.id]){bodyA.onCollideWith[bodyB.id](bodyB,pair)}if(bodyB.onCollideWith[bodyA.id]){bodyB.onCollideWith[bodyA.id](bodyA,pair)}})});matter.Events.on(this,'collisionActive',function(event){event.pairs.map(function(pair){var bodyA=pair.bodyA;var bodyB=pair.bodyB;if(bodyA.gameObject){bodyA.gameObject.emit('collideActive',bodyA,bodyB,pair)}if(bodyB.gameObject){bodyB.gameObject.emit('collideActive',bodyB,bodyA,pair)}matter.Events.trigger(bodyA,'onCollideActive',{pair:pair});matter.Events.trigger(bodyB,'onCollideActive',{pair:pair});if(bodyA.onCollideActiveCallback){bodyA.onCollideActiveCallback(pair)}if(bodyB.onCollideActiveCallback){bodyB.onCollideActiveCallback(pair)}})});matter.Events.on(this,'collisionEnd',function(event){event.pairs.map(function(pair){var bodyA=pair.bodyA;var bodyB=pair.bodyB;if(bodyA.gameObject){bodyA.gameObject.emit('collideEnd',bodyA,bodyB,pair)}if(bodyB.gameObject){bodyB.gameObject.emit('collideEnd',bodyB,bodyA,pair)}matter.Events.trigger(bodyA,'onCollideEnd',{pair:pair});matter.Events.trigger(bodyB,'onCollideEnd',{pair:pair});if(bodyA.onCollideEndCallback){bodyA.onCollideEndCallback(pair)}if(bodyB.onCollideEndCallback){bodyB.onCollideEndCallback(pair)}})})})}};module.exports=MatterCollisionEvents}),(function(module,exports,__webpack_require__){var Matter=__webpack_require__(1298);var MatterWrap={name:'matter-wrap',version:'0.1.4',for:'matter-js@^0.14.2',silent:true,install:function(base){base.after('Engine.update',function(){MatterWrap.Engine.update(this)})},Engine:{update:function(engine){var world=engine.world,bodies=Matter.Composite.allBodies(world),composites=Matter.Composite.allComposites(world);for(var i=0;i<bodies.length;i+=1){var body=bodies[i];if(body.plugin.wrap){MatterWrap.Body.wrap(body,body.plugin.wrap)}}for(i=0;i<composites.length;i+=1){var composite=composites[i];if(composite.plugin.wrap){MatterWrap.Composite.wrap(composite,composite.plugin.wrap)}}}},Bounds:{wrap:function(objectBounds,bounds){var x=null,y=null;if(typeof bounds.min.x!=='undefined'&&typeof bounds.max.x!=='undefined'){if(objectBounds.min.x>bounds.max.x){x=bounds.min.x-objectBounds.max.x}else if(objectBounds.max.x<bounds.min.x){x=bounds.max.x-objectBounds.min.x}}if(typeof bounds.min.y!=='undefined'&&typeof bounds.max.y!=='undefined'){if(objectBounds.min.y>bounds.max.y){y=bounds.min.y-objectBounds.max.y}else if(objectBounds.max.y<bounds.min.y){y=bounds.max.y-objectBounds.min.y}}if(x!==null||y!==null){return{x:x||0,y:y||0}}}},Body:{wrap:function(body,bounds){var translation=MatterWrap.Bounds.wrap(body.bounds,bounds);if(translation){Matter.Body.translate(body,translation)}return translation}},Composite:{bounds:function(composite){var bodies=Matter.Composite.allBodies(composite),vertices=[];for(var i=0;i<bodies.length;i+=1){var body=bodies[i];vertices.push(body.bounds.min,body.bounds.max)}return Matter.Bounds.create(vertices)},wrap:function(composite,bounds){var translation=MatterWrap.Bounds.wrap(MatterWrap.Composite.bounds(composite),bounds);if(translation){Matter.Composite.translate(composite,translation)}return translation}}};module.exports=MatterWrap}),(function(module,exports,__webpack_require__){module.exports={Canvas:__webpack_require__(1432),Snapshot:__webpack_require__(1433),WebGL:__webpack_require__(1434)}}),(function(module,exports,__webpack_require__){module.exports={CanvasRenderer:__webpack_require__(505),GetBlendModes:__webpack_require__(507),SetTransform:__webpack_require__(28)}}),(function(module,exports,__webpack_require__){module.exports={Canvas:__webpack_require__(506),WebGL:__webpack_require__(509)}}),(function(module,exports,__webpack_require__){module.exports={Utils:__webpack_require__(9),WebGLPipeline:__webpack_require__(147),WebGLRenderer:__webpack_require__(508),Pipelines:__webpack_require__(1435),BYTE:0,SHORT:1,UNSIGNED_BYTE:2,UNSIGNED_SHORT:3,FLOAT:4}}),(function(module,exports,__webpack_require__){module.exports={BitmapMaskPipeline:__webpack_require__(510),ForwardDiffuseLightPipeline:__webpack_require__(511),TextureTintPipeline:__webpack_require__(237),TextureTintStripPipeline:__webpack_require__(512),ModelViewProjection:__webpack_require__(238)}})])})}),(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return cardCells});__webpack_require__.d(__webpack_exports__,"d",function(){return cardRequired});__webpack_require__.d(__webpack_exports__,"e",function(){return cardUnits});__webpack_require__.d(__webpack_exports__,"b",function(){return bonus});var __WEBPACK_IMPORTED_MODULE_0__config__=__webpack_require__(0);let cardCells,cardRequired,cardUnits,bonus;const CreateInteractiveGameElements=(game)=>{bonus=game.add.image(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width-300,620,'bow').setOrigin(0.5);cardRequired=game.add.image(0,0,'bow_small').setOrigin(0.5).setPosition(570,1090);cardCells=game.add.group({key:'frame',repeat:5,setXY:{x:75,y:1225}});cardCells.children.iterate((cell,i)=>{cell.setOrigin(0);if(i<3){cell.x+=(337*(i))}else{cell.y=1560;cell.x+=(337*(i-3))}});cardUnits=game.add.group({key:'bow',repeat:5,setXY:{x:215,y:1365}});cardUnits.children.iterate((unit,i)=>{if(i<3){unit.x+=(337*(i))}else{unit.y=1700;unit.x+=(337*(i-3))}})}__webpack_exports__["a"]=CreateInteractiveGameElements}),(function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__config__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_1__create_Starter__=__webpack_require__(1);var __WEBPACK_IMPORTED_MODULE_2__create_Scratch__=__webpack_require__(6);var __WEBPACK_IMPORTED_MODULE_3__UpdateInteractiveElements__=__webpack_require__(15);let created=false;const setCreated=(value)=>{created=value}__webpack_exports__["b"]=setCreated;const StarterListener=(game)=>{let counter=0;if(!created){Object(__WEBPACK_IMPORTED_MODULE_3__UpdateInteractiveElements__["a"])(game);setCreated(true)}if(!__WEBPACK_IMPORTED_MODULE_1__create_Starter__["c"]){for(const unit of __WEBPACK_IMPORTED_MODULE_1__create_Starter__["f"]){if(unit.defaultY+400>unit.y){unit.y+=5}}if(!__WEBPACK_IMPORTED_MODULE_1__create_Starter__["b"]){for(const element of __WEBPACK_IMPORTED_MODULE_1__create_Starter__["g"]){element.setAlpha(0)}}__WEBPACK_IMPORTED_MODULE_1__create_Starter__["e"].setAlpha(0);for(const unit in __WEBPACK_IMPORTED_MODULE_2__create_Scratch__["b"]){__WEBPACK_IMPORTED_MODULE_2__create_Scratch__["b"][unit].scratched&&counter++}if(counter===7){Object(__WEBPACK_IMPORTED_MODULE_1__create_Starter__["d"])(true);for(const unit in __WEBPACK_IMPORTED_MODULE_2__create_Scratch__["b"]){delete __WEBPACK_IMPORTED_MODULE_2__create_Scratch__["b"][unit].scratched}}}if(__WEBPACK_IMPORTED_MODULE_1__create_Starter__["c"]){for(const element of __WEBPACK_IMPORTED_MODULE_1__create_Starter__["f"]){if(element.y>element.defaultY){element.y-=5}}if(!__WEBPACK_IMPORTED_MODULE_1__create_Starter__["b"]){for(const element of __WEBPACK_IMPORTED_MODULE_1__create_Starter__["g"]){element.setAlpha(1)}}__WEBPACK_IMPORTED_MODULE_1__create_Starter__["e"].setAlpha(1)}}__webpack_exports__["a"]=StarterListener}),(function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return scratchField});var __WEBPACK_IMPORTED_MODULE_0__config__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_1__Starter__=__webpack_require__(1);const coordinator={}__webpack_exports__["b"]=coordinator;let scratchField;const Scratch=(game)=>{const brush=game.add.image(-100,-100,'coin_icon_big');scratchField=game.add.renderTexture(0,0,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.height).setDepth(1);scratchField.destroy=0;scratchField.draw('bonus_scratch',615,415);coordinator.bonusCard={scratched:false,type:'bonus',diagonal:520,segment:368,initialX:615,initialY:415,}game.input.on('pointermove',function(pointer){if(pointer.isDown){if(!__WEBPACK_IMPORTED_MODULE_1__Starter__["c"]){scratchField.erase(brush,pointer.x,pointer.y);coordinatorAudit(pointer,coordinator,scratchField,game)}}});game.input.on('pointerdown',function(pointer){if(!__WEBPACK_IMPORTED_MODULE_1__Starter__["c"]){scratchField.erase(brush,pointer.x,pointer.y)}})}__webpack_exports__["a"]=Scratch;function coordinatorAudit(pointer,coordinator,scratchField,game){for(const card in coordinator){if(pointer.x>coordinator[card].initialX&&pointer.x<(coordinator[card].initialX+coordinator[card].segment)&&pointer.y>coordinator[card].initialY&&pointer.y<(coordinator[card].initialY+coordinator[card].segment)){if(coordinator[card].minX>pointer.x||!coordinator[card].minX){coordinator[card].minX=Math.floor(pointer.x)}if(coordinator[card].minY>pointer.y||!coordinator[card].minY){coordinator[card].minY=Math.floor(pointer.y)}if(coordinator[card].maxX<pointer.x||!coordinator[card].maxX){coordinator[card].maxX=Math.floor(pointer.x)}if(coordinator[card].maxY<pointer.y||!coordinator[card].maxY){coordinator[card].maxY=Math.floor(pointer.y)}const verticalSide=coordinator[card].maxY-coordinator[card].minY;const horizontalSide=coordinator[card].maxX-coordinator[card].minX;const diagonal=Math.sqrt(Math.pow(verticalSide,2)+Math.pow(horizontalSide,2))if(diagonal>coordinator[card].diagonal*0.9){scratchField.erase(game.add.image(-500,-500,`${coordinator[card].type}_scratch`,).setOrigin(0),coordinator[card].initialX,coordinator[card].initialY,coordinator[card].scratched=true,)}}}}}),(function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0_expose_loader_PIXI_phaser_ce_build_custom_pixi_js__=__webpack_require__(8);var __WEBPACK_IMPORTED_MODULE_0_expose_loader_PIXI_phaser_ce_build_custom_pixi_js___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_expose_loader_PIXI_phaser_ce_build_custom_pixi_js__);var __WEBPACK_IMPORTED_MODULE_1_expose_loader_p2_phaser_ce_build_custom_p2_js__=__webpack_require__(10);var __WEBPACK_IMPORTED_MODULE_1_expose_loader_p2_phaser_ce_build_custom_p2_js___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_expose_loader_p2_phaser_ce_build_custom_p2_js__);var __WEBPACK_IMPORTED_MODULE_2_phaser__=__webpack_require__(3);var __WEBPACK_IMPORTED_MODULE_2_phaser___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_phaser__);var __WEBPACK_IMPORTED_MODULE_3__config__=__webpack_require__(0);const game=new __WEBPACK_IMPORTED_MODULE_2_phaser___default.a.Game(__WEBPACK_IMPORTED_MODULE_3__config__["a"]);window.onload=function(){resize();window.addEventListener("resize",resize,false);function resize(){var canvas=document.querySelector("canvas");var windowWidth=window.innerWidth;var windowHeight=window.innerHeight;var windowRatio=windowWidth/windowHeight;var gameRatio=game.config.width/game.config.height;if(windowRatio<gameRatio){canvas.style.width=windowWidth+"px";canvas.style.height=(windowWidth/gameRatio)+"px"}else{canvas.style.width=(windowHeight*gameRatio)+"px";canvas.style.height=windowHeight+"px"}}}}),(function(module,exports,__webpack_require__){(function(global){module.exports=global["PIXI"]=__webpack_require__(9)}.call(exports,__webpack_require__(2)))}),(function(module,exports,__webpack_require__){(function(){var root=this;var PIXI=PIXI||{};PIXI.DisplayObject=function(){this.position=new PIXI.Point(0,0);this.scale=new PIXI.Point(1,1);this.pivot=new PIXI.Point(0,0);this.rotation=0;this.alpha=1;this.visible=true;this.hitArea=null;this.renderable=false;this.parent=null;this.worldAlpha=1;this.worldTransform=new Phaser.Matrix();this.worldPosition=new PIXI.Point(0,0);this.worldScale=new PIXI.Point(1,1);this.worldRotation=0;this.filterArea=null;this._sr=0;this._cr=1;this._bounds=new PIXI.Rectangle(0,0,0,0);this._currentBounds=null;this._mask=null;this._cacheAsBitmap=false;this._cacheIsDirty=false};PIXI.DisplayObject.prototype={constructor:PIXI.DisplayObject,destroy:function(){if(this.children){var i=this.children.length;while(i--){this.children[i].destroy()}this.children=[]}this.hitArea=null;this.parent=null;this.worldTransform=null;this.filterArea=null;this.renderable=false;this._bounds=null;this._currentBounds=null;this._mask=null;this._destroyCachedSprite();this._destroyTintedTexture()},updateTransform:function(parent){if(!parent&&!this.parent&&!this.game){return this}var p=this.parent;if(parent){p=parent}else if(!this.parent){p=this.game.world}var pt=p.worldTransform;var wt=this.worldTransform;var a,b,c,d,tx,ty;if(this.rotation%Phaser.Math.PI2){if(this.rotation!==this.rotationCache){this.rotationCache=this.rotation;this._sr=Math.sin(this.rotation);this._cr=Math.cos(this.rotation)}a=this._cr*this.scale.x;b=this._sr*this.scale.x;c=-this._sr*this.scale.y;d=this._cr*this.scale.y;tx=this.position.x;ty=this.position.y;if(this.pivot.x||this.pivot.y){tx-=this.pivot.x*a+this.pivot.y*c;ty-=this.pivot.x*b+this.pivot.y*d}wt.a=a*pt.a+b*pt.c;wt.b=a*pt.b+b*pt.d;wt.c=c*pt.a+d*pt.c;wt.d=c*pt.b+d*pt.d;wt.tx=tx*pt.a+ty*pt.c+pt.tx;wt.ty=tx*pt.b+ty*pt.d+pt.ty}else{a=this.scale.x;b=0;c=0;d=this.scale.y;tx=this.position.x-this.pivot.x*a;ty=this.position.y-this.pivot.y*d;wt.a=a*pt.a;wt.b=a*pt.b;wt.c=d*pt.c;wt.d=d*pt.d;wt.tx=tx*pt.a+ty*pt.c+pt.tx;wt.ty=tx*pt.b+ty*pt.d+pt.ty}a=wt.a;b=wt.b;c=wt.c;d=wt.d;var determ=(a*d)-(b*c);if(a||b){var r=Math.sqrt((a*a)+(b*b));this.worldRotation=(b>0)?Math.acos(a/r):-Math.acos(a/r);this.worldScale.x=r;this.worldScale.y=determ/r}else if(c||d){var s=Math.sqrt((c*c)+(d*d));this.worldRotation=Phaser.Math.HALF_PI-((d>0)?Math.acos(-c/s):-Math.acos(c/s));this.worldScale.x=determ/s;this.worldScale.y=s}else{this.worldScale.x=0;this.worldScale.y=0}this.worldAlpha=this.alpha*p.worldAlpha;this.worldPosition.x=wt.tx;this.worldPosition.y=wt.ty;this._currentBounds=null;if(this.transformCallback){this.transformCallback.call(this.transformCallbackContext,wt,pt)}return this},preUpdate:function(){},generateTexture:function(resolution,scaleMode,renderer){var bounds=this.getLocalBounds();var renderTexture=new Phaser.RenderTexture(this.game,bounds.width|0,bounds.height|0,renderer,scaleMode,resolution);PIXI.DisplayObject._tempMatrix.tx=-bounds.x;PIXI.DisplayObject._tempMatrix.ty=-bounds.y;renderTexture.render(this,PIXI.DisplayObject._tempMatrix);return renderTexture},updateCache:function(){this._generateCachedSprite();return this},toGlobal:function(position){this.updateTransform();return this.worldTransform.apply(position)},toLocal:function(position,from){if(from){position=from.toGlobal(position)}this.updateTransform();return this.worldTransform.applyInverse(position)},_renderCachedSprite:function(renderSession){this._cachedSprite.worldAlpha=this.worldAlpha;if(renderSession.gl){PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,renderSession)}else{PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,renderSession)}},_generateCachedSprite:function(){this._cacheAsBitmap=false;var bounds=this.getLocalBounds();bounds.width=Math.max(1,Math.ceil(bounds.width));bounds.height=Math.max(1,Math.ceil(bounds.height));this.updateTransform();if(!this._cachedSprite){var textureUnit=0;if(this.texture&&this.texture.baseTexture&&PIXI._enableMultiTextureToggle){textureUnit=this.texture.baseTexture.textureIndex}var renderTexture=new Phaser.RenderTexture(this.game,bounds.width,bounds.height,undefined,undefined,undefined,undefined,textureUnit);this._cachedSprite=new PIXI.Sprite(renderTexture);this._cachedSprite.worldTransform=this.worldTransform}else{this._cachedSprite.texture.resize(bounds.width,bounds.height)}var tempFilters=this._filters;this._filters=null;this._cachedSprite.filters=tempFilters;PIXI.DisplayObject._tempMatrix.tx=-bounds.x;PIXI.DisplayObject._tempMatrix.ty=-bounds.y;this._cachedSprite.texture.render(this,PIXI.DisplayObject._tempMatrix,true);this._cachedSprite.anchor.x=-(bounds.x/bounds.width);this._cachedSprite.anchor.y=-(bounds.y/bounds.height);this._filters=tempFilters;this._cacheAsBitmap=true},_destroyCachedSprite:function(){if(!this._cachedSprite){return}this._cachedSprite.texture.destroy(true);this._cachedSprite=null},_destroyTintedTexture:function(){if(!this.tintedTexture){return}Phaser.CanvasPool.removeByCanvas(this.tintedTexture);this.tintedTexture=null}};PIXI.DisplayObject.prototype.displayObjectUpdateTransform=PIXI.DisplayObject.prototype.updateTransform;Object.defineProperties(PIXI.DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(value){this.position.x=value}},y:{get:function(){return this.position.y},set:function(value){this.position.y=value}},worldVisible:{get:function(){if(!this.visible){return false}else{var item=this.parent;if(!item){return this.visible}else{do{if(!item.visible){return false}item=item.parent}while(item)}return true}}},mask:{get:function(){return this._mask},set:function(value){if(this._mask){this._mask.isMask=false}this._mask=value;if(value){this._mask.isMask=true}}},filters:{get:function(){return this._filters},set:function(value){if(Array.isArray(value)){var passes=[];for(var i=0;i<value.length;i++){var filterPasses=value[i].passes;for(var j=0;j<filterPasses.length;j++){passes.push(filterPasses[j])}}this._filterBlock={target:this,filterPasses:passes}}this._filters=value;if(this.blendMode&&this.blendMode===PIXI.blendModes.MULTIPLY){this.blendMode=PIXI.blendModes.NORMAL}}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(value){if(this._cacheAsBitmap===value){return}if(value){this._generateCachedSprite()}else{this._destroyCachedSprite()}this._cacheAsBitmap=value}}});PIXI.DisplayObjectContainer=function(){PIXI.DisplayObject.call(this);this.children=[];this.ignoreChildInput=false};PIXI.DisplayObjectContainer.prototype=Object.create(PIXI.DisplayObject.prototype);PIXI.DisplayObjectContainer.prototype.constructor=PIXI.DisplayObjectContainer;PIXI.DisplayObjectContainer.prototype.addChild=function(child){return this.addChildAt(child,this.children.length)};PIXI.DisplayObjectContainer.prototype.addChildAt=function(child,index){if(index>=0&&index<=this.children.length){if(child.parent){child.parent.removeChild(child)}child.parent=this;this.children.splice(index,0,child);return child}else{throw new Error(child+'addChildAt: The index '+index+' supplied is out of bounds '+this.children.length)}};PIXI.DisplayObjectContainer.prototype.swapChildren=function(child,child2){if(child===child2){return}var index1=this.getChildIndex(child);var index2=this.getChildIndex(child2);if(index1<0||index2<0){throw new Error('swapChildren: Both the supplied DisplayObjects must be a child of the caller.')}this.children[index1]=child2;this.children[index2]=child};PIXI.DisplayObjectContainer.prototype.getChildIndex=function(child){var index=this.children.indexOf(child);if(index===-1){throw new Error('The supplied DisplayObject must be a child of the caller')}return index};PIXI.DisplayObjectContainer.prototype.setChildIndex=function(child,index){if(index<0||index>=this.children.length){throw new Error('The supplied index is out of bounds')}var currentIndex=this.getChildIndex(child);this.children.splice(currentIndex,1);this.children.splice(index,0,child)};PIXI.DisplayObjectContainer.prototype.getChildAt=function(index){if(index<0||index>=this.children.length){throw new Error('getChildAt: Supplied index '+index+' does not exist in the child list, or the supplied DisplayObject must be a child of the caller')}return this.children[index]};PIXI.DisplayObjectContainer.prototype.removeChild=function(child){var index=this.children.indexOf(child);if(index===-1){return}return this.removeChildAt(index)};PIXI.DisplayObjectContainer.prototype.removeChildAt=function(index){var child=this.getChildAt(index);if(child){child.parent=undefined;this.children.splice(index,1)}return child};PIXI.DisplayObjectContainer.prototype.bringChildToTop=function(child){if(child.parent!==this){return}return this.setChildIndex(child,this.children.length-1)};PIXI.DisplayObjectContainer.prototype.sendChildToBack=function(child){if(child.parent!==this){return}return this.setChildIndex(child,0)};PIXI.DisplayObjectContainer.prototype.removeChildren=function(beginIndex,endIndex){if(beginIndex===undefined){beginIndex=0}if(endIndex===undefined){endIndex=this.children.length}var range=endIndex-beginIndex;if(range>0&&range<=endIndex){var removed=this.children.splice(beginIndex,range);for(var i=0;i<removed.length;i++){var child=removed[i];child.parent=undefined}return removed}else if(range===0&&this.children.length===0){return[]}else{throw new Error('removeChildren: Range Error, numeric values are outside the acceptable range')}};PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(!this.visible){return}this.displayObjectUpdateTransform();if(this._cacheAsBitmap){return}for(var i=0;i<this.children.length;i++){this.children[i].updateTransform()}};PIXI.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=PIXI.DisplayObjectContainer.prototype.updateTransform;PIXI.DisplayObjectContainer.prototype.getBounds=function(targetCoordinateSpace){var isTargetCoordinateSpaceDisplayObject=(targetCoordinateSpace&&targetCoordinateSpace instanceof PIXI.DisplayObject);var isTargetCoordinateSpaceThisOrParent=true;if(!isTargetCoordinateSpaceDisplayObject){targetCoordinateSpace=this}else if(targetCoordinateSpace instanceof PIXI.DisplayObjectContainer){isTargetCoordinateSpaceThisOrParent=targetCoordinateSpace.contains(this)}else{isTargetCoordinateSpaceThisOrParent=false}var i;if(isTargetCoordinateSpaceDisplayObject){var matrixCache=targetCoordinateSpace.worldTransform;targetCoordinateSpace.worldTransform=Phaser.identityMatrix;for(i=0;i<targetCoordinateSpace.children.length;i++){targetCoordinateSpace.children[i].updateTransform()}}var minX=Infinity;var minY=Infinity;var maxX=-Infinity;var maxY=-Infinity;var childBounds;var childMaxX;var childMaxY;var childVisible=false;for(i=0;i<this.children.length;i++){var child=this.children[i];if(!child.visible){continue}childVisible=true;childBounds=this.children[i].getBounds();minX=(minX<childBounds.x)?minX:childBounds.x;minY=(minY<childBounds.y)?minY:childBounds.y;childMaxX=childBounds.width+childBounds.x;childMaxY=childBounds.height+childBounds.y;maxX=(maxX>childMaxX)?maxX:childMaxX;maxY=(maxY>childMaxY)?maxY:childMaxY}var bounds=this._bounds;if(!childVisible){bounds=new PIXI.Rectangle();var w0=bounds.x;var w1=bounds.width+bounds.x;var h0=bounds.y;var h1=bounds.height+bounds.y;var worldTransform=this.worldTransform;var a=worldTransform.a;var b=worldTransform.b;var c=worldTransform.c;var d=worldTransform.d;var tx=worldTransform.tx;var ty=worldTransform.ty;var x1=a*w1+c*h1+tx;var y1=d*h1+b*w1+ty;var x2=a*w0+c*h1+tx;var y2=d*h1+b*w0+ty;var x3=a*w0+c*h0+tx;var y3=d*h0+b*w0+ty;var x4=a*w1+c*h0+tx;var y4=d*h0+b*w1+ty;maxX=x1;maxY=y1;minX=x1;minY=y1;minX=x2<minX?x2:minX;minX=x3<minX?x3:minX;minX=x4<minX?x4:minX;minY=y2<minY?y2:minY;minY=y3<minY?y3:minY;minY=y4<minY?y4:minY;maxX=x2>maxX?x2:maxX;maxX=x3>maxX?x3:maxX;maxX=x4>maxX?x4:maxX;maxY=y2>maxY?y2:maxY;maxY=y3>maxY?y3:maxY;maxY=y4>maxY?y4:maxY}bounds.x=minX;bounds.y=minY;bounds.width=maxX-minX;bounds.height=maxY-minY;if(isTargetCoordinateSpaceDisplayObject){targetCoordinateSpace.worldTransform=matrixCache;for(i=0;i<targetCoordinateSpace.children.length;i++){targetCoordinateSpace.children[i].updateTransform()}}if(!isTargetCoordinateSpaceThisOrParent){var targetCoordinateSpaceBounds=targetCoordinateSpace.getBounds();bounds.x-=targetCoordinateSpaceBounds.x;bounds.y-=targetCoordinateSpaceBounds.y}return bounds};PIXI.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)};PIXI.DisplayObjectContainer.prototype.contains=function(child){if(!child){return false}else if(child===this){return true}else{return this.contains(child.parent)}};PIXI.DisplayObjectContainer.prototype._renderWebGL=function(renderSession){if(!this.visible||this.alpha<=0){return}if(this._cacheAsBitmap){this._renderCachedSprite(renderSession);return}var i;if(this._mask||this._filters){if(this._filters){renderSession.spriteBatch.flush();renderSession.filterManager.pushFilter(this._filterBlock)}if(this._mask){renderSession.spriteBatch.stop();renderSession.maskManager.pushMask(this.mask,renderSession);renderSession.spriteBatch.start()}for(i=0;i<this.children.length;i++){this.children[i]._renderWebGL(renderSession)}renderSession.spriteBatch.stop();if(this._mask){renderSession.maskManager.popMask(this._mask,renderSession)}if(this._filters){renderSession.filterManager.popFilter()}renderSession.spriteBatch.start()}else{for(i=0;i<this.children.length;i++){this.children[i]._renderWebGL(renderSession)}}};PIXI.DisplayObjectContainer.prototype._renderCanvas=function(renderSession){if(this.visible===false||this.alpha===0){return}if(this._cacheAsBitmap){this._renderCachedSprite(renderSession);return}if(this._mask){renderSession.maskManager.pushMask(this._mask,renderSession)}for(var i=0;i<this.children.length;i++){this.children[i]._renderCanvas(renderSession)}if(this._mask){renderSession.maskManager.popMask(renderSession)}};Object.defineProperty(PIXI.DisplayObjectContainer.prototype,'width',{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(value){var width=this.getLocalBounds().width;if(width!==0){this.scale.x=value/width}else{this.scale.x=1}this._width=value}});Object.defineProperty(PIXI.DisplayObjectContainer.prototype,'height',{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(value){var height=this.getLocalBounds().height;if(height!==0){this.scale.y=value/height}else{this.scale.y=1}this._height=value}});PIXI.Sprite=function(texture){PIXI.DisplayObjectContainer.call(this);this.anchor=new PIXI.Point(PIXI.Sprite.defaultAnchor.x,PIXI.Sprite.defaultAnchor.y);this.texture=texture||PIXI.Texture.emptyTexture;this._width=0;this._height=0;this.tint=0xFFFFFF;this.cachedTint=-1;this.tintedTexture=null;this.blendMode=PIXI.blendModes.NORMAL;this.shader=null;this.exists=true;if(this.texture.baseTexture.hasLoaded){this.onTextureUpdate()}this.renderable=true};PIXI.Sprite.defaultAnchor={x:0,y:0};PIXI.Sprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);PIXI.Sprite.prototype.constructor=PIXI.Sprite;Object.defineProperty(PIXI.Sprite.prototype,'width',{get:function(){return this.scale.x*this.texture.frame.width},set:function(value){this.scale.x=value/this.texture.frame.width;this._width=value}});Object.defineProperty(PIXI.Sprite.prototype,'height',{get:function(){return this.scale.y*this.texture.frame.height},set:function(value){this.scale.y=value/this.texture.frame.height;this._height=value}});PIXI.Sprite.prototype.setTexture=function(texture,destroyBase){if(destroyBase){this.texture.baseTexture.destroy()}this.texture.baseTexture.skipRender=false;this.texture=texture;this.texture.valid=true;this.cachedTint=-1};PIXI.Sprite.prototype.onTextureUpdate=function(){if(this._width){this.scale.x=this._width/this.texture.frame.width}if(this._height){this.scale.y=this._height/this.texture.frame.height}};PIXI.Sprite.prototype.getBounds=function(matrix){var width=this.texture.frame.width;var height=this.texture.frame.height;var w0=width*(1-this.anchor.x);var w1=width*-this.anchor.x;var h0=height*(1-this.anchor.y);var h1=height*-this.anchor.y;var worldTransform=matrix||this.worldTransform;var a=worldTransform.a;var b=worldTransform.b;var c=worldTransform.c;var d=worldTransform.d;var tx=worldTransform.tx;var ty=worldTransform.ty;var maxX=-Infinity;var maxY=-Infinity;var minX=Infinity;var minY=Infinity;if(b===0&&c===0){if(a<0){a*=-1;var temp=w0;w0=-w1;w1=-temp}if(d<0){d*=-1;var temp=h0;h0=-h1;h1=-temp}minX=a*w1+tx;maxX=a*w0+tx;minY=d*h1+ty;maxY=d*h0+ty}else{var x1=a*w1+c*h1+tx;var y1=d*h1+b*w1+ty;var x2=a*w0+c*h1+tx;var y2=d*h1+b*w0+ty;var x3=a*w0+c*h0+tx;var y3=d*h0+b*w0+ty;var x4=a*w1+c*h0+tx;var y4=d*h0+b*w1+ty;minX=x1<minX?x1:minX;minX=x2<minX?x2:minX;minX=x3<minX?x3:minX;minX=x4<minX?x4:minX;minY=y1<minY?y1:minY;minY=y2<minY?y2:minY;minY=y3<minY?y3:minY;minY=y4<minY?y4:minY;maxX=x1>maxX?x1:maxX;maxX=x2>maxX?x2:maxX;maxX=x3>maxX?x3:maxX;maxX=x4>maxX?x4:maxX;maxY=y1>maxY?y1:maxY;maxY=y2>maxY?y2:maxY;maxY=y3>maxY?y3:maxY;maxY=y4>maxY?y4:maxY}var bounds=this._bounds;bounds.x=minX;bounds.width=maxX-minX;bounds.y=minY;bounds.height=maxY-minY;this._currentBounds=bounds;return bounds};PIXI.Sprite.prototype.getLocalBounds=function(){var matrixCache=this.worldTransform;this.worldTransform=Phaser.identityMatrix;for(var i=0;i<this.children.length;i++){this.children[i].updateTransform()}var bounds=this.getBounds();this.worldTransform=matrixCache;for(i=0;i<this.children.length;i++){this.children[i].updateTransform()}return bounds};PIXI.Sprite.prototype._renderWebGL=function(renderSession,matrix){if(!this.visible||this.alpha<=0||!this.renderable){return}var wt=this.worldTransform;if(matrix){wt=matrix}if(this._mask||this._filters){var spriteBatch=renderSession.spriteBatch;if(this._filters){spriteBatch.flush();renderSession.filterManager.pushFilter(this._filterBlock)}if(this._mask){spriteBatch.stop();renderSession.maskManager.pushMask(this.mask,renderSession);spriteBatch.start()}spriteBatch.render(this);for(var i=0;i<this.children.length;i++){this.children[i]._renderWebGL(renderSession)}spriteBatch.stop();if(this._mask){renderSession.maskManager.popMask(this._mask,renderSession)}if(this._filters){renderSession.filterManager.popFilter()}spriteBatch.start()}else{renderSession.spriteBatch.render(this);for(var i=0;i<this.children.length;i++){this.children[i]._renderWebGL(renderSession,wt)}}};PIXI.Sprite.prototype._renderCanvas=function(renderSession,matrix){if(!this.visible||this.alpha===0||!this.renderable||this.texture.crop.width<1||this.texture.crop.height<1){return}var wt=this.worldTransform;if(matrix){wt=matrix}if(this.blendMode!==renderSession.currentBlendMode){renderSession.currentBlendMode=this.blendMode;renderSession.context.globalCompositeOperation=PIXI.blendModesCanvas[renderSession.currentBlendMode]}if(this._mask){renderSession.maskManager.pushMask(this._mask,renderSession)}if(!this.texture.valid){for(var i=0;i<this.children.length;i++){this.children[i]._renderCanvas(renderSession)}if(this._mask){renderSession.maskManager.popMask(renderSession)}return}var resolution=this.texture.baseTexture.resolution/renderSession.resolution;renderSession.context.globalAlpha=this.worldAlpha;if(renderSession.smoothProperty&&renderSession.scaleMode!==this.texture.baseTexture.scaleMode){renderSession.scaleMode=this.texture.baseTexture.scaleMode;renderSession.context[renderSession.smoothProperty]=(renderSession.scaleMode===PIXI.scaleModes.LINEAR)}var dx=(this.texture.trim)?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width;var dy=(this.texture.trim)?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;var tx=(wt.tx*renderSession.resolution)+renderSession.shakeX;var ty=(wt.ty*renderSession.resolution)+renderSession.shakeY;var cw=this.texture.crop.width;var ch=this.texture.crop.height;if(this.texture.rotated){var a=wt.a;var b=wt.b;var c=wt.c;var d=wt.d;var e=cw;tx=wt.c*ch+tx;ty=wt.d*ch+ty;wt.a=a*6.123233995736766e-17+ -c;wt.b=b*6.123233995736766e-17+ -d;wt.c=a+c*6.123233995736766e-17;wt.d=b+d*6.123233995736766e-17;cw=ch;ch=e}if(renderSession.roundPixels){renderSession.context.setTransform(wt.a,wt.b,wt.c,wt.d,tx|0,ty|0);dx|=0;dy|=0}else{renderSession.context.setTransform(wt.a,wt.b,wt.c,wt.d,tx,ty)}dx/=resolution;dy/=resolution;cw|=0;ch|=0;if(!cw||!ch){return}if(this.tint!==0xFFFFFF){if(this.texture.requiresReTint||this.cachedTint!==this.tint){this.tintedTexture=PIXI.CanvasTinter.getTintedTexture(this,this.tint);this.cachedTint=this.tint;this.texture.requiresReTint=false}renderSession.context.drawImage(this.tintedTexture,0,0,cw,ch,dx,dy,cw/resolution,ch/resolution)}else{var cx=this.texture.crop.x;var cy=this.texture.crop.y;renderSession.context.drawImage(this.texture.baseTexture.source,cx,cy,cw,ch,dx,dy,cw/resolution,ch/resolution)}for(var i=0;i<this.children.length;i++){this.children[i]._renderCanvas(renderSession)}if(this._mask){renderSession.maskManager.popMask(renderSession)}};PIXI.initDefaultShaders=function(){};PIXI.CompileVertexShader=function(gl,shaderSrc){return PIXI._CompileShader(gl,shaderSrc,gl.VERTEX_SHADER)};PIXI.CompileFragmentShader=function(gl,shaderSrc){return PIXI._CompileShader(gl,shaderSrc,gl.FRAGMENT_SHADER)};PIXI._CompileShader=function(gl,shaderSrc,shaderType){var src=shaderSrc;if(Array.isArray(shaderSrc)){src=shaderSrc.join('\t')}var shader=gl.createShader(shaderType);gl.shaderSource(shader,src);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){window.console.log(gl.getShaderInfoLog(shader));return null}return shader};PIXI.compileProgram=function(gl,vertexSrc,fragmentSrc){var fragmentShader=PIXI.CompileFragmentShader(gl,fragmentSrc);var vertexShader=PIXI.CompileVertexShader(gl,vertexSrc);var shaderProgram=gl.createProgram();gl.attachShader(shaderProgram,vertexShader);gl.attachShader(shaderProgram,fragmentShader);gl.linkProgram(shaderProgram);if(!gl.getProgramParameter(shaderProgram,gl.LINK_STATUS)){window.console.log(gl.getProgramInfoLog(shaderProgram));window.console.log('Could not initialise shaders')}return shaderProgram};PIXI.PixiShader=function(gl){this._UID=Phaser._UID++;this.gl=gl;this.program=null;this.fragmentSrc=null;this.textureCount=0;this.firstRun=true;this.dirty=true;this.attributes=[];this.init()};PIXI.PixiShader.prototype.constructor=PIXI.PixiShader;PIXI.PixiShader.prototype.initMultitexShader=function(){var gl=this.gl;this.MAX_TEXTURES=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var dynamicIfs='\nif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\t';for(var index=1;index<this.MAX_TEXTURES;++index){dynamicIfs+='\nif (vTextureIndex == '+index+'.0) {gl_FragColor = texture2D(uSamplerArray['+index+'], vTextureCoord) * vColor;return;}\t'}this.fragmentSrc=['// PixiShader Fragment Shader.','precision lowp float;','bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }','varying vec2 vTextureCoord;','varying vec4 vColor;','varying float vTextureIndex;','uniform sampler2D uSamplerArray['+this.MAX_TEXTURES+'];','const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);','const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);','void main(void) {',dynamicIfs,'   if(vTextureIndex >= '+this.MAX_TEXTURES+'.0) { gl_FragColor = BLUE;return;}','   if(isnan(vTextureIndex)) { gl_FragColor = RED;return;}','}'];var program=PIXI.compileProgram(gl,this.vertexSrc||PIXI.PixiShader.defaultVertexSrc,this.fragmentSrc);gl.useProgram(program);this.uSamplerArray=gl.getUniformLocation(program,'uSamplerArray[0]');this.projectionVector=gl.getUniformLocation(program,'projectionVector');this.offsetVector=gl.getUniformLocation(program,'offsetVector');this.dimensions=gl.getUniformLocation(program,'dimensions');this.aVertexPosition=gl.getAttribLocation(program,'aVertexPosition');this.aTextureCoord=gl.getAttribLocation(program,'aTextureCoord');this.colorAttribute=gl.getAttribLocation(program,'aColor');this.aTextureIndex=gl.getAttribLocation(program,'aTextureIndex');var indices=[];var tempTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,tempTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGB,1,1,0,gl.RGB,gl.UNSIGNED_BYTE,null);for(var i=0;i<this.MAX_TEXTURES;++i){gl.activeTexture(gl.TEXTURE0+i);gl.bindTexture(gl.TEXTURE_2D,tempTexture);indices.push(i)}gl.activeTexture(gl.TEXTURE0);gl.uniform1iv(this.uSamplerArray,indices);if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute,this.aTextureIndex];for(var key in this.uniforms){this.uniforms[key].uniformLocation=gl.getUniformLocation(program,key)}this.initUniforms();this.program=program};PIXI.PixiShader.prototype.initDefaultShader=function(){if(this.fragmentSrc===null){this.fragmentSrc=['precision lowp float;','varying vec2 vTextureCoord;','varying vec4 vColor;','varying float vTextureIndex;','uniform sampler2D uSampler;','void main(void) {','   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;','}']}var gl=this.gl;var program=PIXI.compileProgram(gl,this.vertexSrc||PIXI.PixiShader.defaultVertexSrc,this.fragmentSrc);gl.useProgram(program);this.uSampler=gl.getUniformLocation(program,'uSampler');this.projectionVector=gl.getUniformLocation(program,'projectionVector');this.offsetVector=gl.getUniformLocation(program,'offsetVector');this.dimensions=gl.getUniformLocation(program,'dimensions');this.aVertexPosition=gl.getAttribLocation(program,'aVertexPosition');this.aTextureCoord=gl.getAttribLocation(program,'aTextureCoord');this.colorAttribute=gl.getAttribLocation(program,'aColor');this.aTextureIndex=gl.getAttribLocation(program,'aTextureIndex');if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute,this.aTextureIndex];for(var key in this.uniforms){this.uniforms[key].uniformLocation=gl.getUniformLocation(program,key)}this.initUniforms();this.program=program};PIXI.PixiShader.prototype.init=function(usingFilter){if(PIXI._enableMultiTextureToggle&&!usingFilter){this.initMultitexShader()}else{this.initDefaultShader()}};PIXI.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var gl=this.gl;var uniform;for(var key in this.uniforms){uniform=this.uniforms[key];var type=uniform.type;if(type==='sampler2D'){uniform._init=false;if(uniform.value!==null){this.initSampler2D(uniform)}}else if(type==='mat2'||type==='mat3'||type==='mat4'){uniform.glMatrix=true;uniform.glValueLength=1;if(type==='mat2'){uniform.glFunc=gl.uniformMatrix2fv}else if(type==='mat3'){uniform.glFunc=gl.uniformMatrix3fv}else if(type==='mat4'){uniform.glFunc=gl.uniformMatrix4fv}}else{uniform.glFunc=gl['uniform'+type];if(type==='2f'||type==='2i'){uniform.glValueLength=2}else if(type==='3f'||type==='3i'){uniform.glValueLength=3}else if(type==='4f'||type==='4i'){uniform.glValueLength=4}else{uniform.glValueLength=1}}}};PIXI.PixiShader.prototype.initSampler2D=function(uniform){if(!uniform.value||!uniform.value.baseTexture||!uniform.value.baseTexture.hasLoaded){return}var gl=this.gl;gl.activeTexture(gl.TEXTURE0+this.textureCount);gl.bindTexture(gl.TEXTURE_2D,uniform.value.baseTexture._glTextures[gl.id]);if(uniform.textureData){var data=uniform.textureData;var magFilter=(data.magFilter)?data.magFilter:gl.LINEAR;var minFilter=(data.minFilter)?data.minFilter:gl.LINEAR;var wrapS=(data.wrapS)?data.wrapS:gl.CLAMP_TO_EDGE;var wrapT=(data.wrapT)?data.wrapT:gl.CLAMP_TO_EDGE;var format=(data.luminance)?gl.LUMINANCE:gl.RGBA;if(data.repeat){wrapS=gl.REPEAT;wrapT=gl.REPEAT}gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!!data.flipY);if(data.width){var width=(data.width)?data.width:512;var height=(data.height)?data.height:2;var border=(data.border)?data.border:0;gl.texImage2D(gl.TEXTURE_2D,0,format,width,height,border,format,gl.UNSIGNED_BYTE,null)}else{gl.texImage2D(gl.TEXTURE_2D,0,format,gl.RGBA,gl.UNSIGNED_BYTE,uniform.value.baseTexture.source)}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT)}gl.uniform1i(uniform.uniformLocation,this.textureCount);uniform._init=true;this.textureCount++};PIXI.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var uniform;var gl=this.gl;for(var key in this.uniforms){uniform=this.uniforms[key];if(uniform.glValueLength===1){if(uniform.glMatrix===true){uniform.glFunc.call(gl,uniform.uniformLocation,uniform.transpose,uniform.value)}else{uniform.glFunc.call(gl,uniform.uniformLocation,uniform.value)}}else if(uniform.glValueLength===2){uniform.glFunc.call(gl,uniform.uniformLocation,uniform.value.x,uniform.value.y)}else if(uniform.glValueLength===3){uniform.glFunc.call(gl,uniform.uniformLocation,uniform.value.x,uniform.value.y,uniform.value.z)}else if(uniform.glValueLength===4){uniform.glFunc.call(gl,uniform.uniformLocation,uniform.value.x,uniform.value.y,uniform.value.z,uniform.value.w)}else if(uniform.type==='sampler2D'){if(uniform._init){gl.activeTexture(gl['TEXTURE'+this.textureCount]);if(uniform.value.baseTexture._dirty[gl.id]){PIXI.instances[gl.id].updateTexture(uniform.value.baseTexture)}else{gl.bindTexture(gl.TEXTURE_2D,uniform.value.baseTexture._glTextures[gl.id])}gl.uniform1i(uniform.uniformLocation,this.textureCount);this.textureCount++}else{this.initSampler2D(uniform)}}}};PIXI.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};PIXI.PixiShader.defaultVertexSrc=['// PixiShader Vertex Shader','// With multi-texture rendering','attribute vec2 aVertexPosition;','attribute vec2 aTextureCoord;','attribute vec4 aColor;','attribute float aTextureIndex;','uniform vec2 projectionVector;','uniform vec2 offsetVector;','varying vec2 vTextureCoord;','varying vec4 vColor;','varying float vTextureIndex;','const vec2 center = vec2(-1.0, 1.0);','void main(void) {','   if (aTextureIndex > 0.0) gl_Position = vec4(0.0);','   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);','   vTextureCoord = aTextureCoord;','   vColor = vec4(aColor.rgb * aColor.a, aColor.a);','   vTextureIndex = aTextureIndex;','}'];PIXI.PixiFastShader=function(gl){this._UID=Phaser._UID++;this.gl=gl;this.program=null;if(PIXI._enableMultiTextureToggle){var gl=this.gl;this.MAX_TEXTURES=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var dynamicIfs='\nif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\'';for(var index=1;index<this.MAX_TEXTURES;++index){dynamicIfs+='\tif (vTextureIndex == '+index+'.0) { gl_FragColor = texture2D(uSamplerArray['+index+'], vTextureCoord) * vColor;return;}\n'}this.fragmentSrc=['// PixiFastShader Fragment Shader.','precision lowp float;','bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }','varying vec2 vTextureCoord;','varying float vColor;','varying float vTextureIndex;','uniform sampler2D uSamplerArray['+this.MAX_TEXTURES+'];','const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);','const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);','void main(void) {',dynamicIfs,'   if(vTextureIndex >= '+this.MAX_TEXTURES+'.0) { gl_FragColor = BLUE;return;}','   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}','}']}else{this.fragmentSrc=['// PixiFastShader Fragment Shader.','precision lowp float;','varying vec2 vTextureCoord;','varying float vColor;','varying float vTextureIndex;','uniform sampler2D uSampler;','void main(void) {','   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;','}']}this.vertexSrc=['// PixiFastShader Vertex Shader.','attribute vec2 aVertexPosition;','attribute vec2 aPositionCoord;','attribute vec2 aScale;','attribute float aRotation;','attribute vec2 aTextureCoord;','attribute float aColor;','attribute float aTextureIndex;','uniform vec2 projectionVector;','uniform vec2 offsetVector;','uniform mat3 uMatrix;','varying vec2 vTextureCoord;','varying float vColor;','varying float vTextureIndex;','const vec2 center = vec2(-1.0, 1.0);','void main(void) {','   vec2 v;','   vec2 sv = aVertexPosition * aScale;','   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);','   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);','   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;','   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);','   vTextureCoord = aTextureCoord;','   vTextureIndex = aTextureIndex;','   vColor = aColor;','}'];this.textureCount=0;this.init()};PIXI.PixiFastShader.prototype.constructor=PIXI.PixiFastShader;PIXI.PixiFastShader.prototype.init=function(){var gl=this.gl;var program=PIXI.compileProgram(gl,this.vertexSrc,this.fragmentSrc);gl.useProgram(program);this.uSampler=PIXI._enableMultiTextureToggle?gl.getUniformLocation(program,'uSamplerArray[0]'):gl.getUniformLocation(program,'uSampler');if(PIXI._enableMultiTextureToggle){var indices=[];var tempTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,tempTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGB,1,1,0,gl.RGB,gl.UNSIGNED_BYTE,null);for(var i=0;i<this.MAX_TEXTURES;++i){gl.activeTexture(gl.TEXTURE0+i);gl.bindTexture(gl.TEXTURE_2D,tempTexture);indices.push(i)}gl.activeTexture(gl.TEXTURE0);gl.uniform1iv(this.uSampler,indices)}this.projectionVector=gl.getUniformLocation(program,'projectionVector');this.offsetVector=gl.getUniformLocation(program,'offsetVector');this.dimensions=gl.getUniformLocation(program,'dimensions');this.uMatrix=gl.getUniformLocation(program,'uMatrix');this.aVertexPosition=gl.getAttribLocation(program,'aVertexPosition');this.aPositionCoord=gl.getAttribLocation(program,'aPositionCoord');this.aScale=gl.getAttribLocation(program,'aScale');this.aRotation=gl.getAttribLocation(program,'aRotation');this.aTextureCoord=gl.getAttribLocation(program,'aTextureCoord');this.colorAttribute=gl.getAttribLocation(program,'aColor');this.aTextureIndex=gl.getAttribLocation(program,'aTextureIndex');if(this.colorAttribute===-1){this.colorAttribute=2}this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute,this.aTextureIndex];this.program=program};PIXI.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};PIXI.StripShader=function(gl){this._UID=Phaser._UID++;this.gl=gl;this.program=null;if(PIXI._enableMultiTextureToggle){var gl=this.gl;this.MAX_TEXTURES=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var dynamicIfs='\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord);return;}\n';for(var index=1;index<this.MAX_TEXTURES;++index){dynamicIfs+='\tif (vTextureIndex == '+index+'.0) { gl_FragColor = texture2D(uSamplerArray['+index+'], vTextureCoord) ;return;}\''}this.fragmentSrc=['//StripShader Fragment Shader.','precision mediump float;','bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }','varying vec2 vTextureCoord;','varying float vTextureIndex;','uniform float alpha;','uniform sampler2D uSamplerArray['+this.MAX_TEXTURES+'];','const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);','const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);','void main(void) {',dynamicIfs,'   if(vTextureIndex >= '+this.MAX_TEXTURES+'.0) { gl_FragColor = BLUE;return;}','   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}','}']}else{this.fragmentSrc=['//StripShader Fragment Shader.','precision mediump float;','varying vec2 vTextureCoord;','varying float vTextureIndex;','uniform float alpha;','uniform sampler2D uSampler;','void main(void) {','   gl_FragColor = texture2D(uSampler, vTextureCoord);','}']}this.vertexSrc=['//StripShader Vertex Shader.','attribute vec2 aVertexPosition;','attribute vec2 aTextureCoord;','attribute float aTextureIndex;','uniform mat3 translationMatrix;','uniform vec2 projectionVector;','uniform vec2 offsetVector;','varying vec2 vTextureCoord;','varying float vTextureIndex;','void main(void) {','   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);','   v -= offsetVector.xyx;','   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);','   vTextureCoord = aTextureCoord;','   vTextureIndex = aTextureIndex;','}'];this.init()};PIXI.StripShader.prototype.constructor=PIXI.StripShader;PIXI.StripShader.prototype.init=function(){var gl=this.gl;var program=PIXI.compileProgram(gl,this.vertexSrc,this.fragmentSrc);gl.useProgram(program);this.uSampler=PIXI._enableMultiTextureToggle?gl.getUniformLocation(program,'uSamplerArray[0]'):gl.getUniformLocation(program,'uSampler');if(PIXI._enableMultiTextureToggle){var indices=[];var tempTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,tempTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGB,1,1,0,gl.RGB,gl.UNSIGNED_BYTE,null);for(var i=0;i<this.MAX_TEXTURES;++i){gl.activeTexture(gl.TEXTURE0+i);gl.bindTexture(gl.TEXTURE_2D,tempTexture);indices.push(i)}gl.activeTexture(gl.TEXTURE0);gl.uniform1iv(this.uSampler,indices)}this.projectionVector=gl.getUniformLocation(program,'projectionVector');this.offsetVector=gl.getUniformLocation(program,'offsetVector');this.colorAttribute=gl.getAttribLocation(program,'aColor');this.aTextureIndex=gl.getAttribLocation(program,'aTextureIndex');this.aVertexPosition=gl.getAttribLocation(program,'aVertexPosition');this.aTextureCoord=gl.getAttribLocation(program,'aTextureCoord');this.attributes=[this.aVertexPosition,this.aTextureCoord,this.aTextureIndex];this.translationMatrix=gl.getUniformLocation(program,'translationMatrix');this.alpha=gl.getUniformLocation(program,'alpha');this.program=program};PIXI.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};PIXI.PrimitiveShader=function(gl){this._UID=Phaser._UID++;this.gl=gl;this.program=null;this.fragmentSrc=['precision mediump float;','varying vec4 vColor;','void main(void) {','   gl_FragColor = vColor;','}'];this.vertexSrc=['attribute vec2 aVertexPosition;','attribute vec4 aColor;','uniform mat3 translationMatrix;','uniform vec2 projectionVector;','uniform vec2 offsetVector;','uniform float alpha;','uniform float flipY;','uniform vec3 tint;','varying vec4 vColor;','void main(void) {','   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);','   v -= offsetVector.xyx;','   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);','   vColor = aColor * vec4(tint * alpha, alpha);','}'];this.init()};PIXI.PrimitiveShader.prototype.constructor=PIXI.PrimitiveShader;PIXI.PrimitiveShader.prototype.init=function(){var gl=this.gl;var program=PIXI.compileProgram(gl,this.vertexSrc,this.fragmentSrc);gl.useProgram(program);this.projectionVector=gl.getUniformLocation(program,'projectionVector');this.offsetVector=gl.getUniformLocation(program,'offsetVector');this.tintColor=gl.getUniformLocation(program,'tint');this.flipY=gl.getUniformLocation(program,'flipY');this.aVertexPosition=gl.getAttribLocation(program,'aVertexPosition');this.colorAttribute=gl.getAttribLocation(program,'aColor');this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=gl.getUniformLocation(program,'translationMatrix');this.alpha=gl.getUniformLocation(program,'alpha');this.program=program};PIXI.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attributes=null};PIXI.ComplexPrimitiveShader=function(gl){this._UID=Phaser._UID++;this.gl=gl;this.program=null;this.fragmentSrc=['precision mediump float;','varying vec4 vColor;','void main(void) {','   gl_FragColor = vColor;','}'];this.vertexSrc=['attribute vec2 aVertexPosition;','uniform mat3 translationMatrix;','uniform vec2 projectionVector;','uniform vec2 offsetVector;','uniform vec3 tint;','uniform float alpha;','uniform vec3 color;','uniform float flipY;','varying vec4 vColor;','void main(void) {','   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);','   v -= offsetVector.xyx;','   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);','   vColor = vec4(color * alpha * tint, alpha);','}'];this.init()};PIXI.ComplexPrimitiveShader.prototype.constructor=PIXI.ComplexPrimitiveShader;PIXI.ComplexPrimitiveShader.prototype.init=function(){var gl=this.gl;var program=PIXI.compileProgram(gl,this.vertexSrc,this.fragmentSrc);gl.useProgram(program);this.projectionVector=gl.getUniformLocation(program,'projectionVector');this.offsetVector=gl.getUniformLocation(program,'offsetVector');this.tintColor=gl.getUniformLocation(program,'tint');this.color=gl.getUniformLocation(program,'color');this.flipY=gl.getUniformLocation(program,'flipY');this.aVertexPosition=gl.getAttribLocation(program,'aVertexPosition');this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=gl.getUniformLocation(program,'translationMatrix');this.alpha=gl.getUniformLocation(program,'alpha');this.program=program};PIXI.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.uniforms=null;this.gl=null;this.attribute=null};PIXI.glContexts=[];PIXI.instances=[];PIXI._enableMultiTextureToggle=false;PIXI.WebGLRenderer=function(game,config){this.game=game;if(!PIXI.defaultRenderer){PIXI.defaultRenderer=this}this.extensions={};this.type=Phaser.WEBGL;this.resolution=game.resolution;this.transparent=game.transparent;this.autoResize=false;this.preserveDrawingBuffer=game.preserveDrawingBuffer;this.clearBeforeRender=game.clearBeforeRender;this.powerPreference=game.powerPreference;this.width=game.width;this.height=game.height;this.view=game.canvas;this._contextOptions={alpha:this.transparent,antialias:game.antialias,failIfMajorPerformanceCaveat:config.failIfMajorPerformanceCaveat,premultipliedAlpha:this.transparent&&this.transparent!=='notMultiplied',stencil:true,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:game.powerPreference};this.projection=new PIXI.Point();this.offset=new PIXI.Point();this.shaderManager=new PIXI.WebGLShaderManager();this.spriteBatch=new PIXI.WebGLSpriteBatch(game);this.maskManager=new PIXI.WebGLMaskManager();this.filterManager=new PIXI.WebGLFilterManager();this.stencilManager=new PIXI.WebGLStencilManager();this.blendModeManager=new PIXI.WebGLBlendModeManager();this.renderSession={};this.currentBatchedTextures=[];this.renderSession.game=this.game;this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.renderSession.roundPixels=config.roundPixels||false;this.renderSession.maxTextureAvailableSpace=null;this.initContext();this.mapBlendModes()};PIXI.WebGLRenderer.prototype.constructor=PIXI.WebGLRenderer;PIXI.WebGLRenderer.prototype.initContext=function(){var gl=this.view.getContext('webgl',this._contextOptions)||this.view.getContext('experimental-webgl',this._contextOptions);this.gl=gl;if(!gl){throw new Error('This browser does not support webGL. Try using the canvas renderer')}this.maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.maxTextureSize=this.gl.getParameter(gl.MAX_TEXTURE_SIZE);this.glContextId=gl.id=PIXI.WebGLRenderer.glContextId++;PIXI.glContexts[this.glContextId]=gl;PIXI.instances[this.glContextId]=this;gl.disable(gl.DEPTH_TEST);gl.disable(gl.CULL_FACE);gl.enable(gl.BLEND);this.shaderManager.setContext(gl);this.spriteBatch.setContext(gl);this.maskManager.setContext(gl);this.filterManager.setContext(gl);this.blendModeManager.setContext(gl);this.stencilManager.setContext(gl);this.renderSession.gl=this.gl;this.resize(this.width,this.height);this.extensions.compression={};var etc1=gl.getExtension('WEBGL_compressed_texture_etc1')||gl.getExtension('WEBKIT_WEBGL_compressed_texture_etc1');var pvrtc=gl.getExtension('WEBGL_compressed_texture_pvrtc')||gl.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');var s3tc=gl.getExtension('WEBGL_compressed_texture_s3tc')||gl.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');if(etc1){this.extensions.compression.ETC1=etc1}if(pvrtc){this.extensions.compression.PVRTC=pvrtc}if(s3tc){this.extensions.compression.S3TC=s3tc}};PIXI.WebGLRenderer.prototype.setTexturePriority=function(textureNameCollection){if(!PIXI._enableMultiTextureToggle){console.warn('setTexturePriority error: Multi Texture support hasn\'t been enabled in the Phaser Game Config.');return}var clampPot=function(potSize){--potSize;potSize|=potSize>>1;potSize|=potSize>>2;potSize|=potSize>>4;potSize|=potSize>>8;potSize|=potSize>>16;return++potSize};var gl=this.gl;var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);var imageCache=this.game.cache._cache.image;var imageName=null;for(var i=0;i<this.currentBatchedTextures.length;i++){imageName=this.currentBatchedTextures[i];if(!(imageName in imageCache)){console.warn('setTexturePriority: There is no image "%s" in the image cache.',imageName);continue}imageCache[imageName].base.textureIndex=0}var maxTextureAvailableSpace=(maxTextureSize)-clampPot(Math.max(this.width,this.height));this.currentBatchedTextures.length=0;for(var j=0;j<textureNameCollection.length;++j){imageName=textureNameCollection[j];if(!(imageName in imageCache)){console.warn('setTexturePriority: There is no image "%s" in the image cache.',imageName);continue}var base=imageCache[imageName].base;maxTextureAvailableSpace-=clampPot(Math.max(base.width,base.height));if(maxTextureAvailableSpace<=0){base.textureIndex=0;console.warn('setTexturePriority: Image "%s" was given textureIndex=0 because there is no available texture space (%s).',imageName,maxTextureAvailableSpace)}else{base.textureIndex=(1+(j%(maxTextures-1)))}this.currentBatchedTextures.push(imageName)}this.renderSession.maxTextureAvailableSpace=maxTextureAvailableSpace;return this.currentBatchedTextures};PIXI.WebGLRenderer.prototype.render=function(stage){if(this.contextLost){return}var gl=this.gl;gl.viewport(0,0,this.width,this.height);gl.bindFramebuffer(gl.FRAMEBUFFER,null);if(this.game.clearBeforeRender){gl.clearColor(stage._bgColor.r,stage._bgColor.g,stage._bgColor.b,stage._bgColor.a);gl.clear(gl.COLOR_BUFFER_BIT)}this.offset.x=this.game.camera._shake.x;this.offset.y=this.game.camera._shake.y;this.renderDisplayObject(stage,this.projection)};PIXI.WebGLRenderer.prototype.renderDisplayObject=function(displayObject,projection,buffer,matrix){this.renderSession.blendModeManager.setBlendMode(PIXI.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.flipY=buffer?-1:1;this.renderSession.projection=projection;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,buffer);displayObject._renderWebGL(this.renderSession,matrix);this.spriteBatch.end()};PIXI.WebGLRenderer.prototype.resize=function(width,height){this.width=width*this.resolution;this.height=height*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+'px';this.view.style.height=this.height/this.resolution+'px'}this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};PIXI.WebGLRenderer.prototype.updateCompressedTexture=function(texture){if(!texture.hasLoaded){return false}var gl=this.gl;var textureMetaData=texture.source;if(!texture._glTextures[gl.id]){texture._glTextures[gl.id]=gl.createTexture()}gl.activeTexture(gl.TEXTURE0+texture.textureIndex);gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]);gl.compressedTexImage2D(gl.TEXTURE_2D,0,textureMetaData.glExtensionFormat,textureMetaData.width,textureMetaData.height,0,textureMetaData.textureData);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,texture.scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR:gl.NEAREST);if(texture.mipmap&&Phaser.Math.isPowerOfTwo(texture.width,texture.height)){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,texture.scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST);gl.generateMipmap(gl.TEXTURE_2D)}else{gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,texture.scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR:gl.NEAREST)}if(!texture._powerOf2){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)}else{gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)}texture._dirty[gl.id]=false;return true};PIXI.WebGLRenderer.prototype.updateTexture=function(texture){if(!texture.hasLoaded||!texture.source){return false}if(texture.source.compressionAlgorithm){return this.updateCompressedTexture(texture)}var gl=this.gl;if(!texture._glTextures[gl.id]){texture._glTextures[gl.id]=gl.createTexture()}gl.activeTexture(gl.TEXTURE0+texture.textureIndex);gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultipliedAlpha);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,texture.source);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,texture.scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR:gl.NEAREST);if(texture.mipmap&&Phaser.Math.isPowerOfTwo(texture.width,texture.height)){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,texture.scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST);gl.generateMipmap(gl.TEXTURE_2D)}else{gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,texture.scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR:gl.NEAREST)}if(!texture._powerOf2){gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)}else{gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)}texture._dirty[gl.id]=false;return true};PIXI.WebGLRenderer.prototype.destroy=function(){PIXI.glContexts[this.glContextId]=null;this.projection=null;this.offset=null;this.shaderManager.destroy();this.spriteBatch.destroy();this.maskManager.destroy();this.filterManager.destroy();this.shaderManager=null;this.spriteBatch=null;this.maskManager=null;this.filterManager=null;this.gl=null;this.renderSession=null;Phaser.CanvasPool.remove(this);PIXI.instances[this.glContextId]=null;PIXI.WebGLRenderer.glContextId--};PIXI.WebGLRenderer.prototype.mapBlendModes=function(){var gl=this.gl;if(!PIXI.blendModesWebGL){var b=[];var modes=PIXI.blendModes;b[modes.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.ADD]=[gl.SRC_ALPHA,gl.DST_ALPHA];b[modes.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA];b[modes.SCREEN]=[gl.SRC_ALPHA,gl.ONE];b[modes.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];b[modes.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA];PIXI.blendModesWebGL=b}};PIXI.WebGLRenderer.prototype.getMaxTextureUnit=function(){var gl=this.gl;return gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS)};PIXI.enableMultiTexture=function(){PIXI._enableMultiTextureToggle=true};PIXI.WebGLRenderer.glContextId=0;PIXI.WebGLRenderer.textureArray=[];PIXI.WebGLBlendModeManager=function(){this.currentBlendMode=99999};PIXI.WebGLBlendModeManager.prototype.constructor=PIXI.WebGLBlendModeManager;PIXI.WebGLBlendModeManager.prototype.setContext=function(gl){this.gl=gl};PIXI.WebGLBlendModeManager.prototype.setBlendMode=function(blendMode){if(this.currentBlendMode===blendMode){return false}this.currentBlendMode=blendMode;var blendModeWebGL=PIXI.blendModesWebGL[this.currentBlendMode];if(blendModeWebGL){this.gl.blendFunc(blendModeWebGL[0],blendModeWebGL[1])}return true};PIXI.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};PIXI.WebGLMaskManager=function(){};PIXI.WebGLMaskManager.prototype.constructor=PIXI.WebGLMaskManager;PIXI.WebGLMaskManager.prototype.setContext=function(gl){this.gl=gl};PIXI.WebGLMaskManager.prototype.pushMask=function(maskData,renderSession){var gl=renderSession.gl;if(maskData.dirty){PIXI.WebGLGraphics.updateGraphics(maskData,gl)}if(maskData._webGL[gl.id]===undefined||maskData._webGL[gl.id].data===undefined||maskData._webGL[gl.id].data.length===0){return}renderSession.stencilManager.pushStencil(maskData,maskData._webGL[gl.id].data[0],renderSession)};PIXI.WebGLMaskManager.prototype.popMask=function(maskData,renderSession){var gl=this.gl;if(maskData._webGL[gl.id]===undefined||maskData._webGL[gl.id].data===undefined||maskData._webGL[gl.id].data.length===0){return}renderSession.stencilManager.popStencil(maskData,maskData._webGL[gl.id].data[0],renderSession)};PIXI.WebGLMaskManager.prototype.destroy=function(){this.gl=null};PIXI.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=true;this.count=0};PIXI.WebGLStencilManager.prototype.setContext=function(gl){this.gl=gl};PIXI.WebGLStencilManager.prototype.pushStencil=function(graphics,webGLData,renderSession){var gl=this.gl;this.bindGraphics(graphics,webGLData,renderSession);if(this.stencilStack.length===0){gl.enable(gl.STENCIL_TEST);gl.clear(gl.STENCIL_BUFFER_BIT);this.reverse=true;this.count=0}this.stencilStack.push(webGLData);var level=this.count;gl.colorMask(false,false,false,false);gl.stencilFunc(gl.ALWAYS,0,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INVERT);if(webGLData.mode===1){gl.drawElements(gl.TRIANGLE_FAN,webGLData.indices.length-4,gl.UNSIGNED_SHORT,0);if(this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-level,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)}else{gl.stencilFunc(gl.EQUAL,level,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)}gl.drawElements(gl.TRIANGLE_FAN,4,gl.UNSIGNED_SHORT,(webGLData.indices.length-4)*2);if(this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-(level+1),0xFF)}else{gl.stencilFunc(gl.EQUAL,level+1,0xFF)}this.reverse=!this.reverse}else{if(!this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-level,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)}else{gl.stencilFunc(gl.EQUAL,level,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)}gl.drawElements(gl.TRIANGLE_STRIP,webGLData.indices.length,gl.UNSIGNED_SHORT,0);if(!this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-(level+1),0xFF)}else{gl.stencilFunc(gl.EQUAL,level+1,0xFF)}}gl.colorMask(true,true,true,true);gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP);this.count++};PIXI.WebGLStencilManager.prototype.bindGraphics=function(graphics,webGLData,renderSession){this._currentGraphics=graphics;var gl=this.gl;var projection=renderSession.projection,offset=renderSession.offset,shader;if(webGLData.mode===1){shader=renderSession.shaderManager.complexPrimitiveShader;renderSession.shaderManager.setShader(shader);gl.uniform1f(shader.flipY,renderSession.flipY);gl.uniformMatrix3fv(shader.translationMatrix,false,graphics.worldTransform.toArray(true));gl.uniform2f(shader.projectionVector,projection.x,-projection.y);gl.uniform2f(shader.offsetVector,-offset.x,-offset.y);gl.uniform3fv(shader.tintColor,Phaser.Color.hexToRGBArray(graphics.tint));gl.uniform3fv(shader.color,webGLData.color);gl.uniform1f(shader.alpha,graphics.worldAlpha*webGLData.alpha);gl.bindBuffer(gl.ARRAY_BUFFER,webGLData.buffer);gl.vertexAttribPointer(shader.aVertexPosition,2,gl.FLOAT,false,4*2,0);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,webGLData.indexBuffer)}else{shader=renderSession.shaderManager.primitiveShader;renderSession.shaderManager.setShader(shader);gl.uniformMatrix3fv(shader.translationMatrix,false,graphics.worldTransform.toArray(true));gl.uniform1f(shader.flipY,renderSession.flipY);gl.uniform2f(shader.projectionVector,projection.x,-projection.y);gl.uniform2f(shader.offsetVector,-offset.x,-offset.y);gl.uniform3fv(shader.tintColor,Phaser.Color.hexToRGBArray(graphics.tint));gl.uniform1f(shader.alpha,graphics.worldAlpha);gl.bindBuffer(gl.ARRAY_BUFFER,webGLData.buffer);gl.vertexAttribPointer(shader.aVertexPosition,2,gl.FLOAT,false,4*6,0);gl.vertexAttribPointer(shader.colorAttribute,4,gl.FLOAT,false,4*6,2*4);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,webGLData.indexBuffer)}};PIXI.WebGLStencilManager.prototype.popStencil=function(graphics,webGLData,renderSession){var gl=this.gl;this.stencilStack.pop();this.count--;if(this.stencilStack.length===0){gl.disable(gl.STENCIL_TEST)}else{var level=this.count;this.bindGraphics(graphics,webGLData,renderSession);gl.colorMask(false,false,false,false);if(webGLData.mode===1){this.reverse=!this.reverse;if(this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-(level+1),0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)}else{gl.stencilFunc(gl.EQUAL,level+1,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)}gl.drawElements(gl.TRIANGLE_FAN,4,gl.UNSIGNED_SHORT,(webGLData.indices.length-4)*2);gl.stencilFunc(gl.ALWAYS,0,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INVERT);gl.drawElements(gl.TRIANGLE_FAN,webGLData.indices.length-4,gl.UNSIGNED_SHORT,0);if(!this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-(level),0xFF)}else{gl.stencilFunc(gl.EQUAL,level,0xFF)}}else{if(!this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-(level+1),0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)}else{gl.stencilFunc(gl.EQUAL,level+1,0xFF);gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)}gl.drawElements(gl.TRIANGLE_STRIP,webGLData.indices.length,gl.UNSIGNED_SHORT,0);if(!this.reverse){gl.stencilFunc(gl.EQUAL,0xFF-(level),0xFF)}else{gl.stencilFunc(gl.EQUAL,level,0xFF)}}gl.colorMask(true,true,true,true);gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)}};PIXI.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null;this.gl=null};PIXI.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var i=0;i<this.maxAttibs;i++){this.attribState[i]=false}this.stack=[]};PIXI.WebGLShaderManager.prototype.constructor=PIXI.WebGLShaderManager;PIXI.WebGLShaderManager.prototype.setContext=function(gl){this.gl=gl;this.primitiveShader=new PIXI.PrimitiveShader(gl);this.complexPrimitiveShader=new PIXI.ComplexPrimitiveShader(gl);this.defaultShader=new PIXI.PixiShader(gl);this.fastShader=new PIXI.PixiFastShader(gl);this.stripShader=new PIXI.StripShader(gl);this.creatureShader=PIXI.CreatureShader?new PIXI.CreatureShader(gl):null;this.setShader(this.defaultShader)};PIXI.WebGLShaderManager.prototype.setAttribs=function(attribs){var i;for(i=0;i<this.tempAttribState.length;i++){this.tempAttribState[i]=false}for(i=0;i<attribs.length;i++){var attribId=attribs[i];this.tempAttribState[attribId]=true}var gl=this.gl;for(i=0;i<this.attribState.length;i++){if(this.attribState[i]!==this.tempAttribState[i]){this.attribState[i]=this.tempAttribState[i];if(this.tempAttribState[i]){gl.enableVertexAttribArray(i)}else{gl.disableVertexAttribArray(i)}}}};PIXI.WebGLShaderManager.prototype.setShader=function(shader){if(this._currentId===shader._UID){return false}this._currentId=shader._UID;this.currentShader=shader;this.gl.useProgram(shader.program);this.setAttribs(shader.attributes);return true};PIXI.WebGLShaderManager.prototype.destroy=function(){this.attribState=null;this.tempAttribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();if(this.creatureShader){this.creatureShader.destroy()}this.gl=null};PIXI.WebGLSpriteBatch=function(game){this.game=game;this.vertSize=5;this.size=2000;this.vertexSize=(4*2)+(4*2)+(4)+(4);var numVerts=this.vertexSize*this.size*4;var numIndices=this.size*6;this.vertices=new ArrayBuffer(numVerts);this.positions=new Float32Array(this.vertices);this.colors=new Uint32Array(this.vertices);this.indices=new Uint16Array(numIndices);this.lastIndexCount=0;for(var i=0,j=0;i<numIndices;i+=6,j+=4){this.indices[i+0]=j+0;this.indices[i+1]=j+1;this.indices[i+2]=j+2;this.indices[i+3]=j+0;this.indices[i+4]=j+2;this.indices[i+5]=j+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=true;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=null};PIXI.WebGLSpriteBatch.prototype.setContext=function(gl){this.MAX_TEXTURES=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.gl=gl;if(PIXI._enableMultiTextureToggle){var dynamicIfs='\nif (vTextureIndex == 0.0) {gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\*';for(var index=1;index<this.MAX_TEXTURES;++index){dynamicIfs+='\*if (vTextureIndex == '+index+'.0) {gl_FragColor = texture2D(uSamplerArray['+index+'], vTextureCoord) * vColor;return;}\*'}this.defaultShader=new Phaser.Filter(this.game,undefined,['//WebGLSpriteBatch Fragment Shader.','precision lowp float;','varying vec2 vTextureCoord;','varying vec4 vColor;','varying float vTextureIndex;','uniform sampler2D uSamplerArray['+this.MAX_TEXTURES+'];','void main(void) {',dynamicIfs,'\*gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;','}'])}else{this.defaultShader=new Phaser.Filter(this.game,undefined,['//WebGLSpriteBatch Fragment Shader.','precision lowp float;','varying vec2 vTextureCoord;','varying vec4 vColor;','varying float vTextureIndex;','uniform sampler2D uSampler;','void main(void) {','   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;','}'])}this.vertexBuffer=gl.createBuffer();this.indexBuffer=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.indices,gl.STATIC_DRAW);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,this.vertices,gl.DYNAMIC_DRAW);this.currentBlendMode=99999;var shader=new PIXI.PixiShader(gl);shader.fragmentSrc=this.defaultShader.fragmentSrc;shader.uniforms={};shader.init();this.defaultShader.shaders[gl.id]=shader};PIXI.WebGLSpriteBatch.prototype.begin=function(renderSession){this.renderSession=renderSession;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};PIXI.WebGLSpriteBatch.prototype.end=function(){this.flush()};PIXI.WebGLSpriteBatch.prototype.render=function(sprite,matrix){var texture=sprite.texture;var baseTexture=texture.baseTexture;var gl=this.gl;if(PIXI.WebGLRenderer.textureArray[baseTexture.textureIndex]!=baseTexture){this.flush();gl.activeTexture(gl.TEXTURE0+baseTexture.textureIndex);gl.bindTexture(gl.TEXTURE_2D,baseTexture._glTextures[gl.id]);PIXI.WebGLRenderer.textureArray[baseTexture.textureIndex]=baseTexture}var wt=sprite.worldTransform;if(matrix){wt=matrix}if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=texture.baseTexture}var uvs=texture._uvs;if(!uvs){return}var aX=sprite.anchor.x;var aY=sprite.anchor.y;var w0,w1,h0,h1;if(texture.trim){var trim=texture.trim;w1=trim.x-aX*trim.width;w0=w1+texture.crop.width;h1=trim.y-aY*trim.height;h0=h1+texture.crop.height}else{w0=(texture.frame.width)*(1-aX);w1=(texture.frame.width)*-aX;h0=texture.frame.height*(1-aY);h1=texture.frame.height*-aY}var i=this.currentBatchSize*this.vertexSize;var resolution=texture.baseTexture.resolution;var textureIndex=texture.baseTexture.textureIndex;var a=wt.a/resolution;var b=wt.b/resolution;var c=wt.c/resolution;var d=wt.d/resolution;var tx=wt.tx;var ty=wt.ty;var ch=texture.crop.height;if(texture.rotated){var a0=wt.a;var b0=wt.b;var c0=wt.c;var d0=wt.d;var _w1=w1;var _w0=w0;tx=wt.c*ch+tx;ty=wt.d*ch+ty;a=a0*6.123233995736766e-17+ -c0;b=b0*6.123233995736766e-17+ -d0;c=a0+c0*6.123233995736766e-17;d=b0+d0*6.123233995736766e-17;texture._updateUvsInverted();w0=h0;w1=h1;h0=_w0;h1=_w1}var colors=this.colors;var positions=this.positions;var tint=sprite.tint;var color=(tint>>16)+(tint&0xff00)+((tint&0xff)<<16)+(sprite.worldAlpha*255<<24);if(this.renderSession.roundPixels){positions[i++]=a*w1+c*h1+tx|0;positions[i++]=d*h1+b*w1+ty|0;positions[i++]=uvs.x0;positions[i++]=uvs.y0;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w0+c*h1+tx|0;positions[i++]=d*h1+b*w0+ty|0;positions[i++]=uvs.x1;positions[i++]=uvs.y1;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w0+c*h0+tx|0;positions[i++]=d*h0+b*w0+ty|0;positions[i++]=uvs.x2;positions[i++]=uvs.y2;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w1+c*h0+tx|0;positions[i++]=d*h0+b*w1+ty|0;positions[i++]=uvs.x3;positions[i++]=uvs.y3;colors[i++]=color;positions[i++]=textureIndex}else{positions[i++]=a*w1+c*h1+tx;positions[i++]=d*h1+b*w1+ty;positions[i++]=uvs.x0;positions[i++]=uvs.y0;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w0+c*h1+tx;positions[i++]=d*h1+b*w0+ty;positions[i++]=uvs.x1;positions[i++]=uvs.y1;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w0+c*h0+tx;positions[i++]=d*h0+b*w0+ty;positions[i++]=uvs.x2;positions[i++]=uvs.y2;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w1+c*h0+tx;positions[i++]=d*h0+b*w1+ty;positions[i++]=uvs.x3;positions[i++]=uvs.y3;colors[i++]=color;positions[i++]=textureIndex}this.sprites[this.currentBatchSize++]=sprite};PIXI.WebGLSpriteBatch.prototype.renderTilingSprite=function(sprite){var texture=sprite.tilingTexture;var baseTexture=texture.baseTexture;var gl=this.gl;var textureIndex=sprite.texture.baseTexture.textureIndex;if(PIXI.WebGLRenderer.textureArray[textureIndex]!=baseTexture){this.flush();gl.activeTexture(gl.TEXTURE0+textureIndex);gl.bindTexture(gl.TEXTURE_2D,baseTexture._glTextures[gl.id]);PIXI.WebGLRenderer.textureArray[textureIndex]=baseTexture}if(this.currentBatchSize>=this.size){this.flush();this.currentBaseTexture=texture.baseTexture}if(!sprite._uvs){sprite._uvs=new PIXI.TextureUvs()}var uvs=sprite._uvs;var w=texture.baseTexture.width;var h=texture.baseTexture.height;sprite.tilePosition.x%=w*sprite.tileScaleOffset.x;sprite.tilePosition.y%=h*sprite.tileScaleOffset.y;var offsetX=sprite.tilePosition.x/(w*sprite.tileScaleOffset.x);var offsetY=sprite.tilePosition.y/(h*sprite.tileScaleOffset.y);var scaleX=(sprite.width/w)/(sprite.tileScale.x*sprite.tileScaleOffset.x);var scaleY=(sprite.height/h)/(sprite.tileScale.y*sprite.tileScaleOffset.y);uvs.x0=0-offsetX;uvs.y0=0-offsetY;uvs.x1=(1*scaleX)-offsetX;uvs.y1=0-offsetY;uvs.x2=(1*scaleX)-offsetX;uvs.y2=(1*scaleY)-offsetY;uvs.x3=0-offsetX;uvs.y3=(1*scaleY)-offsetY;var tint=sprite.tint;var color=(tint>>16)+(tint&0xff00)+((tint&0xff)<<16)+(sprite.worldAlpha*255<<24);var positions=this.positions;var colors=this.colors;var width=sprite.width;var height=sprite.height;var aX=sprite.anchor.x;var aY=sprite.anchor.y;var w0=width*(1-aX);var w1=width*-aX;var h0=height*(1-aY);var h1=height*-aY;var i=this.currentBatchSize*this.vertexSize;var resolution=texture.baseTexture.resolution;var wt=sprite.worldTransform;var a=wt.a/resolution;var b=wt.b/resolution;var c=wt.c/resolution;var d=wt.d/resolution;var tx=wt.tx;var ty=wt.ty;positions[i++]=a*w1+c*h1+tx;positions[i++]=d*h1+b*w1+ty;positions[i++]=uvs.x0;positions[i++]=uvs.y0;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=(a*w0+c*h1+tx);positions[i++]=d*h1+b*w0+ty;positions[i++]=uvs.x1;positions[i++]=uvs.y1;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w0+c*h0+tx;positions[i++]=d*h0+b*w0+ty;positions[i++]=uvs.x2;positions[i++]=uvs.y2;colors[i++]=color;positions[i++]=textureIndex;positions[i++]=a*w1+c*h0+tx;positions[i++]=d*h0+b*w1+ty;positions[i++]=uvs.x3;positions[i++]=uvs.y3;colors[i++]=color;positions[i++]=textureIndex;this.sprites[this.currentBatchSize++]=sprite};PIXI.WebGLSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0){return}var gl=this.gl;var shader;if(this.dirty){this.dirty=false;shader=this.defaultShader.shaders[gl.id];gl.activeTexture(gl.TEXTURE0);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var stride=this.vertexSize;gl.vertexAttribPointer(shader.aVertexPosition,2,gl.FLOAT,false,stride,0);gl.vertexAttribPointer(shader.aTextureCoord,2,gl.FLOAT,false,stride,8);gl.vertexAttribPointer(shader.colorAttribute,4,gl.UNSIGNED_BYTE,true,stride,16);gl.vertexAttribPointer(shader.aTextureIndex,1,gl.FLOAT,false,stride,20)}if(this.currentBatchSize>(this.size*0.5)){gl.bufferSubData(gl.ARRAY_BUFFER,0,this.vertices)}else{gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);var view=this.positions.subarray(0,this.currentBatchSize*this.vertexSize);gl.bufferSubData(gl.ARRAY_BUFFER,0,view)}var nextTexture,nextBlendMode,nextShader;var batchSize=0;var start=0;var currentBaseTexture=null;var currentBlendMode=this.renderSession.blendModeManager.currentBlendMode;var currentShader=null;var blendSwap=false;var shaderSwap=false;var sprite;for(var i=0,j=this.currentBatchSize;i<j;i++){sprite=this.sprites[i];if(sprite.tilingTexture){nextTexture=sprite.tilingTexture.baseTexture}else{nextTexture=sprite.texture.baseTexture}nextBlendMode=sprite.blendMode;nextShader=sprite.shader||this.defaultShader;blendSwap=currentBlendMode!==nextBlendMode;shaderSwap=currentShader!==nextShader;var skip=nextTexture.skipRender;if(skip&&sprite.children.length>0){skip=false}if(blendSwap||shaderSwap){this.renderBatch(currentBaseTexture,batchSize,start);start=i;batchSize=0;currentBaseTexture=nextTexture;if(blendSwap){currentBlendMode=nextBlendMode;this.renderSession.blendModeManager.setBlendMode(currentBlendMode)}if(shaderSwap){currentShader=nextShader;shader=currentShader.shaders[gl.id];if(!shader){shader=new PIXI.PixiShader(gl);shader.fragmentSrc=currentShader.fragmentSrc;shader.uniforms=currentShader.uniforms;shader.init();currentShader.shaders[gl.id]=shader}this.renderSession.shaderManager.setShader(shader);if(shader.dirty){shader.syncUniforms()}var projection=this.renderSession.projection;gl.uniform2f(shader.projectionVector,projection.x,projection.y);var offsetVector=this.renderSession.offset;gl.uniform2f(shader.offsetVector,offsetVector.x,offsetVector.y)}}batchSize++}this.renderBatch(currentBaseTexture,batchSize,start);this.currentBatchSize=0};PIXI.WebGLSpriteBatch.prototype.renderBatch=function(texture,size,startIndex){if(size===0){return}var gl=this.gl;if(texture._dirty[gl.id]){if(!this.renderSession.renderer.updateTexture(texture)){return}}else{gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id])}gl.drawElements(gl.TRIANGLES,size*6,gl.UNSIGNED_SHORT,startIndex*6*2);this.renderSession.drawCount++};PIXI.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=true};PIXI.WebGLSpriteBatch.prototype.start=function(){this.dirty=true};PIXI.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null;this.indices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.currentBaseTexture=null;this.gl=null};PIXI.WebGLFastSpriteBatch=function(gl){this.vertSize=11;this.maxSize=6000;this.size=this.maxSize;var numVerts=this.size*4*this.vertSize;var numIndices=this.maxSize*6;this.vertices=new Float32Array(numVerts);this.indices=new Uint16Array(numIndices);this.vertexBuffer=null;this.indexBuffer=null;this.lastIndexCount=0;for(var i=0,j=0;i<numIndices;i+=6,j+=4){this.indices[i+0]=j+0;this.indices[i+1]=j+1;this.indices[i+2]=j+2;this.indices[i+3]=j+0;this.indices[i+4]=j+2;this.indices[i+5]=j+3}this.drawing=false;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.renderSession=null;this.shader=null;this.matrix=null;this.setContext(gl)};PIXI.WebGLFastSpriteBatch.prototype.constructor=PIXI.WebGLFastSpriteBatch;PIXI.WebGLFastSpriteBatch.prototype.setContext=function(gl){this.gl=gl;this.vertexBuffer=gl.createBuffer();this.indexBuffer=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.indices,gl.STATIC_DRAW);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,this.vertices,gl.DYNAMIC_DRAW)};PIXI.WebGLFastSpriteBatch.prototype.begin=function(spriteBatch,renderSession){this.renderSession=renderSession;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=spriteBatch.worldTransform.toArray(true);this.start()};PIXI.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};PIXI.WebGLFastSpriteBatch.prototype.render=function(spriteBatch){var children=spriteBatch.children;var sprite=children[0];if(!sprite.texture._uvs){return}this.currentBaseTexture=sprite.texture.baseTexture;if(sprite.blendMode!==this.renderSession.blendModeManager.currentBlendMode){this.flush();this.renderSession.blendModeManager.setBlendMode(sprite.blendMode)}var textureIndex=this.currentBaseTexture.textureIndex;var gl=this.gl;gl.activeTexture(gl.TEXTURE0+textureIndex);gl.bindTexture(gl.TEXTURE_2D,this.currentBaseTexture._glTextures[gl.id]);PIXI.WebGLRenderer.textureArray[textureIndex]=this.currentBaseTexture;for(var i=0,j=children.length;i<j;i++){this.renderSprite(children[i])}this.flush()};PIXI.WebGLFastSpriteBatch.prototype.renderSprite=function(sprite){var texture=sprite.texture;var baseTexture=texture.baseTexture;var gl=this.gl;var textureIndex=sprite.texture.baseTexture.textureIndex;if(PIXI.WebGLRenderer.textureArray[textureIndex]!=baseTexture&&baseTexture._glTextures[gl.id]&&!sprite.texture.baseTexture.skipRender){this.flush();gl.activeTexture(gl.TEXTURE0+textureIndex);gl.bindTexture(gl.TEXTURE_2D,baseTexture._glTextures[gl.id]);PIXI.WebGLRenderer.textureArray[textureIndex]=baseTexture;if(!sprite.texture._uvs){return}}if(!sprite.visible){return}var uvs,vertices=this.vertices,width,height,w0,w1,h0,h1,index;uvs=sprite.texture._uvs;width=sprite.texture.frame.width;height=sprite.texture.frame.height;if(sprite.texture.trim){var trim=sprite.texture.trim;w1=trim.x-sprite.anchor.x*trim.width;w0=w1+sprite.texture.crop.width;h1=trim.y-sprite.anchor.y*trim.height;h0=h1+sprite.texture.crop.height}else{w0=width*(1-sprite.anchor.x);w1=width*-sprite.anchor.x;h0=height*(1-sprite.anchor.y);h1=height*-sprite.anchor.y}index=this.currentBatchSize*4*this.vertSize;vertices[index++]=w1;vertices[index++]=h1;vertices[index++]=sprite.position.x;vertices[index++]=sprite.position.y;vertices[index++]=sprite.scale.x;vertices[index++]=sprite.scale.y;vertices[index++]=sprite.rotation;vertices[index++]=uvs.x0;vertices[index++]=uvs.y1;vertices[index++]=sprite.alpha;vertices[index++]=textureIndex;vertices[index++]=w0;vertices[index++]=h1;vertices[index++]=sprite.position.x;vertices[index++]=sprite.position.y;vertices[index++]=sprite.scale.x;vertices[index++]=sprite.scale.y;vertices[index++]=sprite.rotation;vertices[index++]=uvs.x1;vertices[index++]=uvs.y1;vertices[index++]=sprite.alpha;vertices[index++]=textureIndex;vertices[index++]=w0;vertices[index++]=h0;vertices[index++]=sprite.position.x;vertices[index++]=sprite.position.y;vertices[index++]=sprite.scale.x;vertices[index++]=sprite.scale.y;vertices[index++]=sprite.rotation;vertices[index++]=uvs.x2;vertices[index++]=uvs.y2;vertices[index++]=sprite.alpha;vertices[index++]=textureIndex;vertices[index++]=w1;vertices[index++]=h0;vertices[index++]=sprite.position.x;vertices[index++]=sprite.position.y;vertices[index++]=sprite.scale.x;vertices[index++]=sprite.scale.y;vertices[index++]=sprite.rotation;vertices[index++]=uvs.x3;vertices[index++]=uvs.y3;vertices[index++]=sprite.alpha;vertices[index++]=textureIndex;this.currentBatchSize++;if(this.currentBatchSize>=this.size){this.flush()}};PIXI.WebGLFastSpriteBatch.prototype.flush=function(){if(this.currentBatchSize===0){return}var gl=this.gl;if(!this.currentBaseTexture._glTextures[gl.id]){this.renderSession.renderer.updateTexture(this.currentBaseTexture,gl);return}if(this.currentBatchSize>(this.size*0.5)){gl.bufferSubData(gl.ARRAY_BUFFER,0,this.vertices)}else{var view=this.vertices.subarray(0,this.currentBatchSize*4*this.vertSize);gl.bufferSubData(gl.ARRAY_BUFFER,0,view)}gl.drawElements(gl.TRIANGLES,this.currentBatchSize*6,gl.UNSIGNED_SHORT,0);this.currentBatchSize=0;this.renderSession.drawCount++};PIXI.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};PIXI.WebGLFastSpriteBatch.prototype.start=function(){var gl=this.gl;gl.activeTexture(gl.TEXTURE0);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var projection=this.renderSession.projection;gl.uniform2f(this.shader.projectionVector,projection.x,projection.y);gl.uniformMatrix3fv(this.shader.uMatrix,false,this.matrix);var stride=this.vertSize*4;gl.vertexAttribPointer(this.shader.aVertexPosition,2,gl.FLOAT,false,stride,0);gl.vertexAttribPointer(this.shader.aPositionCoord,2,gl.FLOAT,false,stride,2*4);gl.vertexAttribPointer(this.shader.aScale,2,gl.FLOAT,false,stride,4*4);gl.vertexAttribPointer(this.shader.aRotation,1,gl.FLOAT,false,stride,6*4);gl.vertexAttribPointer(this.shader.aTextureCoord,2,gl.FLOAT,false,stride,7*4);gl.vertexAttribPointer(this.shader.colorAttribute,1,gl.FLOAT,false,stride,9*4);gl.vertexAttribPointer(this.shader.aTextureIndex,1,gl.FLOAT,false,stride,10*4)};PIXI.WebGLFilterManager=function(){this.filterStack=[];this.offsetX=0;this.offsetY=0};PIXI.WebGLFilterManager.prototype.constructor=PIXI.WebGLFilterManager;PIXI.WebGLFilterManager.prototype.setContext=function(gl){this.gl=gl;this.texturePool=[];this.initShaderBuffers()};PIXI.WebGLFilterManager.prototype.begin=function(renderSession,buffer){this.renderSession=renderSession;this.defaultShader=renderSession.shaderManager.defaultShader;var projection=this.renderSession.projection;this.width=projection.x*2;this.height=-projection.y*2;this.buffer=buffer};PIXI.WebGLFilterManager.prototype.pushFilter=function(filterBlock){var gl=this.gl;var projection=this.renderSession.projection;var offset=this.renderSession.offset;filterBlock._filterArea=filterBlock.target.filterArea||filterBlock.target.getBounds();filterBlock._previous_stencil_mgr=this.renderSession.stencilManager;this.renderSession.stencilManager=new PIXI.WebGLStencilManager();this.renderSession.stencilManager.setContext(gl);gl.disable(gl.STENCIL_TEST);this.filterStack.push(filterBlock);var filter=filterBlock.filterPasses[0];this.offsetX+=filterBlock._filterArea.x;this.offsetY+=filterBlock._filterArea.y;var texture=this.texturePool.pop();if(!texture){texture=new PIXI.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)}else{texture.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)}gl.bindTexture(gl.TEXTURE_2D,texture.texture);var filterArea=filterBlock._filterArea;var padding=filter.padding;filterArea.x-=padding;filterArea.y-=padding;filterArea.width+=padding*2;filterArea.height+=padding*2;if(filterArea.x<0){filterArea.x=0}if(filterArea.width>this.width){filterArea.width=this.width}if(filterArea.y<0){filterArea.y=0}if(filterArea.height>this.height){filterArea.height=this.height}gl.bindFramebuffer(gl.FRAMEBUFFER,texture.frameBuffer);gl.viewport(0,0,filterArea.width*this.renderSession.resolution,filterArea.height*this.renderSession.resolution);projection.x=filterArea.width/2;projection.y=-filterArea.height/2;offset.x=-filterArea.x;offset.y=-filterArea.y;gl.colorMask(true,true,true,true);gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT);filterBlock._glFilterTexture=texture};PIXI.WebGLFilterManager.prototype.popFilter=function(){var gl=this.gl;var filterBlock=this.filterStack.pop();var filterArea=filterBlock._filterArea;var texture=filterBlock._glFilterTexture;var projection=this.renderSession.projection;var offset=this.renderSession.offset;if(filterBlock.filterPasses.length>1){gl.viewport(0,0,filterArea.width*this.renderSession.resolution,filterArea.height*this.renderSession.resolution);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=filterArea.height;this.vertexArray[2]=filterArea.width;this.vertexArray[3]=filterArea.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=filterArea.width;this.vertexArray[7]=0;gl.bufferSubData(gl.ARRAY_BUFFER,0,this.vertexArray);gl.bindBuffer(gl.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=filterArea.width/this.width;this.uvArray[5]=filterArea.height/this.height;this.uvArray[6]=filterArea.width/this.width;this.uvArray[7]=filterArea.height/this.height;gl.bufferSubData(gl.ARRAY_BUFFER,0,this.uvArray);var inputTexture=texture;var outputTexture=this.texturePool.pop();if(!outputTexture){outputTexture=new PIXI.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)}outputTexture.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution);gl.bindFramebuffer(gl.FRAMEBUFFER,outputTexture.frameBuffer);gl.clear(gl.COLOR_BUFFER_BIT);gl.disable(gl.BLEND);for(var i=0;i<filterBlock.filterPasses.length-1;i++){var filterPass=filterBlock.filterPasses[i];gl.bindFramebuffer(gl.FRAMEBUFFER,outputTexture.frameBuffer);gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,inputTexture.texture);this.applyFilterPass(filterPass,filterArea,filterArea.width,filterArea.height);var temp=inputTexture;inputTexture=outputTexture;outputTexture=temp}gl.enable(gl.BLEND);texture=inputTexture;this.texturePool.push(outputTexture)}var filter=filterBlock.filterPasses[filterBlock.filterPasses.length-1];this.offsetX-=filterArea.x;this.offsetY-=filterArea.y;var sizeX=this.width;var sizeY=this.height;var offsetX=0;var offsetY=0;var buffer=this.buffer;if(this.filterStack.length===0){gl.colorMask(true,true,true,true)}else{var currentFilter=this.filterStack[this.filterStack.length-1];filterArea=currentFilter._filterArea;sizeX=filterArea.width;sizeY=filterArea.height;offsetX=filterArea.x;offsetY=filterArea.y;buffer=currentFilter._glFilterTexture.frameBuffer}projection.x=sizeX/2;projection.y=-sizeY/2;offset.x=offsetX;offset.y=offsetY;filterArea=filterBlock._filterArea;var x=filterArea.x-offsetX;var y=filterArea.y-offsetY;gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=x;this.vertexArray[1]=y+filterArea.height;this.vertexArray[2]=x+filterArea.width;this.vertexArray[3]=y+filterArea.height;this.vertexArray[4]=x;this.vertexArray[5]=y;this.vertexArray[6]=x+filterArea.width;this.vertexArray[7]=y;gl.bufferSubData(gl.ARRAY_BUFFER,0,this.vertexArray);gl.bindBuffer(gl.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=filterArea.width/this.width;this.uvArray[5]=filterArea.height/this.height;this.uvArray[6]=filterArea.width/this.width;this.uvArray[7]=filterArea.height/this.height;gl.bufferSubData(gl.ARRAY_BUFFER,0,this.uvArray);gl.viewport(0,0,sizeX*this.renderSession.resolution,sizeY*this.renderSession.resolution);gl.bindFramebuffer(gl.FRAMEBUFFER,buffer);gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,texture.texture);if(this.renderSession.stencilManager){this.renderSession.stencilManager.destroy()}this.renderSession.stencilManager=filterBlock._previous_stencil_mgr;filterBlock._previous_stencil_mgr=null;if(this.renderSession.stencilManager.count>0){gl.enable(gl.STENCIL_TEST)}else{gl.disable(gl.STENCIL_TEST)}this.applyFilterPass(filter,filterArea,sizeX,sizeY);this.texturePool.push(texture);filterBlock._glFilterTexture=null};PIXI.WebGLFilterManager.prototype.applyFilterPass=function(filter,filterArea,width,height){var gl=this.gl;var shader=filter.shaders[gl.id];if(!shader){shader=new PIXI.PixiShader(gl);shader.fragmentSrc=filter.fragmentSrc;shader.uniforms=filter.uniforms;shader.init(true);filter.shaders[gl.id]=shader}this.renderSession.shaderManager.setShader(shader);gl.uniform2f(shader.projectionVector,width/2,-height/2);gl.uniform2f(shader.offsetVector,0,0);if(filter.uniforms.dimensions){filter.uniforms.dimensions.value[0]=this.width;filter.uniforms.dimensions.value[1]=this.height;filter.uniforms.dimensions.value[2]=this.vertexArray[0];filter.uniforms.dimensions.value[3]=this.vertexArray[5]}shader.syncUniforms();gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.vertexAttribPointer(shader.aVertexPosition,2,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,this.uvBuffer);gl.vertexAttribPointer(shader.aTextureCoord,2,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,this.colorBuffer);gl.vertexAttribPointer(shader.colorAttribute,2,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0);this.renderSession.drawCount++};PIXI.WebGLFilterManager.prototype.initShaderBuffers=function(){var gl=this.gl;this.vertexBuffer=gl.createBuffer();this.uvBuffer=gl.createBuffer();this.colorBuffer=gl.createBuffer();this.indexBuffer=gl.createBuffer();this.vertexArray=new Float32Array([0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0]);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,this.vertexArray,gl.STATIC_DRAW);this.uvArray=new Float32Array([0.0,0.0,1.0,0.0,0.0,1.0,1.0,1.0]);gl.bindBuffer(gl.ARRAY_BUFFER,this.uvBuffer);gl.bufferData(gl.ARRAY_BUFFER,this.uvArray,gl.STATIC_DRAW);this.colorArray=new Float32Array([1.0,0xFFFFFF,1.0,0xFFFFFF,1.0,0xFFFFFF,1.0,0xFFFFFF]);gl.bindBuffer(gl.ARRAY_BUFFER,this.colorBuffer);gl.bufferData(gl.ARRAY_BUFFER,this.colorArray,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),gl.STATIC_DRAW)};PIXI.WebGLFilterManager.prototype.destroy=function(){var gl=this.gl;this.filterStack=null;this.offsetX=0;this.offsetY=0;for(var i=0;i<this.texturePool.length;i++){this.texturePool[i].destroy()}this.texturePool=null;gl.deleteBuffer(this.vertexBuffer);gl.deleteBuffer(this.uvBuffer);gl.deleteBuffer(this.colorBuffer);gl.deleteBuffer(this.indexBuffer)};function _CreateEmptyTexture(gl,width,height,scaleMode){var texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,texture);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR:gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,scaleMode===PIXI.scaleModes.LINEAR?gl.LINEAR:gl.NEAREST);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);return texture}var _fbErrors={36054:'Incomplete attachment',36055:'Missing attachment',36057:'Incomplete dimensions',36061:'Framebuffer unsupported'};function _CreateFramebuffer(gl,width,height,scaleMode,textureUnit){var framebuffer=gl.createFramebuffer();var depthStencilBuffer=gl.createRenderbuffer();var colorBuffer=null;var fbStatus=0;gl.activeTexture(gl.TEXTURE0+textureUnit);gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);gl.bindRenderbuffer(gl.RENDERBUFFER,depthStencilBuffer);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,this.renderBuffer);colorBuffer=_CreateEmptyTexture(gl,width,height,scaleMode);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,colorBuffer,0);fbStatus=gl.checkFramebufferStatus(gl.FRAMEBUFFER);if(fbStatus!==gl.FRAMEBUFFER_COMPLETE){console.error('Incomplete GL framebuffer. ',_fbErrors[fbStatus])}framebuffer.width=width;framebuffer.height=height;framebuffer.targetTexture=colorBuffer;framebuffer.renderBuffer=depthStencilBuffer;return framebuffer}PIXI.FilterTexture=function(gl,width,height,scaleMode,textureUnit){textureUnit=typeof textureUnit==='number'?textureUnit:0;this.gl=gl;this.frameBuffer=_CreateFramebuffer(gl,width,height,scaleMode||PIXI.scaleModes.DEFAULT,textureUnit);this.texture=this.frameBuffer.targetTexture;this.width=width;this.height=height;this.renderBuffer=this.frameBuffer.renderBuffer};PIXI.FilterTexture.prototype.constructor=PIXI.FilterTexture;PIXI.FilterTexture.prototype.clear=function(){var gl=this.gl;gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT)};PIXI.FilterTexture.prototype.resize=function(width,height){if(this.width===width&&this.height===height){return}this.width=width;this.height=height;var gl=this.gl;gl.bindTexture(gl.TEXTURE_2D,this.texture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.bindRenderbuffer(gl.RENDERBUFFER,this.renderBuffer);gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width,height)};PIXI.FilterTexture.prototype.destroy=function(){var gl=this.gl;gl.deleteFramebuffer(this.frameBuffer);gl.deleteTexture(this.texture);this.frameBuffer=null;this.texture=null};PIXI.CanvasBuffer=function(width,height){this.width=width;this.height=height;this.canvas=Phaser.CanvasPool.create(this,this.width,this.height);this.context=this.canvas.getContext('2d');this.canvas.width=width;this.canvas.height=height};PIXI.CanvasBuffer.prototype.constructor=PIXI.CanvasBuffer;PIXI.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0);this.context.clearRect(0,0,this.width,this.height)};PIXI.CanvasBuffer.prototype.resize=function(width,height){this.width=this.canvas.width=width;this.height=this.canvas.height=height};PIXI.CanvasBuffer.prototype.destroy=function(){Phaser.CanvasPool.remove(this)};PIXI.CanvasMaskManager=function(){};PIXI.CanvasMaskManager.prototype.constructor=PIXI.CanvasMaskManager;PIXI.CanvasMaskManager.prototype.pushMask=function(maskData,renderSession){var context=renderSession.context;context.save();var cacheAlpha=maskData.alpha;var transform=maskData.worldTransform;var resolution=renderSession.resolution;context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution);PIXI.CanvasGraphics.renderGraphicsMask(maskData,context);context.clip();maskData.worldAlpha=cacheAlpha};PIXI.CanvasMaskManager.prototype.popMask=function(renderSession){renderSession.context.restore()};PIXI.CanvasTinter=function(){};PIXI.CanvasTinter.getTintedTexture=function(sprite,color){var canvas=sprite.tintedTexture||Phaser.CanvasPool.create(this);PIXI.CanvasTinter.tintMethod(sprite.texture,color,canvas);return canvas};PIXI.CanvasTinter.tintWithMultiply=function(texture,color,canvas){var context=canvas.getContext('2d');var crop=texture.crop;var w=crop.width;var h=crop.height;if(texture.rotated){w=h;h=crop.width}if(canvas.width!==w||canvas.height!==h){canvas.width=w;canvas.height=h}context.clearRect(0,0,w,h);context.fillStyle='#'+('00000'+(color|0).toString(16)).substr(-6);context.fillRect(0,0,w,h);context.globalCompositeOperation='multiply';context.drawImage(texture.baseTexture.source,crop.x,crop.y,w,h,0,0,w,h);context.globalCompositeOperation='destination-atop';context.drawImage(texture.baseTexture.source,crop.x,crop.y,w,h,0,0,w,h)};PIXI.CanvasTinter.tintWithPerPixel=function(texture,color,canvas){var context=canvas.getContext('2d');var crop=texture.crop;var w=crop.width;var h=crop.height;if(texture.rotated){w=h;h=crop.width}if(canvas.width!==w||canvas.height!==h){canvas.width=w;canvas.height=h}context.globalCompositeOperation='copy';context.drawImage(texture.baseTexture.source,crop.x,crop.y,w,h,0,0,w,h);var rgbValues=Phaser.Color.hexToRGBArray(color);var r=rgbValues[0],g=rgbValues[1],b=rgbValues[2];var pixelData=context.getImageData(0,0,w,h);var pixels=pixelData.data;for(var i=0;i<pixels.length;i+=4){pixels[i+0]*=r;pixels[i+1]*=g;pixels[i+2]*=b;if(!PIXI.CanvasTinter.canHandleAlpha){var alpha=pixels[i+3];pixels[i+0]/= 255 /alpha;pixels[i+1]/= 255 /alpha;pixels[i+2]/= 255 /alpha}}context.putImageData(pixelData,0,0)};PIXI.CanvasRenderer=function(game,config){this.game=game;if(!PIXI.defaultRenderer){PIXI.defaultRenderer=this}this.type=Phaser.CANVAS;this.resolution=game.resolution;this.clearBeforeRender=game.clearBeforeRender;this.transparent=game.transparent;this.autoResize=false;this.width=game.width*this.resolution;this.height=game.height*this.resolution;this.view=game.canvas;this.context=this.view.getContext('2d',{alpha:this.transparent});if(!this.context){throw new Error('Failed to create a Canvas 2d context.')}this.refresh=true;this.count=0;this.maskManager=new PIXI.CanvasMaskManager();this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:config.roundPixels||false};this.mapBlendModes();this.resize(this.width,this.height)};PIXI.CanvasRenderer.prototype.constructor=PIXI.CanvasRenderer;PIXI.CanvasRenderer.prototype.render=function(root){this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=0;this.renderSession.shakeX=this.game.camera._shake.x;this.renderSession.shakeY=this.game.camera._shake.y;this.context.globalCompositeOperation='source-over';if(navigator.isCocoonJS&&this.view.screencanvas){this.context.fillStyle='black';this.context.clear()}if(this.clearBeforeRender){if(this.transparent){this.context.clearRect(0,0,this.width,this.height)}else if(root._bgColor){this.context.fillStyle=root._bgColor.rgba;this.context.fillRect(0,0,this.width,this.height)}}this.renderDisplayObject(root)};PIXI.CanvasRenderer.prototype.setTexturePriority=function(){};PIXI.CanvasRenderer.prototype.destroy=function(removeView){if(removeView===undefined){removeView=true}if(removeView&&this.view.parent){this.view.parent.removeChild(this.view)}this.view=null;this.context=null;this.maskManager=null;this.renderSession=null};PIXI.CanvasRenderer.prototype.resize=function(width,height){this.width=width*this.resolution;this.height=height*this.resolution;this.view.width=this.width;this.view.height=this.height;if(this.autoResize){this.view.style.width=this.width/this.resolution+'px';this.view.style.height=this.height/this.resolution+'px'}if(this.renderSession.smoothProperty){this.context[this.renderSession.smoothProperty]=(this.renderSession.scaleMode===PIXI.scaleModes.LINEAR)}};PIXI.CanvasRenderer.prototype.renderDisplayObject=function(displayObject,context,matrix){this.renderSession.context=context||this.context;this.renderSession.resolution=this.resolution;displayObject._renderCanvas(this.renderSession,matrix)};PIXI.CanvasRenderer.prototype.mapBlendModes=function(){if(!PIXI.blendModesCanvas){var b=[];var modes=PIXI.blendModes;var useNew=this.game.device.canUseMultiply;b[modes.NORMAL]='source-over';b[modes.ADD]='lighter';b[modes.MULTIPLY]=(useNew)?'multiply':'source-over';b[modes.SCREEN]=(useNew)?'screen':'source-over';b[modes.OVERLAY]=(useNew)?'overlay':'source-over';b[modes.DARKEN]=(useNew)?'darken':'source-over';b[modes.LIGHTEN]=(useNew)?'lighten':'source-over';b[modes.COLOR_DODGE]=(useNew)?'color-dodge':'source-over';b[modes.COLOR_BURN]=(useNew)?'color-burn':'source-over';b[modes.HARD_LIGHT]=(useNew)?'hard-light':'source-over';b[modes.SOFT_LIGHT]=(useNew)?'soft-light':'source-over';b[modes.DIFFERENCE]=(useNew)?'difference':'source-over';b[modes.EXCLUSION]=(useNew)?'exclusion':'source-over';b[modes.HUE]=(useNew)?'hue':'source-over';b[modes.SATURATION]=(useNew)?'saturation':'source-over';b[modes.COLOR]=(useNew)?'color':'source-over';b[modes.LUMINOSITY]=(useNew)?'luminosity':'source-over';PIXI.blendModesCanvas=b}};PIXI.BaseTexture=function(source,scaleMode,resolution){this.resolution=resolution||1;this.width=100;this.height=100;this.scaleMode=scaleMode||PIXI.scaleModes.DEFAULT;this.hasLoaded=false;this.source=source;this.premultipliedAlpha=true;this._glTextures=[];this.mipmap=false;this.textureIndex=0;this._dirty=[true,true,true,true];if(!source){return}if((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height){this.hasLoaded=true;this.width=this.source.naturalWidth||this.source.width;this.height=this.source.naturalHeight||this.source.height;this.dirty()}this.skipRender=false;this._powerOf2=false};PIXI.BaseTexture.prototype.constructor=PIXI.BaseTexture;PIXI.BaseTexture.prototype.forceLoaded=function(width,height){this.hasLoaded=true;this.width=width;this.height=height;this.dirty()};PIXI.BaseTexture.prototype.destroy=function(){if(this.source){Phaser.CanvasPool.removeByCanvas(this.source)}this.source=null;this.unloadFromGPU()};PIXI.BaseTexture.prototype.dirty=function(){for(var i=0;i<this._glTextures.length;i++){this._dirty[i]=true}};PIXI.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var i=this._glTextures.length-1;i>=0;i--){var glTexture=this._glTextures[i];var gl=PIXI.glContexts[i];if(gl&&glTexture){gl.deleteTexture(glTexture)}}this._glTextures.length=0;this.dirty()};PIXI.BaseTexture.fromCanvas=function(canvas,scaleMode,resolution){if(canvas.width===0){canvas.width=1}if(canvas.height===0){canvas.height=1}resolution=resolution||1;return new PIXI.BaseTexture(canvas,scaleMode,resolution)};PIXI.TextureSilentFail=false;PIXI.Texture=function(baseTexture,frame,crop,trim){this.noFrame=false;if(!frame){this.noFrame=true;frame=new PIXI.Rectangle(0,0,1,1)}if(baseTexture instanceof PIXI.Texture){baseTexture=baseTexture.baseTexture}this.baseTexture=baseTexture;this.frame=frame;this.trim=trim;this.valid=false;this.isTiling=false;this.requiresUpdate=false;this.requiresReTint=false;this._uvs=null;this.width=0;this.height=0;this.crop=crop||new PIXI.Rectangle(0,0,1,1);this.rotated=false;if(baseTexture.hasLoaded){if(this.noFrame){frame=new PIXI.Rectangle(0,0,baseTexture.width,baseTexture.height)}this.setFrame(frame)}};PIXI.Texture.prototype.constructor=PIXI.Texture;PIXI.Texture.prototype.onBaseTextureLoaded=function(){var baseTexture=this.baseTexture;if(this.noFrame){this.frame=new PIXI.Rectangle(0,0,baseTexture.width,baseTexture.height)}this.setFrame(this.frame)};PIXI.Texture.prototype.destroy=function(destroyBase){if(destroyBase){this.baseTexture.destroy()}this.valid=false};PIXI.Texture.prototype.setFrame=function(frame){this.noFrame=false;this.frame=frame;this.width=frame.width;this.height=frame.height;this.crop.x=frame.x;this.crop.y=frame.y;this.crop.width=frame.width;this.crop.height=frame.height;if(!this.trim&&(frame.x+frame.width>this.baseTexture.width||frame.y+frame.height>this.baseTexture.height)){if(!PIXI.TextureSilentFail){throw new Error('Texture Error: frame does not fit inside the base Texture dimensions '+this)}this.valid=false;return}this.valid=frame&&frame.width&&frame.height&&this.baseTexture.source&&this.baseTexture.hasLoaded;if(this.trim){this.width=this.trim.width;this.height=this.trim.height;this.frame.width=this.trim.width;this.frame.height=this.trim.height}if(this.valid){this._updateUvs()}};PIXI.Texture.prototype._updateUvs=function(){if(!this._uvs){this._uvs=new PIXI.TextureUvs()}var frame=this.crop;var tw=this.baseTexture.width;var th=this.baseTexture.height;this._uvs.x0=frame.x/tw;this._uvs.y0=frame.y/th;this._uvs.x1=(frame.x+frame.width)/tw;this._uvs.y1=frame.y/th;this._uvs.x2=(frame.x+frame.width)/tw;this._uvs.y2=(frame.y+frame.height)/th;this._uvs.x3=frame.x/tw;this._uvs.y3=(frame.y+frame.height)/th};PIXI.Texture.prototype._updateUvsInverted=function(){if(!this._uvs){this._uvs=new PIXI.TextureUvs()}var frame=this.crop;var tw=this.baseTexture.width;var th=this.baseTexture.height;this._uvs.x0=frame.x/tw;this._uvs.y0=frame.y/th;this._uvs.x1=(frame.x+frame.height)/tw;this._uvs.y1=frame.y/th;this._uvs.x2=(frame.x+frame.height)/tw;this._uvs.y2=(frame.y+frame.width)/th;this._uvs.x3=frame.x/tw;this._uvs.y3=(frame.y+frame.width)/th};PIXI.Texture.fromCanvas=function(canvas,scaleMode){var baseTexture=PIXI.BaseTexture.fromCanvas(canvas,scaleMode);return new PIXI.Texture(baseTexture)};PIXI.TextureUvs=function(){this.x0=0;this.y0=0;this.x1=0;this.y1=0;this.x2=0;this.y2=0;this.x3=0;this.y3=0};if(true){if(typeof module!=='undefined'&&module.exports){exports=module.exports=PIXI}exports.PIXI=PIXI}else if(typeof define!=='undefined'&&define.amd){define('PIXI',(function(){return root.PIXI=PIXI})())}else{root.PIXI=PIXI}return PIXI}).call(this)}),(function(module,exports,__webpack_require__){(function(global){module.exports=global["p2"]=__webpack_require__(11)}.call(exports,__webpack_require__(2)))}),(function(module,exports,__webpack_require__){var require;var require;!function(e){if(true){module.exports=e()}else if(typeof define=='function'&&false){define(e)}else{var f;typeof window!='undefined'?f=window:typeof global!='undefined'?f=global:typeof self!='undefined'&&(f=self),f.p2=e()}}(function(){var define,module,exports;return(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=='function'&&require;if(!u&&a){return require(o,!0)}if(i){return i(o,!0)}throw new Error('Cannot find module \*'+o+'\*')}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=='function'&&require;for(var o=0;o<r.length;o++){s(r[o])}return s})({1:[function(_dereq_,module,exports){var Scalar=_dereq_('./Scalar');module.exports=Line;function Line(){}Line.lineInt=function(l1,l2,precision){precision=precision||0;var i=[0,0];var a1,b1,c1,a2,b2,c2,det;a1=l1[1][1]-l1[0][1];b1=l1[0][0]-l1[1][0];c1=a1*l1[0][0]+b1*l1[0][1];a2=l2[1][1]-l2[0][1];b2=l2[0][0]-l2[1][0];c2=a2*l2[0][0]+b2*l2[0][1];det=a1*b2-a2*b1;if(!Scalar.eq(det,0,precision)){i[0]=(b2*c1-b1*c2)/det;i[1]=(a1*c2-a2*c1)/det}return i};Line.segmentsIntersect=function(p1,p2,q1,q2){var dx=p2[0]-p1[0];var dy=p2[1]-p1[1];var da=q2[0]-q1[0];var db=q2[1]-q1[1];if(da*dy-db*dx==0){return false}var s=(dx*(q1[1]-p1[1])+dy*(p1[0]-q1[0]))/(da*dy-db*dx);var t=(da*(p1[1]-q1[1])+db*(q1[0]-p1[0]))/(db*dx-da*dy);return(s>=0&&s<=1&&t>=0&&t<=1)}},{'./Scalar':4}],2:[function(_dereq_,module,exports){module.exports=Point;function Point(){}Point.area=function(a,b,c){return(((b[0]-a[0])*(c[1]-a[1]))-((c[0]-a[0])*(b[1]-a[1])))};Point.left=function(a,b,c){return Point.area(a,b,c)>0};Point.leftOn=function(a,b,c){return Point.area(a,b,c)>=0};Point.right=function(a,b,c){return Point.area(a,b,c)<0};Point.rightOn=function(a,b,c){return Point.area(a,b,c)<=0};var tmpPoint1=[],tmpPoint2=[];Point.collinear=function(a,b,c,thresholdAngle){if(!thresholdAngle){return Point.area(a,b,c)==0}else{var ab=tmpPoint1,bc=tmpPoint2;ab[0]=b[0]-a[0];ab[1]=b[1]-a[1];bc[0]=c[0]-b[0];bc[1]=c[1]-b[1];var dot=ab[0]*bc[0]+ab[1]*bc[1],magA=Math.sqrt(ab[0]*ab[0]+ab[1]*ab[1]),magB=Math.sqrt(bc[0]*bc[0]+bc[1]*bc[1]),angle=Math.acos(dot/(magA*magB));return angle<thresholdAngle}};Point.sqdist=function(a,b){var dx=b[0]-a[0];var dy=b[1]-a[1];return dx*dx+dy*dy}},{}],3:[function(_dereq_,module,exports){var Line=_dereq_('./Line'),Point=_dereq_('./Point'),Scalar=_dereq_('./Scalar');module.exports=Polygon;function Polygon(){this.vertices=[]}Polygon.prototype.at=function(i){var v=this.vertices,s=v.length;return v[i<0?i%s+s:i%s]};Polygon.prototype.first=function(){return this.vertices[0]};Polygon.prototype.last=function(){return this.vertices[this.vertices.length-1]};Polygon.prototype.clear=function(){this.vertices.length=0};Polygon.prototype.append=function(poly,from,to){if(typeof(from)=='undefined'){throw new Error('From is not given!')}if(typeof(to)=='undefined'){throw new Error('To is not given!')}if(to-1<from){throw new Error('lol1')}if(to>poly.vertices.length){throw new Error('lol2')}if(from<0){throw new Error('lol3')}for(var i=from;i<to;i++){this.vertices.push(poly.vertices[i])}};Polygon.prototype.makeCCW=function(){var br=0,v=this.vertices;for(var i=1;i<this.vertices.length;++i){if(v[i][1]<v[br][1]||(v[i][1]==v[br][1]&&v[i][0]>v[br][0])){br=i}}if(!Point.left(this.at(br-1),this.at(br),this.at(br+1))){this.reverse()}};Polygon.prototype.reverse=function(){var tmp=[];for(var i=0,N=this.vertices.length;i!==N;i++){tmp.push(this.vertices.pop())}this.vertices=tmp};Polygon.prototype.isReflex=function(i){return Point.right(this.at(i-1),this.at(i),this.at(i+1))};var tmpLine1=[],tmpLine2=[];Polygon.prototype.canSee=function(a,b){var p,dist,l1=tmpLine1,l2=tmpLine2;if(Point.leftOn(this.at(a+1),this.at(a),this.at(b))&&Point.rightOn(this.at(a-1),this.at(a),this.at(b))){return false}dist=Point.sqdist(this.at(a),this.at(b));for(var i=0;i!==this.vertices.length;++i){if((i+1)%this.vertices.length===a||i===a){continue}if(Point.leftOn(this.at(a),this.at(b),this.at(i+1))&&Point.rightOn(this.at(a),this.at(b),this.at(i))){l1[0]=this.at(a);l1[1]=this.at(b);l2[0]=this.at(i);l2[1]=this.at(i+1);p=Line.lineInt(l1,l2);if(Point.sqdist(this.at(a),p)<dist){return false}}}return true};Polygon.prototype.copy=function(i,j,targetPoly){var p=targetPoly||new Polygon();p.clear();if(i<j){for(var k=i;k<=j;k++){p.vertices.push(this.vertices[k])}}else{for(var k=0;k<=j;k++){p.vertices.push(this.vertices[k])}for(var k=i;k<this.vertices.length;k++){p.vertices.push(this.vertices[k])}}return p};Polygon.prototype.getCutEdges=function(){var min=[],tmp1=[],tmp2=[],tmpPoly=new Polygon();var nDiags=Number.MAX_VALUE;for(var i=0;i<this.vertices.length;++i){if(this.isReflex(i)){for(var j=0;j<this.vertices.length;++j){if(this.canSee(i,j)){tmp1=this.copy(i,j,tmpPoly).getCutEdges();tmp2=this.copy(j,i,tmpPoly).getCutEdges();for(var k=0;k<tmp2.length;k++){tmp1.push(tmp2[k])}if(tmp1.length<nDiags){min=tmp1;nDiags=tmp1.length;min.push([this.at(i),this.at(j)])}}}}}return min};Polygon.prototype.decomp=function(){var edges=this.getCutEdges();if(edges.length>0){return this.slice(edges)}else{return[this]}};Polygon.prototype.slice=function(cutEdges){if(cutEdges.length==0){return[this]}if(cutEdges instanceof Array&&cutEdges.length&&cutEdges[0]instanceof Array&&cutEdges[0].length==2&&cutEdges[0][0]instanceof Array){var polys=[this];for(var i=0;i<cutEdges.length;i++){var cutEdge=cutEdges[i];for(var j=0;j<polys.length;j++){var poly=polys[j];var result=poly.slice(cutEdge);if(result){polys.splice(j,1);polys.push(result[0],result[1]);break}}}return polys}else{var cutEdge=cutEdges;var i=this.vertices.indexOf(cutEdge[0]);var j=this.vertices.indexOf(cutEdge[1]);if(i!=-1&&j!=-1){return[this.copy(i,j),this.copy(j,i)]}else{return false}}};Polygon.prototype.isSimple=function(){var path=this.vertices;for(var i=0;i<path.length-1;i++){for(var j=0;j<i-1;j++){if(Line.segmentsIntersect(path[i],path[i+1],path[j],path[j+1])){return false}}}for(var i=1;i<path.length-2;i++){if(Line.segmentsIntersect(path[0],path[path.length-1],path[i],path[i+1])){return false}}return true};function getIntersectionPoint(p1,p2,q1,q2,delta){delta=delta||0;var a1=p2[1]-p1[1];var b1=p1[0]-p2[0];var c1=(a1*p1[0])+(b1*p1[1]);var a2=q2[1]-q1[1];var b2=q1[0]-q2[0];var c2=(a2*q1[0])+(b2*q1[1]);var det=(a1*b2)-(a2*b1);if(!Scalar.eq(det,0,delta)){return[((b2*c1)-(b1*c2))/det,((a1*c2)-(a2*c1))/det]}else{return[0,0]}}Polygon.prototype.quickDecomp=function(result,reflexVertices,steinerPoints,delta,maxlevel,level){maxlevel=maxlevel||100;level=level||0;delta=delta||25;result=typeof(result)!='undefined'?result:[];reflexVertices=reflexVertices||[];steinerPoints=steinerPoints||[];var upperInt=[0,0],lowerInt=[0,0],p=[0,0];var upperDist=0,lowerDist=0,d=0,closestDist=0;var upperIndex=0,lowerIndex=0,closestIndex=0;var lowerPoly=new Polygon(),upperPoly=new Polygon();var poly=this,v=this.vertices;if(v.length<3){return result}level++;if(level>maxlevel){console.warn('quickDecomp: max level ('+maxlevel+') reached.');return result}for(var i=0;i<this.vertices.length;++i){if(poly.isReflex(i)){reflexVertices.push(poly.vertices[i]);upperDist=lowerDist=Number.MAX_VALUE;for(var j=0;j<this.vertices.length;++j){if(Point.left(poly.at(i-1),poly.at(i),poly.at(j))&&Point.rightOn(poly.at(i-1),poly.at(i),poly.at(j-1))){p=getIntersectionPoint(poly.at(i-1),poly.at(i),poly.at(j),poly.at(j-1));if(Point.right(poly.at(i+1),poly.at(i),p)){d=Point.sqdist(poly.vertices[i],p);if(d<lowerDist){lowerDist=d;lowerInt=p;lowerIndex=j}}}if(Point.left(poly.at(i+1),poly.at(i),poly.at(j+1))&&Point.rightOn(poly.at(i+1),poly.at(i),poly.at(j))){p=getIntersectionPoint(poly.at(i+1),poly.at(i),poly.at(j),poly.at(j+1));if(Point.left(poly.at(i-1),poly.at(i),p)){d=Point.sqdist(poly.vertices[i],p);if(d<upperDist){upperDist=d;upperInt=p;upperIndex=j}}}}if(lowerIndex==(upperIndex+1)%this.vertices.length){p[0]=(lowerInt[0]+upperInt[0])/2;p[1]=(lowerInt[1]+upperInt[1])/2;steinerPoints.push(p);if(i<upperIndex){lowerPoly.append(poly,i,upperIndex+1);lowerPoly.vertices.push(p);upperPoly.vertices.push(p);if(lowerIndex!=0){upperPoly.append(poly,lowerIndex,poly.vertices.length)}upperPoly.append(poly,0,i+1)}else{if(i!=0){lowerPoly.append(poly,i,poly.vertices.length)}lowerPoly.append(poly,0,upperIndex+1);lowerPoly.vertices.push(p);upperPoly.vertices.push(p);upperPoly.append(poly,lowerIndex,i+1)}}else{if(lowerIndex>upperIndex){upperIndex+=this.vertices.length}closestDist=Number.MAX_VALUE;if(upperIndex<lowerIndex){return result}for(var j=lowerIndex;j<=upperIndex;++j){if(Point.leftOn(poly.at(i-1),poly.at(i),poly.at(j))&&Point.rightOn(poly.at(i+1),poly.at(i),poly.at(j))){d=Point.sqdist(poly.at(i),poly.at(j));if(d<closestDist){closestDist=d;closestIndex=j%this.vertices.length}}}if(i<closestIndex){lowerPoly.append(poly,i,closestIndex+1);if(closestIndex!=0){upperPoly.append(poly,closestIndex,v.length)}upperPoly.append(poly,0,i+1)}else{if(i!=0){lowerPoly.append(poly,i,v.length)}lowerPoly.append(poly,0,closestIndex+1);upperPoly.append(poly,closestIndex,i+1)}}if(lowerPoly.vertices.length<upperPoly.vertices.length){lowerPoly.quickDecomp(result,reflexVertices,steinerPoints,delta,maxlevel,level);upperPoly.quickDecomp(result,reflexVertices,steinerPoints,delta,maxlevel,level)}else{upperPoly.quickDecomp(result,reflexVertices,steinerPoints,delta,maxlevel,level);lowerPoly.quickDecomp(result,reflexVertices,steinerPoints,delta,maxlevel,level)}return result}}result.push(this);return result};Polygon.prototype.removeCollinearPoints=function(precision){var num=0;for(var i=this.vertices.length-1;this.vertices.length>3&&i>=0;--i){if(Point.collinear(this.at(i-1),this.at(i),this.at(i+1),precision)){this.vertices.splice(i%this.vertices.length,1);i--;num++}}return num}},{'./Line':1,'./Point':2,'./Scalar':4}],4:[function(_dereq_,module,exports){module.exports=Scalar;function Scalar(){}Scalar.eq=function(a,b,precision){precision=precision||0;return Math.abs(a-b)<precision}},{}],5:[function(_dereq_,module,exports){module.exports={Polygon:_dereq_('./Polygon'),Point:_dereq_('./Point')}},{'./Point':2,'./Polygon':3}],6:[function(_dereq_,module,exports){module.exports={name:'p2',version:'0.7.1',description:'A JavaScript 2D physics engine.',author:'Stefan Hedman <schteppe@gmail.com> (http://steffe.se)',keywords:['p2.js','p2','physics','engine','2d'],main:'./src/p2.js',engines:{node:'*'},repository:{type:'git',url:'https://github.com/schteppe/p2.js.git'},bugs:{url:'https://github.com/schteppe/p2.js/issues'},licenses:[{type:'MIT'}],devDependencies:{grunt:'^0.4.5','grunt-contrib-jshint':'^0.11.2','grunt-contrib-nodeunit':'^0.4.1','grunt-contrib-uglify':'~0.4.0','grunt-contrib-watch':'~0.5.0','grunt-browserify':'~2.0.1','grunt-contrib-concat':'^0.4.0'},dependencies:{'poly-decomp':'0.1.1'}}},{}],7:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),Utils=_dereq_('../utils/Utils');module.exports=AABB;function AABB(options){this.lowerBound=vec2.create();if(options&&options.lowerBound){vec2.copy(this.lowerBound,options.lowerBound)}this.upperBound=vec2.create();if(options&&options.upperBound){vec2.copy(this.upperBound,options.upperBound)}}var tmp=vec2.create();AABB.prototype.setFromPoints=function(points,position,angle,skinSize){var l=this.lowerBound,u=this.upperBound;if(typeof(angle)!=='number'){angle=0}if(angle!==0){vec2.rotate(l,points[0],angle)}else{vec2.copy(l,points[0])}vec2.copy(u,l);var cosAngle=Math.cos(angle),sinAngle=Math.sin(angle);for(var i=1;i<points.length;i++){var p=points[i];if(angle!==0){var x=p[0],y=p[1];tmp[0]=cosAngle*x-sinAngle*y;tmp[1]=sinAngle*x+cosAngle*y;p=tmp}for(var j=0;j<2;j++){if(p[j]>u[j]){u[j]=p[j]}if(p[j]<l[j]){l[j]=p[j]}}}if(position){vec2.add(this.lowerBound,this.lowerBound,position);vec2.add(this.upperBound,this.upperBound,position)}if(skinSize){this.lowerBound[0]-=skinSize;this.lowerBound[1]-=skinSize;this.upperBound[0]+=skinSize;this.upperBound[1]+=skinSize}};AABB.prototype.copy=function(aabb){vec2.copy(this.lowerBound,aabb.lowerBound);vec2.copy(this.upperBound,aabb.upperBound)};AABB.prototype.extend=function(aabb){var i=2;while(i--){var l=aabb.lowerBound[i];if(this.lowerBound[i]>l){this.lowerBound[i]=l}var u=aabb.upperBound[i];if(this.upperBound[i]<u){this.upperBound[i]=u}}};AABB.prototype.overlaps=function(aabb){var l1=this.lowerBound,u1=this.upperBound,l2=aabb.lowerBound,u2=aabb.upperBound;return((l2[0]<=u1[0]&&u1[0]<=u2[0])||(l1[0]<=u2[0]&&u2[0]<=u1[0]))&&((l2[1]<=u1[1]&&u1[1]<=u2[1])||(l1[1]<=u2[1]&&u2[1]<=u1[1]))};AABB.prototype.containsPoint=function(point){var l=this.lowerBound,u=this.upperBound;return l[0]<=point[0]&&point[0]<=u[0]&&l[1]<=point[1]&&point[1]<=u[1]};AABB.prototype.overlapsRay=function(ray){var t=0;var dirFracX=1/ray.direction[0];var dirFracY=1/ray.direction[1];var t1=(this.lowerBound[0]-ray.from[0])*dirFracX;var t2=(this.upperBound[0]-ray.from[0])*dirFracX;var t3=(this.lowerBound[1]-ray.from[1])*dirFracY;var t4=(this.upperBound[1]-ray.from[1])*dirFracY;var tmin=Math.max(Math.max(Math.min(t1,t2),Math.min(t3,t4)));var tmax=Math.min(Math.min(Math.max(t1,t2),Math.max(t3,t4)));if(tmax<0){return-1}if(tmin>tmax){return-1}return tmin}},{'../math/vec2':30,'../utils/Utils':57}],8:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2');var Body=_dereq_('../objects/Body');module.exports=Broadphase;function Broadphase(type){this.type=type;this.result=[];this.world=null;this.boundingVolumeType=Broadphase.AABB}Broadphase.AABB=1;Broadphase.BOUNDING_CIRCLE=2;Broadphase.prototype.setWorld=function(world){this.world=world};Broadphase.prototype.getCollisionPairs=function(world){};var dist=vec2.create();Broadphase.boundingRadiusCheck=function(bodyA,bodyB){vec2.sub(dist,bodyA.position,bodyB.position);var d2=vec2.squaredLength(dist),r=bodyA.boundingRadius+bodyB.boundingRadius;return d2<=r*r};Broadphase.aabbCheck=function(bodyA,bodyB){return bodyA.getAABB().overlaps(bodyB.getAABB())};Broadphase.prototype.boundingVolumeCheck=function(bodyA,bodyB){var result;switch(this.boundingVolumeType){case Broadphase.BOUNDING_CIRCLE:result=Broadphase.boundingRadiusCheck(bodyA,bodyB);break;case Broadphase.AABB:result=Broadphase.aabbCheck(bodyA,bodyB);break;default:throw new Error('Bounding volume type not recognized: '+this.boundingVolumeType)}return result};Broadphase.canCollide=function(bodyA,bodyB){var KINEMATIC=Body.KINEMATIC;var STATIC=Body.STATIC;if(bodyA.type===STATIC&&bodyB.type===STATIC){return false}if((bodyA.type===KINEMATIC&&bodyB.type===STATIC)||(bodyA.type===STATIC&&bodyB.type===KINEMATIC)){return false}if(bodyA.type===KINEMATIC&&bodyB.type===KINEMATIC){return false}if(bodyA.sleepState===Body.SLEEPING&&bodyB.sleepState===Body.SLEEPING){return false}if((bodyA.sleepState===Body.SLEEPING&&bodyB.type===STATIC)||(bodyB.sleepState===Body.SLEEPING&&bodyA.type===STATIC)){return false}return true};Broadphase.NAIVE=1;Broadphase.SAP=2},{'../math/vec2':30,'../objects/Body':31}],9:[function(_dereq_,module,exports){var Circle=_dereq_('../shapes/Circle'),Plane=_dereq_('../shapes/Plane'),Shape=_dereq_('../shapes/Shape'),Particle=_dereq_('../shapes/Particle'),Broadphase=_dereq_('../collision/Broadphase'),vec2=_dereq_('../math/vec2');module.exports=NaiveBroadphase;function NaiveBroadphase(){Broadphase.call(this,Broadphase.NAIVE)}NaiveBroadphase.prototype=new Broadphase();NaiveBroadphase.prototype.constructor=NaiveBroadphase;NaiveBroadphase.prototype.getCollisionPairs=function(world){var bodies=world.bodies,result=this.result;result.length=0;for(var i=0,Ncolliding=bodies.length;i!==Ncolliding;i++){var bi=bodies[i];for(var j=0;j<i;j++){var bj=bodies[j];if(Broadphase.canCollide(bi,bj)&&this.boundingVolumeCheck(bi,bj)){result.push(bi,bj)}}}return result};NaiveBroadphase.prototype.aabbQuery=function(world,aabb,result){result=result||[];var bodies=world.bodies;for(var i=0;i<bodies.length;i++){var b=bodies[i];if(b.aabbNeedsUpdate){b.updateAABB()}if(b.aabb.overlaps(aabb)){result.push(b)}}return result}},{'../collision/Broadphase':8,'../math/vec2':30,'../shapes/Circle':39,'../shapes/Particle':43,'../shapes/Plane':44,'../shapes/Shape':45}],10:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),sub=vec2.sub,add=vec2.add,dot=vec2.dot,Utils=_dereq_('../utils/Utils'),ContactEquationPool=_dereq_('../utils/ContactEquationPool'),FrictionEquationPool=_dereq_('../utils/FrictionEquationPool'),TupleDictionary=_dereq_('../utils/TupleDictionary'),Equation=_dereq_('../equations/Equation'),ContactEquation=_dereq_('../equations/ContactEquation'),FrictionEquation=_dereq_('../equations/FrictionEquation'),Circle=_dereq_('../shapes/Circle'),Convex=_dereq_('../shapes/Convex'),Shape=_dereq_('../shapes/Shape'),Body=_dereq_('../objects/Body'),Box=_dereq_('../shapes/Box');module.exports=Narrowphase;var yAxis=vec2.fromValues(0,1);var tmp1=vec2.fromValues(0,0),tmp2=vec2.fromValues(0,0),tmp3=vec2.fromValues(0,0),tmp4=vec2.fromValues(0,0),tmp5=vec2.fromValues(0,0),tmp6=vec2.fromValues(0,0),tmp7=vec2.fromValues(0,0),tmp8=vec2.fromValues(0,0),tmp9=vec2.fromValues(0,0),tmp10=vec2.fromValues(0,0),tmp11=vec2.fromValues(0,0),tmp12=vec2.fromValues(0,0),tmp13=vec2.fromValues(0,0),tmp14=vec2.fromValues(0,0),tmp15=vec2.fromValues(0,0),tmp16=vec2.fromValues(0,0),tmp17=vec2.fromValues(0,0),tmp18=vec2.fromValues(0,0),tmpArray=[];function Narrowphase(){this.contactEquations=[];this.frictionEquations=[];this.enableFriction=true;this.enabledEquations=true;this.slipForce=10.0;this.frictionCoefficient=0.3;this.surfaceVelocity=0;this.contactEquationPool=new ContactEquationPool({size:32});this.frictionEquationPool=new FrictionEquationPool({size:64});this.restitution=0;this.stiffness=Equation.DEFAULT_STIFFNESS;this.relaxation=Equation.DEFAULT_RELAXATION;this.frictionStiffness=Equation.DEFAULT_STIFFNESS;this.frictionRelaxation=Equation.DEFAULT_RELAXATION;this.enableFrictionReduction=true;this.collidingBodiesLastStep=new TupleDictionary();this.contactSkinSize=0.01}var bodiesOverlap_shapePositionA=vec2.create();var bodiesOverlap_shapePositionB=vec2.create();Narrowphase.prototype.bodiesOverlap=function(bodyA,bodyB){var shapePositionA=bodiesOverlap_shapePositionA;var shapePositionB=bodiesOverlap_shapePositionB;for(var k=0,Nshapesi=bodyA.shapes.length;k!==Nshapesi;k++){var shapeA=bodyA.shapes[k];bodyA.toWorldFrame(shapePositionA,shapeA.position);for(var l=0,Nshapesj=bodyB.shapes.length;l!==Nshapesj;l++){var shapeB=bodyB.shapes[l];bodyB.toWorldFrame(shapePositionB,shapeB.position);if(this[shapeA.type|shapeB.type](bodyA,shapeA,shapePositionA,shapeA.angle+bodyA.angle,bodyB,shapeB,shapePositionB,shapeB.angle+bodyB.angle,true)){return true}}}return false};Narrowphase.prototype.collidedLastStep=function(bodyA,bodyB){var id1=bodyA.id|0,id2=bodyB.id|0;return!!this.collidingBodiesLastStep.get(id1,id2)};Narrowphase.prototype.reset=function(){this.collidingBodiesLastStep.reset();var eqs=this.contactEquations;var l=eqs.length;while(l--){var eq=eqs[l],id1=eq.bodyA.id,id2=eq.bodyB.id;this.collidingBodiesLastStep.set(id1,id2,true)}var ce=this.contactEquations,fe=this.frictionEquations;for(var i=0;i<ce.length;i++){this.contactEquationPool.release(ce[i])}for(var i=0;i<fe.length;i++){this.frictionEquationPool.release(fe[i])}this.contactEquations.length=this.frictionEquations.length=0};Narrowphase.prototype.createContactEquation=function(bodyA,bodyB,shapeA,shapeB){var c=this.contactEquationPool.get();c.bodyA=bodyA;c.bodyB=bodyB;c.shapeA=shapeA;c.shapeB=shapeB;c.restitution=this.restitution;c.firstImpact=!this.collidedLastStep(bodyA,bodyB);c.stiffness=this.stiffness;c.relaxation=this.relaxation;c.needsUpdate=true;c.enabled=this.enabledEquations;c.offset=this.contactSkinSize;return c};Narrowphase.prototype.createFrictionEquation=function(bodyA,bodyB,shapeA,shapeB){var c=this.frictionEquationPool.get();c.bodyA=bodyA;c.bodyB=bodyB;c.shapeA=shapeA;c.shapeB=shapeB;c.setSlipForce(this.slipForce);c.frictionCoefficient=this.frictionCoefficient;c.relativeVelocity=this.surfaceVelocity;c.enabled=this.enabledEquations;c.needsUpdate=true;c.stiffness=this.frictionStiffness;c.relaxation=this.frictionRelaxation;c.contactEquations.length=0;return c};Narrowphase.prototype.createFrictionFromContact=function(c){var eq=this.createFrictionEquation(c.bodyA,c.bodyB,c.shapeA,c.shapeB);vec2.copy(eq.contactPointA,c.contactPointA);vec2.copy(eq.contactPointB,c.contactPointB);vec2.rotate90cw(eq.t,c.normalA);eq.contactEquations.push(c);return eq};Narrowphase.prototype.createFrictionFromAverage=function(numContacts){var c=this.contactEquations[this.contactEquations.length-1];var eq=this.createFrictionEquation(c.bodyA,c.bodyB,c.shapeA,c.shapeB);var bodyA=c.bodyA;var bodyB=c.bodyB;vec2.set(eq.contactPointA,0,0);vec2.set(eq.contactPointB,0,0);vec2.set(eq.t,0,0);for(var i=0;i!==numContacts;i++){c=this.contactEquations[this.contactEquations.length-1-i];if(c.bodyA===bodyA){vec2.add(eq.t,eq.t,c.normalA);vec2.add(eq.contactPointA,eq.contactPointA,c.contactPointA);vec2.add(eq.contactPointB,eq.contactPointB,c.contactPointB)}else{vec2.sub(eq.t,eq.t,c.normalA);vec2.add(eq.contactPointA,eq.contactPointA,c.contactPointB);vec2.add(eq.contactPointB,eq.contactPointB,c.contactPointA)}eq.contactEquations.push(c)}var invNumContacts=1/numContacts;vec2.scale(eq.contactPointA,eq.contactPointA,invNumContacts);vec2.scale(eq.contactPointB,eq.contactPointB,invNumContacts);vec2.normalize(eq.t,eq.t);vec2.rotate90cw(eq.t,eq.t);return eq};Narrowphase.prototype[Shape.LINE|Shape.CONVEX]=Narrowphase.prototype.convexLine=function(convexBody,convexShape,convexOffset,convexAngle,lineBody,lineShape,lineOffset,lineAngle,justTest){if(justTest){return false}else{return 0}};Narrowphase.prototype[Shape.LINE|Shape.BOX]=Narrowphase.prototype.lineBox=function(lineBody,lineShape,lineOffset,lineAngle,boxBody,boxShape,boxOffset,boxAngle,justTest){if(justTest){return false}else{return 0}};function setConvexToCapsuleShapeMiddle(convexShape,capsuleShape){vec2.set(convexShape.vertices[0],-capsuleShape.length*0.5,-capsuleShape.radius);vec2.set(convexShape.vertices[1],capsuleShape.length*0.5,-capsuleShape.radius);vec2.set(convexShape.vertices[2],capsuleShape.length*0.5,capsuleShape.radius);vec2.set(convexShape.vertices[3],-capsuleShape.length*0.5,capsuleShape.radius)}var convexCapsule_tempRect=new Box({width:1,height:1}),convexCapsule_tempVec=vec2.create();Narrowphase.prototype[Shape.CAPSULE|Shape.CONVEX]=Narrowphase.prototype[Shape.CAPSULE|Shape.BOX]=Narrowphase.prototype.convexCapsule=function(convexBody,convexShape,convexPosition,convexAngle,capsuleBody,capsuleShape,capsulePosition,capsuleAngle,justTest){var circlePos=convexCapsule_tempVec;vec2.set(circlePos,capsuleShape.length/2,0);vec2.rotate(circlePos,circlePos,capsuleAngle);vec2.add(circlePos,circlePos,capsulePosition);var result1=this.circleConvex(capsuleBody,capsuleShape,circlePos,capsuleAngle,convexBody,convexShape,convexPosition,convexAngle,justTest,capsuleShape.radius);vec2.set(circlePos,-capsuleShape.length/2,0);vec2.rotate(circlePos,circlePos,capsuleAngle);vec2.add(circlePos,circlePos,capsulePosition);var result2=this.circleConvex(capsuleBody,capsuleShape,circlePos,capsuleAngle,convexBody,convexShape,convexPosition,convexAngle,justTest,capsuleShape.radius);if(justTest&&(result1||result2)){return true}var r=convexCapsule_tempRect;setConvexToCapsuleShapeMiddle(r,capsuleShape);var result=this.convexConvex(convexBody,convexShape,convexPosition,convexAngle,capsuleBody,r,capsulePosition,capsuleAngle,justTest);return result+result1+result2};Narrowphase.prototype[Shape.CAPSULE|Shape.LINE]=Narrowphase.prototype.lineCapsule=function(lineBody,lineShape,linePosition,lineAngle,capsuleBody,capsuleShape,capsulePosition,capsuleAngle,justTest){if(justTest){return false}else{return 0}};var capsuleCapsule_tempVec1=vec2.create();var capsuleCapsule_tempVec2=vec2.create();var capsuleCapsule_tempRect1=new Box({width:1,height:1});Narrowphase.prototype[Shape.CAPSULE|Shape.CAPSULE]=Narrowphase.prototype.capsuleCapsule=function(bi,si,xi,ai,bj,sj,xj,aj,justTest){var enableFrictionBefore;var circlePosi=capsuleCapsule_tempVec1,circlePosj=capsuleCapsule_tempVec2;var numContacts=0;for(var i=0;i<2;i++){vec2.set(circlePosi,(i===0?-1:1)*si.length/2,0);vec2.rotate(circlePosi,circlePosi,ai);vec2.add(circlePosi,circlePosi,xi);for(var j=0;j<2;j++){vec2.set(circlePosj,(j===0?-1:1)*sj.length/2,0);vec2.rotate(circlePosj,circlePosj,aj);vec2.add(circlePosj,circlePosj,xj);if(this.enableFrictionReduction){enableFrictionBefore=this.enableFriction;this.enableFriction=false}var result=this.circleCircle(bi,si,circlePosi,ai,bj,sj,circlePosj,aj,justTest,si.radius,sj.radius);if(this.enableFrictionReduction){this.enableFriction=enableFrictionBefore}if(justTest&&result){return true}numContacts+=result}}if(this.enableFrictionReduction){enableFrictionBefore=this.enableFriction;this.enableFriction=false}var rect=capsuleCapsule_tempRect1;setConvexToCapsuleShapeMiddle(rect,si);var result1=this.convexCapsule(bi,rect,xi,ai,bj,sj,xj,aj,justTest);if(this.enableFrictionReduction){this.enableFriction=enableFrictionBefore}if(justTest&&result1){return true}numContacts+=result1;if(this.enableFrictionReduction){var enableFrictionBefore=this.enableFriction;this.enableFriction=false}setConvexToCapsuleShapeMiddle(rect,sj);var result2=this.convexCapsule(bj,rect,xj,aj,bi,si,xi,ai,justTest);if(this.enableFrictionReduction){this.enableFriction=enableFrictionBefore}if(justTest&&result2){return true}numContacts+=result2;if(this.enableFrictionReduction){if(numContacts&&this.enableFriction){this.frictionEquations.push(this.createFrictionFromAverage(numContacts))}}return numContacts};Narrowphase.prototype[Shape.LINE|Shape.LINE]=Narrowphase.prototype.lineLine=function(bodyA,shapeA,positionA,angleA,bodyB,shapeB,positionB,angleB,justTest){if(justTest){return false}else{return 0}};Narrowphase.prototype[Shape.PLANE|Shape.LINE]=Narrowphase.prototype.planeLine=function(planeBody,planeShape,planeOffset,planeAngle,lineBody,lineShape,lineOffset,lineAngle,justTest){var worldVertex0=tmp1,worldVertex1=tmp2,worldVertex01=tmp3,worldVertex11=tmp4,worldEdge=tmp5,worldEdgeUnit=tmp6,dist=tmp7,worldNormal=tmp8,worldTangent=tmp9,verts=tmpArray,numContacts=0;vec2.set(worldVertex0,-lineShape.length/2,0);vec2.set(worldVertex1,lineShape.length/2,0);vec2.rotate(worldVertex01,worldVertex0,lineAngle);vec2.rotate(worldVertex11,worldVertex1,lineAngle);add(worldVertex01,worldVertex01,lineOffset);add(worldVertex11,worldVertex11,lineOffset);vec2.copy(worldVertex0,worldVertex01);vec2.copy(worldVertex1,worldVertex11);sub(worldEdge,worldVertex1,worldVertex0);vec2.normalize(worldEdgeUnit,worldEdge);vec2.rotate90cw(worldTangent,worldEdgeUnit);vec2.rotate(worldNormal,yAxis,planeAngle);verts[0]=worldVertex0;verts[1]=worldVertex1;for(var i=0;i<verts.length;i++){var v=verts[i];sub(dist,v,planeOffset);var d=dot(dist,worldNormal);if(d<0){if(justTest){return true}var c=this.createContactEquation(planeBody,lineBody,planeShape,lineShape);numContacts++;vec2.copy(c.normalA,worldNormal);vec2.normalize(c.normalA,c.normalA);vec2.scale(dist,worldNormal,d);sub(c.contactPointA,v,dist);sub(c.contactPointA,c.contactPointA,planeBody.position);sub(c.contactPointB,v,lineOffset);add(c.contactPointB,c.contactPointB,lineOffset);sub(c.contactPointB,c.contactPointB,lineBody.position);this.contactEquations.push(c);if(!this.enableFrictionReduction){if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}}}}if(justTest){return false}if(!this.enableFrictionReduction){if(numContacts&&this.enableFriction){this.frictionEquations.push(this.createFrictionFromAverage(numContacts))}}return numContacts};Narrowphase.prototype[Shape.PARTICLE|Shape.CAPSULE]=Narrowphase.prototype.particleCapsule=function(particleBody,particleShape,particlePosition,particleAngle,capsuleBody,capsuleShape,capsulePosition,capsuleAngle,justTest){return this.circleLine(particleBody,particleShape,particlePosition,particleAngle,capsuleBody,capsuleShape,capsulePosition,capsuleAngle,justTest,capsuleShape.radius,0)};Narrowphase.prototype[Shape.CIRCLE|Shape.LINE]=Narrowphase.prototype.circleLine=function(circleBody,circleShape,circleOffset,circleAngle,lineBody,lineShape,lineOffset,lineAngle,justTest,lineRadius,circleRadius){var lineRadius=lineRadius||0,circleRadius=typeof(circleRadius)!=='undefined'?circleRadius:circleShape.radius,orthoDist=tmp1,lineToCircleOrthoUnit=tmp2,projectedPoint=tmp3,centerDist=tmp4,worldTangent=tmp5,worldEdge=tmp6,worldEdgeUnit=tmp7,worldVertex0=tmp8,worldVertex1=tmp9,worldVertex01=tmp10,worldVertex11=tmp11,dist=tmp12,lineToCircle=tmp13,lineEndToLineRadius=tmp14,verts=tmpArray;vec2.set(worldVertex0,-lineShape.length/2,0);vec2.set(worldVertex1,lineShape.length/2,0);vec2.rotate(worldVertex01,worldVertex0,lineAngle);vec2.rotate(worldVertex11,worldVertex1,lineAngle);add(worldVertex01,worldVertex01,lineOffset);add(worldVertex11,worldVertex11,lineOffset);vec2.copy(worldVertex0,worldVertex01);vec2.copy(worldVertex1,worldVertex11);sub(worldEdge,worldVertex1,worldVertex0);vec2.normalize(worldEdgeUnit,worldEdge);vec2.rotate90cw(worldTangent,worldEdgeUnit);sub(dist,circleOffset,worldVertex0);var d=dot(dist,worldTangent);sub(centerDist,worldVertex0,lineOffset);sub(lineToCircle,circleOffset,lineOffset);var radiusSum=circleRadius+lineRadius;if(Math.abs(d)<radiusSum){vec2.scale(orthoDist,worldTangent,d);sub(projectedPoint,circleOffset,orthoDist);vec2.scale(lineToCircleOrthoUnit,worldTangent,dot(worldTangent,lineToCircle));vec2.normalize(lineToCircleOrthoUnit,lineToCircleOrthoUnit);vec2.scale(lineToCircleOrthoUnit,lineToCircleOrthoUnit,lineRadius);add(projectedPoint,projectedPoint,lineToCircleOrthoUnit);var pos=dot(worldEdgeUnit,projectedPoint);var pos0=dot(worldEdgeUnit,worldVertex0);var pos1=dot(worldEdgeUnit,worldVertex1);if(pos>pos0&&pos<pos1){if(justTest){return true}var c=this.createContactEquation(circleBody,lineBody,circleShape,lineShape);vec2.scale(c.normalA,orthoDist,-1);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointA,c.normalA,circleRadius);add(c.contactPointA,c.contactPointA,circleOffset);sub(c.contactPointA,c.contactPointA,circleBody.position);sub(c.contactPointB,projectedPoint,lineOffset);add(c.contactPointB,c.contactPointB,lineOffset);sub(c.contactPointB,c.contactPointB,lineBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1}}verts[0]=worldVertex0;verts[1]=worldVertex1;for(var i=0;i<verts.length;i++){var v=verts[i];sub(dist,v,circleOffset);if(vec2.squaredLength(dist)<Math.pow(radiusSum,2)){if(justTest){return true}var c=this.createContactEquation(circleBody,lineBody,circleShape,lineShape);vec2.copy(c.normalA,dist);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointA,c.normalA,circleRadius);add(c.contactPointA,c.contactPointA,circleOffset);sub(c.contactPointA,c.contactPointA,circleBody.position);sub(c.contactPointB,v,lineOffset);vec2.scale(lineEndToLineRadius,c.normalA,-lineRadius);add(c.contactPointB,c.contactPointB,lineEndToLineRadius);add(c.contactPointB,c.contactPointB,lineOffset);sub(c.contactPointB,c.contactPointB,lineBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1}}return 0};Narrowphase.prototype[Shape.CIRCLE|Shape.CAPSULE]=Narrowphase.prototype.circleCapsule=function(bi,si,xi,ai,bj,sj,xj,aj,justTest){return this.circleLine(bi,si,xi,ai,bj,sj,xj,aj,justTest,sj.radius)};Narrowphase.prototype[Shape.CIRCLE|Shape.CONVEX]=Narrowphase.prototype[Shape.CIRCLE|Shape.BOX]=Narrowphase.prototype.circleConvex=function(circleBody,circleShape,circleOffset,circleAngle,convexBody,convexShape,convexOffset,convexAngle,justTest,circleRadius){var circleRadius=typeof(circleRadius)==='number'?circleRadius:circleShape.radius;var worldVertex0=tmp1,worldVertex1=tmp2,worldEdge=tmp3,worldEdgeUnit=tmp4,worldNormal=tmp5,centerDist=tmp6,convexToCircle=tmp7,orthoDist=tmp8,projectedPoint=tmp9,dist=tmp10,worldVertex=tmp11,closestEdge=-1,closestEdgeDistance=null,closestEdgeOrthoDist=tmp12,closestEdgeProjectedPoint=tmp13,candidate=tmp14,candidateDist=tmp15,minCandidate=tmp16,found=false,minCandidateDistance=Number.MAX_VALUE;var numReported=0;var verts=convexShape.vertices;for(var i=0;i!==verts.length+1;i++){var v0=verts[i%verts.length],v1=verts[(i+1)%verts.length];vec2.rotate(worldVertex0,v0,convexAngle);vec2.rotate(worldVertex1,v1,convexAngle);add(worldVertex0,worldVertex0,convexOffset);add(worldVertex1,worldVertex1,convexOffset);sub(worldEdge,worldVertex1,worldVertex0);vec2.normalize(worldEdgeUnit,worldEdge);vec2.rotate90cw(worldNormal,worldEdgeUnit);vec2.scale(candidate,worldNormal,-circleShape.radius);add(candidate,candidate,circleOffset);if(pointInConvex(candidate,convexShape,convexOffset,convexAngle)){vec2.sub(candidateDist,worldVertex0,candidate);var candidateDistance=Math.abs(vec2.dot(candidateDist,worldNormal));if(candidateDistance<minCandidateDistance){vec2.copy(minCandidate,candidate);minCandidateDistance=candidateDistance;vec2.scale(closestEdgeProjectedPoint,worldNormal,candidateDistance);vec2.add(closestEdgeProjectedPoint,closestEdgeProjectedPoint,candidate);found=true}}}if(found){if(justTest){return true}var c=this.createContactEquation(circleBody,convexBody,circleShape,convexShape);vec2.sub(c.normalA,minCandidate,circleOffset);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointA,c.normalA,circleRadius);add(c.contactPointA,c.contactPointA,circleOffset);sub(c.contactPointA,c.contactPointA,circleBody.position);sub(c.contactPointB,closestEdgeProjectedPoint,convexOffset);add(c.contactPointB,c.contactPointB,convexOffset);sub(c.contactPointB,c.contactPointB,convexBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1}if(circleRadius>0){for(var i=0;i<verts.length;i++){var localVertex=verts[i];vec2.rotate(worldVertex,localVertex,convexAngle);add(worldVertex,worldVertex,convexOffset);sub(dist,worldVertex,circleOffset);if(vec2.squaredLength(dist)<Math.pow(circleRadius,2)){if(justTest){return true}var c=this.createContactEquation(circleBody,convexBody,circleShape,convexShape);vec2.copy(c.normalA,dist);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointA,c.normalA,circleRadius);add(c.contactPointA,c.contactPointA,circleOffset);sub(c.contactPointA,c.contactPointA,circleBody.position);sub(c.contactPointB,worldVertex,convexOffset);add(c.contactPointB,c.contactPointB,convexOffset);sub(c.contactPointB,c.contactPointB,convexBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1}}}return 0};var pic_worldVertex0=vec2.create(),pic_worldVertex1=vec2.create(),pic_r0=vec2.create(),pic_r1=vec2.create();function pointInConvex(worldPoint,convexShape,convexOffset,convexAngle){var worldVertex0=pic_worldVertex0,worldVertex1=pic_worldVertex1,r0=pic_r0,r1=pic_r1,point=worldPoint,verts=convexShape.vertices,lastCross=null;for(var i=0;i!==verts.length+1;i++){var v0=verts[i%verts.length],v1=verts[(i+1)%verts.length];vec2.rotate(worldVertex0,v0,convexAngle);vec2.rotate(worldVertex1,v1,convexAngle);add(worldVertex0,worldVertex0,convexOffset);add(worldVertex1,worldVertex1,convexOffset);sub(r0,worldVertex0,point);sub(r1,worldVertex1,point);var cross=vec2.crossLength(r0,r1);if(lastCross===null){lastCross=cross}if(cross*lastCross<=0){return false}lastCross=cross}return true}Narrowphase.prototype[Shape.PARTICLE|Shape.CONVEX]=Narrowphase.prototype[Shape.PARTICLE|Shape.BOX]=Narrowphase.prototype.particleConvex=function(particleBody,particleShape,particleOffset,particleAngle,convexBody,convexShape,convexOffset,convexAngle,justTest){var worldVertex0=tmp1,worldVertex1=tmp2,worldEdge=tmp3,worldEdgeUnit=tmp4,worldTangent=tmp5,centerDist=tmp6,convexToparticle=tmp7,orthoDist=tmp8,projectedPoint=tmp9,dist=tmp10,worldVertex=tmp11,closestEdge=-1,closestEdgeDistance=null,closestEdgeOrthoDist=tmp12,closestEdgeProjectedPoint=tmp13,r0=tmp14,r1=tmp15,localPoint=tmp16,candidateDist=tmp17,minEdgeNormal=tmp18,minCandidateDistance=Number.MAX_VALUE;var numReported=0,found=false,verts=convexShape.vertices;if(!pointInConvex(particleOffset,convexShape,convexOffset,convexAngle)){return 0}if(justTest){return true}var lastCross=null;for(var i=0;i!==verts.length+1;i++){var v0=verts[i%verts.length],v1=verts[(i+1)%verts.length];vec2.rotate(worldVertex0,v0,convexAngle);vec2.rotate(worldVertex1,v1,convexAngle);add(worldVertex0,worldVertex0,convexOffset);add(worldVertex1,worldVertex1,convexOffset);sub(worldEdge,worldVertex1,worldVertex0);vec2.normalize(worldEdgeUnit,worldEdge);vec2.rotate90cw(worldTangent,worldEdgeUnit);sub(dist,particleOffset,worldVertex0);var d=dot(dist,worldTangent);sub(centerDist,worldVertex0,convexOffset);sub(convexToparticle,particleOffset,convexOffset);vec2.sub(candidateDist,worldVertex0,particleOffset);var candidateDistance=Math.abs(vec2.dot(candidateDist,worldTangent));if(candidateDistance<minCandidateDistance){minCandidateDistance=candidateDistance;vec2.scale(closestEdgeProjectedPoint,worldTangent,candidateDistance);vec2.add(closestEdgeProjectedPoint,closestEdgeProjectedPoint,particleOffset);vec2.copy(minEdgeNormal,worldTangent);found=true}}if(found){var c=this.createContactEquation(particleBody,convexBody,particleShape,convexShape);vec2.scale(c.normalA,minEdgeNormal,-1);vec2.normalize(c.normalA,c.normalA);vec2.set(c.contactPointA,0,0);add(c.contactPointA,c.contactPointA,particleOffset);sub(c.contactPointA,c.contactPointA,particleBody.position);sub(c.contactPointB,closestEdgeProjectedPoint,convexOffset);add(c.contactPointB,c.contactPointB,convexOffset);sub(c.contactPointB,c.contactPointB,convexBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1}return 0};Narrowphase.prototype[Shape.CIRCLE]=Narrowphase.prototype.circleCircle=function(bodyA,shapeA,offsetA,angleA,bodyB,shapeB,offsetB,angleB,justTest,radiusA,radiusB){var dist=tmp1,radiusA=radiusA||shapeA.radius,radiusB=radiusB||shapeB.radius;sub(dist,offsetA,offsetB);var r=radiusA+radiusB;if(vec2.squaredLength(dist)>Math.pow(r,2)){return 0}if(justTest){return true}var c=this.createContactEquation(bodyA,bodyB,shapeA,shapeB);sub(c.normalA,offsetB,offsetA);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointA,c.normalA,radiusA);vec2.scale(c.contactPointB,c.normalA,-radiusB);add(c.contactPointA,c.contactPointA,offsetA);sub(c.contactPointA,c.contactPointA,bodyA.position);add(c.contactPointB,c.contactPointB,offsetB);sub(c.contactPointB,c.contactPointB,bodyB.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1};Narrowphase.prototype[Shape.PLANE|Shape.CONVEX]=Narrowphase.prototype[Shape.PLANE|Shape.BOX]=Narrowphase.prototype.planeConvex=function(planeBody,planeShape,planeOffset,planeAngle,convexBody,convexShape,convexOffset,convexAngle,justTest){var worldVertex=tmp1,worldNormal=tmp2,dist=tmp3;var numReported=0;vec2.rotate(worldNormal,yAxis,planeAngle);for(var i=0;i!==convexShape.vertices.length;i++){var v=convexShape.vertices[i];vec2.rotate(worldVertex,v,convexAngle);add(worldVertex,worldVertex,convexOffset);sub(dist,worldVertex,planeOffset);if(dot(dist,worldNormal)<=0){if(justTest){return true}numReported++;var c=this.createContactEquation(planeBody,convexBody,planeShape,convexShape);sub(dist,worldVertex,planeOffset);vec2.copy(c.normalA,worldNormal);var d=dot(dist,c.normalA);vec2.scale(dist,c.normalA,d);sub(c.contactPointB,worldVertex,convexBody.position);sub(c.contactPointA,worldVertex,dist);sub(c.contactPointA,c.contactPointA,planeBody.position);this.contactEquations.push(c);if(!this.enableFrictionReduction){if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}}}}if(this.enableFrictionReduction){if(this.enableFriction&&numReported){this.frictionEquations.push(this.createFrictionFromAverage(numReported))}}return numReported};Narrowphase.prototype[Shape.PARTICLE|Shape.PLANE]=Narrowphase.prototype.particlePlane=function(particleBody,particleShape,particleOffset,particleAngle,planeBody,planeShape,planeOffset,planeAngle,justTest){var dist=tmp1,worldNormal=tmp2;planeAngle=planeAngle||0;sub(dist,particleOffset,planeOffset);vec2.rotate(worldNormal,yAxis,planeAngle);var d=dot(dist,worldNormal);if(d>0){return 0}if(justTest){return true}var c=this.createContactEquation(planeBody,particleBody,planeShape,particleShape);vec2.copy(c.normalA,worldNormal);vec2.scale(dist,c.normalA,d);sub(c.contactPointA,particleOffset,dist);sub(c.contactPointA,c.contactPointA,planeBody.position);sub(c.contactPointB,particleOffset,particleBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1};Narrowphase.prototype[Shape.CIRCLE|Shape.PARTICLE]=Narrowphase.prototype.circleParticle=function(circleBody,circleShape,circleOffset,circleAngle,particleBody,particleShape,particleOffset,particleAngle,justTest){var dist=tmp1;sub(dist,particleOffset,circleOffset);if(vec2.squaredLength(dist)>Math.pow(circleShape.radius,2)){return 0}if(justTest){return true}var c=this.createContactEquation(circleBody,particleBody,circleShape,particleShape);vec2.copy(c.normalA,dist);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointA,c.normalA,circleShape.radius);add(c.contactPointA,c.contactPointA,circleOffset);sub(c.contactPointA,c.contactPointA,circleBody.position);sub(c.contactPointB,particleOffset,particleBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}return 1};var planeCapsule_tmpCircle=new Circle({radius:1}),planeCapsule_tmp1=vec2.create(),planeCapsule_tmp2=vec2.create(),planeCapsule_tmp3=vec2.create();Narrowphase.prototype[Shape.PLANE|Shape.CAPSULE]=Narrowphase.prototype.planeCapsule=function(planeBody,planeShape,planeOffset,planeAngle,capsuleBody,capsuleShape,capsuleOffset,capsuleAngle,justTest){var end1=planeCapsule_tmp1,end2=planeCapsule_tmp2,circle=planeCapsule_tmpCircle,dst=planeCapsule_tmp3;vec2.set(end1,-capsuleShape.length/2,0);vec2.rotate(end1,end1,capsuleAngle);add(end1,end1,capsuleOffset);vec2.set(end2,capsuleShape.length/2,0);vec2.rotate(end2,end2,capsuleAngle);add(end2,end2,capsuleOffset);circle.radius=capsuleShape.radius;var enableFrictionBefore;if(this.enableFrictionReduction){enableFrictionBefore=this.enableFriction;this.enableFriction=false}var numContacts1=this.circlePlane(capsuleBody,circle,end1,0,planeBody,planeShape,planeOffset,planeAngle,justTest),numContacts2=this.circlePlane(capsuleBody,circle,end2,0,planeBody,planeShape,planeOffset,planeAngle,justTest);if(this.enableFrictionReduction){this.enableFriction=enableFrictionBefore}if(justTest){return numContacts1||numContacts2}else{var numTotal=numContacts1+numContacts2;if(this.enableFrictionReduction){if(numTotal){this.frictionEquations.push(this.createFrictionFromAverage(numTotal))}}return numTotal}};Narrowphase.prototype[Shape.CIRCLE|Shape.PLANE]=Narrowphase.prototype.circlePlane=function(bi,si,xi,ai,bj,sj,xj,aj,justTest){var circleBody=bi,circleShape=si,circleOffset=xi,planeBody=bj,shapeB=sj,planeOffset=xj,planeAngle=aj;planeAngle=planeAngle||0;var planeToCircle=tmp1,worldNormal=tmp2,temp=tmp3;sub(planeToCircle,circleOffset,planeOffset);vec2.rotate(worldNormal,yAxis,planeAngle);var d=dot(worldNormal,planeToCircle);if(d>circleShape.radius){return 0}if(justTest){return true}var contact=this.createContactEquation(planeBody,circleBody,sj,si);vec2.copy(contact.normalA,worldNormal);vec2.scale(contact.contactPointB,contact.normalA,-circleShape.radius);add(contact.contactPointB,contact.contactPointB,circleOffset);sub(contact.contactPointB,contact.contactPointB,circleBody.position);vec2.scale(temp,contact.normalA,d);sub(contact.contactPointA,planeToCircle,temp);add(contact.contactPointA,contact.contactPointA,planeOffset);sub(contact.contactPointA,contact.contactPointA,planeBody.position);this.contactEquations.push(contact);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(contact))}return 1};Narrowphase.prototype[Shape.CONVEX]=Narrowphase.prototype[Shape.CONVEX|Shape.BOX]=Narrowphase.prototype[Shape.BOX]=Narrowphase.prototype.convexConvex=function(bi,si,xi,ai,bj,sj,xj,aj,justTest,precision){var sepAxis=tmp1,worldPoint=tmp2,worldPoint0=tmp3,worldPoint1=tmp4,worldEdge=tmp5,projected=tmp6,penetrationVec=tmp7,dist=tmp8,worldNormal=tmp9,numContacts=0,precision=typeof(precision)==='number'?precision:0;var found=Narrowphase.findSeparatingAxis(si,xi,ai,sj,xj,aj,sepAxis);if(!found){return 0}sub(dist,xj,xi);if(dot(sepAxis,dist)>0){vec2.scale(sepAxis,sepAxis,-1)}var closestEdge1=Narrowphase.getClosestEdge(si,ai,sepAxis,true),closestEdge2=Narrowphase.getClosestEdge(sj,aj,sepAxis);if(closestEdge1===-1||closestEdge2===-1){return 0}for(var k=0;k<2;k++){var closestEdgeA=closestEdge1,closestEdgeB=closestEdge2,shapeA=si,shapeB=sj,offsetA=xi,offsetB=xj,angleA=ai,angleB=aj,bodyA=bi,bodyB=bj;if(k===0){var tmp;tmp=closestEdgeA;closestEdgeA=closestEdgeB;closestEdgeB=tmp;tmp=shapeA;shapeA=shapeB;shapeB=tmp;tmp=offsetA;offsetA=offsetB;offsetB=tmp;tmp=angleA;angleA=angleB;angleB=tmp;tmp=bodyA;bodyA=bodyB;bodyB=tmp}for(var j=closestEdgeB;j<closestEdgeB+2;j++){var v=shapeB.vertices[(j+shapeB.vertices.length)%shapeB.vertices.length];vec2.rotate(worldPoint,v,angleB);add(worldPoint,worldPoint,offsetB);var insideNumEdges=0;for(var i=closestEdgeA-1;i<closestEdgeA+2;i++){var v0=shapeA.vertices[(i+shapeA.vertices.length)%shapeA.vertices.length],v1=shapeA.vertices[(i+1+shapeA.vertices.length)%shapeA.vertices.length];vec2.rotate(worldPoint0,v0,angleA);vec2.rotate(worldPoint1,v1,angleA);add(worldPoint0,worldPoint0,offsetA);add(worldPoint1,worldPoint1,offsetA);sub(worldEdge,worldPoint1,worldPoint0);vec2.rotate90cw(worldNormal,worldEdge);vec2.normalize(worldNormal,worldNormal);sub(dist,worldPoint,worldPoint0);var d=dot(worldNormal,dist);if((i===closestEdgeA&&d<=precision)||(i!==closestEdgeA&&d<=0)){insideNumEdges++}}if(insideNumEdges>=3){if(justTest){return true}var c=this.createContactEquation(bodyA,bodyB,shapeA,shapeB);numContacts++;var v0=shapeA.vertices[(closestEdgeA)%shapeA.vertices.length],v1=shapeA.vertices[(closestEdgeA+1)%shapeA.vertices.length];vec2.rotate(worldPoint0,v0,angleA);vec2.rotate(worldPoint1,v1,angleA);add(worldPoint0,worldPoint0,offsetA);add(worldPoint1,worldPoint1,offsetA);sub(worldEdge,worldPoint1,worldPoint0);vec2.rotate90cw(c.normalA,worldEdge);vec2.normalize(c.normalA,c.normalA);sub(dist,worldPoint,worldPoint0);var d=dot(c.normalA,dist);vec2.scale(penetrationVec,c.normalA,d);sub(c.contactPointA,worldPoint,offsetA);sub(c.contactPointA,c.contactPointA,penetrationVec);add(c.contactPointA,c.contactPointA,offsetA);sub(c.contactPointA,c.contactPointA,bodyA.position);sub(c.contactPointB,worldPoint,offsetB);add(c.contactPointB,c.contactPointB,offsetB);sub(c.contactPointB,c.contactPointB,bodyB.position);this.contactEquations.push(c);if(!this.enableFrictionReduction){if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}}}}}if(this.enableFrictionReduction){if(this.enableFriction&&numContacts){this.frictionEquations.push(this.createFrictionFromAverage(numContacts))}}return numContacts};var pcoa_tmp1=vec2.fromValues(0,0);Narrowphase.projectConvexOntoAxis=function(convexShape,convexOffset,convexAngle,worldAxis,result){var max=null,min=null,v,value,localAxis=pcoa_tmp1;vec2.rotate(localAxis,worldAxis,-convexAngle);for(var i=0;i<convexShape.vertices.length;i++){v=convexShape.vertices[i];value=dot(v,localAxis);if(max===null||value>max){max=value}if(min===null||value<min){min=value}}if(min>max){var t=min;min=max;max=t}var offset=dot(convexOffset,worldAxis);vec2.set(result,min+offset,max+offset)};var fsa_tmp1=vec2.fromValues(0,0),fsa_tmp2=vec2.fromValues(0,0),fsa_tmp3=vec2.fromValues(0,0),fsa_tmp4=vec2.fromValues(0,0),fsa_tmp5=vec2.fromValues(0,0),fsa_tmp6=vec2.fromValues(0,0);Narrowphase.findSeparatingAxis=function(c1,offset1,angle1,c2,offset2,angle2,sepAxis){var maxDist=null,overlap=false,found=false,edge=fsa_tmp1,worldPoint0=fsa_tmp2,worldPoint1=fsa_tmp3,normal=fsa_tmp4,span1=fsa_tmp5,span2=fsa_tmp6;if(c1 instanceof Box&&c2 instanceof Box){for(var j=0;j!==2;j++){var c=c1,angle=angle1;if(j===1){c=c2;angle=angle2}for(var i=0;i!==2;i++){if(i===0){vec2.set(normal,0,1)}else if(i===1){vec2.set(normal,1,0)}if(angle!==0){vec2.rotate(normal,normal,angle)}Narrowphase.projectConvexOntoAxis(c1,offset1,angle1,normal,span1);Narrowphase.projectConvexOntoAxis(c2,offset2,angle2,normal,span2);var a=span1,b=span2,swapped=false;if(span1[0]>span2[0]){b=span1;a=span2;swapped=true}var dist=b[0]-a[1];overlap=(dist<=0);if(maxDist===null||dist>maxDist){vec2.copy(sepAxis,normal);maxDist=dist;found=overlap}}}}else{for(var j=0;j!==2;j++){var c=c1,angle=angle1;if(j===1){c=c2;angle=angle2}for(var i=0;i!==c.vertices.length;i++){vec2.rotate(worldPoint0,c.vertices[i],angle);vec2.rotate(worldPoint1,c.vertices[(i+1)%c.vertices.length],angle);sub(edge,worldPoint1,worldPoint0);vec2.rotate90cw(normal,edge);vec2.normalize(normal,normal);Narrowphase.projectConvexOntoAxis(c1,offset1,angle1,normal,span1);Narrowphase.projectConvexOntoAxis(c2,offset2,angle2,normal,span2);var a=span1,b=span2,swapped=false;if(span1[0]>span2[0]){b=span1;a=span2;swapped=true}var dist=b[0]-a[1];overlap=(dist<=0);if(maxDist===null||dist>maxDist){vec2.copy(sepAxis,normal);maxDist=dist;found=overlap}}}}return found};var gce_tmp1=vec2.fromValues(0,0),gce_tmp2=vec2.fromValues(0,0),gce_tmp3=vec2.fromValues(0,0);Narrowphase.getClosestEdge=function(c,angle,axis,flip){var localAxis=gce_tmp1,edge=gce_tmp2,normal=gce_tmp3;vec2.rotate(localAxis,axis,-angle);if(flip){vec2.scale(localAxis,localAxis,-1)}var closestEdge=-1,N=c.vertices.length,maxDot=-1;for(var i=0;i!==N;i++){sub(edge,c.vertices[(i+1)%N],c.vertices[i%N]);vec2.rotate90cw(normal,edge);vec2.normalize(normal,normal);var d=dot(normal,localAxis);if(closestEdge===-1||d>maxDot){closestEdge=i%N;maxDot=d}}return closestEdge};var circleHeightfield_candidate=vec2.create(),circleHeightfield_dist=vec2.create(),circleHeightfield_v0=vec2.create(),circleHeightfield_v1=vec2.create(),circleHeightfield_minCandidate=vec2.create(),circleHeightfield_worldNormal=vec2.create(),circleHeightfield_minCandidateNormal=vec2.create();Narrowphase.prototype[Shape.CIRCLE|Shape.HEIGHTFIELD]=Narrowphase.prototype.circleHeightfield=function(circleBody,circleShape,circlePos,circleAngle,hfBody,hfShape,hfPos,hfAngle,justTest,radius){var data=hfShape.heights,radius=radius||circleShape.radius,w=hfShape.elementWidth,dist=circleHeightfield_dist,candidate=circleHeightfield_candidate,minCandidate=circleHeightfield_minCandidate,minCandidateNormal=circleHeightfield_minCandidateNormal,worldNormal=circleHeightfield_worldNormal,v0=circleHeightfield_v0,v1=circleHeightfield_v1;var idxA=Math.floor((circlePos[0]-radius-hfPos[0])/w),idxB=Math.ceil((circlePos[0]+radius-hfPos[0])/w);if(idxA<0){idxA=0}if(idxB>=data.length){idxB=data.length-1}var max=data[idxA],min=data[idxB];for(var i=idxA;i<idxB;i++){if(data[i]<min){min=data[i]}if(data[i]>max){max=data[i]}}if(circlePos[1]-radius>max){return justTest?false:0}var found=false;for(var i=idxA;i<idxB;i++){vec2.set(v0,i*w,data[i]);vec2.set(v1,(i+1)*w,data[i+1]);vec2.add(v0,v0,hfPos);vec2.add(v1,v1,hfPos);vec2.sub(worldNormal,v1,v0);vec2.rotate(worldNormal,worldNormal,Math.PI/2);vec2.normalize(worldNormal,worldNormal);vec2.scale(candidate,worldNormal,-radius);vec2.add(candidate,candidate,circlePos);vec2.sub(dist,candidate,v0);var d=vec2.dot(dist,worldNormal);if(candidate[0]>=v0[0]&&candidate[0]<v1[0]&&d<=0){if(justTest){return true}found=true;vec2.scale(dist,worldNormal,-d);vec2.add(minCandidate,candidate,dist);vec2.copy(minCandidateNormal,worldNormal);var c=this.createContactEquation(hfBody,circleBody,hfShape,circleShape);vec2.copy(c.normalA,minCandidateNormal);vec2.scale(c.contactPointB,c.normalA,-radius);add(c.contactPointB,c.contactPointB,circlePos);sub(c.contactPointB,c.contactPointB,circleBody.position);vec2.copy(c.contactPointA,minCandidate);vec2.sub(c.contactPointA,c.contactPointA,hfBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}}}found=false;if(radius>0){for(var i=idxA;i<=idxB;i++){vec2.set(v0,i*w,data[i]);vec2.add(v0,v0,hfPos);vec2.sub(dist,circlePos,v0);if(vec2.squaredLength(dist)<Math.pow(radius,2)){if(justTest){return true}found=true;var c=this.createContactEquation(hfBody,circleBody,hfShape,circleShape);vec2.copy(c.normalA,dist);vec2.normalize(c.normalA,c.normalA);vec2.scale(c.contactPointB,c.normalA,-radius);add(c.contactPointB,c.contactPointB,circlePos);sub(c.contactPointB,c.contactPointB,circleBody.position);sub(c.contactPointA,v0,hfPos);add(c.contactPointA,c.contactPointA,hfPos);sub(c.contactPointA,c.contactPointA,hfBody.position);this.contactEquations.push(c);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(c))}}}}if(found){return 1}return 0};var convexHeightfield_v0=vec2.create(),convexHeightfield_v1=vec2.create(),convexHeightfield_tilePos=vec2.create(),convexHeightfield_tempConvexShape=new Convex({vertices:[vec2.create(),vec2.create(),vec2.create(),vec2.create()]});Narrowphase.prototype[Shape.BOX|Shape.HEIGHTFIELD]=Narrowphase.prototype[Shape.CONVEX|Shape.HEIGHTFIELD]=Narrowphase.prototype.convexHeightfield=function(convexBody,convexShape,convexPos,convexAngle,hfBody,hfShape,hfPos,hfAngle,justTest){var data=hfShape.heights,w=hfShape.elementWidth,v0=convexHeightfield_v0,v1=convexHeightfield_v1,tilePos=convexHeightfield_tilePos,tileConvex=convexHeightfield_tempConvexShape;var idxA=Math.floor((convexBody.aabb.lowerBound[0]-hfPos[0])/w),idxB=Math.ceil((convexBody.aabb.upperBound[0]-hfPos[0])/w);if(idxA<0){idxA=0}if(idxB>=data.length){idxB=data.length-1}var max=data[idxA],min=data[idxB];for(var i=idxA;i<idxB;i++){if(data[i]<min){min=data[i]}if(data[i]>max){max=data[i]}}if(convexBody.aabb.lowerBound[1]>max){return justTest?false:0}var found=false;var numContacts=0;for(var i=idxA;i<idxB;i++){vec2.set(v0,i*w,data[i]);vec2.set(v1,(i+1)*w,data[i+1]);vec2.add(v0,v0,hfPos);vec2.add(v1,v1,hfPos);var tileHeight=100;vec2.set(tilePos,(v1[0]+v0[0])*0.5,(v1[1]+v0[1]-tileHeight)*0.5);vec2.sub(tileConvex.vertices[0],v1,tilePos);vec2.sub(tileConvex.vertices[1],v0,tilePos);vec2.copy(tileConvex.vertices[2],tileConvex.vertices[1]);vec2.copy(tileConvex.vertices[3],tileConvex.vertices[0]);tileConvex.vertices[2][1]-=tileHeight;tileConvex.vertices[3][1]-=tileHeight;numContacts+=this.convexConvex(convexBody,convexShape,convexPos,convexAngle,hfBody,tileConvex,tilePos,0,justTest)}return numContacts}},{'../equations/ContactEquation':21,'../equations/Equation':22,'../equations/FrictionEquation':23,'../math/vec2':30,'../objects/Body':31,'../shapes/Box':37,'../shapes/Circle':39,'../shapes/Convex':40,'../shapes/Shape':45,'../utils/ContactEquationPool':48,'../utils/FrictionEquationPool':49,'../utils/TupleDictionary':56,'../utils/Utils':57}],11:[function(_dereq_,module,exports){module.exports=Ray;var vec2=_dereq_('../math/vec2');var RaycastResult=_dereq_('../collision/RaycastResult');var Shape=_dereq_('../shapes/Shape');var AABB=_dereq_('../collision/AABB');function Ray(options){options=options||{};this.from=options.from?vec2.fromValues(options.from[0],options.from[1]):vec2.create();this.to=options.to?vec2.fromValues(options.to[0],options.to[1]):vec2.create();this.checkCollisionResponse=options.checkCollisionResponse!==undefined?options.checkCollisionResponse:true;this.skipBackfaces=!!options.skipBackfaces;this.collisionMask=options.collisionMask!==undefined?options.collisionMask:-1;this.collisionGroup=options.collisionGroup!==undefined?options.collisionGroup:-1;this.mode=options.mode!==undefined?options.mode:Ray.ANY;this.callback=options.callback||function(result){};this.direction=vec2.create();this.length=1;this.update()}Ray.prototype.constructor=Ray;Ray.CLOSEST=1;Ray.ANY=2;Ray.ALL=4;Ray.prototype.update=function(){var d=this.direction;vec2.sub(d,this.to,this.from);this.length=vec2.length(d);vec2.normalize(d,d)};Ray.prototype.intersectBodies=function(result,bodies){for(var i=0,l=bodies.length;!result.shouldStop(this)&&i<l;i++){var body=bodies[i];var aabb=body.getAABB();if(aabb.overlapsRay(this)>=0||aabb.containsPoint(this.from)){this.intersectBody(result,body)}}};var intersectBody_worldPosition=vec2.create();Ray.prototype.intersectBody=function(result,body){var checkCollisionResponse=this.checkCollisionResponse;if(checkCollisionResponse&&!body.collisionResponse){return}var worldPosition=intersectBody_worldPosition;for(var i=0,N=body.shapes.length;i<N;i++){var shape=body.shapes[i];if(checkCollisionResponse&&!shape.collisionResponse){continue}if((this.collisionGroup&shape.collisionMask)===0||(shape.collisionGroup&this.collisionMask)===0){continue}vec2.rotate(worldPosition,shape.position,body.angle);vec2.add(worldPosition,worldPosition,body.position);var worldAngle=shape.angle+body.angle;this.intersectShape(result,shape,worldAngle,worldPosition,body);if(result.shouldStop(this)){break}}};Ray.prototype.intersectShape=function(result,shape,angle,position,body){var from=this.from;var distance=distanceFromIntersectionSquared(from,this.direction,position);if(distance>shape.boundingRadius*shape.boundingRadius){return}this._currentBody=body;this._currentShape=shape;shape.raycast(result,this,position,angle);this._currentBody=this._currentShape=null};Ray.prototype.getAABB=function(result){var to=this.to;var from=this.from;vec2.set(result.lowerBound,Math.min(to[0],from[0]),Math.min(to[1],from[1]));vec2.set(result.upperBound,Math.max(to[0],from[0]),Math.max(to[1],from[1]))};var hitPointWorld=vec2.create();Ray.prototype.reportIntersection=function(result,fraction,normal,faceIndex){var from=this.from;var to=this.to;var shape=this._currentShape;var body=this._currentBody;if(this.skipBackfaces&&vec2.dot(normal,this.direction)>0){return}switch(this.mode){case Ray.ALL:result.set(normal,shape,body,fraction,faceIndex);this.callback(result);break;case Ray.CLOSEST:if(fraction<result.fraction||!result.hasHit()){result.set(normal,shape,body,fraction,faceIndex)}break;case Ray.ANY:result.set(normal,shape,body,fraction,faceIndex);break}};var v0=vec2.create(),intersect=vec2.create();function distanceFromIntersectionSquared(from,direction,position){vec2.sub(v0,position,from);var dot=vec2.dot(v0,direction);vec2.scale(intersect,direction,dot);vec2.add(intersect,intersect,from);return vec2.squaredDistance(position,intersect)}},{'../collision/AABB':7,'../collision/RaycastResult':12,'../math/vec2':30,'../shapes/Shape':45}],12:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2');var Ray=_dereq_('../collision/Ray');module.exports=RaycastResult;function RaycastResult(){this.normal=vec2.create();this.shape=null;this.body=null;this.faceIndex=-1;this.fraction=-1;this.isStopped=false}RaycastResult.prototype.reset=function(){vec2.set(this.normal,0,0);this.shape=null;this.body=null;this.faceIndex=-1;this.fraction=-1;this.isStopped=false};RaycastResult.prototype.getHitDistance=function(ray){return vec2.distance(ray.from,ray.to)*this.fraction};RaycastResult.prototype.hasHit=function(){return this.fraction!==-1};RaycastResult.prototype.getHitPoint=function(out,ray){vec2.lerp(out,ray.from,ray.to,this.fraction)};RaycastResult.prototype.stop=function(){this.isStopped=true};RaycastResult.prototype.shouldStop=function(ray){return this.isStopped||(this.fraction!==-1&&ray.mode===Ray.ANY)};RaycastResult.prototype.set=function(normal,shape,body,fraction,faceIndex){vec2.copy(this.normal,normal);this.shape=shape;this.body=body;this.fraction=fraction;this.faceIndex=faceIndex}},{'../collision/Ray':11,'../math/vec2':30}],13:[function(_dereq_,module,exports){var Utils=_dereq_('../utils/Utils'),Broadphase=_dereq_('../collision/Broadphase');module.exports=SAPBroadphase;function SAPBroadphase(){Broadphase.call(this,Broadphase.SAP);this.axisList=[];this.axisIndex=0;var that=this;this._addBodyHandler=function(e){that.axisList.push(e.body)};this._removeBodyHandler=function(e){var idx=that.axisList.indexOf(e.body);if(idx!==-1){that.axisList.splice(idx,1)}}}SAPBroadphase.prototype=new Broadphase();SAPBroadphase.prototype.constructor=SAPBroadphase;SAPBroadphase.prototype.setWorld=function(world){this.axisList.length=0;Utils.appendArray(this.axisList,world.bodies);world.off('addBody',this._addBodyHandler).off('removeBody',this._removeBodyHandler);world.on('addBody',this._addBodyHandler).on('removeBody',this._removeBodyHandler);this.world=world};SAPBroadphase.sortAxisList=function(a,axisIndex){axisIndex=axisIndex|0;for(var i=1,l=a.length;i<l;i++){var v=a[i];for(var j=i-1;j>=0;j--){if(a[j].aabb.lowerBound[axisIndex]<=v.aabb.lowerBound[axisIndex]){break}a[j+1]=a[j]}a[j+1]=v}return a};SAPBroadphase.prototype.sortList=function(){var bodies=this.axisList,axisIndex=this.axisIndex;SAPBroadphase.sortAxisList(bodies,axisIndex)};SAPBroadphase.prototype.getCollisionPairs=function(world){var bodies=this.axisList,result=this.result,axisIndex=this.axisIndex;result.length=0;var l=bodies.length;while(l--){var b=bodies[l];if(b.aabbNeedsUpdate){b.updateAABB()}}this.sortList();for(var i=0,N=bodies.length|0;i!==N;i++){var bi=bodies[i];for(var j=i+1;j<N;j++){var bj=bodies[j];var overlaps=(bj.aabb.lowerBound[axisIndex]<=bi.aabb.upperBound[axisIndex]);if(!overlaps){break}if(Broadphase.canCollide(bi,bj)&&this.boundingVolumeCheck(bi,bj)){result.push(bi,bj)}}}return result};SAPBroadphase.prototype.aabbQuery=function(world,aabb,result){result=result||[];this.sortList();var axisIndex=this.axisIndex;var axis='x';if(axisIndex===1){axis='y'}if(axisIndex===2){axis='z'}var axisList=this.axisList;var lower=aabb.lowerBound[axis];var upper=aabb.upperBound[axis];for(var i=0;i<axisList.length;i++){var b=axisList[i];if(b.aabbNeedsUpdate){b.updateAABB()}if(b.aabb.overlaps(aabb)){result.push(b)}}return result}},{'../collision/Broadphase':8,'../utils/Utils':57}],14:[function(_dereq_,module,exports){module.exports=Constraint;var Utils=_dereq_('../utils/Utils');function Constraint(bodyA,bodyB,type,options){this.type=type;options=Utils.defaults(options,{collideConnected:true,wakeUpBodies:true});this.equations=[];this.bodyA=bodyA;this.bodyB=bodyB;this.collideConnected=options.collideConnected;if(options.wakeUpBodies){if(bodyA){bodyA.wakeUp()}if(bodyB){bodyB.wakeUp()}}}Constraint.prototype.update=function(){throw new Error('method update() not implmemented in this Constraint subclass!')};Constraint.DISTANCE=1;Constraint.GEAR=2;Constraint.LOCK=3;Constraint.PRISMATIC=4;Constraint.REVOLUTE=5;Constraint.prototype.setStiffness=function(stiffness){var eqs=this.equations;for(var i=0;i!==eqs.length;i++){var eq=eqs[i];eq.stiffness=stiffness;eq.needsUpdate=true}};Constraint.prototype.setRelaxation=function(relaxation){var eqs=this.equations;for(var i=0;i!==eqs.length;i++){var eq=eqs[i];eq.relaxation=relaxation;eq.needsUpdate=true}}},{'../utils/Utils':57}],15:[function(_dereq_,module,exports){var Constraint=_dereq_('./Constraint'),Equation=_dereq_('../equations/Equation'),vec2=_dereq_('../math/vec2'),Utils=_dereq_('../utils/Utils');module.exports=DistanceConstraint;function DistanceConstraint(bodyA,bodyB,options){options=Utils.defaults(options,{localAnchorA:[0,0],localAnchorB:[0,0]});Constraint.call(this,bodyA,bodyB,Constraint.DISTANCE,options);this.localAnchorA=vec2.fromValues(options.localAnchorA[0],options.localAnchorA[1]);this.localAnchorB=vec2.fromValues(options.localAnchorB[0],options.localAnchorB[1]);var localAnchorA=this.localAnchorA;var localAnchorB=this.localAnchorB;this.distance=0;if(typeof(options.distance)==='number'){this.distance=options.distance}else{var worldAnchorA=vec2.create(),worldAnchorB=vec2.create(),r=vec2.create();vec2.rotate(worldAnchorA,localAnchorA,bodyA.angle);vec2.rotate(worldAnchorB,localAnchorB,bodyB.angle);vec2.add(r,bodyB.position,worldAnchorB);vec2.sub(r,r,worldAnchorA);vec2.sub(r,r,bodyA.position);this.distance=vec2.length(r)}var maxForce;if(typeof(options.maxForce)==='undefined'){maxForce=Number.MAX_VALUE}else{maxForce=options.maxForce}var normal=new Equation(bodyA,bodyB,-maxForce,maxForce);this.equations=[normal];this.maxForce=maxForce;var r=vec2.create();var ri=vec2.create();var rj=vec2.create();var that=this;normal.computeGq=function(){var bodyA=this.bodyA,bodyB=this.bodyB,xi=bodyA.position,xj=bodyB.position;vec2.rotate(ri,localAnchorA,bodyA.angle);vec2.rotate(rj,localAnchorB,bodyB.angle);vec2.add(r,xj,rj);vec2.sub(r,r,ri);vec2.sub(r,r,xi);return vec2.length(r)-that.distance};this.setMaxForce(maxForce);this.upperLimitEnabled=false;this.upperLimit=1;this.lowerLimitEnabled=false;this.lowerLimit=0;this.position=0}DistanceConstraint.prototype=new Constraint();DistanceConstraint.prototype.constructor=DistanceConstraint;var n=vec2.create();var ri=vec2.create();var rj=vec2.create();DistanceConstraint.prototype.update=function(){var normal=this.equations[0],bodyA=this.bodyA,bodyB=this.bodyB,distance=this.distance,xi=bodyA.position,xj=bodyB.position,normalEquation=this.equations[0],G=normal.G;vec2.rotate(ri,this.localAnchorA,bodyA.angle);vec2.rotate(rj,this.localAnchorB,bodyB.angle);vec2.add(n,xj,rj);vec2.sub(n,n,ri);vec2.sub(n,n,xi);this.position=vec2.length(n);var violating=false;if(this.upperLimitEnabled){if(this.position>this.upperLimit){normalEquation.maxForce=0;normalEquation.minForce=-this.maxForce;this.distance=this.upperLimit;violating=true}}if(this.lowerLimitEnabled){if(this.position<this.lowerLimit){normalEquation.maxForce=this.maxForce;normalEquation.minForce=0;this.distance=this.lowerLimit;violating=true}}if((this.lowerLimitEnabled||this.upperLimitEnabled)&&!violating){normalEquation.enabled=false;return}normalEquation.enabled=true;vec2.normalize(n,n);var rixn=vec2.crossLength(ri,n),rjxn=vec2.crossLength(rj,n);G[0]=-n[0];G[1]=-n[1];G[2]=-rixn;G[3]=n[0];G[4]=n[1];G[5]=rjxn};DistanceConstraint.prototype.setMaxForce=function(maxForce){var normal=this.equations[0];normal.minForce=-maxForce;normal.maxForce=maxForce};DistanceConstraint.prototype.getMaxForce=function(){var normal=this.equations[0];return normal.maxForce}},{'../equations/Equation':22,'../math/vec2':30,'../utils/Utils':57,'./Constraint':14}],16:[function(_dereq_,module,exports){var Constraint=_dereq_('./Constraint'),Equation=_dereq_('../equations/Equation'),AngleLockEquation=_dereq_('../equations/AngleLockEquation'),vec2=_dereq_('../math/vec2');module.exports=GearConstraint;function GearConstraint(bodyA,bodyB,options){options=options||{};Constraint.call(this,bodyA,bodyB,Constraint.GEAR,options);this.ratio=options.ratio!==undefined?options.ratio:1;this.angle=options.angle!==undefined?options.angle:bodyB.angle-this.ratio*bodyA.angle;options.angle=this.angle;options.ratio=this.ratio;this.equations=[new AngleLockEquation(bodyA,bodyB,options)];if(options.maxTorque!==undefined){this.setMaxTorque(options.maxTorque)}}GearConstraint.prototype=new Constraint();GearConstraint.prototype.constructor=GearConstraint;GearConstraint.prototype.update=function(){var eq=this.equations[0];if(eq.ratio!==this.ratio){eq.setRatio(this.ratio)}eq.angle=this.angle};GearConstraint.prototype.setMaxTorque=function(torque){this.equations[0].setMaxTorque(torque)};GearConstraint.prototype.getMaxTorque=function(torque){return this.equations[0].maxForce}},{'../equations/AngleLockEquation':20,'../equations/Equation':22,'../math/vec2':30,'./Constraint':14}],17:[function(_dereq_,module,exports){var Constraint=_dereq_('./Constraint'),vec2=_dereq_('../math/vec2'),Equation=_dereq_('../equations/Equation');module.exports=LockConstraint;function LockConstraint(bodyA,bodyB,options){options=options||{};Constraint.call(this,bodyA,bodyB,Constraint.LOCK,options);var maxForce=(typeof(options.maxForce)==='undefined'?Number.MAX_VALUE:options.maxForce);var localAngleB=options.localAngleB||0;var x=new Equation(bodyA,bodyB,-maxForce,maxForce),y=new Equation(bodyA,bodyB,-maxForce,maxForce),rot=new Equation(bodyA,bodyB,-maxForce,maxForce);var l=vec2.create(),g=vec2.create(),that=this;x.computeGq=function(){vec2.rotate(l,that.localOffsetB,bodyA.angle);vec2.sub(g,bodyB.position,bodyA.position);vec2.sub(g,g,l);return g[0]};y.computeGq=function(){vec2.rotate(l,that.localOffsetB,bodyA.angle);vec2.sub(g,bodyB.position,bodyA.position);vec2.sub(g,g,l);return g[1]};var r=vec2.create(),t=vec2.create();rot.computeGq=function(){vec2.rotate(r,that.localOffsetB,bodyB.angle-that.localAngleB);vec2.scale(r,r,-1);vec2.sub(g,bodyA.position,bodyB.position);vec2.add(g,g,r);vec2.rotate(t,r,-Math.PI/2);vec2.normalize(t,t);return vec2.dot(g,t)};this.localOffsetB=vec2.create();if(options.localOffsetB){vec2.copy(this.localOffsetB,options.localOffsetB)}else{vec2.sub(this.localOffsetB,bodyB.position,bodyA.position);vec2.rotate(this.localOffsetB,this.localOffsetB,-bodyA.angle)}this.localAngleB=0;if(typeof(options.localAngleB)==='number'){this.localAngleB=options.localAngleB}else{this.localAngleB=bodyB.angle-bodyA.angle}this.equations.push(x,y,rot);this.setMaxForce(maxForce)}LockConstraint.prototype=new Constraint();LockConstraint.prototype.constructor=LockConstraint;LockConstraint.prototype.setMaxForce=function(force){var eqs=this.equations;for(var i=0;i<this.equations.length;i++){eqs[i].maxForce=force;eqs[i].minForce=-force}};LockConstraint.prototype.getMaxForce=function(){return this.equations[0].maxForce};var l=vec2.create();var r=vec2.create();var t=vec2.create();var xAxis=vec2.fromValues(1,0);var yAxis=vec2.fromValues(0,1);LockConstraint.prototype.update=function(){var x=this.equations[0],y=this.equations[1],rot=this.equations[2],bodyA=this.bodyA,bodyB=this.bodyB;vec2.rotate(l,this.localOffsetB,bodyA.angle);vec2.rotate(r,this.localOffsetB,bodyB.angle-this.localAngleB);vec2.scale(r,r,-1);vec2.rotate(t,r,Math.PI/2);vec2.normalize(t,t);x.G[0]=-1;x.G[1]=0;x.G[2]=-vec2.crossLength(l,xAxis);x.G[3]=1;y.G[0]=0;y.G[1]=-1;y.G[2]=-vec2.crossLength(l,yAxis);y.G[4]=1;rot.G[0]=-t[0];rot.G[1]=-t[1];rot.G[3]=t[0];rot.G[4]=t[1];rot.G[5]=vec2.crossLength(r,t)}},{'../equations/Equation':22,'../math/vec2':30,'./Constraint':14}],18:[function(_dereq_,module,exports){var Constraint=_dereq_('./Constraint'),ContactEquation=_dereq_('../equations/ContactEquation'),Equation=_dereq_('../equations/Equation'),vec2=_dereq_('../math/vec2'),RotationalLockEquation=_dereq_('../equations/RotationalLockEquation');module.exports=PrismaticConstraint;function PrismaticConstraint(bodyA,bodyB,options){options=options||{};Constraint.call(this,bodyA,bodyB,Constraint.PRISMATIC,options);var localAnchorA=vec2.fromValues(0,0),localAxisA=vec2.fromValues(1,0),localAnchorB=vec2.fromValues(0,0);if(options.localAnchorA){vec2.copy(localAnchorA,options.localAnchorA)}if(options.localAxisA){vec2.copy(localAxisA,options.localAxisA)}if(options.localAnchorB){vec2.copy(localAnchorB,options.localAnchorB)}this.localAnchorA=localAnchorA;this.localAnchorB=localAnchorB;this.localAxisA=localAxisA;var maxForce=this.maxForce=typeof(options.maxForce)!=='undefined'?options.maxForce:Number.MAX_VALUE;var trans=new Equation(bodyA,bodyB,-maxForce,maxForce);var ri=new vec2.create(),rj=new vec2.create(),gg=new vec2.create(),t=new vec2.create();trans.computeGq=function(){return vec2.dot(gg,t)};trans.updateJacobian=function(){var G=this.G,xi=bodyA.position,xj=bodyB.position;vec2.rotate(ri,localAnchorA,bodyA.angle);vec2.rotate(rj,localAnchorB,bodyB.angle);vec2.add(gg,xj,rj);vec2.sub(gg,gg,xi);vec2.sub(gg,gg,ri);vec2.rotate(t,localAxisA,bodyA.angle+Math.PI/2);G[0]=-t[0];G[1]=-t[1];G[2]=-vec2.crossLength(ri,t)+vec2.crossLength(t,gg);G[3]=t[0];G[4]=t[1];G[5]=vec2.crossLength(rj,t)};this.equations.push(trans);if(!options.disableRotationalLock){var rot=new RotationalLockEquation(bodyA,bodyB,-maxForce,maxForce);this.equations.push(rot)}this.position=0;this.velocity=0;this.lowerLimitEnabled=typeof(options.lowerLimit)!=='undefined'?true:false;this.upperLimitEnabled=typeof(options.upperLimit)!=='undefined'?true:false;this.lowerLimit=typeof(options.lowerLimit)!=='undefined'?options.lowerLimit:0;this.upperLimit=typeof(options.upperLimit)!=='undefined'?options.upperLimit:1;this.upperLimitEquation=new ContactEquation(bodyA,bodyB);this.lowerLimitEquation=new ContactEquation(bodyA,bodyB);this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0;this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=maxForce;this.motorEquation=new Equation(bodyA,bodyB);this.motorEnabled=false;this.motorSpeed=0;var that=this;var motorEquation=this.motorEquation;var old=motorEquation.computeGW;motorEquation.computeGq=function(){return 0};motorEquation.computeGW=function(){var G=this.G,bi=this.bodyA,bj=this.bodyB,vi=bi.velocity,vj=bj.velocity,wi=bi.angularVelocity,wj=bj.angularVelocity;return this.gmult(G,vi,wi,vj,wj)+that.motorSpeed}}PrismaticConstraint.prototype=new Constraint();PrismaticConstraint.prototype.constructor=PrismaticConstraint;var worldAxisA=vec2.create(),worldAnchorA=vec2.create(),worldAnchorB=vec2.create(),orientedAnchorA=vec2.create(),orientedAnchorB=vec2.create(),tmp=vec2.create();PrismaticConstraint.prototype.update=function(){var eqs=this.equations,trans=eqs[0],upperLimit=this.upperLimit,lowerLimit=this.lowerLimit,upperLimitEquation=this.upperLimitEquation,lowerLimitEquation=this.lowerLimitEquation,bodyA=this.bodyA,bodyB=this.bodyB,localAxisA=this.localAxisA,localAnchorA=this.localAnchorA,localAnchorB=this.localAnchorB;trans.updateJacobian();vec2.rotate(worldAxisA,localAxisA,bodyA.angle);vec2.rotate(orientedAnchorA,localAnchorA,bodyA.angle);vec2.add(worldAnchorA,orientedAnchorA,bodyA.position);vec2.rotate(orientedAnchorB,localAnchorB,bodyB.angle);vec2.add(worldAnchorB,orientedAnchorB,bodyB.position);var relPosition=this.position=vec2.dot(worldAnchorB,worldAxisA)-vec2.dot(worldAnchorA,worldAxisA);if(this.motorEnabled){var G=this.motorEquation.G;G[0]=worldAxisA[0];G[1]=worldAxisA[1];G[2]=vec2.crossLength(worldAxisA,orientedAnchorB);G[3]=-worldAxisA[0];G[4]=-worldAxisA[1];G[5]=-vec2.crossLength(worldAxisA,orientedAnchorA)}if(this.upperLimitEnabled&&relPosition>upperLimit){vec2.scale(upperLimitEquation.normalA,worldAxisA,-1);vec2.sub(upperLimitEquation.contactPointA,worldAnchorA,bodyA.position);vec2.sub(upperLimitEquation.contactPointB,worldAnchorB,bodyB.position);vec2.scale(tmp,worldAxisA,upperLimit);vec2.add(upperLimitEquation.contactPointA,upperLimitEquation.contactPointA,tmp);if(eqs.indexOf(upperLimitEquation)===-1){eqs.push(upperLimitEquation)}}else{var idx=eqs.indexOf(upperLimitEquation);if(idx!==-1){eqs.splice(idx,1)}}if(this.lowerLimitEnabled&&relPosition<lowerLimit){vec2.scale(lowerLimitEquation.normalA,worldAxisA,1);vec2.sub(lowerLimitEquation.contactPointA,worldAnchorA,bodyA.position);vec2.sub(lowerLimitEquation.contactPointB,worldAnchorB,bodyB.position);vec2.scale(tmp,worldAxisA,lowerLimit);vec2.sub(lowerLimitEquation.contactPointB,lowerLimitEquation.contactPointB,tmp);if(eqs.indexOf(lowerLimitEquation)===-1){eqs.push(lowerLimitEquation)}}else{var idx=eqs.indexOf(lowerLimitEquation);if(idx!==-1){eqs.splice(idx,1)}}};PrismaticConstraint.prototype.enableMotor=function(){if(this.motorEnabled){return}this.equations.push(this.motorEquation);this.motorEnabled=true};PrismaticConstraint.prototype.disableMotor=function(){if(!this.motorEnabled){return}var i=this.equations.indexOf(this.motorEquation);this.equations.splice(i,1);this.motorEnabled=false};PrismaticConstraint.prototype.setLimits=function(lower,upper){if(typeof(lower)==='number'){this.lowerLimit=lower;this.lowerLimitEnabled=true}else{this.lowerLimit=lower;this.lowerLimitEnabled=false}if(typeof(upper)==='number'){this.upperLimit=upper;this.upperLimitEnabled=true}else{this.upperLimit=upper;this.upperLimitEnabled=false}}},{'../equations/ContactEquation':21,'../equations/Equation':22,'../equations/RotationalLockEquation':24,'../math/vec2':30,'./Constraint':14}],19:[function(_dereq_,module,exports){var Constraint=_dereq_('./Constraint'),Equation=_dereq_('../equations/Equation'),RotationalVelocityEquation=_dereq_('../equations/RotationalVelocityEquation'),RotationalLockEquation=_dereq_('../equations/RotationalLockEquation'),vec2=_dereq_('../math/vec2');module.exports=RevoluteConstraint;var worldPivotA=vec2.create(),worldPivotB=vec2.create(),xAxis=vec2.fromValues(1,0),yAxis=vec2.fromValues(0,1),g=vec2.create();function RevoluteConstraint(bodyA,bodyB,options){options=options||{};Constraint.call(this,bodyA,bodyB,Constraint.REVOLUTE,options);var maxForce=this.maxForce=typeof(options.maxForce)!=='undefined'?options.maxForce:Number.MAX_VALUE;this.pivotA=vec2.create();this.pivotB=vec2.create();if(options.worldPivot){vec2.sub(this.pivotA,options.worldPivot,bodyA.position);vec2.sub(this.pivotB,options.worldPivot,bodyB.position);vec2.rotate(this.pivotA,this.pivotA,-bodyA.angle);vec2.rotate(this.pivotB,this.pivotB,-bodyB.angle)}else{vec2.copy(this.pivotA,options.localPivotA);vec2.copy(this.pivotB,options.localPivotB)}var eqs=this.equations=[new Equation(bodyA,bodyB,-maxForce,maxForce),new Equation(bodyA,bodyB,-maxForce,maxForce)];var x=eqs[0];var y=eqs[1];var that=this;x.computeGq=function(){vec2.rotate(worldPivotA,that.pivotA,bodyA.angle);vec2.rotate(worldPivotB,that.pivotB,bodyB.angle);vec2.add(g,bodyB.position,worldPivotB);vec2.sub(g,g,bodyA.position);vec2.sub(g,g,worldPivotA);return vec2.dot(g,xAxis)};y.computeGq=function(){vec2.rotate(worldPivotA,that.pivotA,bodyA.angle);vec2.rotate(worldPivotB,that.pivotB,bodyB.angle);vec2.add(g,bodyB.position,worldPivotB);vec2.sub(g,g,bodyA.position);vec2.sub(g,g,worldPivotA);return vec2.dot(g,yAxis)};y.minForce=x.minForce=-maxForce;y.maxForce=x.maxForce=maxForce;this.motorEquation=new RotationalVelocityEquation(bodyA,bodyB);this.motorEnabled=false;this.angle=0;this.lowerLimitEnabled=false;this.upperLimitEnabled=false;this.lowerLimit=0;this.upperLimit=0;this.upperLimitEquation=new RotationalLockEquation(bodyA,bodyB);this.lowerLimitEquation=new RotationalLockEquation(bodyA,bodyB);this.upperLimitEquation.minForce=0;this.lowerLimitEquation.maxForce=0}RevoluteConstraint.prototype=new Constraint();RevoluteConstraint.prototype.constructor=RevoluteConstraint;RevoluteConstraint.prototype.setLimits=function(lower,upper){if(typeof(lower)==='number'){this.lowerLimit=lower;this.lowerLimitEnabled=true}else{this.lowerLimit=lower;this.lowerLimitEnabled=false}if(typeof(upper)==='number'){this.upperLimit=upper;this.upperLimitEnabled=true}else{this.upperLimit=upper;this.upperLimitEnabled=false}};RevoluteConstraint.prototype.update=function(){var bodyA=this.bodyA,bodyB=this.bodyB,pivotA=this.pivotA,pivotB=this.pivotB,eqs=this.equations,normal=eqs[0],tangent=eqs[1],x=eqs[0],y=eqs[1],upperLimit=this.upperLimit,lowerLimit=this.lowerLimit,upperLimitEquation=this.upperLimitEquation,lowerLimitEquation=this.lowerLimitEquation;var relAngle=this.angle=bodyB.angle-bodyA.angle;if(this.upperLimitEnabled&&relAngle>upperLimit){upperLimitEquation.angle=upperLimit;if(eqs.indexOf(upperLimitEquation)===-1){eqs.push(upperLimitEquation)}}else{var idx=eqs.indexOf(upperLimitEquation);if(idx!==-1){eqs.splice(idx,1)}}if(this.lowerLimitEnabled&&relAngle<lowerLimit){lowerLimitEquation.angle=lowerLimit;if(eqs.indexOf(lowerLimitEquation)===-1){eqs.push(lowerLimitEquation)}}else{var idx=eqs.indexOf(lowerLimitEquation);if(idx!==-1){eqs.splice(idx,1)}}vec2.rotate(worldPivotA,pivotA,bodyA.angle);vec2.rotate(worldPivotB,pivotB,bodyB.angle);x.G[0]=-1;x.G[1]=0;x.G[2]=-vec2.crossLength(worldPivotA,xAxis);x.G[3]=1;x.G[4]=0;x.G[5]=vec2.crossLength(worldPivotB,xAxis);y.G[0]=0;y.G[1]=-1;y.G[2]=-vec2.crossLength(worldPivotA,yAxis);y.G[3]=0;y.G[4]=1;y.G[5]=vec2.crossLength(worldPivotB,yAxis)};RevoluteConstraint.prototype.enableMotor=function(){if(this.motorEnabled){return}this.equations.push(this.motorEquation);this.motorEnabled=true};RevoluteConstraint.prototype.disableMotor=function(){if(!this.motorEnabled){return}var i=this.equations.indexOf(this.motorEquation);this.equations.splice(i,1);this.motorEnabled=false};RevoluteConstraint.prototype.setMotorSpeed=function(speed){if(!this.motorEnabled){return}var i=this.equations.indexOf(this.motorEquation);this.equations[i].relativeVelocity=speed};RevoluteConstraint.prototype.getMotorSpeed=function(){if(!this.motorEnabled){return false}return this.motorEquation.relativeVelocity}},{'../equations/Equation':22,'../equations/RotationalLockEquation':24,'../equations/RotationalVelocityEquation':25,'../math/vec2':30,'./Constraint':14}],20:[function(_dereq_,module,exports){var Equation=_dereq_('./Equation'),vec2=_dereq_('../math/vec2');module.exports=AngleLockEquation;function AngleLockEquation(bodyA,bodyB,options){options=options||{};Equation.call(this,bodyA,bodyB,-Number.MAX_VALUE,Number.MAX_VALUE);this.angle=options.angle||0;this.ratio=typeof(options.ratio)==='number'?options.ratio:1;this.setRatio(this.ratio)}AngleLockEquation.prototype=new Equation();AngleLockEquation.prototype.constructor=AngleLockEquation;AngleLockEquation.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle};AngleLockEquation.prototype.setRatio=function(ratio){var G=this.G;G[2]=ratio;G[5]=-1;this.ratio=ratio};AngleLockEquation.prototype.setMaxTorque=function(torque){this.maxForce=torque;this.minForce=-torque}},{'../math/vec2':30,'./Equation':22}],21:[function(_dereq_,module,exports){var Equation=_dereq_('./Equation'),vec2=_dereq_('../math/vec2');module.exports=ContactEquation;function ContactEquation(bodyA,bodyB){Equation.call(this,bodyA,bodyB,0,Number.MAX_VALUE);this.contactPointA=vec2.create();this.penetrationVec=vec2.create();this.contactPointB=vec2.create();this.normalA=vec2.create();this.restitution=0;this.firstImpact=false;this.shapeA=null;this.shapeB=null}ContactEquation.prototype=new Equation();ContactEquation.prototype.constructor=ContactEquation;ContactEquation.prototype.computeB=function(a,b,h){var bi=this.bodyA,bj=this.bodyB,ri=this.contactPointA,rj=this.contactPointB,xi=bi.position,xj=bj.position;var penetrationVec=this.penetrationVec,n=this.normalA,G=this.G;var rixn=vec2.crossLength(ri,n),rjxn=vec2.crossLength(rj,n);G[0]=-n[0];G[1]=-n[1];G[2]=-rixn;G[3]=n[0];G[4]=n[1];G[5]=rjxn;vec2.add(penetrationVec,xj,rj);vec2.sub(penetrationVec,penetrationVec,xi);vec2.sub(penetrationVec,penetrationVec,ri);var GW,Gq;if(this.firstImpact&&this.restitution!==0){Gq=0;GW=(1/b)*(1+this.restitution)*this.computeGW()}else{Gq=vec2.dot(n,penetrationVec)+this.offset;GW=this.computeGW()}var GiMf=this.computeGiMf();var B=-Gq*a-GW*b-h*GiMf;return B};var vi=vec2.create();var vj=vec2.create();var relVel=vec2.create();ContactEquation.prototype.getVelocityAlongNormal=function(){this.bodyA.getVelocityAtPoint(vi,this.contactPointA);this.bodyB.getVelocityAtPoint(vj,this.contactPointB);vec2.subtract(relVel,vi,vj);return vec2.dot(this.normalA,relVel)}},{'../math/vec2':30,'./Equation':22}],22:[function(_dereq_,module,exports){module.exports=Equation;var vec2=_dereq_('../math/vec2'),Utils=_dereq_('../utils/Utils'),Body=_dereq_('../objects/Body');function Equation(bodyA,bodyB,minForce,maxForce){this.minForce=typeof(minForce)==='undefined'?-Number.MAX_VALUE:minForce;this.maxForce=typeof(maxForce)==='undefined'?Number.MAX_VALUE:maxForce;this.bodyA=bodyA;this.bodyB=bodyB;this.stiffness=Equation.DEFAULT_STIFFNESS;this.relaxation=Equation.DEFAULT_RELAXATION;this.G=new Utils.ARRAY_TYPE(6);for(var i=0;i<6;i++){this.G[i]=0}this.offset=0;this.a=0;this.b=0;this.epsilon=0;this.timeStep=1/60;this.needsUpdate=true;this.multiplier=0;this.relativeVelocity=0;this.enabled=true}Equation.prototype.constructor=Equation;Equation.DEFAULT_STIFFNESS=1e6;Equation.DEFAULT_RELAXATION=4;Equation.prototype.update=function(){var k=this.stiffness,d=this.relaxation,h=this.timeStep;this.a=4.0/(h*(1+4*d));this.b=(4.0*d)/(1+4*d);this.epsilon=4.0/(h*h*k*(1+4*d));this.needsUpdate=false};Equation.prototype.gmult=function(G,vi,wi,vj,wj){return G[0]*vi[0]+G[1]*vi[1]+G[2]*wi+G[3]*vj[0]+G[4]*vj[1]+G[5]*wj};Equation.prototype.computeB=function(a,b,h){var GW=this.computeGW();var Gq=this.computeGq();var GiMf=this.computeGiMf();return-Gq*a-GW*b-GiMf*h};var qi=vec2.create(),qj=vec2.create();Equation.prototype.computeGq=function(){var G=this.G,bi=this.bodyA,bj=this.bodyB,xi=bi.position,xj=bj.position,ai=bi.angle,aj=bj.angle;return this.gmult(G,qi,ai,qj,aj)+this.offset};Equation.prototype.computeGW=function(){var G=this.G,bi=this.bodyA,bj=this.bodyB,vi=bi.velocity,vj=bj.velocity,wi=bi.angularVelocity,wj=bj.angularVelocity;return this.gmult(G,vi,wi,vj,wj)+this.relativeVelocity};Equation.prototype.computeGWlambda=function(){var G=this.G,bi=this.bodyA,bj=this.bodyB,vi=bi.vlambda,vj=bj.vlambda,wi=bi.wlambda,wj=bj.wlambda;return this.gmult(G,vi,wi,vj,wj)};var iMfi=vec2.create(),iMfj=vec2.create();Equation.prototype.computeGiMf=function(){var bi=this.bodyA,bj=this.bodyB,fi=bi.force,ti=bi.angularForce,fj=bj.force,tj=bj.angularForce,invMassi=bi.invMassSolve,invMassj=bj.invMassSolve,invIi=bi.invInertiaSolve,invIj=bj.invInertiaSolve,G=this.G;vec2.scale(iMfi,fi,invMassi);vec2.multiply(iMfi,bi.massMultiplier,iMfi);vec2.scale(iMfj,fj,invMassj);vec2.multiply(iMfj,bj.massMultiplier,iMfj);return this.gmult(G,iMfi,ti*invIi,iMfj,tj*invIj)};Equation.prototype.computeGiMGt=function(){var bi=this.bodyA,bj=this.bodyB,invMassi=bi.invMassSolve,invMassj=bj.invMassSolve,invIi=bi.invInertiaSolve,invIj=bj.invInertiaSolve,G=this.G;return G[0]*G[0]*invMassi*bi.massMultiplier[0]+G[1]*G[1]*invMassi*bi.massMultiplier[1]+G[2]*G[2]*invIi+G[3]*G[3]*invMassj*bj.massMultiplier[0]+G[4]*G[4]*invMassj*bj.massMultiplier[1]+G[5]*G[5]*invIj};var addToWlambda_temp=vec2.create(),addToWlambda_Gi=vec2.create(),addToWlambda_Gj=vec2.create(),addToWlambda_ri=vec2.create(),addToWlambda_rj=vec2.create(),addToWlambda_Mdiag=vec2.create();Equation.prototype.addToWlambda=function(deltalambda){var bi=this.bodyA,bj=this.bodyB,temp=addToWlambda_temp,Gi=addToWlambda_Gi,Gj=addToWlambda_Gj,ri=addToWlambda_ri,rj=addToWlambda_rj,invMassi=bi.invMassSolve,invMassj=bj.invMassSolve,invIi=bi.invInertiaSolve,invIj=bj.invInertiaSolve,Mdiag=addToWlambda_Mdiag,G=this.G;Gi[0]=G[0];Gi[1]=G[1];Gj[0]=G[3];Gj[1]=G[4];vec2.scale(temp,Gi,invMassi*deltalambda);vec2.multiply(temp,temp,bi.massMultiplier);vec2.add(bi.vlambda,bi.vlambda,temp);bi.wlambda+=invIi*G[2]*deltalambda;vec2.scale(temp,Gj,invMassj*deltalambda);vec2.multiply(temp,temp,bj.massMultiplier);vec2.add(bj.vlambda,bj.vlambda,temp);bj.wlambda+=invIj*G[5]*deltalambda};Equation.prototype.computeInvC=function(eps){return 1.0/ (this.computeGiMGt() + eps)}},{'../math/vec2': 30,'../objects/Body': 31,'../utils/Utils':57}],23:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),Equation=_dereq_('./Equation'),Utils=_dereq_('../utils/Utils');module.exports=FrictionEquation;function FrictionEquation(bodyA,bodyB,slipForce){Equation.call(this,bodyA,bodyB,-slipForce,slipForce);this.contactPointA=vec2.create();this.contactPointB=vec2.create();this.t=vec2.create();this.contactEquations=[];this.shapeA=null;this.shapeB=null;this.frictionCoefficient=0.3}FrictionEquation.prototype=new Equation();FrictionEquation.prototype.constructor=FrictionEquation;FrictionEquation.prototype.setSlipForce=function(slipForce){this.maxForce=slipForce;this.minForce=-slipForce};FrictionEquation.prototype.getSlipForce=function(){return this.maxForce};FrictionEquation.prototype.computeB=function(a,b,h){var bi=this.bodyA,bj=this.bodyB,ri=this.contactPointA,rj=this.contactPointB,t=this.t,G=this.G;G[0]=-t[0];G[1]=-t[1];G[2]=-vec2.crossLength(ri,t);G[3]=t[0];G[4]=t[1];G[5]=vec2.crossLength(rj,t);var GW=this.computeGW(),GiMf=this.computeGiMf();var B=-GW*b-h*GiMf;return B}},{'../math/vec2':30,'../utils/Utils':57,'./Equation':22}],24:[function(_dereq_,module,exports){var Equation=_dereq_('./Equation'),vec2=_dereq_('../math/vec2');module.exports=RotationalLockEquation;function RotationalLockEquation(bodyA,bodyB,options){options=options||{};Equation.call(this,bodyA,bodyB,-Number.MAX_VALUE,Number.MAX_VALUE);this.angle=options.angle||0;var G=this.G;G[2]=1;G[5]=-1}RotationalLockEquation.prototype=new Equation();RotationalLockEquation.prototype.constructor=RotationalLockEquation;var worldVectorA=vec2.create(),worldVectorB=vec2.create(),xAxis=vec2.fromValues(1,0),yAxis=vec2.fromValues(0,1);RotationalLockEquation.prototype.computeGq=function(){vec2.rotate(worldVectorA,xAxis,this.bodyA.angle+this.angle);vec2.rotate(worldVectorB,yAxis,this.bodyB.angle);return vec2.dot(worldVectorA,worldVectorB)}},{'../math/vec2':30,'./Equation':22}],25:[function(_dereq_,module,exports){var Equation=_dereq_('./Equation'),vec2=_dereq_('../math/vec2');module.exports=RotationalVelocityEquation;function RotationalVelocityEquation(bodyA,bodyB){Equation.call(this,bodyA,bodyB,-Number.MAX_VALUE,Number.MAX_VALUE);this.relativeVelocity=1;this.ratio=1}RotationalVelocityEquation.prototype=new Equation();RotationalVelocityEquation.prototype.constructor=RotationalVelocityEquation;RotationalVelocityEquation.prototype.computeB=function(a,b,h){var G=this.G;G[2]=-1;G[5]=this.ratio;var GiMf=this.computeGiMf();var GW=this.computeGW();var B=-GW*b-h*GiMf;return B}},{'../math/vec2':30,'./Equation':22}],26:[function(_dereq_,module,exports){var EventEmitter=function(){};module.exports=EventEmitter;EventEmitter.prototype={constructor:EventEmitter,on:function(type,listener,context){listener.context=context||this;if(this._listeners===undefined){this._listeners={}}var listeners=this._listeners;if(listeners[type]===undefined){listeners[type]=[]}if(listeners[type].indexOf(listener)===-1){listeners[type].push(listener)}return this},has:function(type,listener){if(this._listeners===undefined){return false}var listeners=this._listeners;if(listener){if(listeners[type]!==undefined&&listeners[type].indexOf(listener)!==-1){return true}}else if(listeners[type]!==undefined){return true}return false},off:function(type,listener){if(this._listeners===undefined){return this}var listeners=this._listeners;var index=listeners[type].indexOf(listener);if(index!==-1){listeners[type].splice(index,1)}return this},emit:function(event){if(this._listeners===undefined){return this}var listeners=this._listeners;var listenerArray=listeners[event.type];if(listenerArray!==undefined){event.target=this;for(var i=0,l=listenerArray.length;i<l;i++){var listener=listenerArray[i];listener.call(listener.context,event)}}return this}}},{}],27:[function(_dereq_,module,exports){var Material=_dereq_('./Material');var Equation=_dereq_('../equations/Equation');module.exports=ContactMaterial;function ContactMaterial(materialA,materialB,options){options=options||{};if(!(materialA instanceof Material)||!(materialB instanceof Material)){throw new Error('First two arguments must be Material instances.')}this.id=ContactMaterial.idCounter++;this.materialA=materialA;this.materialB=materialB;this.friction=typeof(options.friction)!=='undefined'?Number(options.friction):0.3;this.restitution=typeof(options.restitution)!=='undefined'?Number(options.restitution):0;this.stiffness=typeof(options.stiffness)!=='undefined'?Number(options.stiffness):Equation.DEFAULT_STIFFNESS;this.relaxation=typeof(options.relaxation)!=='undefined'?Number(options.relaxation):Equation.DEFAULT_RELAXATION;this.frictionStiffness=typeof(options.frictionStiffness)!=='undefined'?Number(options.frictionStiffness):Equation.DEFAULT_STIFFNESS;this.frictionRelaxation=typeof(options.frictionRelaxation)!=='undefined'?Number(options.frictionRelaxation):Equation.DEFAULT_RELAXATION;this.surfaceVelocity=typeof(options.surfaceVelocity)!=='undefined'?Number(options.surfaceVelocity):0;this.contactSkinSize=0.005}ContactMaterial.idCounter=0},{'../equations/Equation':22,'./Material':28}],28:[function(_dereq_,module,exports){module.exports=Material;function Material(id){this.id=id||Material.idCounter++}Material.idCounter=0},{}],29:[function(_dereq_,module,exports){var PolyK={};PolyK.GetArea=function(p){if(p.length<6){return 0}var l=p.length-2;var sum=0;for(var i=0;i<l;i+=2){sum+=(p[i+2]-p[i])*(p[i+1]+p[i+3])}sum+=(p[0]-p[l])*(p[l+1]+p[1]);return-sum*0.5};PolyK.Triangulate=function(p){var n=p.length>>1;if(n<3){return[]}var tgs=[];var avl=[];for(var i=0;i<n;i++){avl.push(i)}var i=0;var al=n;while(al>3){var i0=avl[(i+0)%al];var i1=avl[(i+1)%al];var i2=avl[(i+2)%al];var ax=p[2*i0],ay=p[2*i0+1];var bx=p[2*i1],by=p[2*i1+1];var cx=p[2*i2],cy=p[2*i2+1];var earFound=false;if(PolyK._convex(ax,ay,bx,by,cx,cy)){earFound=true;for(var j=0;j<al;j++){var vi=avl[j];if(vi==i0||vi==i1||vi==i2){continue}if(PolyK._PointInTriangle(p[2*vi],p[2*vi+1],ax,ay,bx,by,cx,cy)){earFound=false;break}}}if(earFound){tgs.push(i0,i1,i2);avl.splice((i+1)%al,1);al--;i=0}else if(i++>3*al){break}}tgs.push(avl[0],avl[1],avl[2]);return tgs};PolyK._PointInTriangle=function(px,py,ax,ay,bx,by,cx,cy){var v0x=cx-ax;var v0y=cy-ay;var v1x=bx-ax;var v1y=by-ay;var v2x=px-ax;var v2y=py-ay;var dot00=v0x*v0x+v0y*v0y;var dot01=v0x*v1x+v0y*v1y;var dot02=v0x*v2x+v0y*v2y;var dot11=v1x*v1x+v1y*v1y;var dot12=v1x*v2x+v1y*v2y;var invDenom=1/(dot00*dot11-dot01*dot01);var u=(dot11*dot02-dot01*dot12)*invDenom;var v=(dot00*dot12-dot01*dot02)*invDenom;return(u>=0)&&(v>=0)&&(u+v<1)};PolyK._convex=function(ax,ay,bx,by,cx,cy){return(ay-by)*(cx-bx)+(bx-ax)*(cy-by)>=0};module.exports=PolyK},{}],30:[function(_dereq_,module,exports){var vec2=module.exports={};var Utils=_dereq_('../utils/Utils');vec2.crossLength=function(a,b){return a[0]*b[1]-a[1]*b[0]};vec2.crossVZ=function(out,vec,zcomp){vec2.rotate(out,vec,-Math.PI/2); vec2.scale(out,out,zcomp);return out};vec2.crossZV=function(out,zcomp,vec){vec2.rotate(out,vec,Math.PI/2); vec2.scale(out,out,zcomp);return out};vec2.rotate=function(out,a,angle){if(angle!==0){var c=Math.cos(angle),s=Math.sin(angle),x=a[0],y=a[1];out[0]=c*x-s*y;out[1]=s*x+c*y}else{out[0]=a[0];out[1]=a[1]}};vec2.rotate90cw=function(out,a){var x=a[0];var y=a[1];out[0]=y;out[1]=-x};vec2.toLocalFrame=function(out,worldPoint,framePosition,frameAngle){vec2.copy(out,worldPoint);vec2.sub(out,out,framePosition);vec2.rotate(out,out,-frameAngle)};vec2.toGlobalFrame=function(out,localPoint,framePosition,frameAngle){vec2.copy(out,localPoint);vec2.rotate(out,out,frameAngle);vec2.add(out,out,framePosition)};vec2.vectorToLocalFrame=function(out,worldVector,frameAngle){vec2.rotate(out,worldVector,-frameAngle)};vec2.vectorToGlobalFrame=function(out,localVector,frameAngle){vec2.rotate(out,localVector,frameAngle)};vec2.centroid=function(out,a,b,c){vec2.add(out,a,b);vec2.add(out,out,c);vec2.scale(out,out,1/3);return out};vec2.create=function(){var out=new Utils.ARRAY_TYPE(2);out[0]=0;out[1]=0;return out};vec2.clone=function(a){var out=new Utils.ARRAY_TYPE(2);out[0]=a[0];out[1]=a[1];return out};vec2.fromValues=function(x,y){var out=new Utils.ARRAY_TYPE(2);out[0]=x;out[1]=y;return out};vec2.copy=function(out,a){out[0]=a[0];out[1]=a[1];return out};vec2.set=function(out,x,y){out[0]=x;out[1]=y;return out};vec2.add=function(out,a,b){out[0]=a[0]+b[0];out[1]=a[1]+b[1];return out};vec2.subtract=function(out,a,b){out[0]=a[0]-b[0];out[1]=a[1]-b[1];return out};vec2.sub=vec2.subtract;vec2.multiply=function(out,a,b){out[0]=a[0]*b[0];out[1]=a[1]*b[1];return out};vec2.mul=vec2.multiply;vec2.divide=function(out,a,b){out[0]=a[0]/b[0];out[1]=a[1]/b[1];return out};vec2.div=vec2.divide;vec2.scale=function(out,a,b){out[0]=a[0]*b;out[1]=a[1]*b;return out};vec2.distance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1];return Math.sqrt(x*x+y*y)};vec2.dist=vec2.distance;vec2.squaredDistance=function(a,b){var x=b[0]-a[0],y=b[1]-a[1];return x*x+y*y};vec2.sqrDist=vec2.squaredDistance;vec2.length=function(a){var x=a[0],y=a[1];return Math.sqrt(x*x+y*y)};vec2.len=vec2.length;vec2.squaredLength=function(a){var x=a[0],y=a[1];return x*x+y*y};vec2.sqrLen=vec2.squaredLength;vec2.negate=function(out,a){out[0]=-a[0];out[1]=-a[1];return out};vec2.normalize=function(out,a){var x=a[0],y=a[1];var len=x*x+y*y;if(len>0){len=1/Math.sqrt(len);out[0]=a[0]*len;out[1]=a[1]*len}return out};vec2.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};vec2.str=function(a){return'vec2('+a[0]+', '+a[1]+')'};vec2.lerp=function(out,a,b,t){var ax=a[0],ay=a[1];out[0]=ax+t*(b[0]-ax);out[1]=ay+t*(b[1]-ay);return out};vec2.reflect=function(out,vector,normal){var dot=vector[0]*normal[0]+vector[1]*normal[1];out[0]=vector[0]-2*normal[0]*dot;out[1]=vector[1]-2*normal[1]*dot};vec2.getLineSegmentsIntersection=function(out,p0,p1,p2,p3){var t=vec2.getLineSegmentsIntersectionFraction(p0,p1,p2,p3);if(t<0){return false}else{out[0]=p0[0]+(t*(p1[0]-p0[0]));out[1]=p0[1]+(t*(p1[1]-p0[1]));return true}};vec2.getLineSegmentsIntersectionFraction=function(p0,p1,p2,p3){var s1_x=p1[0]-p0[0];var s1_y=p1[1]-p0[1];var s2_x=p3[0]-p2[0];var s2_y=p3[1]-p2[1];var s,t;s=(-s1_y*(p0[0]-p2[0])+s1_x*(p0[1]-p2[1]))/(-s2_x*s1_y+s1_x*s2_y);t=(s2_x*(p0[1]-p2[1])-s2_y*(p0[0]-p2[0]))/(-s2_x*s1_y+s1_x*s2_y);if(s>=0&&s<=1&&t>=0&&t<=1){return t}return-1}},{'../utils/Utils':57}],31:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),decomp=_dereq_('poly-decomp'),Convex=_dereq_('../shapes/Convex'),RaycastResult=_dereq_('../collision/RaycastResult'),Ray=_dereq_('../collision/Ray'),AABB=_dereq_('../collision/AABB'),EventEmitter=_dereq_('../events/EventEmitter');module.exports=Body;function Body(options){options=options||{};EventEmitter.call(this);this.id=options.id||++Body._idCounter;this.world=null;this.shapes=[];this.mass=options.mass||0;this.invMass=0;this.inertia=0;this.invInertia=0;this.invMassSolve=0;this.invInertiaSolve=0;this.fixedRotation=!!options.fixedRotation;this.fixedX=!!options.fixedX;this.fixedY=!!options.fixedY;this.massMultiplier=vec2.create();this.position=vec2.fromValues(0,0);if(options.position){vec2.copy(this.position,options.position)}this.interpolatedPosition=vec2.fromValues(0,0);this.interpolatedAngle=0;this.previousPosition=vec2.fromValues(0,0);this.previousAngle=0;this.velocity=vec2.fromValues(0,0);if(options.velocity){vec2.copy(this.velocity,options.velocity)}this.vlambda=vec2.fromValues(0,0);this.wlambda=0;this.angle=options.angle||0;this.angularVelocity=options.angularVelocity||0;this.force=vec2.create();if(options.force){vec2.copy(this.force,options.force)}this.angularForce=options.angularForce||0;this.damping=typeof(options.damping)==='number'?options.damping:0.1;this.angularDamping=typeof(options.angularDamping)==='number'?options.angularDamping:0.1;this.type=Body.STATIC;if(typeof(options.type)!=='undefined'){this.type=options.type}else if(!options.mass){this.type=Body.STATIC}else{this.type=Body.DYNAMIC}this.boundingRadius=0;this.aabb=new AABB();this.aabbNeedsUpdate=true;this.allowSleep=options.allowSleep!==undefined?options.allowSleep:true;this.wantsToSleep=false;this.sleepState=Body.AWAKE;this.sleepSpeedLimit=options.sleepSpeedLimit!==undefined?options.sleepSpeedLimit:0.2;this.sleepTimeLimit=options.sleepTimeLimit!==undefined?options.sleepTimeLimit:1;this.gravityScale=options.gravityScale!==undefined?options.gravityScale:1;this.collisionResponse=options.collisionResponse!==undefined?options.collisionResponse:true;this.idleTime=0;this.timeLastSleepy=0;this.ccdSpeedThreshold=options.ccdSpeedThreshold!==undefined?options.ccdSpeedThreshold:-1;this.ccdIterations=options.ccdIterations!==undefined?options.ccdIterations:10;this.concavePath=null;this._wakeUpAfterNarrowphase=false;this.updateMassProperties()}Body.prototype=new EventEmitter();Body.prototype.constructor=Body;Body._idCounter=0;Body.prototype.updateSolveMassProperties=function(){if(this.sleepState===Body.SLEEPING||this.type===Body.KINEMATIC){this.invMassSolve=0;this.invInertiaSolve=0}else{this.invMassSolve=this.invMass;this.invInertiaSolve=this.invInertia}};Body.prototype.setDensity=function(density){var totalArea=this.getArea();this.mass=totalArea*density;this.updateMassProperties()};Body.prototype.getArea=function(){var totalArea=0;for(var i=0;i<this.shapes.length;i++){totalArea+=this.shapes[i].area}return totalArea};Body.prototype.getAABB=function(){if(this.aabbNeedsUpdate){this.updateAABB()}return this.aabb};var shapeAABB=new AABB(),tmp=vec2.create();Body.prototype.updateAABB=function(){var shapes=this.shapes,N=shapes.length,offset=tmp,bodyAngle=this.angle;for(var i=0;i!==N;i++){var shape=shapes[i],angle=shape.angle+bodyAngle;vec2.rotate(offset,shape.position,bodyAngle);vec2.add(offset,offset,this.position);shape.computeAABB(shapeAABB,offset,angle);if(i===0){this.aabb.copy(shapeAABB)}else{this.aabb.extend(shapeAABB)}}this.aabbNeedsUpdate=false};Body.prototype.updateBoundingRadius=function(){var shapes=this.shapes,N=shapes.length,radius=0;for(var i=0;i!==N;i++){var shape=shapes[i],offset=vec2.length(shape.position),r=shape.boundingRadius;if(offset+r>radius){radius=offset+r}}this.boundingRadius=radius};Body.prototype.addShape=function(shape,offset,angle){if(shape.body){throw new Error('A shape can only be added to one body.')}shape.body=this;if(offset){vec2.copy(shape.position,offset)}else{vec2.set(shape.position,0,0)}shape.angle=angle||0;this.shapes.push(shape);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=true};Body.prototype.removeShape=function(shape){var idx=this.shapes.indexOf(shape);if(idx!==-1){this.shapes.splice(idx,1);this.aabbNeedsUpdate=true;shape.body=null;return true}else{return false}};Body.prototype.updateMassProperties=function(){if(this.type===Body.STATIC||this.type===Body.KINEMATIC){this.mass=Number.MAX_VALUE;this.invMass=0;this.inertia=Number.MAX_VALUE;this.invInertia=0}else{var shapes=this.shapes,N=shapes.length,m=this.mass/N,I=0;if(!this.fixedRotation){for(var i=0;i<N;i++){var shape=shapes[i],r2=vec2.squaredLength(shape.position),Icm=shape.computeMomentOfInertia(m);I+=Icm+m*r2}this.inertia=I;this.invInertia=I>0?1/I:0}else{this.inertia=Number.MAX_VALUE;this.invInertia=0}this.invMass=1/this.mass;vec2.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}};var Body_applyForce_r=vec2.create();Body.prototype.applyForce=function(force,relativePoint){vec2.add(this.force,this.force,force);if(relativePoint){var rotForce=vec2.crossLength(relativePoint,force);this.angularForce+=rotForce}};var Body_applyForce_forceWorld=vec2.create();var Body_applyForce_pointWorld=vec2.create();var Body_applyForce_pointLocal=vec2.create();Body.prototype.applyForceLocal=function(localForce,localPoint){localPoint=localPoint||Body_applyForce_pointLocal;var worldForce=Body_applyForce_forceWorld;var worldPoint=Body_applyForce_pointWorld;this.vectorToWorldFrame(worldForce,localForce);this.vectorToWorldFrame(worldPoint,localPoint);this.applyForce(worldForce,worldPoint)};var Body_applyImpulse_velo=vec2.create();Body.prototype.applyImpulse=function(impulseVector,relativePoint){if(this.type!==Body.DYNAMIC){return}var velo=Body_applyImpulse_velo;vec2.scale(velo,impulseVector,this.invMass);vec2.multiply(velo,this.massMultiplier,velo);vec2.add(this.velocity,velo,this.velocity);if(relativePoint){var rotVelo=vec2.crossLength(relativePoint,impulseVector);rotVelo*=this.invInertia;this.angularVelocity+=rotVelo}};var Body_applyImpulse_impulseWorld=vec2.create();var Body_applyImpulse_pointWorld=vec2.create();var Body_applyImpulse_pointLocal=vec2.create();Body.prototype.applyImpulseLocal=function(localImpulse,localPoint){localPoint=localPoint||Body_applyImpulse_pointLocal;var worldImpulse=Body_applyImpulse_impulseWorld;var worldPoint=Body_applyImpulse_pointWorld;this.vectorToWorldFrame(worldImpulse,localImpulse);this.vectorToWorldFrame(worldPoint,localPoint);this.applyImpulse(worldImpulse,worldPoint)};Body.prototype.toLocalFrame=function(out,worldPoint){vec2.toLocalFrame(out,worldPoint,this.position,this.angle)};Body.prototype.toWorldFrame=function(out,localPoint){vec2.toGlobalFrame(out,localPoint,this.position,this.angle)};Body.prototype.vectorToLocalFrame=function(out,worldVector){vec2.vectorToLocalFrame(out,worldVector,this.angle)};Body.prototype.vectorToWorldFrame=function(out,localVector){vec2.vectorToGlobalFrame(out,localVector,this.angle)};Body.prototype.fromPolygon=function(path,options){options=options||{};for(var i=this.shapes.length;i>=0;--i){this.removeShape(this.shapes[i])}var p=new decomp.Polygon();p.vertices=path;p.makeCCW();if(typeof(options.removeCollinearPoints)==='number'){p.removeCollinearPoints(options.removeCollinearPoints)}if(typeof(options.skipSimpleCheck)==='undefined'){if(!p.isSimple()){return false}}this.concavePath=p.vertices.slice(0);for(var i=0;i<this.concavePath.length;i++){var v=[0,0];vec2.copy(v,this.concavePath[i]);this.concavePath[i]=v}var convexes;if(options.optimalDecomp){convexes=p.decomp()}else{convexes=p.quickDecomp()}var cm=vec2.create();for(var i=0;i!==convexes.length;i++){var c=new Convex({vertices:convexes[i].vertices});for(var j=0;j!==c.vertices.length;j++){var v=c.vertices[j];vec2.sub(v,v,c.centerOfMass)}vec2.scale(cm,c.centerOfMass,1);c.updateTriangles();c.updateCenterOfMass();c.updateBoundingRadius();this.addShape(c,cm)}this.adjustCenterOfMass();this.aabbNeedsUpdate=true;return true};var adjustCenterOfMass_tmp1=vec2.fromValues(0,0),adjustCenterOfMass_tmp2=vec2.fromValues(0,0),adjustCenterOfMass_tmp3=vec2.fromValues(0,0),adjustCenterOfMass_tmp4=vec2.fromValues(0,0);Body.prototype.adjustCenterOfMass=function(){var offset_times_area=adjustCenterOfMass_tmp2,sum=adjustCenterOfMass_tmp3,cm=adjustCenterOfMass_tmp4,totalArea=0;vec2.set(sum,0,0);for(var i=0;i!==this.shapes.length;i++){var s=this.shapes[i];vec2.scale(offset_times_area,s.position,s.area);vec2.add(sum,sum,offset_times_area);totalArea+=s.area}vec2.scale(cm,sum,1/totalArea);for(var i=0;i!==this.shapes.length;i++){var s=this.shapes[i];vec2.sub(s.position,s.position,cm)}vec2.add(this.position,this.position,cm);for(var i=0;this.concavePath&&i<this.concavePath.length;i++){vec2.sub(this.concavePath[i],this.concavePath[i],cm)}this.updateMassProperties();this.updateBoundingRadius()};Body.prototype.setZeroForce=function(){vec2.set(this.force,0.0,0.0);this.angularForce=0.0};Body.prototype.resetConstraintVelocity=function(){var b=this,vlambda=b.vlambda;vec2.set(vlambda,0,0);b.wlambda=0};Body.prototype.addConstraintVelocity=function(){var b=this,v=b.velocity;vec2.add(v,v,b.vlambda);b.angularVelocity+=b.wlambda};Body.prototype.applyDamping=function(dt){if(this.type===Body.DYNAMIC){var v=this.velocity;vec2.scale(v,v,Math.pow(1.0-this.damping,dt));this.angularVelocity*=Math.pow(1.0-this.angularDamping,dt)}};Body.prototype.wakeUp=function(){var s=this.sleepState;this.sleepState=Body.AWAKE;this.idleTime=0;if(s!==Body.AWAKE){this.emit(Body.wakeUpEvent)}};Body.prototype.sleep=function(){this.sleepState=Body.SLEEPING;this.angularVelocity=0;this.angularForce=0;vec2.set(this.velocity,0,0);vec2.set(this.force,0,0);this.emit(Body.sleepEvent)};Body.prototype.sleepTick=function(time,dontSleep,dt){if(!this.allowSleep||this.type===Body.SLEEPING){return}this.wantsToSleep=false;var sleepState=this.sleepState,speedSquared=vec2.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2),speedLimitSquared=Math.pow(this.sleepSpeedLimit,2);if(speedSquared>=speedLimitSquared){this.idleTime=0;this.sleepState=Body.AWAKE}else{this.idleTime+=dt;this.sleepState=Body.SLEEPY}if(this.idleTime>this.sleepTimeLimit){if(!dontSleep){this.sleep()}else{this.wantsToSleep=true}}};Body.prototype.overlaps=function(body){return this.world.overlapKeeper.bodiesAreOverlapping(this,body)};var integrate_fhMinv=vec2.create();var integrate_velodt=vec2.create();Body.prototype.integrate=function(dt){var minv=this.invMass,f=this.force,pos=this.position,velo=this.velocity;vec2.copy(this.previousPosition,this.position);this.previousAngle=this.angle;if(!this.fixedRotation){this.angularVelocity+=this.angularForce*this.invInertia*dt}vec2.scale(integrate_fhMinv,f,dt*minv);vec2.multiply(integrate_fhMinv,this.massMultiplier,integrate_fhMinv);vec2.add(velo,integrate_fhMinv,velo);if(!this.integrateToTimeOfImpact(dt)){vec2.scale(integrate_velodt,velo,dt);vec2.add(pos,pos,integrate_velodt);if(!this.fixedRotation){this.angle+=this.angularVelocity*dt}}this.aabbNeedsUpdate=true};var result=new RaycastResult();var ray=new Ray({mode:Ray.ALL});var direction=vec2.create();var end=vec2.create();var startToEnd=vec2.create();var rememberPosition=vec2.create();Body.prototype.integrateToTimeOfImpact=function(dt){if(this.ccdSpeedThreshold<0||vec2.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2)){return false}vec2.normalize(direction,this.velocity);vec2.scale(end,this.velocity,dt);vec2.add(end,end,this.position);vec2.sub(startToEnd,end,this.position);var startToEndAngle=this.angularVelocity*dt;var len=vec2.length(startToEnd);var timeOfImpact=1;var hit;var that=this;result.reset();ray.callback=function(result){if(result.body===that){return}hit=result.body;result.getHitPoint(end,ray);vec2.sub(startToEnd,end,that.position);timeOfImpact=vec2.length(startToEnd)/len;result.stop()};vec2.copy(ray.from,this.position);vec2.copy(ray.to,end);ray.update();this.world.raycast(result,ray);if(!hit){return false}var rememberAngle=this.angle;vec2.copy(rememberPosition,this.position);var iter=0;var tmin=0;var tmid=0;var tmax=timeOfImpact;while(tmax>=tmin&&iter<this.ccdIterations){iter++;tmid=(tmax-tmin)/2;vec2.scale(integrate_velodt,startToEnd,timeOfImpact);vec2.add(this.position,rememberPosition,integrate_velodt);this.angle=rememberAngle+startToEndAngle*timeOfImpact;this.updateAABB();var overlaps=this.aabb.overlaps(hit.aabb)&&this.world.narrowphase.bodiesOverlap(this,hit);if(overlaps){tmin=tmid}else{tmax=tmid}}timeOfImpact=tmid;vec2.copy(this.position,rememberPosition);this.angle=rememberAngle;vec2.scale(integrate_velodt,startToEnd,timeOfImpact);vec2.add(this.position,this.position,integrate_velodt);if(!this.fixedRotation){this.angle+=startToEndAngle*timeOfImpact}return true};Body.prototype.getVelocityAtPoint=function(result,relativePoint){vec2.crossVZ(result,relativePoint,this.angularVelocity);vec2.subtract(result,this.velocity,result);return result};Body.sleepyEvent={type:'sleepy'};Body.sleepEvent={type:'sleep'};Body.wakeUpEvent={type:'wakeup'};Body.DYNAMIC=1;Body.STATIC=2;Body.KINEMATIC=4;Body.AWAKE=0;Body.SLEEPY=1;Body.SLEEPING=2},{'../collision/AABB':7,'../collision/Ray':11,'../collision/RaycastResult':12,'../events/EventEmitter':26,'../math/vec2':30,'../shapes/Convex':40,'poly-decomp':5}],32:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2');var Spring=_dereq_('./Spring');var Utils=_dereq_('../utils/Utils');module.exports=LinearSpring;function LinearSpring(bodyA,bodyB,options){options=options||{};Spring.call(this,bodyA,bodyB,options);this.localAnchorA=vec2.fromValues(0,0);this.localAnchorB=vec2.fromValues(0,0);if(options.localAnchorA){vec2.copy(this.localAnchorA,options.localAnchorA)}if(options.localAnchorB){vec2.copy(this.localAnchorB,options.localAnchorB)}if(options.worldAnchorA){this.setWorldAnchorA(options.worldAnchorA)}if(options.worldAnchorB){this.setWorldAnchorB(options.worldAnchorB)}var worldAnchorA=vec2.create();var worldAnchorB=vec2.create();this.getWorldAnchorA(worldAnchorA);this.getWorldAnchorB(worldAnchorB);var worldDistance=vec2.distance(worldAnchorA,worldAnchorB);this.restLength=typeof(options.restLength)==='number'?options.restLength:worldDistance}LinearSpring.prototype=new Spring();LinearSpring.prototype.constructor=LinearSpring;LinearSpring.prototype.setWorldAnchorA=function(worldAnchorA){this.bodyA.toLocalFrame(this.localAnchorA,worldAnchorA)};LinearSpring.prototype.setWorldAnchorB=function(worldAnchorB){this.bodyB.toLocalFrame(this.localAnchorB,worldAnchorB)};LinearSpring.prototype.getWorldAnchorA=function(result){this.bodyA.toWorldFrame(result,this.localAnchorA)};LinearSpring.prototype.getWorldAnchorB=function(result){this.bodyB.toWorldFrame(result,this.localAnchorB)};var applyForce_r=vec2.create(),applyForce_r_unit=vec2.create(),applyForce_u=vec2.create(),applyForce_f=vec2.create(),applyForce_worldAnchorA=vec2.create(),applyForce_worldAnchorB=vec2.create(),applyForce_ri=vec2.create(),applyForce_rj=vec2.create(),applyForce_tmp=vec2.create();LinearSpring.prototype.applyForce=function(){var k=this.stiffness,d=this.damping,l=this.restLength,bodyA=this.bodyA,bodyB=this.bodyB,r=applyForce_r,r_unit=applyForce_r_unit,u=applyForce_u,f=applyForce_f,tmp=applyForce_tmp;var worldAnchorA=applyForce_worldAnchorA,worldAnchorB=applyForce_worldAnchorB,ri=applyForce_ri,rj=applyForce_rj;this.getWorldAnchorA(worldAnchorA);this.getWorldAnchorB(worldAnchorB);vec2.sub(ri,worldAnchorA,bodyA.position);vec2.sub(rj,worldAnchorB,bodyB.position);vec2.sub(r,worldAnchorB,worldAnchorA);var rlen=vec2.len(r);vec2.normalize(r_unit,r);vec2.sub(u,bodyB.velocity,bodyA.velocity);vec2.crossZV(tmp,bodyB.angularVelocity,rj);vec2.add(u,u,tmp);vec2.crossZV(tmp,bodyA.angularVelocity,ri);vec2.sub(u,u,tmp);vec2.scale(f,r_unit,-k*(rlen-l)-d*vec2.dot(u,r_unit));vec2.sub(bodyA.force,bodyA.force,f);vec2.add(bodyB.force,bodyB.force,f);var ri_x_f=vec2.crossLength(ri,f);var rj_x_f=vec2.crossLength(rj,f);bodyA.angularForce-=ri_x_f;bodyB.angularForce+=rj_x_f}},{'../math/vec2':30,'../utils/Utils':57,'./Spring':34}],33:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2');var Spring=_dereq_('./Spring');module.exports=RotationalSpring;function RotationalSpring(bodyA,bodyB,options){options=options||{};Spring.call(this,bodyA,bodyB,options);this.restAngle=typeof(options.restAngle)==='number'?options.restAngle:bodyB.angle-bodyA.angle}RotationalSpring.prototype=new Spring();RotationalSpring.prototype.constructor=RotationalSpring;RotationalSpring.prototype.applyForce=function(){var k=this.stiffness,d=this.damping,l=this.restAngle,bodyA=this.bodyA,bodyB=this.bodyB,x=bodyB.angle-bodyA.angle,u=bodyB.angularVelocity-bodyA.angularVelocity;var torque=-k*(x-l)-d*u*0;bodyA.angularForce-=torque;bodyB.angularForce+=torque}},{'../math/vec2':30,'./Spring':34}],34:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2');var Utils=_dereq_('../utils/Utils');module.exports=Spring;function Spring(bodyA,bodyB,options){options=Utils.defaults(options,{stiffness:100,damping:1});this.stiffness=options.stiffness;this.damping=options.damping;this.bodyA=bodyA;this.bodyB=bodyB}Spring.prototype.applyForce=function(){}},{'../math/vec2':30,'../utils/Utils':57}],35:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2');var Utils=_dereq_('../utils/Utils');var Constraint=_dereq_('../constraints/Constraint');var FrictionEquation=_dereq_('../equations/FrictionEquation');var Body=_dereq_('../objects/Body');module.exports=TopDownVehicle;function TopDownVehicle(chassisBody,options){options=options||{};this.chassisBody=chassisBody;this.wheels=[];this.groundBody=new Body({mass:0});this.world=null;var that=this;this.preStepCallback=function(){that.update()}}TopDownVehicle.prototype.addToWorld=function(world){this.world=world;world.addBody(this.groundBody);world.on('preStep',this.preStepCallback);for(var i=0;i<this.wheels.length;i++){var wheel=this.wheels[i];world.addConstraint(wheel)}};TopDownVehicle.prototype.removeFromWorld=function(){var world=this.world;world.removeBody(this.groundBody);world.off('preStep',this.preStepCallback);for(var i=0;i<this.wheels.length;i++){var wheel=this.wheels[i];world.removeConstraint(wheel)}this.world=null};TopDownVehicle.prototype.addWheel=function(wheelOptions){var wheel=new WheelConstraint(this,wheelOptions);this.wheels.push(wheel);return wheel};TopDownVehicle.prototype.update=function(){for(var i=0;i<this.wheels.length;i++){this.wheels[i].update()}};function WheelConstraint(vehicle,options){options=options||{};this.vehicle=vehicle;this.forwardEquation=new FrictionEquation(vehicle.chassisBody,vehicle.groundBody);this.sideEquation=new FrictionEquation(vehicle.chassisBody,vehicle.groundBody);this.steerValue=0;this.engineForce=0;this.setSideFriction(options.sideFriction!==undefined?options.sideFriction:5);this.localForwardVector=vec2.fromValues(0,1);if(options.localForwardVector){vec2.copy(this.localForwardVector,options.localForwardVector)}this.localPosition=vec2.fromValues(0,0);if(options.localPosition){vec2.copy(this.localPosition,options.localPosition)}Constraint.apply(this,vehicle.chassisBody,vehicle.groundBody);this.equations.push(this.forwardEquation,this.sideEquation);this.setBrakeForce(0)}WheelConstraint.prototype=new Constraint();WheelConstraint.prototype.setBrakeForce=function(force){this.forwardEquation.setSlipForce(force)};WheelConstraint.prototype.setSideFriction=function(force){this.sideEquation.setSlipForce(force)};var worldVelocity=vec2.create();var relativePoint=vec2.create();WheelConstraint.prototype.getSpeed=function(){this.vehicle.chassisBody.vectorToWorldFrame(relativePoint,this.localForwardVector);this.vehicle.chassisBody.getVelocityAtPoint(worldVelocity,relativePoint);return vec2.dot(worldVelocity,relativePoint)};var tmpVec=vec2.create();WheelConstraint.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector);vec2.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2);this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t);vec2.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue);vec2.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue);this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition);vec2.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB);this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition);vec2.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA);vec2.normalize(tmpVec,this.forwardEquation.t);vec2.scale(tmpVec,tmpVec,this.engineForce);this.vehicle.chassisBody.applyForce(tmpVec,this.forwardEquation.contactPointA)}},{'../constraints/Constraint':14,'../equations/FrictionEquation':23,'../math/vec2':30,'../objects/Body':31,'../utils/Utils':57}],36:[function(_dereq_,module,exports){var p2=module.exports={AABB:_dereq_('./collision/AABB'),AngleLockEquation:_dereq_('./equations/AngleLockEquation'),Body:_dereq_('./objects/Body'),Broadphase:_dereq_('./collision/Broadphase'),Capsule:_dereq_('./shapes/Capsule'),Circle:_dereq_('./shapes/Circle'),Constraint:_dereq_('./constraints/Constraint'),ContactEquation:_dereq_('./equations/ContactEquation'),ContactEquationPool:_dereq_('./utils/ContactEquationPool'),ContactMaterial:_dereq_('./material/ContactMaterial'),Convex:_dereq_('./shapes/Convex'),DistanceConstraint:_dereq_('./constraints/DistanceConstraint'),Equation:_dereq_('./equations/Equation'),EventEmitter:_dereq_('./events/EventEmitter'),FrictionEquation:_dereq_('./equations/FrictionEquation'),FrictionEquationPool:_dereq_('./utils/FrictionEquationPool'),GearConstraint:_dereq_('./constraints/GearConstraint'),GSSolver:_dereq_('./solver/GSSolver'),Heightfield:_dereq_('./shapes/Heightfield'),Line:_dereq_('./shapes/Line'),LockConstraint:_dereq_('./constraints/LockConstraint'),Material:_dereq_('./material/Material'),Narrowphase:_dereq_('./collision/Narrowphase'),NaiveBroadphase:_dereq_('./collision/NaiveBroadphase'),Particle:_dereq_('./shapes/Particle'),Plane:_dereq_('./shapes/Plane'),Pool:_dereq_('./utils/Pool'),RevoluteConstraint:_dereq_('./constraints/RevoluteConstraint'),PrismaticConstraint:_dereq_('./constraints/PrismaticConstraint'),Ray:_dereq_('./collision/Ray'),RaycastResult:_dereq_('./collision/RaycastResult'),Box:_dereq_('./shapes/Box'),RotationalVelocityEquation:_dereq_('./equations/RotationalVelocityEquation'),SAPBroadphase:_dereq_('./collision/SAPBroadphase'),Shape:_dereq_('./shapes/Shape'),Solver:_dereq_('./solver/Solver'),Spring:_dereq_('./objects/Spring'),TopDownVehicle:_dereq_('./objects/TopDownVehicle'),LinearSpring:_dereq_('./objects/LinearSpring'),RotationalSpring:_dereq_('./objects/RotationalSpring'),Utils:_dereq_('./utils/Utils'),World:_dereq_('./world/World'),vec2:_dereq_('./math/vec2'),version:_dereq_('../package.json').version};Object.defineProperty(p2,'Rectangle',{get:function(){console.warn('The Rectangle class has been renamed to Box.');return this.Box}})},{'../package.json':6,'./collision/AABB':7,'./collision/Broadphase':8,'./collision/NaiveBroadphase':9,'./collision/Narrowphase':10,'./collision/Ray':11,'./collision/RaycastResult':12,'./collision/SAPBroadphase':13,'./constraints/Constraint':14,'./constraints/DistanceConstraint':15,'./constraints/GearConstraint':16,'./constraints/LockConstraint':17,'./constraints/PrismaticConstraint':18,'./constraints/RevoluteConstraint':19,'./equations/AngleLockEquation':20,'./equations/ContactEquation':21,'./equations/Equation':22,'./equations/FrictionEquation':23,'./equations/RotationalVelocityEquation':25,'./events/EventEmitter':26,'./material/ContactMaterial':27,'./material/Material':28,'./math/vec2':30,'./objects/Body':31,'./objects/LinearSpring':32,'./objects/RotationalSpring':33,'./objects/Spring':34,'./objects/TopDownVehicle':35,'./shapes/Box':37,'./shapes/Capsule':38,'./shapes/Circle':39,'./shapes/Convex':40,'./shapes/Heightfield':41,'./shapes/Line':42,'./shapes/Particle':43,'./shapes/Plane':44,'./shapes/Shape':45,'./solver/GSSolver':46,'./solver/Solver':47,'./utils/ContactEquationPool':48,'./utils/FrictionEquationPool':49,'./utils/Pool':55,'./utils/Utils':57,'./world/World':61}],37:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),Shape=_dereq_('./Shape'),Convex=_dereq_('./Convex');module.exports=Box;function Box(options){if(typeof(arguments[0])==='number'&&typeof(arguments[1])==='number'){options={width:arguments[0],height:arguments[1]};console.warn('The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })')}options=options||{};var width=this.width=options.width||1;var height=this.height=options.height||1;var verts=[vec2.fromValues(-width/2,-height/2),vec2.fromValues(width/2,-height/2),vec2.fromValues(width/2,height/2),vec2.fromValues(-width/2,height/2)];var axes=[vec2.fromValues(1,0),vec2.fromValues(0,1)];options.vertices=verts;options.axes=axes;options.type=Shape.BOX;Convex.call(this,options)}Box.prototype=new Convex();Box.prototype.constructor=Box;Box.prototype.computeMomentOfInertia=function(mass){var w=this.width,h=this.height;return mass*(h*h+w*w)/12};Box.prototype.updateBoundingRadius=function(){var w=this.width,h=this.height;this.boundingRadius=Math.sqrt(w*w+h*h)/2};var corner1=vec2.create(),corner2=vec2.create(),corner3=vec2.create(),corner4=vec2.create();Box.prototype.computeAABB=function(out,position,angle){out.setFromPoints(this.vertices,position,angle,0)};Box.prototype.updateArea=function(){this.area=this.width*this.height}},{'../math/vec2':30,'./Convex':40,'./Shape':45}],38:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2');module.exports=Capsule;function Capsule(options){if(typeof(arguments[0])==='number'&&typeof(arguments[1])==='number'){options={length:arguments[0],radius:arguments[1]};console.warn('The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })')}options=options||{};this.length=options.length||1;this.radius=options.radius||1;options.type=Shape.CAPSULE;Shape.call(this,options)}Capsule.prototype=new Shape();Capsule.prototype.constructor=Capsule;Capsule.prototype.computeMomentOfInertia=function(mass){var r=this.radius,w=this.length+r,h=r*2;return mass*(h*h+w*w)/12};Capsule.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2};Capsule.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+this.radius*2*this.length};var r=vec2.create();Capsule.prototype.computeAABB=function(out,position,angle){var radius=this.radius;vec2.set(r,this.length/2,0);if(angle!==0){vec2.rotate(r,r,angle)}vec2.set(out.upperBound,Math.max(r[0]+radius,-r[0]+radius),Math.max(r[1]+radius,-r[1]+radius));vec2.set(out.lowerBound,Math.min(r[0]-radius,-r[0]-radius),Math.min(r[1]-radius,-r[1]-radius));vec2.add(out.lowerBound,out.lowerBound,position);vec2.add(out.upperBound,out.upperBound,position)};var intersectCapsule_hitPointWorld=vec2.create();var intersectCapsule_normal=vec2.create();var intersectCapsule_l0=vec2.create();var intersectCapsule_l1=vec2.create();var intersectCapsule_unit_y=vec2.fromValues(0,1);Capsule.prototype.raycast=function(result,ray,position,angle){var from=ray.from;var to=ray.to;var direction=ray.direction;var hitPointWorld=intersectCapsule_hitPointWorld;var normal=intersectCapsule_normal;var l0=intersectCapsule_l0;var l1=intersectCapsule_l1;var halfLen=this.length/2;for(var i=0;i<2;i++){var y=this.radius*(i*2-1);vec2.set(l0,-halfLen,y);vec2.set(l1,halfLen,y);vec2.toGlobalFrame(l0,l0,position,angle);vec2.toGlobalFrame(l1,l1,position,angle);var delta=vec2.getLineSegmentsIntersectionFraction(from,to,l0,l1);if(delta>=0){vec2.rotate(normal,intersectCapsule_unit_y,angle);vec2.scale(normal,normal,(i*2-1));ray.reportIntersection(result,delta,normal,-1);if(result.shouldStop(ray)){return}}}var diagonalLengthSquared=Math.pow(this.radius,2)+Math.pow(halfLen,2);for(var i=0;i<2;i++){vec2.set(l0,halfLen*(i*2-1),0);vec2.toGlobalFrame(l0,l0,position,angle);var a=Math.pow(to[0]-from[0],2)+Math.pow(to[1]-from[1],2);var b=2*((to[0]-from[0])*(from[0]-l0[0])+(to[1]-from[1])*(from[1]-l0[1]));var c=Math.pow(from[0]-l0[0],2)+Math.pow(from[1]-l0[1],2)-Math.pow(this.radius,2);var delta=Math.pow(b,2)-4*a*c;if(delta<0){continue}else if(delta===0){vec2.lerp(hitPointWorld,from,to,delta);if(vec2.squaredDistance(hitPointWorld,position)>diagonalLengthSquared){vec2.sub(normal,hitPointWorld,l0);vec2.normalize(normal,normal);ray.reportIntersection(result,delta,normal,-1);if(result.shouldStop(ray)){return}}}else{var sqrtDelta=Math.sqrt(delta);var inv2a=1/(2*a);var d1=(-b-sqrtDelta)*inv2a;var d2=(-b+sqrtDelta)*inv2a;if(d1>=0&&d1<=1){vec2.lerp(hitPointWorld,from,to,d1);if(vec2.squaredDistance(hitPointWorld,position)>diagonalLengthSquared){vec2.sub(normal,hitPointWorld,l0);vec2.normalize(normal,normal);ray.reportIntersection(result,d1,normal,-1);if(result.shouldStop(ray)){return}}}if(d2>=0&&d2<=1){vec2.lerp(hitPointWorld,from,to,d2);if(vec2.squaredDistance(hitPointWorld,position)>diagonalLengthSquared){vec2.sub(normal,hitPointWorld,l0);vec2.normalize(normal,normal);ray.reportIntersection(result,d2,normal,-1);if(result.shouldStop(ray)){return}}}}}}},{'../math/vec2':30,'./Shape':45}],39:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2');module.exports=Circle;function Circle(options){if(typeof(arguments[0])==='number'){options={radius:arguments[0]};console.warn('The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })')}options=options||{};this.radius=options.radius||1;options.type=Shape.CIRCLE;Shape.call(this,options)}Circle.prototype=new Shape();Circle.prototype.constructor=Circle;Circle.prototype.computeMomentOfInertia=function(mass){var r=this.radius;return mass*r*r/2};Circle.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius};Circle.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius};Circle.prototype.computeAABB=function(out,position,angle){var r=this.radius;vec2.set(out.upperBound,r,r);vec2.set(out.lowerBound,-r,-r);if(position){vec2.add(out.lowerBound,out.lowerBound,position);vec2.add(out.upperBound,out.upperBound,position)}};var Ray_intersectSphere_intersectionPoint=vec2.create();var Ray_intersectSphere_normal=vec2.create();Circle.prototype.raycast=function(result,ray,position,angle){var from=ray.from,to=ray.to,r=this.radius;var a=Math.pow(to[0]-from[0],2)+Math.pow(to[1]-from[1],2);var b=2*((to[0]-from[0])*(from[0]-position[0])+(to[1]-from[1])*(from[1]-position[1]));var c=Math.pow(from[0]-position[0],2)+Math.pow(from[1]-position[1],2)-Math.pow(r,2);var delta=Math.pow(b,2)-4*a*c;var intersectionPoint=Ray_intersectSphere_intersectionPoint;var normal=Ray_intersectSphere_normal;if(delta<0){return}else if(delta===0){vec2.lerp(intersectionPoint,from,to,delta);vec2.sub(normal,intersectionPoint,position);vec2.normalize(normal,normal);ray.reportIntersection(result,delta,normal,-1)}else{var sqrtDelta=Math.sqrt(delta);var inv2a=1/(2*a);var d1=(-b-sqrtDelta)*inv2a;var d2=(-b+sqrtDelta)*inv2a;if(d1>=0&&d1<=1){vec2.lerp(intersectionPoint,from,to,d1);vec2.sub(normal,intersectionPoint,position);vec2.normalize(normal,normal);ray.reportIntersection(result,d1,normal,-1);if(result.shouldStop(ray)){return}}if(d2>=0&&d2<=1){vec2.lerp(intersectionPoint,from,to,d2);vec2.sub(normal,intersectionPoint,position);vec2.normalize(normal,normal);ray.reportIntersection(result,d2,normal,-1)}}}},{'../math/vec2':30,'./Shape':45}],40:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2'),polyk=_dereq_('../math/polyk'),decomp=_dereq_('poly-decomp');module.exports=Convex;function Convex(options){if(Array.isArray(arguments[0])){options={vertices:arguments[0],axes:arguments[1]};console.warn('The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })')}options=options||{};this.vertices=[];var vertices=options.vertices!==undefined?options.vertices:[];for(var i=0;i<vertices.length;i++){var v=vec2.create();vec2.copy(v,vertices[i]);this.vertices.push(v)}this.axes=[];if(options.axes){for(var i=0;i<options.axes.length;i++){var axis=vec2.create();vec2.copy(axis,options.axes[i]);this.axes.push(axis)}}else{for(var i=0;i<this.vertices.length;i++){var worldPoint0=this.vertices[i];var worldPoint1=this.vertices[(i+1)%this.vertices.length];var normal=vec2.create();vec2.sub(normal,worldPoint1,worldPoint0);vec2.rotate90cw(normal,normal);vec2.normalize(normal,normal);this.axes.push(normal)}}this.centerOfMass=vec2.fromValues(0,0);this.triangles=[];if(this.vertices.length){this.updateTriangles();this.updateCenterOfMass()}this.boundingRadius=0;options.type=Shape.CONVEX;Shape.call(this,options);this.updateBoundingRadius();this.updateArea();if(this.area<0){throw new Error('Convex vertices must be given in conter-clockwise winding.')}}Convex.prototype=new Shape();Convex.prototype.constructor=Convex;var tmpVec1=vec2.create();var tmpVec2=vec2.create();Convex.prototype.projectOntoLocalAxis=function(localAxis,result){var max=null,min=null,v,value,localAxis=tmpVec1;for(var i=0;i<this.vertices.length;i++){v=this.vertices[i];value=vec2.dot(v,localAxis);if(max===null||value>max){max=value}if(min===null||value<min){min=value}}if(min>max){var t=min;min=max;max=t}vec2.set(result,min,max)};Convex.prototype.projectOntoWorldAxis=function(localAxis,shapeOffset,shapeAngle,result){var worldAxis=tmpVec2;this.projectOntoLocalAxis(localAxis,result);if(shapeAngle!==0){vec2.rotate(worldAxis,localAxis,shapeAngle)}else{worldAxis=localAxis}var offset=vec2.dot(shapeOffset,worldAxis);vec2.set(result,result[0]+offset,result[1]+offset)};Convex.prototype.updateTriangles=function(){this.triangles.length=0;var polykVerts=[];for(var i=0;i<this.vertices.length;i++){var v=this.vertices[i];polykVerts.push(v[0],v[1])}var triangles=polyk.Triangulate(polykVerts);for(var i=0;i<triangles.length;i+=3){var id1=triangles[i],id2=triangles[i+1],id3=triangles[i+2];this.triangles.push([id1,id2,id3])}};var updateCenterOfMass_centroid=vec2.create(),updateCenterOfMass_centroid_times_mass=vec2.create(),updateCenterOfMass_a=vec2.create(),updateCenterOfMass_b=vec2.create(),updateCenterOfMass_c=vec2.create(),updateCenterOfMass_ac=vec2.create(),updateCenterOfMass_ca=vec2.create(),updateCenterOfMass_cb=vec2.create(),updateCenterOfMass_n=vec2.create();Convex.prototype.updateCenterOfMass=function(){var triangles=this.triangles,verts=this.vertices,cm=this.centerOfMass,centroid=updateCenterOfMass_centroid,n=updateCenterOfMass_n,a=updateCenterOfMass_a,b=updateCenterOfMass_b,c=updateCenterOfMass_c,ac=updateCenterOfMass_ac,ca=updateCenterOfMass_ca,cb=updateCenterOfMass_cb,centroid_times_mass=updateCenterOfMass_centroid_times_mass;vec2.set(cm,0,0);var totalArea=0;for(var i=0;i!==triangles.length;i++){var t=triangles[i],a=verts[t[0]],b=verts[t[1]],c=verts[t[2]];vec2.centroid(centroid,a,b,c);var m=Convex.triangleArea(a,b,c);totalArea+=m;vec2.scale(centroid_times_mass,centroid,m);vec2.add(cm,cm,centroid_times_mass)}vec2.scale(cm,cm,1/totalArea)};Convex.prototype.computeMomentOfInertia=function(mass){var denom=0.0,numer=0.0,N=this.vertices.length;for(var j=N-1,i=0;i<N;j=i,i++){var p0=this.vertices[j];var p1=this.vertices[i];var a=Math.abs(vec2.crossLength(p0,p1));var b=vec2.dot(p1,p1)+vec2.dot(p1,p0)+vec2.dot(p0,p0);denom+=a*b;numer+=a}return(mass/6.0)*(denom/numer)};Convex.prototype.updateBoundingRadius=function(){var verts=this.vertices,r2=0;for(var i=0;i!==verts.length;i++){var l2=vec2.squaredLength(verts[i]);if(l2>r2){r2=l2}}this.boundingRadius=Math.sqrt(r2)};Convex.triangleArea=function(a,b,c){return(((b[0]-a[0])*(c[1]-a[1]))-((c[0]-a[0])*(b[1]-a[1])))*0.5};Convex.prototype.updateArea=function(){this.updateTriangles();this.area=0;var triangles=this.triangles,verts=this.vertices;for(var i=0;i!==triangles.length;i++){var t=triangles[i],a=verts[t[0]],b=verts[t[1]],c=verts[t[2]];var m=Convex.triangleArea(a,b,c);this.area+=m}};Convex.prototype.computeAABB=function(out,position,angle){out.setFromPoints(this.vertices,position,angle,0)};var intersectConvex_rayStart=vec2.create();var intersectConvex_rayEnd=vec2.create();var intersectConvex_normal=vec2.create();Convex.prototype.raycast=function(result,ray,position,angle){var rayStart=intersectConvex_rayStart;var rayEnd=intersectConvex_rayEnd;var normal=intersectConvex_normal;var vertices=this.vertices;vec2.toLocalFrame(rayStart,ray.from,position,angle);vec2.toLocalFrame(rayEnd,ray.to,position,angle);var n=vertices.length;for(var i=0;i<n&&!result.shouldStop(ray);i++){var q1=vertices[i];var q2=vertices[(i+1)%n];var delta=vec2.getLineSegmentsIntersectionFraction(rayStart,rayEnd,q1,q2);if(delta>=0){vec2.sub(normal,q2,q1);vec2.rotate(normal,normal,-Math.PI/2+angle);vec2.normalize(normal,normal);ray.reportIntersection(result,delta,normal,i)}}}},{'../math/polyk':29,'../math/vec2':30,'./Shape':45,'poly-decomp':5}],41:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2'),Utils=_dereq_('../utils/Utils');module.exports=Heightfield;function Heightfield(options){if(Array.isArray(arguments[0])){options={heights:arguments[0]};if(typeof(arguments[1])==='object'){for(var key in arguments[1]){options[key]=arguments[1][key]}}console.warn('The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })')}options=options||{};this.heights=options.heights?options.heights.slice(0):[];this.maxValue=options.maxValue||null;this.minValue=options.minValue||null;this.elementWidth=options.elementWidth||0.1;if(options.maxValue===undefined||options.minValue===undefined){this.updateMaxMinValues()}options.type=Shape.HEIGHTFIELD;Shape.call(this,options)}Heightfield.prototype=new Shape();Heightfield.prototype.constructor=Heightfield;Heightfield.prototype.updateMaxMinValues=function(){var data=this.heights;var maxValue=data[0];var minValue=data[0];for(var i=0;i!==data.length;i++){var v=data[i];if(v>maxValue){maxValue=v}if(v<minValue){minValue=v}}this.maxValue=maxValue;this.minValue=minValue};Heightfield.prototype.computeMomentOfInertia=function(mass){return Number.MAX_VALUE};Heightfield.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE};Heightfield.prototype.updateArea=function(){var data=this.heights,area=0;for(var i=0;i<data.length-1;i++){area+=(data[i]+data[i+1])/2*this.elementWidth}this.area=area};var points=[vec2.create(),vec2.create(),vec2.create(),vec2.create()];Heightfield.prototype.computeAABB=function(out,position,angle){vec2.set(points[0],0,this.maxValue);vec2.set(points[1],this.elementWidth*this.heights.length,this.maxValue);vec2.set(points[2],this.elementWidth*this.heights.length,this.minValue);vec2.set(points[3],0,this.minValue);out.setFromPoints(points,position,angle)};Heightfield.prototype.getLineSegment=function(start,end,i){var data=this.heights;var width=this.elementWidth;vec2.set(start,i*width,data[i]);vec2.set(end,(i+1)*width,data[i+1])};Heightfield.prototype.getSegmentIndex=function(position){return Math.floor(position[0]/this.elementWidth)};Heightfield.prototype.getClampedSegmentIndex=function(position){var i=this.getSegmentIndex(position);i=Math.min(this.heights.length,Math.max(i,0));return i};var intersectHeightfield_hitPointWorld=vec2.create();var intersectHeightfield_worldNormal=vec2.create();var intersectHeightfield_l0=vec2.create();var intersectHeightfield_l1=vec2.create();var intersectHeightfield_localFrom=vec2.create();var intersectHeightfield_localTo=vec2.create();var intersectHeightfield_unit_y=vec2.fromValues(0,1);function getLineSegmentsIntersection(out,p0,p1,p2,p3){var s1_x,s1_y,s2_x,s2_y;s1_x=p1[0]-p0[0];s1_y=p1[1]-p0[1];s2_x=p3[0]-p2[0];s2_y=p3[1]-p2[1];var s,t;s=(-s1_y*(p0[0]-p2[0])+s1_x*(p0[1]-p2[1]))/(-s2_x*s1_y+s1_x*s2_y);t=(s2_x*(p0[1]-p2[1])-s2_y*(p0[0]-p2[0]))/(-s2_x*s1_y+s1_x*s2_y);if(s>=0&&s<=1&&t>=0&&t<=1){var intX=p0[0]+(t*s1_x);var intY=p0[1]+(t*s1_y);out[0]=intX;out[1]=intY;return t}return-1}Heightfield.prototype.raycast=function(result,ray,position,angle){var from=ray.from;var to=ray.to;var direction=ray.direction;var hitPointWorld=intersectHeightfield_hitPointWorld;var worldNormal=intersectHeightfield_worldNormal;var l0=intersectHeightfield_l0;var l1=intersectHeightfield_l1;var localFrom=intersectHeightfield_localFrom;var localTo=intersectHeightfield_localTo;vec2.toLocalFrame(localFrom,from,position,angle);vec2.toLocalFrame(localTo,to,position,angle);var i0=this.getClampedSegmentIndex(localFrom);var i1=this.getClampedSegmentIndex(localTo);if(i0>i1){var tmp=i0;i0=i1;i1=tmp}for(var i=0;i<this.heights.length-1;i++){this.getLineSegment(l0,l1,i);var t=vec2.getLineSegmentsIntersectionFraction(localFrom,localTo,l0,l1);if(t>=0){vec2.sub(worldNormal,l1,l0);vec2.rotate(worldNormal,worldNormal,angle+Math.PI/2);vec2.normalize(worldNormal,worldNormal);ray.reportIntersection(result,t,worldNormal,-1);if(result.shouldStop(ray)){return}}}}},{'../math/vec2':30,'../utils/Utils':57,'./Shape':45}],42:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2');module.exports=Line;function Line(options){if(typeof(arguments[0])==='number'){options={length:arguments[0]};console.warn('The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })')}options=options||{};this.length=options.length||1;options.type=Shape.LINE;Shape.call(this,options)}Line.prototype=new Shape();Line.prototype.constructor=Line;Line.prototype.computeMomentOfInertia=function(mass){return mass*Math.pow(this.length,2)/12};Line.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var points=[vec2.create(),vec2.create()];Line.prototype.computeAABB=function(out,position,angle){var l2=this.length/2;vec2.set(points[0],-l2,0);vec2.set(points[1],l2,0);out.setFromPoints(points,position,angle,0)};var raycast_hitPoint=vec2.create();var raycast_normal=vec2.create();var raycast_l0=vec2.create();var raycast_l1=vec2.create();var raycast_unit_y=vec2.fromValues(0,1);Line.prototype.raycast=function(result,ray,position,angle){var from=ray.from;var to=ray.to;var l0=raycast_l0;var l1=raycast_l1;var halfLen=this.length/2;vec2.set(l0,-halfLen,0);vec2.set(l1,halfLen,0);vec2.toGlobalFrame(l0,l0,position,angle);vec2.toGlobalFrame(l1,l1,position,angle);var fraction=vec2.getLineSegmentsIntersectionFraction(l0,l1,from,to);if(fraction>=0){var normal=raycast_normal;vec2.rotate(normal,raycast_unit_y,angle);ray.reportIntersection(result,fraction,normal,-1)}}},{'../math/vec2':30,'./Shape':45}],43:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2');module.exports=Particle;function Particle(options){options=options||{};options.type=Shape.PARTICLE;Shape.call(this,options)}Particle.prototype=new Shape();Particle.prototype.constructor=Particle;Particle.prototype.computeMomentOfInertia=function(mass){return 0};Particle.prototype.updateBoundingRadius=function(){this.boundingRadius=0};Particle.prototype.computeAABB=function(out,position,angle){vec2.copy(out.lowerBound,position);vec2.copy(out.upperBound,position)}},{'../math/vec2':30,'./Shape':45}],44:[function(_dereq_,module,exports){var Shape=_dereq_('./Shape'),vec2=_dereq_('../math/vec2'),Utils=_dereq_('../utils/Utils');module.exports=Plane;function Plane(options){options=options||{};options.type=Shape.PLANE;Shape.call(this,options)}Plane.prototype=new Shape();Plane.prototype.constructor=Plane;Plane.prototype.computeMomentOfInertia=function(mass){return 0};Plane.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE};Plane.prototype.computeAABB=function(out,position,angle){var a=angle%(2*Math.PI);var set=vec2.set;var max=1e7;var lowerBound=out.lowerBound;var upperBound=out.upperBound;set(lowerBound,-max,-max);set(upperBound,max,max);if(a===0){upperBound[1]=0}else if(a===Math.PI/2){lowerBound[0]=0}else if(a===Math.PI){lowerBound[1]=0}else if(a===3*Math.PI/2){upperBound[0]=0}};Plane.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var intersectPlane_planePointToFrom=vec2.create();var intersectPlane_dir_scaled_with_t=vec2.create();var intersectPlane_hitPoint=vec2.create();var intersectPlane_normal=vec2.create();var intersectPlane_len=vec2.create();Plane.prototype.raycast=function(result,ray,position,angle){var from=ray.from;var to=ray.to;var direction=ray.direction;var planePointToFrom=intersectPlane_planePointToFrom;var dir_scaled_with_t=intersectPlane_dir_scaled_with_t;var hitPoint=intersectPlane_hitPoint;var normal=intersectPlane_normal;var len=intersectPlane_len;vec2.set(normal,0,1);vec2.rotate(normal,normal,angle);vec2.sub(len,from,position);var planeToFrom=vec2.dot(len,normal);vec2.sub(len,to,position);var planeToTo=vec2.dot(len,normal);if(planeToFrom*planeToTo>0){return}if(vec2.squaredDistance(from,to)<planeToFrom*planeToFrom){return}var n_dot_dir=vec2.dot(normal,direction);vec2.sub(planePointToFrom,from,position);var t=-vec2.dot(normal,planePointToFrom)/n_dot_dir/ray.length;ray.reportIntersection(result,t,normal,-1)}},{'../math/vec2':30,'../utils/Utils':57,'./Shape':45}],45:[function(_dereq_,module,exports){module.exports=Shape;var vec2=_dereq_('../math/vec2');function Shape(options){options=options||{};this.body=null;this.position=vec2.fromValues(0,0);if(options.position){vec2.copy(this.position,options.position)}this.angle=options.angle||0;this.type=options.type||0;this.id=Shape.idCounter++;this.boundingRadius=0;this.collisionGroup=options.collisionGroup!==undefined?options.collisionGroup:1;this.collisionResponse=options.collisionResponse!==undefined?options.collisionResponse:true;this.collisionMask=options.collisionMask!==undefined?options.collisionMask:1;this.material=options.material||null;this.area=0;this.sensor=options.sensor!==undefined?options.sensor:false;if(this.type){this.updateBoundingRadius()}this.updateArea()}Shape.idCounter=0;Shape.CIRCLE=1;Shape.PARTICLE=2;Shape.PLANE=4;Shape.CONVEX=8;Shape.LINE=16;Shape.BOX=32;Shape.CAPSULE=64;Shape.HEIGHTFIELD=128;Shape.prototype.computeMomentOfInertia=function(mass){};Shape.prototype.updateBoundingRadius=function(){};Shape.prototype.updateArea=function(){};Shape.prototype.computeAABB=function(out,position,angle){};Shape.prototype.raycast=function(result,ray,position,angle){}},{'../math/vec2':30}],46:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),Solver=_dereq_('./Solver'),Utils=_dereq_('../utils/Utils'),FrictionEquation=_dereq_('../equations/FrictionEquation');module.exports=GSSolver;function GSSolver(options){Solver.call(this,options,Solver.GS);options=options||{};this.iterations=options.iterations||10;this.tolerance=options.tolerance||1e-7;this.arrayStep=30;this.lambda=new Utils.ARRAY_TYPE(this.arrayStep);this.Bs=new Utils.ARRAY_TYPE(this.arrayStep);this.invCs=new Utils.ARRAY_TYPE(this.arrayStep);this.useZeroRHS=false;this.frictionIterations=options.frictionIterations!==undefined?0:options.frictionIterations;this.usedIterations=0}GSSolver.prototype=new Solver();GSSolver.prototype.constructor=GSSolver;function setArrayZero(array){var l=array.length;while(l--){array[l]=+0.0}}GSSolver.prototype.solve=function(h,world){this.sortEquations();var iter=0,maxIter=this.iterations,maxFrictionIter=this.frictionIterations,equations=this.equations,Neq=equations.length,tolSquared=Math.pow(this.tolerance*Neq,2),bodies=world.bodies,Nbodies=world.bodies.length,add=vec2.add,set=vec2.set,useZeroRHS=this.useZeroRHS,lambda=this.lambda;this.usedIterations=0;if(Neq){for(var i=0;i!==Nbodies;i++){var b=bodies[i];b.updateSolveMassProperties()}}if(lambda.length<Neq){lambda=this.lambda=new Utils.ARRAY_TYPE(Neq+this.arrayStep);this.Bs=new Utils.ARRAY_TYPE(Neq+this.arrayStep);this.invCs=new Utils.ARRAY_TYPE(Neq+this.arrayStep)}setArrayZero(lambda);var invCs=this.invCs,Bs=this.Bs,lambda=this.lambda;for(var i=0;i!==equations.length;i++){var c=equations[i];if(c.timeStep!==h||c.needsUpdate){c.timeStep=h;c.update()}Bs[i]=c.computeB(c.a,c.b,h);invCs[i]=c.computeInvC(c.epsilon)}var q,B,c,deltalambdaTot,i,j;if(Neq!==0){for(i=0;i!==Nbodies;i++){var b=bodies[i];b.resetConstraintVelocity()}if(maxFrictionIter){for(iter=0;iter!==maxFrictionIter;iter++){deltalambdaTot=0.0;for(j=0;j!==Neq;j++){c=equations[j];var deltalambda=GSSolver.iterateEquation(j,c,c.epsilon,Bs,invCs,lambda,useZeroRHS,h,iter);deltalambdaTot+=Math.abs(deltalambda)}this.usedIterations++;if(deltalambdaTot*deltalambdaTot<=tolSquared){break}}GSSolver.updateMultipliers(equations,lambda,1/h);for(j=0;j!==Neq;j++){var eq=equations[j];if(eq instanceof FrictionEquation){var f=0.0;for(var k=0;k!==eq.contactEquations.length;k++){f+=eq.contactEquations[k].multiplier}f*=eq.frictionCoefficient/eq.contactEquations.length;eq.maxForce=f;eq.minForce=-f}}}for(iter=0;iter!==maxIter;iter++){deltalambdaTot=0.0;for(j=0;j!==Neq;j++){c=equations[j];var deltalambda=GSSolver.iterateEquation(j,c,c.epsilon,Bs,invCs,lambda,useZeroRHS,h,iter);deltalambdaTot+=Math.abs(deltalambda)}this.usedIterations++;if(deltalambdaTot*deltalambdaTot<=tolSquared){break}}for(i=0;i!==Nbodies;i++){bodies[i].addConstraintVelocity()}GSSolver.updateMultipliers(equations,lambda,1/h)}};GSSolver.updateMultipliers=function(equations,lambda,invDt){var l=equations.length;while(l--){equations[l].multiplier=lambda[l]*invDt}};GSSolver.iterateEquation=function(j,eq,eps,Bs,invCs,lambda,useZeroRHS,dt,iter){var B=Bs[j],invC=invCs[j],lambdaj=lambda[j],GWlambda=eq.computeGWlambda();var maxForce=eq.maxForce,minForce=eq.minForce;if(useZeroRHS){B=0}var deltalambda=invC*(B-GWlambda-eps*lambdaj);var lambdaj_plus_deltalambda=lambdaj+deltalambda;if(lambdaj_plus_deltalambda<minForce*dt){deltalambda=minForce*dt-lambdaj}else if(lambdaj_plus_deltalambda>maxForce*dt){deltalambda=maxForce*dt-lambdaj}lambda[j]+=deltalambda;eq.addToWlambda(deltalambda);return deltalambda}},{'../equations/FrictionEquation':23,'../math/vec2':30,'../utils/Utils':57,'./Solver':47}],47:[function(_dereq_,module,exports){var Utils=_dereq_('../utils/Utils'),EventEmitter=_dereq_('../events/EventEmitter');module.exports=Solver;function Solver(options,type){options=options||{};EventEmitter.call(this);this.type=type;this.equations=[];this.equationSortFunction=options.equationSortFunction||false}Solver.prototype=new EventEmitter();Solver.prototype.constructor=Solver;Solver.prototype.solve=function(dt,world){throw new Error('Solver.solve should be implemented by subclasses!')};var mockWorld={bodies:[]};Solver.prototype.solveIsland=function(dt,island){this.removeAllEquations();if(island.equations.length){this.addEquations(island.equations);mockWorld.bodies.length=0;island.getBodies(mockWorld.bodies);if(mockWorld.bodies.length){this.solve(dt,mockWorld)}}};Solver.prototype.sortEquations=function(){if(this.equationSortFunction){this.equations.sort(this.equationSortFunction)}};Solver.prototype.addEquation=function(eq){if(eq.enabled){this.equations.push(eq)}};Solver.prototype.addEquations=function(eqs){for(var i=0,N=eqs.length;i!==N;i++){var eq=eqs[i];if(eq.enabled){this.equations.push(eq)}}};Solver.prototype.removeEquation=function(eq){var i=this.equations.indexOf(eq);if(i!==-1){this.equations.splice(i,1)}};Solver.prototype.removeAllEquations=function(){this.equations.length=0};Solver.GS=1;Solver.ISLAND=2},{'../events/EventEmitter':26,'../utils/Utils':57}],48:[function(_dereq_,module,exports){var ContactEquation=_dereq_('../equations/ContactEquation');var Pool=_dereq_('./Pool');module.exports=ContactEquationPool;function ContactEquationPool(){Pool.apply(this,arguments)}ContactEquationPool.prototype=new Pool();ContactEquationPool.prototype.constructor=ContactEquationPool;ContactEquationPool.prototype.create=function(){return new ContactEquation()};ContactEquationPool.prototype.destroy=function(equation){equation.bodyA=equation.bodyB=null;return this}},{'../equations/ContactEquation':21,'./Pool':55}],49:[function(_dereq_,module,exports){var FrictionEquation=_dereq_('../equations/FrictionEquation');var Pool=_dereq_('./Pool');module.exports=FrictionEquationPool;function FrictionEquationPool(){Pool.apply(this,arguments)}FrictionEquationPool.prototype=new Pool();FrictionEquationPool.prototype.constructor=FrictionEquationPool;FrictionEquationPool.prototype.create=function(){return new FrictionEquation()};FrictionEquationPool.prototype.destroy=function(equation){equation.bodyA=equation.bodyB=null;return this}},{'../equations/FrictionEquation':23,'./Pool':55}],50:[function(_dereq_,module,exports){var IslandNode=_dereq_('../world/IslandNode');var Pool=_dereq_('./Pool');module.exports=IslandNodePool;function IslandNodePool(){Pool.apply(this,arguments)}IslandNodePool.prototype=new Pool();IslandNodePool.prototype.constructor=IslandNodePool;IslandNodePool.prototype.create=function(){return new IslandNode()};IslandNodePool.prototype.destroy=function(node){node.reset();return this}},{'../world/IslandNode':60,'./Pool':55}],51:[function(_dereq_,module,exports){var Island=_dereq_('../world/Island');var Pool=_dereq_('./Pool');module.exports=IslandPool;function IslandPool(){Pool.apply(this,arguments)}IslandPool.prototype=new Pool();IslandPool.prototype.constructor=IslandPool;IslandPool.prototype.create=function(){return new Island()};IslandPool.prototype.destroy=function(island){island.reset();return this}},{'../world/Island':58,'./Pool':55}],52:[function(_dereq_,module,exports){var TupleDictionary=_dereq_('./TupleDictionary');var OverlapKeeperRecord=_dereq_('./OverlapKeeperRecord');var OverlapKeeperRecordPool=_dereq_('./OverlapKeeperRecordPool');var Utils=_dereq_('./Utils');module.exports=OverlapKeeper;function OverlapKeeper(){this.overlappingShapesLastState=new TupleDictionary();this.overlappingShapesCurrentState=new TupleDictionary();this.recordPool=new OverlapKeeperRecordPool({size:16});this.tmpDict=new TupleDictionary();this.tmpArray1=[]}OverlapKeeper.prototype.tick=function(){var last=this.overlappingShapesLastState;var current=this.overlappingShapesCurrentState;var l=last.keys.length;while(l--){var key=last.keys[l];var lastObject=last.getByKey(key);var currentObject=current.getByKey(key);if(lastObject){this.recordPool.release(lastObject)}}last.reset();last.copy(current);current.reset()};OverlapKeeper.prototype.setOverlapping=function(bodyA,shapeA,bodyB,shapeB){var last=this.overlappingShapesLastState;var current=this.overlappingShapesCurrentState;if(!current.get(shapeA.id,shapeB.id)){var data=this.recordPool.get();data.set(bodyA,shapeA,bodyB,shapeB);current.set(shapeA.id,shapeB.id,data)}};OverlapKeeper.prototype.getNewOverlaps=function(result){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,result)};OverlapKeeper.prototype.getEndOverlaps=function(result){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,result)};OverlapKeeper.prototype.bodiesAreOverlapping=function(bodyA,bodyB){var current=this.overlappingShapesCurrentState;var l=current.keys.length;while(l--){var key=current.keys[l];var data=current.data[key];if((data.bodyA===bodyA&&data.bodyB===bodyB)||data.bodyA===bodyB&&data.bodyB===bodyA){return true}}return false};OverlapKeeper.prototype.getDiff=function(dictA,dictB,result){var result=result||[];var last=dictA;var current=dictB;result.length=0;var l=current.keys.length;while(l--){var key=current.keys[l];var data=current.data[key];if(!data){throw new Error('Key '+key+' had no data!')}var lastData=last.data[key];if(!lastData){result.push(data)}}return result};OverlapKeeper.prototype.isNewOverlap=function(shapeA,shapeB){var idA=shapeA.id|0,idB=shapeB.id|0;var last=this.overlappingShapesLastState;var current=this.overlappingShapesCurrentState;return!last.get(idA,idB)&&!!current.get(idA,idB)};OverlapKeeper.prototype.getNewBodyOverlaps=function(result){this.tmpArray1.length=0;var overlaps=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(overlaps,result)};OverlapKeeper.prototype.getEndBodyOverlaps=function(result){this.tmpArray1.length=0;var overlaps=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(overlaps,result)};OverlapKeeper.prototype.getBodyDiff=function(overlaps,result){result=result||[];var accumulator=this.tmpDict;var l=overlaps.length;while(l--){var data=overlaps[l];accumulator.set(data.bodyA.id|0,data.bodyB.id|0,data)}l=accumulator.keys.length;while(l--){var data=accumulator.getByKey(accumulator.keys[l]);if(data){result.push(data.bodyA,data.bodyB)}}accumulator.reset();return result}},{'./OverlapKeeperRecord':53,'./OverlapKeeperRecordPool':54,'./TupleDictionary':56,'./Utils':57}],53:[function(_dereq_,module,exports){module.exports=OverlapKeeperRecord;function OverlapKeeperRecord(bodyA,shapeA,bodyB,shapeB){this.shapeA=shapeA;this.shapeB=shapeB;this.bodyA=bodyA;this.bodyB=bodyB}OverlapKeeperRecord.prototype.set=function(bodyA,shapeA,bodyB,shapeB){OverlapKeeperRecord.call(this,bodyA,shapeA,bodyB,shapeB)}},{}],54:[function(_dereq_,module,exports){var OverlapKeeperRecord=_dereq_('./OverlapKeeperRecord');var Pool=_dereq_('./Pool');module.exports=OverlapKeeperRecordPool;function OverlapKeeperRecordPool(){Pool.apply(this,arguments)}OverlapKeeperRecordPool.prototype=new Pool();OverlapKeeperRecordPool.prototype.constructor=OverlapKeeperRecordPool;OverlapKeeperRecordPool.prototype.create=function(){return new OverlapKeeperRecord()};OverlapKeeperRecordPool.prototype.destroy=function(record){record.bodyA=record.bodyB=record.shapeA=record.shapeB=null;return this}},{'./OverlapKeeperRecord':53,'./Pool':55}],55:[function(_dereq_,module,exports){module.exports=Pool;function Pool(options){options=options||{};this.objects=[];if(options.size!==undefined){this.resize(options.size)}}Pool.prototype.resize=function(size){var objects=this.objects;while(objects.length>size){objects.pop()}while(objects.length<size){objects.push(this.create())}return this};Pool.prototype.get=function(){var objects=this.objects;return objects.length?objects.pop():this.create()};Pool.prototype.release=function(object){this.destroy(object);this.objects.push(object);return this}},{}],56:[function(_dereq_,module,exports){var Utils=_dereq_('./Utils');module.exports=TupleDictionary;function TupleDictionary(){this.data={};this.keys=[]}TupleDictionary.prototype.getKey=function(id1,id2){id1=id1|0;id2=id2|0;if((id1|0)===(id2|0)){return-1}return((id1|0)>(id2|0)?(id1<<16)|(id2&0xFFFF):(id2<<16)|(id1&0xFFFF))|0};TupleDictionary.prototype.getByKey=function(key){key=key|0;return this.data[key]};TupleDictionary.prototype.get=function(i,j){return this.data[this.getKey(i,j)]};TupleDictionary.prototype.set=function(i,j,value){if(!value){throw new Error('No data!')}var key=this.getKey(i,j);if(!this.data[key]){this.keys.push(key)}this.data[key]=value;return key};TupleDictionary.prototype.reset=function(){var data=this.data,keys=this.keys;var l=keys.length;while(l--){delete data[keys[l]]}keys.length=0};TupleDictionary.prototype.copy=function(dict){this.reset();Utils.appendArray(this.keys,dict.keys);var l=dict.keys.length;while(l--){var key=dict.keys[l];this.data[key]=dict.data[key]}}},{'./Utils':57}],57:[function(_dereq_,module,exports){module.exports=Utils;function Utils(){}Utils.appendArray=function(a,b){if(b.length<150000){a.push.apply(a,b)}else{for(var i=0,len=b.length;i!==len;++i){a.push(b[i])}}};Utils.splice=function(array,index,howmany){howmany=howmany||1;for(var i=index,len=array.length-howmany;i<len;i++){array[i]=array[i+howmany]}array.length=len};if(typeof P2_ARRAY_TYPE!=='undefined'){Utils.ARRAY_TYPE=P2_ARRAY_TYPE}else if(typeof Float32Array!=='undefined'){Utils.ARRAY_TYPE=Float32Array}else{Utils.ARRAY_TYPE=Array}Utils.extend=function(a,b){for(var key in b){a[key]=b[key]}};Utils.defaults=function(options,defaults){options=options||{};for(var key in defaults){if(!(key in options)){options[key]=defaults[key]}}return options}},{}],58:[function(_dereq_,module,exports){var Body=_dereq_('../objects/Body');module.exports=Island;function Island(){this.equations=[];this.bodies=[]}Island.prototype.reset=function(){this.equations.length=this.bodies.length=0};var bodyIds=[];Island.prototype.getBodies=function(result){var bodies=result||[],eqs=this.equations;bodyIds.length=0;for(var i=0;i!==eqs.length;i++){var eq=eqs[i];if(bodyIds.indexOf(eq.bodyA.id)===-1){bodies.push(eq.bodyA);bodyIds.push(eq.bodyA.id)}if(bodyIds.indexOf(eq.bodyB.id)===-1){bodies.push(eq.bodyB);bodyIds.push(eq.bodyB.id)}}return bodies};Island.prototype.wantsToSleep=function(){for(var i=0;i<this.bodies.length;i++){var b=this.bodies[i];if(b.type===Body.DYNAMIC&&!b.wantsToSleep){return false}}return true};Island.prototype.sleep=function(){for(var i=0;i<this.bodies.length;i++){var b=this.bodies[i];b.sleep()}return true}},{'../objects/Body':31}],59:[function(_dereq_,module,exports){var vec2=_dereq_('../math/vec2'),Island=_dereq_('./Island'),IslandNode=_dereq_('./IslandNode'),IslandNodePool=_dereq_('./../utils/IslandNodePool'),IslandPool=_dereq_('./../utils/IslandPool'),Body=_dereq_('../objects/Body');module.exports=IslandManager;function IslandManager(options){this.nodePool=new IslandNodePool({size:16});this.islandPool=new IslandPool({size:8});this.equations=[];this.islands=[];this.nodes=[];this.queue=[]}IslandManager.getUnvisitedNode=function(nodes){var Nnodes=nodes.length;for(var i=0;i!==Nnodes;i++){var node=nodes[i];if(!node.visited&&node.body.type===Body.DYNAMIC){return node}}return false};IslandManager.prototype.visit=function(node,bds,eqs){bds.push(node.body);var Neqs=node.equations.length;for(var i=0;i!==Neqs;i++){var eq=node.equations[i];if(eqs.indexOf(eq)===-1){eqs.push(eq)}}};IslandManager.prototype.bfs=function(root,bds,eqs){var queue=this.queue;queue.length=0;queue.push(root);root.visited=true;this.visit(root,bds,eqs);while(queue.length){var node=queue.pop();var child;while((child=IslandManager.getUnvisitedNode(node.neighbors))){child.visited=true;this.visit(child,bds,eqs);if(child.body.type===Body.DYNAMIC){queue.push(child)}}}};IslandManager.prototype.split=function(world){var bodies=world.bodies,nodes=this.nodes,equations=this.equations;while(nodes.length){this.nodePool.release(nodes.pop())}for(var i=0;i!==bodies.length;i++){var node=this.nodePool.get();node.body=bodies[i];nodes.push(node)}for(var k=0;k!==equations.length;k++){var eq=equations[k],i=bodies.indexOf(eq.bodyA),j=bodies.indexOf(eq.bodyB),ni=nodes[i],nj=nodes[j];ni.neighbors.push(nj);nj.neighbors.push(ni);ni.equations.push(eq);nj.equations.push(eq)}var islands=this.islands;for(var i=0;i<islands.length;i++){this.islandPool.release(islands[i])}islands.length=0;var child;while((child=IslandManager.getUnvisitedNode(nodes))){var island=this.islandPool.get();this.bfs(child,island.bodies,island.equations);islands.push(island)}return islands}},{'../math/vec2':30,'../objects/Body':31,'./../utils/IslandNodePool':50,'./../utils/IslandPool':51,'./Island':58,'./IslandNode':60}],60:[function(_dereq_,module,exports){module.exports=IslandNode;function IslandNode(body){this.body=body;this.neighbors=[];this.equations=[];this.visited=false}IslandNode.prototype.reset=function(){this.equations.length=0;this.neighbors.length=0;this.visited=false;this.body=null}},{}],61:[function(_dereq_,module,exports){var GSSolver=_dereq_('../solver/GSSolver'),Solver=_dereq_('../solver/Solver'),Ray=_dereq_('../collision/Ray'),vec2=_dereq_('../math/vec2'),Circle=_dereq_('../shapes/Circle'),Convex=_dereq_('../shapes/Convex'),Line=_dereq_('../shapes/Line'),Plane=_dereq_('../shapes/Plane'),Capsule=_dereq_('../shapes/Capsule'),Particle=_dereq_('../shapes/Particle'),EventEmitter=_dereq_('../events/EventEmitter'),Body=_dereq_('../objects/Body'),Shape=_dereq_('../shapes/Shape'),LinearSpring=_dereq_('../objects/LinearSpring'),Material=_dereq_('../material/Material'),ContactMaterial=_dereq_('../material/ContactMaterial'),DistanceConstraint=_dereq_('../constraints/DistanceConstraint'),Constraint=_dereq_('../constraints/Constraint'),LockConstraint=_dereq_('../constraints/LockConstraint'),RevoluteConstraint=_dereq_('../constraints/RevoluteConstraint'),PrismaticConstraint=_dereq_('../constraints/PrismaticConstraint'),GearConstraint=_dereq_('../constraints/GearConstraint'),pkg=_dereq_('../../package.json'),Broadphase=_dereq_('../collision/Broadphase'),AABB=_dereq_('../collision/AABB'),SAPBroadphase=_dereq_('../collision/SAPBroadphase'),Narrowphase=_dereq_('../collision/Narrowphase'),Utils=_dereq_('../utils/Utils'),OverlapKeeper=_dereq_('../utils/OverlapKeeper'),IslandManager=_dereq_('./IslandManager'),RotationalSpring=_dereq_('../objects/RotationalSpring');module.exports=World;function World(options){EventEmitter.apply(this);options=options||{};this.springs=[];this.bodies=[];this.disabledBodyCollisionPairs=[];this.solver=options.solver||new GSSolver();this.narrowphase=new Narrowphase(this);this.islandManager=new IslandManager();this.gravity=vec2.fromValues(0,-9.78);if(options.gravity){vec2.copy(this.gravity,options.gravity)}this.frictionGravity=vec2.length(this.gravity)||10;this.useWorldGravityAsFrictionGravity=true;this.useFrictionGravityOnZeroGravity=true;this.broadphase=options.broadphase||new SAPBroadphase();this.broadphase.setWorld(this);this.constraints=[];this.defaultMaterial=new Material();this.defaultContactMaterial=new ContactMaterial(this.defaultMaterial,this.defaultMaterial);this.lastTimeStep=1/60;this.applySpringForces=true;this.applyDamping=true;this.applyGravity=true;this.solveConstraints=true;this.contactMaterials=[];this.time=0.0;this.accumulator=0;this.stepping=false;this.bodiesToBeRemoved=[];this.islandSplit=typeof(options.islandSplit)!=='undefined'?!!options.islandSplit:true;this.emitImpactEvent=true;this._constraintIdCounter=0;this._bodyIdCounter=0;this.postStepEvent={type:'postStep'};this.addBodyEvent={type:'addBody',body:null};this.removeBodyEvent={type:'removeBody',body:null};this.addSpringEvent={type:'addSpring',spring:null};this.impactEvent={type:'impact',bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null};this.postBroadphaseEvent={type:'postBroadphase',pairs:null};this.sleepMode=World.NO_SLEEPING;this.beginContactEvent={type:'beginContact',shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]};this.endContactEvent={type:'endContact',shapeA:null,shapeB:null,bodyA:null,bodyB:null};this.preSolveEvent={type:'preSolve',contactEquations:null,frictionEquations:null};this.overlappingShapesLastState={keys:[]};this.overlappingShapesCurrentState={keys:[]};this.overlapKeeper=new OverlapKeeper()}World.prototype=new Object(EventEmitter.prototype);World.prototype.constructor=World;World.NO_SLEEPING=1;World.BODY_SLEEPING=2;World.ISLAND_SLEEPING=4;World.prototype.addConstraint=function(constraint){this.constraints.push(constraint)};World.prototype.addContactMaterial=function(contactMaterial){this.contactMaterials.push(contactMaterial)};World.prototype.removeContactMaterial=function(cm){var idx=this.contactMaterials.indexOf(cm);if(idx!==-1){Utils.splice(this.contactMaterials,idx,1)}};World.prototype.getContactMaterial=function(materialA,materialB){var cmats=this.contactMaterials;for(var i=0,N=cmats.length;i!==N;i++){var cm=cmats[i];if((cm.materialA.id===materialA.id)&&(cm.materialB.id===materialB.id)||(cm.materialA.id===materialB.id)&&(cm.materialB.id===materialA.id)){return cm}}return false};World.prototype.removeConstraint=function(constraint){var idx=this.constraints.indexOf(constraint);if(idx!==-1){Utils.splice(this.constraints,idx,1)}};var step_r=vec2.create(),step_runit=vec2.create(),step_u=vec2.create(),step_f=vec2.create(),step_fhMinv=vec2.create(),step_velodt=vec2.create(),step_mg=vec2.create(),xiw=vec2.fromValues(0,0),xjw=vec2.fromValues(0,0),zero=vec2.fromValues(0,0),interpvelo=vec2.fromValues(0,0);World.prototype.step=function(dt,timeSinceLastCalled,maxSubSteps){maxSubSteps=maxSubSteps||10;timeSinceLastCalled=timeSinceLastCalled||0;if(timeSinceLastCalled===0){this.internalStep(dt);this.time+=dt}else{this.accumulator+=timeSinceLastCalled;var substeps=0;while(this.accumulator>=dt&&substeps<maxSubSteps){this.internalStep(dt);this.time+=dt;this.accumulator-=dt;substeps++}var t=(this.accumulator%dt)/dt;for(var j=0;j!==this.bodies.length;j++){var b=this.bodies[j];vec2.lerp(b.interpolatedPosition,b.previousPosition,b.position,t);b.interpolatedAngle=b.previousAngle+t*(b.angle-b.previousAngle)}}};var endOverlaps=[];World.prototype.internalStep=function(dt){this.stepping=true;var that=this,Nsprings=this.springs.length,springs=this.springs,bodies=this.bodies,g=this.gravity,solver=this.solver,Nbodies=this.bodies.length,broadphase=this.broadphase,np=this.narrowphase,constraints=this.constraints,t0,t1,fhMinv=step_fhMinv,velodt=step_velodt,mg=step_mg,scale=vec2.scale,add=vec2.add,rotate=vec2.rotate,islandManager=this.islandManager;this.overlapKeeper.tick();this.lastTimeStep=dt;if(this.useWorldGravityAsFrictionGravity){var gravityLen=vec2.length(this.gravity);if(!(gravityLen===0&&this.useFrictionGravityOnZeroGravity)){this.frictionGravity=gravityLen}}if(this.applyGravity){for(var i=0;i!==Nbodies;i++){var b=bodies[i],fi=b.force;if(b.type!==Body.DYNAMIC||b.sleepState===Body.SLEEPING){continue}vec2.scale(mg,g,b.mass*b.gravityScale);add(fi,fi,mg)}}if(this.applySpringForces){for(var i=0;i!==Nsprings;i++){var s=springs[i];s.applyForce()}}if(this.applyDamping){for(var i=0;i!==Nbodies;i++){var b=bodies[i];if(b.type===Body.DYNAMIC){b.applyDamping(dt)}}}var result=broadphase.getCollisionPairs(this);var ignoredPairs=this.disabledBodyCollisionPairs;for(var i=ignoredPairs.length-2;i>=0;i-=2){for(var j=result.length-2;j>=0;j-=2){if((ignoredPairs[i]===result[j]&&ignoredPairs[i+1]===result[j+1])||(ignoredPairs[i+1]===result[j]&&ignoredPairs[i]===result[j+1])){result.splice(j,2)}}}var Nconstraints=constraints.length;for(i=0;i!==Nconstraints;i++){var c=constraints[i];if(!c.collideConnected){for(var j=result.length-2;j>=0;j-=2){if((c.bodyA===result[j]&&c.bodyB===result[j+1])||(c.bodyB===result[j]&&c.bodyA===result[j+1])){result.splice(j,2)}}}}this.postBroadphaseEvent.pairs=result;this.emit(this.postBroadphaseEvent);this.postBroadphaseEvent.pairs=null;np.reset(this);for(var i=0,Nresults=result.length;i!==Nresults;i+=2){var bi=result[i],bj=result[i+1];for(var k=0,Nshapesi=bi.shapes.length;k!==Nshapesi;k++){var si=bi.shapes[k],xi=si.position,ai=si.angle;for(var l=0,Nshapesj=bj.shapes.length;l!==Nshapesj;l++){var sj=bj.shapes[l],xj=sj.position,aj=sj.angle;var cm=this.defaultContactMaterial;if(si.material&&sj.material){var tmp=this.getContactMaterial(si.material,sj.material);if(tmp){cm=tmp}}this.runNarrowphase(np,bi,si,xi,ai,bj,sj,xj,aj,cm,this.frictionGravity)}}}for(var i=0;i!==Nbodies;i++){var body=bodies[i];if(body._wakeUpAfterNarrowphase){body.wakeUp();body._wakeUpAfterNarrowphase=false}}if(this.has('endContact')){this.overlapKeeper.getEndOverlaps(endOverlaps);var e=this.endContactEvent;var l=endOverlaps.length;while(l--){var data=endOverlaps[l];e.shapeA=data.shapeA;e.shapeB=data.shapeB;e.bodyA=data.bodyA;e.bodyB=data.bodyB;this.emit(e)}endOverlaps.length=0}var preSolveEvent=this.preSolveEvent;preSolveEvent.contactEquations=np.contactEquations;preSolveEvent.frictionEquations=np.frictionEquations;this.emit(preSolveEvent);preSolveEvent.contactEquations=preSolveEvent.frictionEquations=null;var Nconstraints=constraints.length;for(i=0;i!==Nconstraints;i++){constraints[i].update()}if(np.contactEquations.length||np.frictionEquations.length||Nconstraints){if(this.islandSplit){islandManager.equations.length=0;Utils.appendArray(islandManager.equations,np.contactEquations);Utils.appendArray(islandManager.equations,np.frictionEquations);for(i=0;i!==Nconstraints;i++){Utils.appendArray(islandManager.equations,constraints[i].equations)}islandManager.split(this);for(var i=0;i!==islandManager.islands.length;i++){var island=islandManager.islands[i];if(island.equations.length){solver.solveIsland(dt,island)}}}else{solver.addEquations(np.contactEquations);solver.addEquations(np.frictionEquations);for(i=0;i!==Nconstraints;i++){solver.addEquations(constraints[i].equations)}if(this.solveConstraints){solver.solve(dt,this)}solver.removeAllEquations()}}for(var i=0;i!==Nbodies;i++){var body=bodies[i];body.integrate(dt)}for(var i=0;i!==Nbodies;i++){bodies[i].setZeroForce()}if(this.emitImpactEvent&&this.has('impact')){var ev=this.impactEvent;for(var i=0;i!==np.contactEquations.length;i++){var eq=np.contactEquations[i];if(eq.firstImpact){ev.bodyA=eq.bodyA;ev.bodyB=eq.bodyB;ev.shapeA=eq.shapeA;ev.shapeB=eq.shapeB;ev.contactEquation=eq;this.emit(ev)}}}if(this.sleepMode===World.BODY_SLEEPING){for(i=0;i!==Nbodies;i++){bodies[i].sleepTick(this.time,false,dt)}}else if(this.sleepMode===World.ISLAND_SLEEPING&&this.islandSplit){for(i=0;i!==Nbodies;i++){bodies[i].sleepTick(this.time,true,dt)}for(var i=0;i<this.islandManager.islands.length;i++){var island=this.islandManager.islands[i];if(island.wantsToSleep()){island.sleep()}}}this.stepping=false;var bodiesToBeRemoved=this.bodiesToBeRemoved;for(var i=0;i!==bodiesToBeRemoved.length;i++){this.removeBody(bodiesToBeRemoved[i])}bodiesToBeRemoved.length=0;this.emit(this.postStepEvent)};World.prototype.runNarrowphase=function(np,bi,si,xi,ai,bj,sj,xj,aj,cm,glen){if(!((si.collisionGroup&sj.collisionMask)!==0&&(sj.collisionGroup&si.collisionMask)!==0)){return}vec2.rotate(xiw,xi,bi.angle);vec2.rotate(xjw,xj,bj.angle);vec2.add(xiw,xiw,bi.position);vec2.add(xjw,xjw,bj.position);var aiw=ai+bi.angle;var ajw=aj+bj.angle;np.enableFriction=cm.friction>0;np.frictionCoefficient=cm.friction;var reducedMass;if(bi.type===Body.STATIC||bi.type===Body.KINEMATIC){reducedMass=bj.mass}else if(bj.type===Body.STATIC||bj.type===Body.KINEMATIC){reducedMass=bi.mass}else{reducedMass=(bi.mass*bj.mass)/(bi.mass+bj.mass)}np.slipForce=cm.friction*glen*reducedMass;np.restitution=cm.restitution;np.surfaceVelocity=cm.surfaceVelocity;np.frictionStiffness=cm.frictionStiffness;np.frictionRelaxation=cm.frictionRelaxation;np.stiffness=cm.stiffness;np.relaxation=cm.relaxation;np.contactSkinSize=cm.contactSkinSize;np.enabledEquations=bi.collisionResponse&&bj.collisionResponse&&si.collisionResponse&&sj.collisionResponse;var resolver=np[si.type|sj.type],numContacts=0;if(resolver){var sensor=si.sensor||sj.sensor;var numFrictionBefore=np.frictionEquations.length;if(si.type<sj.type){numContacts=resolver.call(np,bi,si,xiw,aiw,bj,sj,xjw,ajw,sensor)}else{numContacts=resolver.call(np,bj,sj,xjw,ajw,bi,si,xiw,aiw,sensor)}var numFrictionEquations=np.frictionEquations.length-numFrictionBefore;if(numContacts){if(bi.allowSleep&&bi.type===Body.DYNAMIC&&bi.sleepState===Body.SLEEPING&&bj.sleepState===Body.AWAKE&&bj.type!==Body.STATIC){var speedSquaredB=vec2.squaredLength(bj.velocity)+Math.pow(bj.angularVelocity,2);var speedLimitSquaredB=Math.pow(bj.sleepSpeedLimit,2);if(speedSquaredB>=speedLimitSquaredB*2){bi._wakeUpAfterNarrowphase=true}}if(bj.allowSleep&&bj.type===Body.DYNAMIC&&bj.sleepState===Body.SLEEPING&&bi.sleepState===Body.AWAKE&&bi.type!==Body.STATIC){var speedSquaredA=vec2.squaredLength(bi.velocity)+Math.pow(bi.angularVelocity,2);var speedLimitSquaredA=Math.pow(bi.sleepSpeedLimit,2);if(speedSquaredA>=speedLimitSquaredA*2){bj._wakeUpAfterNarrowphase=true}}this.overlapKeeper.setOverlapping(bi,si,bj,sj);if(this.has('beginContact')&&this.overlapKeeper.isNewOverlap(si,sj)){var e=this.beginContactEvent;e.shapeA=si;e.shapeB=sj;e.bodyA=bi;e.bodyB=bj;e.contactEquations.length=0;if(typeof(numContacts)==='number'){for(var i=np.contactEquations.length-numContacts;i<np.contactEquations.length;i++){e.contactEquations.push(np.contactEquations[i])}}this.emit(e)}if(typeof(numContacts)==='number'&&numFrictionEquations>1){for(var i=np.frictionEquations.length-numFrictionEquations;i<np.frictionEquations.length;i++){var f=np.frictionEquations[i];f.setSlipForce(f.getSlipForce()/numFrictionEquations)}}}}};World.prototype.addSpring=function(spring){this.springs.push(spring);var evt=this.addSpringEvent;evt.spring=spring;this.emit(evt);evt.spring=null};World.prototype.removeSpring=function(spring){var idx=this.springs.indexOf(spring);if(idx!==-1){Utils.splice(this.springs,idx,1)}};World.prototype.addBody=function(body){if(this.bodies.indexOf(body)===-1){this.bodies.push(body);body.world=this;var evt=this.addBodyEvent;evt.body=body;this.emit(evt);evt.body=null}};World.prototype.removeBody=function(body){if(this.stepping){this.bodiesToBeRemoved.push(body)}else{body.world=null;var idx=this.bodies.indexOf(body);if(idx!==-1){Utils.splice(this.bodies,idx,1);this.removeBodyEvent.body=body;body.resetConstraintVelocity();this.emit(this.removeBodyEvent);this.removeBodyEvent.body=null}}};World.prototype.getBodyById=function(id){var bodies=this.bodies;for(var i=0;i<bodies.length;i++){var b=bodies[i];if(b.id===id){return b}}return false};World.prototype.disableBodyCollision=function(bodyA,bodyB){this.disabledBodyCollisionPairs.push(bodyA,bodyB)};World.prototype.enableBodyCollision=function(bodyA,bodyB){var pairs=this.disabledBodyCollisionPairs;for(var i=0;i<pairs.length;i+=2){if((pairs[i]===bodyA&&pairs[i+1]===bodyB)||(pairs[i+1]===bodyA&&pairs[i]===bodyB)){pairs.splice(i,2);return}}};World.prototype.clear=function(){this.time=0;if(this.solver&&this.solver.equations.length){this.solver.removeAllEquations()}var cs=this.constraints;for(var i=cs.length-1;i>=0;i--){this.removeConstraint(cs[i])}var bodies=this.bodies;for(var i=bodies.length-1;i>=0;i--){this.removeBody(bodies[i])}var springs=this.springs;for(var i=springs.length-1;i>=0;i--){this.removeSpring(springs[i])}var cms=this.contactMaterials;for(var i=cms.length-1;i>=0;i--){this.removeContactMaterial(cms[i])}World.apply(this)};var hitTest_tmp1=vec2.create(),hitTest_zero=vec2.fromValues(0,0),hitTest_tmp2=vec2.fromValues(0,0);World.prototype.hitTest=function(worldPoint,bodies,precision){precision=precision||0;var pb=new Body({position:worldPoint}),ps=new Particle(),px=worldPoint,pa=0,x=hitTest_tmp1,zero=hitTest_zero,tmp=hitTest_tmp2;pb.addShape(ps);var n=this.narrowphase,result=[];for(var i=0,N=bodies.length;i!==N;i++){var b=bodies[i];for(var j=0,NS=b.shapes.length;j!==NS;j++){var s=b.shapes[j];vec2.rotate(x,s.position,b.angle);vec2.add(x,x,b.position);var a=s.angle+b.angle;if((s instanceof Circle&&n.circleParticle(b,s,x,a,pb,ps,px,pa,true))||(s instanceof Convex&&n.particleConvex(pb,ps,px,pa,b,s,x,a,true))||(s instanceof Plane&&n.particlePlane(pb,ps,px,pa,b,s,x,a,true))||(s instanceof Capsule&&n.particleCapsule(pb,ps,px,pa,b,s,x,a,true))||(s instanceof Particle&&vec2.squaredLength(vec2.sub(tmp,x,worldPoint))<precision*precision)){result.push(b)}}}return result};World.prototype.setGlobalStiffness=function(stiffness){var constraints=this.constraints;for(var i=0;i!==constraints.length;i++){var c=constraints[i];for(var j=0;j!==c.equations.length;j++){var eq=c.equations[j];eq.stiffness=stiffness;eq.needsUpdate=true}}var contactMaterials=this.contactMaterials;for(var i=0;i!==contactMaterials.length;i++){var c=contactMaterials[i];c.stiffness=c.frictionStiffness=stiffness}var c=this.defaultContactMaterial;c.stiffness=c.frictionStiffness=stiffness};World.prototype.setGlobalRelaxation=function(relaxation){for(var i=0;i!==this.constraints.length;i++){var c=this.constraints[i];for(var j=0;j!==c.equations.length;j++){var eq=c.equations[j];eq.relaxation=relaxation;eq.needsUpdate=true}}for(var i=0;i!==this.contactMaterials.length;i++){var c=this.contactMaterials[i];c.relaxation=c.frictionRelaxation=relaxation}var c=this.defaultContactMaterial;c.relaxation=c.frictionRelaxation=relaxation};var tmpAABB=new AABB();var tmpArray=[];World.prototype.raycast=function(result,ray){ray.getAABB(tmpAABB);this.broadphase.aabbQuery(this,tmpAABB,tmpArray);ray.intersectBodies(result,tmpArray);tmpArray.length=0;return result.hasHit()}},{'../../package.json':6,'../collision/AABB':7,'../collision/Broadphase':8,'../collision/Narrowphase':10,'../collision/Ray':11,'../collision/SAPBroadphase':13,'../constraints/Constraint':14,'../constraints/DistanceConstraint':15,'../constraints/GearConstraint':16,'../constraints/LockConstraint':17,'../constraints/PrismaticConstraint':18,'../constraints/RevoluteConstraint':19,'../events/EventEmitter':26,'../material/ContactMaterial':27,'../material/Material':28,'../math/vec2':30,'../objects/Body':31,'../objects/LinearSpring':32,'../objects/RotationalSpring':33,'../shapes/Capsule':38,'../shapes/Circle':39,'../shapes/Convex':40,'../shapes/Line':42,'../shapes/Particle':43,'../shapes/Plane':44,'../shapes/Shape':45,'../solver/GSSolver':46,'../solver/Solver':47,'../utils/OverlapKeeper':52,'../utils/Utils':57,'./IslandManager':59}]},{},[36])(36)})}),(function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_phaser__=__webpack_require__(3);var __WEBPACK_IMPORTED_MODULE_0_phaser___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_phaser__);var __WEBPACK_IMPORTED_MODULE_1__modules_preload_LoadGameElements__=__webpack_require__(13);var __WEBPACK_IMPORTED_MODULE_2__modules_create_CreateStaticGameElements__=__webpack_require__(14);var __WEBPACK_IMPORTED_MODULE_3__modules_create_CreateInteractiveGameElements__=__webpack_require__(4);var __WEBPACK_IMPORTED_MODULE_4__modules_create_Starter__=__webpack_require__(1);var __WEBPACK_IMPORTED_MODULE_5__modules_update_StarterListener__=__webpack_require__(5);let startInteractive=true;class GameScene extends __WEBPACK_IMPORTED_MODULE_0_phaser__["Scene"]{preload(){Object(__WEBPACK_IMPORTED_MODULE_1__modules_preload_LoadGameElements__["a"])(this)}create(){Object(__WEBPACK_IMPORTED_MODULE_2__modules_create_CreateStaticGameElements__["a"])(this);Object(__WEBPACK_IMPORTED_MODULE_3__modules_create_CreateInteractiveGameElements__["a"])(this);Object(__WEBPACK_IMPORTED_MODULE_4__modules_create_Starter__["a"])(this)}update(){Object(__WEBPACK_IMPORTED_MODULE_5__modules_update_StarterListener__["a"])(this)}}__webpack_exports__["a"]=GameScene}),(function(module,__webpack_exports__,__webpack_require__){"use strict";const LoadGameElements=(game)=>{game.load.image('background','assets/img/magic_forest_bg.png');game.load.image('bonfire','assets/img/magic_forest_bonfire.png');game.load.image('bonfire_small','assets/img/magic_forest_bonfire_small.png');game.load.image('bow','assets/img/magic_forest_bow.png');game.load.image('bow_small','assets/img/magic_forest_bow_small.png');game.load.image('leaf','assets/img/magic_forest_leaf.png');game.load.image('leaf_small','assets/img/magic_forest_leaf_small.png');game.load.image('rope','assets/img/magic_forest_rope.png');game.load.image('rope_small','assets/img/magic_forest_rope_small.png');game.load.image('tent','assets/img/magic_forest_tent.png');game.load.image('tent_small','assets/img/magic_forest_tent_small.png');game.load.image('button','assets/img/magic_forest_button.png');game.load.image('gift_icon','assets/img/magic_forest_gift_icon.png');game.load.image('question_icon','assets/img/magic_forest_question_icon.png');game.load.image('winner_frame','assets/img/magic_forest_winner_frame.png');game.load.image('coin_icon_big','assets/img/magic_forest_coin_icon_big.png');game.load.image('coin_icon_small','assets/img/magic_forest_coin_icon_small.png');game.load.image('dollar_icon','assets/img/magic_forest_dollar_icon.png');game.load.image('frame_for_text','assets/img/magic_forest_frame_for_text.png');game.load.image('frame','assets/img/magic_forest_frame.png');game.load.image('frame1','assets/img/magic_forest_frame1.png');game.load.image('frame2','assets/img/magic_forest_frame2.png');game.load.image('frame3','assets/img/magic_forest_frame3.png');game.load.image('brush','assets/img/brush.png');game.load.image('card_scratch','assets/img/magic_forest_scratch_frame.png');game.load.image('bonus_scratch','assets/img/magic_forest_scratch_frame_big.png');game.load.image('shadow','assets/img/magic_forest_shadow_40_percent.png');game.load.image('win_up_to_100','assets/img/magic_forest_win_up_to_100.png');game.load.image('winner','assets/img/magic_forest_winner.png')}__webpack_exports__["a"]=LoadGameElements}),(function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__config__=__webpack_require__(0);const CreateStaticGameElements=(game)=>{const background=game.add.image(0,0,'background').setOrigin(0).setDisplaySize(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width,__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.height);const brunch=game.add.image(__WEBPACK_IMPORTED_MODULE_0__config__["a"].scale.width,190,'winner_frame').setOrigin(1,0);const winText=game.add.image(150,80,'win_up_to_100').setOrigin(0);const frameText=game.add.image(45,1040,'frame_for_text').setOrigin(0);const staticTextStyle={fontFamily:'DRAguSans',fontSize:'52px',color:'#f45b4e',textTransform:'uppercase',}const textLeft=game.add.text(70,1065,'match the winner',staticTextStyle,);const textRight=game.add.text(640,textLeft.y,'and win a prize!',staticTextStyle,);textLeft.setText(textLeft.text.toUpperCase());textRight.setText(textRight.text.toUpperCase())}__webpack_exports__["a"]=CreateStaticGameElements}),(function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__=__webpack_require__(4);var __WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__=__webpack_require__(16);var __WEBPACK_IMPORTED_MODULE_2__create_Scratch__=__webpack_require__(6);var __WEBPACK_IMPORTED_MODULE_3__create_Starter__=__webpack_require__(1);let coins=0;console.log("coins 0",coins)const UpdateInteractiveElements=(game)=>{let cardsResult;const condition=Phaser.Math.Between(0,4);const probability=Phaser.Math.Between(0,99);const bonusProbability=Phaser.Math.Between(0,9);if(bonusProbability<=7){coins+=25}switch(condition){case 0:__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["d"].setTexture('bonfire_small');__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["b"].setTexture('bonfire');break;case 1:__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["d"].setTexture('bow_small');__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["b"].setTexture('bow');break;case 2:__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["d"].setTexture('leaf_small');__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["b"].setTexture('leaf');break;case 3:__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["d"].setTexture('rope_small');__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["b"].setTexture('rope');break;default:__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["d"].setTexture('tent_small');__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["b"].setTexture('tent')};switch(true){case(probability<2):cardsResult=Object(__WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__["a"])('tent');if(condition===4){coins+=100}break;case(probability>=2&&probability<6):cardsResult=Object(__WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__["a"])('rope');if(condition===3){coins+=50}break;case(probability>=6&&probability<12):cardsResult=Object(__WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__["a"])('leaf');if(condition===2){coins+=35}break;case(probability>=12&&probability<20):cardsResult=Object(__WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__["a"])('bow');if(condition===1){coins+=30}break;case(probability>=20&&probability<30):cardsResult=Object(__WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__["a"])('bonfire');if(condition===0){coins+=25}break;default:cardsResult=Object(__WEBPACK_IMPORTED_MODULE_1__additional_cardArrowCreator__["a"])('lose');break};Object(__WEBPACK_IMPORTED_MODULE_2__create_Scratch__["a"])(game);__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["c"].children.iterate((cell,i)=>{__WEBPACK_IMPORTED_MODULE_2__create_Scratch__["c"].draw('card_scratch',cell.x,cell.y);__WEBPACK_IMPORTED_MODULE_2__create_Scratch__["b"][`card_${i}`]={scratched:false,type:'card',diagonal:400,segment:280,initialX:cell.x,initialY:cell.y,}});__WEBPACK_IMPORTED_MODULE_0__create_CreateInteractiveGameElements__["e"].children.iterate((unit,i)=>{unit.setTexture(cardsResult[i])});if(bonusProbability>7){coins=1000}if(coins){if(coins<1000){__WEBPACK_IMPORTED_MODULE_3__create_Starter__["g"][2].setText(`${coins}`);__WEBPACK_IMPORTED_MODULE_3__create_Starter__["g"][3].setTexture('coin_icon_big')}else{__WEBPACK_IMPORTED_MODULE_3__create_Starter__["g"][2].setText(`1`);__WEBPACK_IMPORTED_MODULE_3__create_Starter__["g"][3].setTexture('dollar_icon')}}coins=0}__webpack_exports__["a"]=UpdateInteractiveElements}),(function(module,__webpack_exports__,__webpack_require__){"use strict";const cardArrowCreator=(unit)=>{console.log("cardArrowCreator -> unit",unit)const result=[];let items=['tent','rope','leaf','bow','bonfire'];const itemsRepeat={};items=items.filter(item=>{if(item!==unit){return item}});for(let i=0;i<6;i++){if(i<3&&unit!=='lose'){result.push(unit)}else{const randomCard=items[Math.floor(Math.random()*items.length)];itemsRepeat[randomCard]=itemsRepeat[randomCard]+1||0;if(itemsRepeat[randomCard]<2){result.push(randomCard)}else{i--}}}return arrayRandomizer(result)}__webpack_exports__["a"]=(cardArrowCreator);function arrayRandomizer(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1));var temp=array[i];array[i]=array[j];array[j]=temp}return array}})]);